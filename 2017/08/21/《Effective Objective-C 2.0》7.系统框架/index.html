<!DOCTYPE html>













<html class="theme-next gemini" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">



  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">













  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">







  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/panda/apple-touch-icon.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda/favicon-32x32.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda/favicon-16x16.png?v=7.1.0">


  <link rel="mask-icon" href="/images/panda/safari-pinned-tab.svg?v=7.1.0" color="#222">


  <link rel="manifest" href="/images/panda/site.webmanifest">


  <meta name="msapplication-config" content="/images/panda/browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '0E2AON8EZF',
      apiKey: '22fbefd84c8343239f5c04365b9728de',
      indexName: 'MyBlogPlatform',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="keywords" content="iOS,Objective-C">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶">
<meta property="og:url" content="https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/index.html">
<meta property="og:site_name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg">
<meta property="og:updated_time" content="2019-04-28T07:45:00.566Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶">
<meta name="twitter:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg">



  <link rel="alternate" href="/atom.xml" title="ç‹¬æœ¨èˆŸçš„æœ¨" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶ | ç‹¬æœ¨èˆŸçš„æœ¨</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8229a094facca297f211d61323fd9fde";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/andy0570" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ç‹¬æœ¨èˆŸçš„æœ¨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">iOS Developer</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»<span class="badge">14</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾<span class="badge">37</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£<span class="badge">317</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/andy0570" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
      <meta itemprop="description" content="æœ‰æ—¶å€™é˜³å…‰å¾ˆå¥½ æœ‰æ—¶å€™é˜³å…‰å¾ˆæš—">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-08-21 10:56:00" itemprop="dateCreated datePublished" datetime="2017-08-21T10:56:00+08:00">2017-08-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-04-28 15:45:00" itemprop="dateModified" datetime="2019-04-28T15:45:00+08:00">2019-04-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ã€ŠEffective-Objective-C-2-0ã€‹/" itemprop="url" rel="index"><span itemprop="name">ã€ŠEffective Objective-C 2.0ã€‹</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/" class="leancloud_visitors" data-flag-title="ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg" alt></p>
<a id="more"></a>
<h2 id="ç¬¬7ç« -ç³»ç»Ÿæ¡†æ¶"><a href="#ç¬¬7ç« -ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç¬¬7ç«  ç³»ç»Ÿæ¡†æ¶"></a>ç¬¬7ç«  ç³»ç»Ÿæ¡†æ¶</h2><h3 id="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"><a href="#ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"></a>ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶</h3><p><strong>æ¡†æ¶</strong>ï¼šå°†ä¸€ç³»åˆ—ä»£ç å°è£…ä¸ºåŠ¨æ€åº“ï¼ˆdynamic library)ï¼Œå¹¶åœ¨å…¶ä¸­æ”¾å…¥æè¿°å…¶æ¥å£çš„å¤´æ–‡ä»¶ã€‚</p>
<p><strong>é™æ€åº“</strong>ï¼šæœ‰æ—¶ä¸º iOS å¹³å°æ„å»ºçš„ç¬¬ä¸‰æ–¹æ¡†æ¶æ‰€ä½¿ç”¨çš„æ˜¯é™æ€åº“ï¼ˆstatic library)ï¼Œè¿™æ˜¯å› ä¸º iOS åº”ç”¨ç¨‹åºä¸å…è®¸åœ¨å…¶ä¸­åŒ…å«åŠ¨æ€åº“ã€‚è¿™äº›ä¸œè¥¿ä¸¥æ ¼æ¥è®²å¹¶ä¸æ˜¯çœŸæ­£çš„æ¡†æ¶ï¼Œç„¶è€Œä¹Ÿç»å¸¸è§†ä¸ºæ¡†æ¶ã€‚ä¸è¿‡ï¼Œæ‰€æœ‰ iOS å¹³å°çš„ç³»ç»Ÿæ¡†æ¶ä»ç„¶ä½¿ç”¨åŠ¨æ€åº“ã€‚</p>
<ul>
<li><p><strong>Cocoa</strong>ï¼šåœ¨ä¸º Mac OS X æˆ– iOS ç³»ç»Ÿå¼€å‘â€œå¸¦å›¾å½¢ç•Œé¢çš„åº”ç”¨ç¨‹åºâ€ï¼ˆgraphical application)æ—¶ï¼Œä¼šç”¨åˆ°åä¸º<strong>Cocoa</strong> çš„æ¡†æ¶ï¼Œåœ¨iOSä¸Šç§°ä¸º <strong>Cocoa Touch</strong>ã€‚</p>
</li>
<li><p><strong>Foundation</strong>ï¼šå®ƒæ˜¯æ‰€æœ‰ Objectice-C åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚<strong>Foundation</strong> æ¡†æ¶ä¸­çš„ç±»ä½¿ç”¨ <strong>NS</strong> å‰ç¼€ã€‚</p>
</li>
<li><p><strong>CoreFoundation</strong>ï¼šä»æŠ€æœ¯ä¸Šè®²ï¼Œ<strong>CoreFoundation</strong> æ¡†æ¶ä¸æ˜¯ Objective-C æ¡†æ¶ï¼Œä½†å®ƒå´æ˜¯ç¼–å†™ Objectice-C åº”ç”¨ç¨‹åºæ—¶æ‰€åº”ç†Ÿæ‚‰çš„é‡è¦æ¡†æ¶ï¼Œ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„è®¸å¤šåŠŸèƒ½ï¼Œéƒ½å¯ä»¥åœ¨æ­¤æ¡†æ¶ä¸­æ‰¾åˆ°å¯¹åº”çš„ C è¯­è¨€ APIã€‚</p>
<blockquote>
<p><strong>æ— ç¼æ¡¥æ¥</strong>ï¼ˆtoll- free bridging )åŠŸèƒ½:</p>
<p>æŠŠ <strong>CoreFoundation</strong> ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„å¹³æ»‘è½¬æ¢ä¸º <strong>Foundation</strong> ä¸­çš„ Objective-C å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åå‘è½¬æ¢ã€‚</p>
<p>æ— ç¼æ¡¥æ¥æŠ€æœ¯æ‰€å®ç°çš„ä»£ç å¯ä»¥ä½¿è¿è¡ŒæœŸç³»ç»ŸæŠŠ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„å¯¹è±¡è§†ä¸ºæ™®é€šçš„ Objective-C å¯¹è±¡ã€‚</p>
<p>ä¾‹å¦‚ï¼šNSString  &lt;â€”&gt; CFString</p>
</blockquote>
</li>
<li><p><strong>CFNetwork</strong>ï¼šæ­¤æ¡†æ¶æä¾›äº† C è¯­è¨€çº§åˆ«çš„ç½‘ç»œé€šä¿¡èƒ½åŠ›ï¼Œå®ƒå°† <strong>BSDå¥—æ¥å­—</strong>ï¼ˆBSD socketï¼‰æŠ½è±¡æˆæ˜“äºä½¿ç”¨çš„ç½‘ç»œæ¥å£ã€‚è€Œ <strong>Foundation</strong> åˆ™å°†è¯¥æ¡†æ¶é‡Œçš„éƒ¨åˆ†å†…å®¹å°è£…ä¸º Objective-C è¯­è¨€çš„æ¥å£ï¼Œä»¥ä¾¿è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œä¾‹å¦‚å¯ä»¥ç”¨ <strong>NSURLConnection</strong> ä» URL ä¸­ä¸‹è½½æ•°æ®ã€‚</p>
</li>
<li><p><strong>CoreAudio</strong>ï¼šè¯¥æ¡†æ¶æ‰€æä¾›çš„ C è¯­è¨€ API å¯ç”¨æ¥æ“ä½œè®¾å¤‡ä¸Šçš„éŸ³é¢‘ç¡¬ä»¶ã€‚è¿™ä¸ªæ¡†æ¶å±äºæ¯”è¾ƒéš¾ç”¨çš„é‚£ç§ï¼Œå› ä¸ºéŸ³é¢‘å¤„ç†æœ¬èº«å°±å¾ˆå¤æ‚ã€‚æ‰€å¹¸ç”±è¿™å¥— API å¯ä»¥æŠ½è±¡å‡ºå¦å¤–ä¸€ å¥— Objective-C å¼ APIï¼Œç”¨åè€…æ¥å¤„ç†éŸ³é¢‘é—®é¢˜ä¼šæ›´ç®€å•äº›ã€‚</p>
</li>
<li><p><strong>AVFoundation</strong>ï¼šæ­¤æ¡†æ¶æ‰€æä¾›çš„ Objective-C å¯¹è±¡å¯ç”¨æ¥å›æ”¾å¹¶å½•åˆ¶éŸ³é¢‘åŠè§†é¢‘ï¼Œæ¯”å¦‚èƒ½å¤Ÿåœ¨ UIè§†å›¾ç±»é‡Œæ’­æ”¾è§†é¢‘ã€‚</p>
</li>
<li><p><strong>CoreData</strong>ï¼šæ­¤æ¡†æ¶æ‰€æä¾›çš„ Objective-C æ¥å£å¯å°†å¯¹è±¡æ”¾äººæ•°æ®åº“ï¼Œä¾¿äºæŒä¹…ä¿å­˜ã€‚ <strong>CoreData</strong> ä¼šå¤„ç†æ•°æ®çš„è·å–åŠå­˜å‚¨äº‹å®œï¼Œè€Œä¸”å¯ä»¥è·¨è¶Š Mac OS X åŠ iOS å¹³å°ã€‚</p>
</li>
<li><p><strong>CoreText</strong>ï¼šæ­¤æ¡†æ¶æä¾›çš„ C è¯­è¨€æ¥å£å¯ä»¥é«˜æ•ˆæ‰§è¡Œæ–‡å­—æ’ç‰ˆåŠæ¸²æŸ“æ“ä½œã€‚</p>
</li>
</ul>
<p>Objective-C ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§ï¼šç»å¸¸éœ€è¦ä½¿ç”¨åº•å±‚çš„ C è¯­è¨€çº§ APIã€‚ç”¨ C è¯­è¨€æ¥å®ç° API çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥ç»•è¿‡ Objective-C çš„è¿è¡ŒæœŸç³»ç»Ÿï¼Œä»è€Œæå‡æ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p>è¯»è€…å¯èƒ½ä¼šç¼–å†™ä½¿ç”¨ UI æ¡†æ¶çš„ Mac OS X æˆ– iOS åº”ç”¨ç¨‹åºã€‚è¿™ä¸¤ä¸ªå¹³å°çš„æ ¸å¿ƒ UI æ¡†æ¶åˆ†åˆ«å«åš <strong>AppKit</strong> åŠ <strong>UIKit</strong> ,å®ƒä»¬éƒ½æä¾›äº†æ„å»ºåœ¨ <strong>Foundation</strong> ä¸ <strong>CoreFoundation</strong> ä¹‹ä¸Šçš„ Objective-C ç±»ã€‚æ¡†æ¶é‡Œå«æœ‰ UI å…ƒç´ ï¼Œä¹Ÿå«æœ‰ç²˜åˆæœºåˆ¶ï¼Œä»¤å¼€å‘è€…å¯å°†æ‰€æœ‰ç›¸å…³å†…å®¹ç»„è£…ä¸ºåº”ç”¨ç¨‹åºã€‚åœ¨è¿™äº›ä¸»è¦çš„ UI æ¡†æ¶ä¹‹ä¸‹ï¼Œæ˜¯ <strong>CoreAnimation</strong> ä¸ <strong>CoreGraphics</strong> æ¡†æ¶ã€‚</p>
<ul>
<li><strong>CoreAnimation</strong> æ˜¯ç”¨ Objective-C è¯­è¨€å†™æˆçš„ï¼Œå®ƒæä¾›äº†ä¸€äº›å·¥å…·ï¼Œè€Œ UI æ¡†æ¶åˆ™ç”¨è¿™äº›å·¥å…·æ¥æ¸²æŸ“å›¾å½¢å¹¶æ’­æ”¾åŠ¨ç”»ã€‚å¼€å‘è€…ç¼–ç¨‹æ—¶å¯èƒ½ä»æ¥ä¸ä¼šæ·±å…¥åˆ°è¿™ç§çº§åˆ«ï¼Œä¸è¿‡çŸ¥é“è¯¥æ¡†æ¶æ€»æ˜¯å¥½çš„ã€‚<strong>CoreAnimation</strong> æœ¬èº«å¹¶ä¸æ˜¯æ¡†æ¶ï¼Œå®ƒæ˜¯ <strong>QuartzCore</strong> æ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œåœ¨æ¡†æ¶çš„å›½åº¦é‡Œï¼Œ<strong>CoreAnimation</strong> ä»åº”ç®—ä½œâ€œä¸€ç­‰å…¬æ°‘â€ï¼ˆfirst-class citizen)ã€‚</li>
<li><strong>CoreGraphics</strong> æ¡†æ¶ä»¥ C è¯­è¨€å†™æˆï¼Œå…¶ä¸­æä¾›äº† 2D æ¸²æŸ“æ‰€å¿…å¤‡çš„æ•°æ®ç»“æ„ä¸å‡½æ•°ã€‚ä¾‹å¦‚, å…¶ä¸­å®šä¹‰äº† CGPointã€CGSizeã€CGRect ç­‰æ•°æ®ç»“æ„ï¼Œè€Œ <strong>UllKit</strong> æ¡†æ¶ä¸­çš„ <strong>UlView</strong> ç±»åœ¨ç¡®å®šè§†å›¾æ§ä»¶ä¹‹é—´çš„ç›¸å¯¹ä½ç½®æ—¶ï¼Œè¿™äº›æ•°æ®ç»“æ„éƒ½è¦ç”¨åˆ°ã€‚</li>
</ul>
<p>è¿˜æœ‰å¾ˆå¤šæ¡†æ¶æ„å»ºåœ¨ UI æ¡†æ¶ä¹‹ä¸Šï¼Œæ¯”æ–¹è¯´ <strong>MapKit</strong> æ¡†æ¶ï¼Œå®ƒå¯ä»¥ä¸º iOS ç¨‹åºæä¾›åœ°å›¾åŠŸèƒ½ã€‚åˆæ¯”å¦‚ <strong>Social</strong> æ¡†æ¶ï¼Œå®ƒä¸º Mac OS X åŠ iOS ç¨‹åºæä¾›äº†ç¤¾äº¤ç½‘ç»œï¼ˆsocial networking) åŠŸèƒ½ã€‚å¼€å‘è€…é€šå¸¸ä¼šå°†è¿™äº›æ¡†æ¶ä¸æ“ä½œç³»ç»Ÿå¹³å°æ‰€å¯¹åº”çš„æ ¸å¿ƒ UI æ¡†æ¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè®¸å¤šæ¡†æ¶éƒ½æ˜¯å®‰è£… Mac OS X ä¸ iOS ç³»ç»Ÿæ—¶çš„æ ‡å‡†é…ç½®ã€‚æ‰€ä»¥ï¼Œåœ¨æ‰“ç®—ç¼–å†™æ–°çš„å·¥å…·ç±»ä¹‹å‰ï¼Œæœ€å¥½åœ¨ç³»ç»Ÿæ¡†æ¶é‡Œæœä¸€ä¸‹ï¼Œé€šå¸¸éƒ½æœ‰å†™å¥½çš„ç±»å¯ä¾›ç›´æ¥ä½¿ç”¨ã€‚</p>
<h4 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>è®¸å¤šç³»ç»Ÿæ¡†æ¶éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯ <strong>Foundation</strong> ä¸ <strong>CoreFoundation</strong>ï¼Œè¿™ä¸¤ä¸ªæ¡†æ¶æä¾›äº†æ„å»ºåº”ç”¨ç¨‹åºæ‰€éœ€çš„è®¸å¤šæ ¸å¿ƒåŠŸèƒ½ã€‚</li>
<li>å¾ˆå¤šå¸¸è§ä»»åŠ¡éƒ½èƒ½ç”¨æ¡†æ¶æ¥åšï¼Œä¾‹å¦‚éŸ³é¢‘ä¸è§†é¢‘å¤„ç†ã€ç½‘ç»œé€šä¿¡ã€æ•°æ®ç®¡ç†ç­‰ã€‚</li>
</ul>
<ul>
<li>è¯·è®°ä½ï¼Œ<strong>ç”¨çº¯ C å†™æˆçš„æ¡†æ¶ä¸ç”¨ Objective-C å†™æˆçš„ä¸€æ ·é‡è¦ï¼Œè‹¥æƒ³æˆä¸ºä¼˜ç§€çš„ Objective-C å¼€å‘è€…ï¼Œåº”è¯¥æŒæ¡ C è¯­è¨€çš„æ ¸å¿ƒæ¦‚å¿µ</strong>ã€‚</li>
</ul>
<h3 id="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨-for-å¾ªç¯"><a href="#ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨-for-å¾ªç¯" class="headerlink" title="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯"></a>ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯</h3><p>å®ç°æšä¸¾çš„æ–¹æ³•ï¼š</p>
<ol>
<li>æ ‡å‡†çš„ C è¯­è¨€å¾ªç¯ï¼›</li>
<li>Objective-C 1.0 çš„ <strong>NSEnumerator</strong> æ–¹æ³•ï¼›</li>
<li>Objective-C 2.0 çš„å¿«é€Ÿéå†æ³•ï¼ˆfast enumeration)ã€‚</li>
<li>åŸºäºå—çš„éå†æ–¹å¼ã€‚</li>
</ol>
<h4 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">NSArray *array;</span><br><span class="line">for (int i = 0; i &lt; array.count; i++) &#123;</span><br><span class="line">    id object = array[i];</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSDictionary */</span><br><span class="line">NSDictionary *dictionary;</span><br><span class="line">NSArray *keys = [dictionary allKeys];</span><br><span class="line">for (int i = 0; i &lt; keys.count; i++) &#123;</span><br><span class="line">    id key = keys[i];</span><br><span class="line">    id value = dictionary[key];</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSSet */</span><br><span class="line">NSSet *set;</span><br><span class="line">NSArray *objects = [set allObjects];</span><br><span class="line">for (int i = 0; i &lt; objects.count; i++) &#123;</span><br><span class="line">    id object = object[i];</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ ¹æ®å®šä¹‰ï¼Œå­—å…¸ä¸setéƒ½æ˜¯â€œæ— åºçš„â€ï¼ˆimoniered)ï¼Œæ‰€ä»¥æ— æ³•æ ¹æ®ç‰¹å®šçš„æ•´æ•°ä¸‹æ ‡æ¥ç›´æ¥è®¿é—®å…¶ä¸­çš„å€¼ã€‚äºæ˜¯ï¼Œå°±éœ€è¦å…ˆè·å–å­—å…¸é‡Œçš„æ‰€æœ‰é”®æˆ–æ˜¯seté‡Œçš„æ‰€æœ‰å¯¹è±¡ï¼Œè¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥åœ¨è·å–åˆ°çš„æœ‰åºæ•°ç»„ä¸Šéå†ï¼Œä»¥ä¾¿å€Ÿæ­¤è®¿é—®åŸå­—å…¸åŠåŸsetä¸­çš„å€¼ã€‚åˆ›å»ºè¿™ä¸ªé™„åŠ æ•°ç»„ä¼šæœ‰é¢å¤–å¼€é”€ï¼Œè€Œä¸”è¿˜ä¼šå¤šåˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå®ƒä¼šä¿ç•™collectionä¸­çš„æ‰€æœ‰å…ƒç´ å¯¹è±¡ã€‚</p>
</blockquote>
<h4 id="ä½¿ç”¨-Objective-C-1-0-çš„-NSEnumerator-éå†"><a href="#ä½¿ç”¨-Objective-C-1-0-çš„-NSEnumerator-éå†" class="headerlink" title="ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†"></a>ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†</h4><p><strong>NSEnumerator.h</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    unsigned long state;</span><br><span class="line">    id __unsafe_unretained _Nullable * _Nullable itemsPtr;</span><br><span class="line">    unsigned long * _Nullable mutationsPtr;</span><br><span class="line">    unsigned long extra[5];</span><br><span class="line">&#125; NSFastEnumerationState;</span><br><span class="line"></span><br><span class="line">@protocol NSFastEnumeration</span><br><span class="line"></span><br><span class="line">- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(id __unsafe_unretained _Nullable [_Nonnull])buffer count:(NSUInteger)len;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@interface NSEnumerator&lt;ObjectType&gt; : NSObject &lt;NSFastEnumeration&gt;</span><br><span class="line"></span><br><span class="line">//â‡ï¸ è¿”å›æšä¸¾é‡Œçš„ä¸‹ä¸ªå¯¹è±¡ã€‚æ¯æ¬¡è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå…¶å†…éƒ¨æ•°æ®ç»“æ„éƒ½ä¼šæ›´æ–°ï¼Œä½¿å¾—ä¸‹æ¬¡è°ƒç”¨æ–¹æ³•æ—¶èƒ½è¿”å›ä¸‹ä¸ªå¯¹è±¡ã€‚ç­‰åˆ°æšä¸¾ä¸­çš„å…¨éƒ¨å¯¹è±¡éƒ½å·²è¿”å›ä¹‹åï¼Œå†è°ƒç”¨å°±å°†è¿”å›nilï¼Œè¿™è¡¨ç¤ºè¾¾åˆ°æšä¸¾æœ«ç«¯äº†ã€‚</span><br><span class="line">- (nullable ObjectType)nextObject;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@interface NSEnumerator&lt;ObjectType&gt; (NSExtendedEnumerator)</span><br><span class="line"></span><br><span class="line">@property (readonly, copy) NSArray&lt;ObjectType&gt; *allObjects;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">NSArray *array;</span><br><span class="line">NSEnumerator *enumerator = [array objectEnumerator];</span><br><span class="line">id object;</span><br><span class="line">while ((object = [enumerator nextObject]) != nil) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSDictionary */</span><br><span class="line">NSDictionary *dictionary;</span><br><span class="line">NSEnumerator *enumerator = [dictionary keyEnumerator];</span><br><span class="line">id key;</span><br><span class="line">while ((key = [enumerator nextObject]) != nil) &#123;</span><br><span class="line">    id value = dictionary[key];</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSSet */</span><br><span class="line">NSSet *set;</span><br><span class="line">NSEnumerator *enumerator = [set objectEnumerator];</span><br><span class="line">id object;</span><br><span class="line">while ((object = [enumerator nextObject]) != nil) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ä¼˜ç‚¹ï¼šä¸è®ºéå†å“ªç§ collectionï¼Œéƒ½å¯ä»¥é‡‡ç”¨è¿™å¥—ç›¸ä¼¼çš„è¯­æ³•ã€‚</p>
</li>
<li><p><strong>NSEnumerator</strong> è¿˜æœ‰å¤šç§â€œæšä¸¾å™¨â€ï¼ˆenumerator) å¯ä¾›ä½¿ç”¨ï¼Œå¦‚åå‘éå†æ•°ç»„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">NSArray *array;</span><br><span class="line">// reverseObjectEnumeratorï¼šåå‘éå†æ•°ç»„</span><br><span class="line">NSEnumerator *enumerator = [array reverseObjectEnumerator];</span><br><span class="line">id object;</span><br><span class="line">while ((object = [enumerator nextObject]) != nil) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="å¿«é€Ÿéå†"><a href="#å¿«é€Ÿéå†" class="headerlink" title="å¿«é€Ÿéå†"></a>å¿«é€Ÿéå†</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">NSArray *array;</span><br><span class="line">for (id object in array) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSDictionary */</span><br><span class="line">NSDictionary *dictionary;</span><br><span class="line">for (id key in dictionary) &#123;</span><br><span class="line">    id value = dictionary[key];</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** NSSet */</span><br><span class="line">NSSet *set;</span><br><span class="line">for (id object in set) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæŸä¸ªç±»çš„å¯¹è±¡æ”¯æŒå¿«é€Ÿéå†ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®£ç§°è‡ªå·±éµä»åä¸º <strong>NSFastEmimeraticm</strong> çš„åè®®ï¼Œä»è€Œä»¤å¼€å‘è€…å¯ä»¥é‡‡ç”¨æ­¤è¯­æ³•æ¥è¿­ä»£è¯¥å¯¹è±¡ã€‚</p>
<p><strong>è¯¥æ–¹æ³•å…è®¸ç±»å®ä¾‹åŒæ—¶è¿”å›å¤šä¸ªå¯¹è±¡ï¼Œä½¿å¾—å¾ªç¯éå†æ“ä½œæ›´ä¸ºé«™æ•ˆã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@protocol NSFastEnumeration</span><br><span class="line"></span><br><span class="line">- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state</span><br><span class="line">                                  objects:(id __unsafe_unretained _Nullable [_Nonnull])buffer</span><br><span class="line">                                    count:(NSUInteger)len;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h4 id="åŸºäºå—çš„éå†æ–¹å¼"><a href="#åŸºäºå—çš„éå†æ–¹å¼" class="headerlink" title="åŸºäºå—çš„éå†æ–¹å¼"></a>åŸºäºå—çš„éå†æ–¹å¼</h4><p><strong>æ–¹æ³•åˆ—è¡¨</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">- (void)enumerateObjectsUsingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;</span><br><span class="line">- (void)enumerateObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;</span><br><span class="line">- (void)enumerateObjectsAtIndexes:(NSIndexSet *)s options:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;</span><br><span class="line"></span><br><span class="line">/** NSDictionary */</span><br><span class="line">- (void)enumerateKeysAndObjectsUsingBlock:(void (NS_NOESCAPE ^)(KeyType key, ObjectType obj, BOOL *stop))block;</span><br><span class="line">- (void)enumerateKeysAndObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(KeyType key, ObjectType obj, BOOL *stop))block;</span><br><span class="line"></span><br><span class="line">/** NSSet */</span><br><span class="line">- (void)enumerateObjectsUsingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, BOOL *stop))block;</span><br><span class="line">- (void)enumerateObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, BOOL *stop))block;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/** NSArray */</span><br><span class="line">NSArray *array;</span><br><span class="line">[array enumerateObjectsUsingBlock:^(id  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">    if (shouldStop) &#123;</span><br><span class="line">        *stop = YES;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">/** NSDictionary */</span><br><span class="line">NSDictionary *dictionary;</span><br><span class="line">[dictionary enumerateKeysAndObjectsUsingBlock:^(id  _Nonnull key, id  _Nonnull obj, BOOL * _Nonnull stop) &#123;</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">    if (shouldStop) &#123;</span><br><span class="line">        *stop = YES;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">/** NSSet */</span><br><span class="line">NSSet *set;</span><br><span class="line">[set enumerateObjectsUsingBlock:^(id  _Nonnull obj, BOOL * _Nonnull stop) &#123;</span><br><span class="line">    // Do something with &apos;object&apos;</span><br><span class="line">    if (shouldStop) &#123;</span><br><span class="line">        *stop = YES;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>æ­¤æ–¹å¼çš„ä¼˜ç‚¹ï¼š</p>
<ol>
<li><p>éå†æ—¶å¯ä»¥ç›´æ¥ä»å—é‡Œè·å–æ›´å¤šä¿¡æ¯ã€‚</p>
</li>
<li><p>èƒ½å¤Ÿä¿®æ”¹å—çš„æ–¹æ³•ç­¾åï¼Œä»¥å…è¿›è¡Œç±»å‹è½¬æ¢æ“ä½œï¼Œä»æ•ˆæœä¸Šè®²ï¼Œç›¸å½“äºæŠŠæœ¬æ¥éœ€è¦æ‰§è¡Œçš„ç±»å‹è½¬æ¢æ“ä½œäº¤ç»™å—æ–¹æ³•ç­¾åæ¥åšã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// for-in éå†ï¼š</span><br><span class="line">NSDictionary *dictionary;</span><br><span class="line">for (NSString *key in dictionary) &#123;</span><br><span class="line">    NSString *object = (NSString *)dictionary[key];</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åŸºäºå—çš„éå†ï¼Œå¯ä»¥åœ¨å—æ–¹æ³•ç­¾åä¸­ç›´æ¥è½¬æ¢æ•°æ®ç±»å‹ï¼š</span><br><span class="line">[dictionary enumerateKeysAndObjectsUsingBlock:^(NSString *key, NSString *obj, BOOL *stop) &#123;</span><br><span class="line">    // Do something with &apos;key&apos; and &apos;value&apos;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
<li><p>åå‘éå†ï¼šè®¾ç½® <strong>NSEnumerationOptions</strong> é€‰é¡¹ä¸º <code>NSEnumerationReverse</code>ã€‚</p>
</li>
<li><p>å¹¶è¡Œæ‰§è¡Œï¼šè®¾ç½® <strong>NSEnumerationOptions</strong> é€‰é¡¹ä¸º <code>NSEnumerationConcurrent</code>ã€‚</p>
</li>
</ol>
<h4 id="è¦ç‚¹-1"><a href="#è¦ç‚¹-1" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>éå† collection æœ‰4ç§æ–¹å¼ã€‚æœ€åŸºæœ¬çš„åŠæ³•æ˜¯ <strong>for å¾ªç¯</strong>ï¼Œå…¶æ¬¡æ˜¯ <strong>NSEnumerator</strong> éå†æ–¹æ³•åŠ<strong>å¿«é€Ÿéå†æ³•</strong>ï¼Œæœ€æ–°ã€æœ€å…ˆè¿›çš„æ–¹å¼åˆ™æ˜¯ <strong>å—æšä¸¾æ³•</strong>ã€‚</li>
<li><strong>å—æšä¸¾æ³•</strong> æœ¬èº«å°±èƒ½é€šè¿‡ GCD æ¥å¹¶å‘æ‰§è¡Œéå†æ“ä½œï¼Œæ— éœ€å¦è¡Œç¼–å†™ä»£ç ã€‚è€Œé‡‡ç”¨å…¶ä»–éå†æ–¹å¼åˆ™æ— æ³•è½»æ˜“å®ç°è¿™ä¸€ç‚¹ã€‚</li>
<li>è‹¥æå‰çŸ¥é“å¾…éå†çš„ collection å«æœ‰ä½•ç§å¯¹è±¡ï¼Œåˆ™åº”ä¿®æ”¹å—ç­¾åï¼ŒæŒ‡å‡ºå¯¹è±¡çš„å…·ä½“ç±»å‹ã€‚</li>
</ul>
<h3 id="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„-collection-ä½¿ç”¨æ— ç¼æ¡¥æ¥"><a href="#ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„-collection-ä½¿ç”¨æ— ç¼æ¡¥æ¥" class="headerlink" title="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥"></a>ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥</h3><p><strong>æ— ç¼æ¡¥æ¥</strong>ï¼šå¯ä»¥åœ¨å®šä¹‰äº <strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C ç±»å’Œå®šä¹‰äº <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C æ•°æ®ç»“æ„ä¹‹é—´äº’ç›¸è½¬æ¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// NSArray â†’ CFArray</span><br><span class="line">NSArray *anNSArray = @[@1, @2, @3, @4, @5];</span><br><span class="line">// CFArray éœ€è¦é€šè¿‡ CFArrayRef æ¥å¼•ç”¨ï¼Œ</span><br><span class="line">// CFArrayRef æ˜¯æŒ‡å‘ struct__CFArray çš„æŒ‡é’ˆ</span><br><span class="line">CFArrayRef aCFArray = (__bridge CFArrayRef)anNSArray;</span><br><span class="line">NSLog(@&quot;Size of array = %li&quot;, CFArrayGetCount(aCFArray));</span><br></pre></td></tr></table></figure>
<h4 id="æ¡¥å¼è½¬æ¢"><a href="#æ¡¥å¼è½¬æ¢" class="headerlink" title="æ¡¥å¼è½¬æ¢"></a>æ¡¥å¼è½¬æ¢</h4><ul>
<li><code>__bridge</code> å‘Šè¯‰ARC (å‚è§ç¬¬30æ¡ï¼‰å¦‚ä½•å¤„ç†è½¬æ¢æ‰€æ¶‰åŠçš„ Objective-C å¯¹è±¡ã€‚</li>
<li><code>__bridge</code> æœ¬èº«çš„æ„æ€æ˜¯ï¼šARC ä»ç„¶å…·å¤‡è¿™ä¸ª Objective-C å¯¹è±¡çš„æ‰€æœ‰æƒã€‚è€Œ <code>__bridge_ retained</code> åˆ™ä¸ä¹‹ç›¸åï¼Œæ„å‘³ç€ ARC å°†äº¤å‡ºå¯¹è±¡çš„æ‰€æœ‰æƒã€‚</li>
<li>åå‘è½¬æ¢å¯é€šè¿‡ <code>__bridge_transfer</code> æ¥å®ç°ã€‚</li>
</ul>
<h4 id="éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š"><a href="#éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š" class="headerlink" title="éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š"></a>éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š</h4><ul>
<li><strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C ç±»æ‰€å…·å¤‡çš„æŸäº›åŠŸèƒ½ï¼Œæ˜¯ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„æ‰€ä¸å…·å¤‡çš„ã€‚</li>
<li><p>åœ¨ä½¿ç”¨ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„å­—å…¸å¯¹è±¡æ—¶ä¼šé‡åˆ°ä¸€ä¸ªå¤§é—®é¢˜ï¼Œé‚£å°±æ˜¯å…¶é”®çš„å†…å­˜ç®¡ç†è¯­ä¹‰ä¸ºâ€œæ‹·è´â€ï¼Œè€Œå€¼çš„è¯­ä¹‰å´æ˜¯â€œä¿ç•™â€ã€‚é™¤éä½¿ç”¨å¼ºå¤§çš„æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¦åˆ™æ— æ³•æ”¹å˜å…¶è¯­ä¹‰ã€‚</p>
<p>åˆ›å»º <strong>CFMutableDictionary</strong> æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹åˆ—æ–¹æ³•æ¥æŒ‡å®šé”®å’Œå€¼çš„å†…å­˜ç®¡ç†è¯­ä¹‰:</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CFMutableDictionaryRef CFDictionaryCreateMutable(</span><br><span class="line">    CFAllocatorRef allocator,</span><br><span class="line">    CFIndex capacity,</span><br><span class="line">    const CFDictionaryKeyCallBacks *keyCallBacks,</span><br><span class="line">    const CFDictionaryValueCallBacks *valueCallBacks</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>CFAllocatorRef</code>ï¼šå°†è¦ä½¿ç”¨çš„å†…å­˜åˆ†é…å™¨ï¼ˆallocator) ã€‚<strong>CoreFoundation</strong> å¯¹è±¡é‡Œçš„æ•°æ®ç»“æ„éœ€è¦å ç”¨å†…å­˜ï¼Œè€Œåˆ†é…å™¨è´Ÿè´£åˆ†é…åŠå›æ”¶è¿™äº›å†…å­˜ã€‚å¼€å‘è€…é€šå¸¸ä¸ºè¿™ä¸ªå‚æ•°ä¼ äºº <strong>NULL</strong>ï¼Œè¡¨ç¤ºé‡‡ç”¨é»˜è®¤çš„åˆ†é…å™¨ã€‚</p>
</li>
<li><p><code>CFIndex</code>ï¼šå®šä¹‰å­—å…¸çš„åˆå§‹å¤§å°ã€‚å®ƒå¹¶ä¸ä¼šé™åˆ¶å­—å…¸çš„æœ€å¤§å®¹æ™¯ï¼Œåªæ˜¯å‘åˆ†é…å™¨æç¤ºä¸€å¼€å§‹åº”è¯¥åˆ†é…å¤šå°‘å†…å­˜ã€‚å‡å¦‚è¦åˆ›å»ºçš„å­—å…¸å«æœ‰10ä¸ªå¯¹è±¡ï¼Œé‚£å°±å‘è¯¥å‚æ•°ä¼ å…¥10ã€‚</p>
</li>
<li><p>æœ€åä¸¤ä¸ªå‚æ•°å€¼å¾—æ³¨æ„ã€‚å®ƒä»¬å®šä¹‰äº†è®¸å¤šå›è°ƒå‡½æ•°ï¼Œç”¨äºæŒ‡ç¤ºå­—å…¸ä¸­çš„é”®å’Œå€¼åœ¨é‡åˆ°å„ç§äº‹ä»¶æ—¶åº”è¯¥æ‰§è¡Œä½•ç§æ“ä½œã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼ŒäºŒè€…æ‰€å¯¹åº”çš„ç»“æ„ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    CFIndex				version;</span><br><span class="line">    CFDictionaryRetainCallBack		retain;</span><br><span class="line">    CFDictionaryReleaseCallBack		release;</span><br><span class="line">    CFDictionaryCopyDescriptionCallBack	copyDescription;</span><br><span class="line">    CFDictionaryEqualCallBack		equal;</span><br><span class="line">    CFDictionaryHashCallBack		hash;</span><br><span class="line">&#125; CFDictionaryKeyCallBacks;</span><br><span class="line"></span><br><span class="line">typedef struct &#123;</span><br><span class="line">    CFIndex				version;</span><br><span class="line">    CFDictionaryRetainCallBack		retain;</span><br><span class="line">    CFDictionaryReleaseCallBack		release;</span><br><span class="line">    CFDictionaryCopyDescriptionCallBack	copyDescription;</span><br><span class="line">    CFDictionaryEqualCallBack		equal;</span><br><span class="line">&#125; CFDictionaryValueCallBacks;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * versionå‚æ•°ç›®å‰åº”è®¾ä¸º0ã€‚å½“å‰ç¼–ç¨‹æ—¶æ€»æ˜¯å–è¿™ä¸ªå€¼ï¼Œä¸è¿‡å°†æ¥è‹¹æœå…¬å¸ä¹Ÿè®¸ä¼šä¿®æ”¹æ­¤ç»“æ„ä½“ï¼Œæ‰€ä»¥</span><br><span class="line"> * è¦é¢„ç•™è¯¥å€¼ä»¥è¡¨ç¤ºç‰ˆæœ¬å·ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥ç”¨äºæ£€æµ‹æ–°ç‰ˆä¸æ—§ç‰ˆæ•°æ®ç»“æ„ä¹‹é—´æ˜¯å¦å…¼å®¹ã€‚</span><br><span class="line"> * ç»“æ„ä½“ä¸­çš„å…¶ä½™æˆå‘˜éƒ½æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œå®ƒä»¬å®šä¹‰äº†å½“å„ç§äº‹ä»¶å‘ç”Ÿæ—¶åº”è¯¥é‡‡ç”¨å“ªä¸ªå‡½æ•°æ¥æ‰§è¡Œç›¸å…³ä»»åŠ¡ã€‚</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åº•å±‚å®ç°æœ‰ç‚¹å¤æ‚ï¼Œæš‚ç¼“ç ”ç©¶ğŸ˜‚</p>
</blockquote>
</li>
</ul>
<h4 id="è¦ç‚¹-2"><a href="#è¦ç‚¹-2" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>é€šè¿‡æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C å¯¹è±¡ä¸ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„ä¹‹å‰æ¥å›è½¬æ¢ã€‚</li>
<li>åœ¨ <strong>CoreFoundation</strong> å±‚é¢åˆ›å»º collection æ—¶ï¼Œå¯ä»¥æŒ‡å®šè®¸å¤šå›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¡¨ç¤ºæ­¤ collection åº”å¦‚ä½•å¤„ç†å…¶å…ƒç´ ã€‚ç„¶åï¼Œå¯è¿ç”¨æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå°†å…¶è½¬æ¢æˆå…·å¤‡ç‰¹æ®Šå†…å­˜ç®¡ç†è¯­ä¹‰çš„ Objective-C collectionã€‚</li>
</ul>
<h3 id="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary"><a href="#ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary" class="headerlink" title="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary"></a>ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary</h3><ul>
<li><strong>NSCache</strong> èƒœè¿‡ <strong>NSDictionary</strong> ä¹‹å¤„åœ¨äºï¼Œå½“ç³»ç»Ÿèµ„æºå°†è¦è€—å°½æ—¶ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åˆ å‡ç¼“å­˜ã€‚</li>
<li><strong>NSCache</strong> è¿˜ä¼šå…ˆè¡Œåˆ å‡ <strong>æœ€ä¹…æœªä½¿ç”¨çš„ï¼ˆlease recently used) å¯¹è±¡</strong>ã€‚</li>
<li><strong>NSCache</strong> å¹¶ä¸ä¼šâ€œæ‹·è´â€é”®ï¼Œè€Œæ˜¯ä¼šâ€œä¿ç•™â€å®ƒã€‚åŸå› åœ¨äºï¼Œå¾ˆå¤šæ—¶å€™ï¼Œé”®éƒ½æ˜¯ç”±ä¸æ”¯æŒæ‹·è´æ“ä½œçš„å¯¹è±¡æ¥å……å½“çš„ã€‚</li>
<li><strong>NSCache</strong> æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚åœ¨å¼€å‘è€…è‡ªå·±ä¸ç¼–å†™åŠ é”ä»£ç çš„å‰æä¸‹ï¼Œ å¤šä¸ªçº¿ç¨‹ä¾¿å¯ä»¥åŒæ—¶è®¿é—®<strong>NSCache</strong>ã€‚å¯¹ç¼“å­˜æ¥è¯´ï¼Œçº¿ç¨‹å®‰å…¨é€šå¸¸å¾ˆé‡è¦ï¼Œå› ä¸ºå¼€å‘è€…å¯èƒ½è¦åœ¨æŸä¸ªçº¿ç¨‹ä¸­è¯»å–æ•°æ®ï¼Œæ­¤æ—¶å¦‚æœå‘ç°ç¼“å­˜é‡Œæ‰¾ä¸åˆ°æŒ‡å®šçš„é”®ï¼Œé‚£ä¹ˆå°±è¦ä¸‹è½½è¯¥é”®æ‰€å¯¹åº”çš„æ•°æ®äº†ã€‚è€Œä¸‹è½½å®Œæ•°æ®ä¹‹åæ‰€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½ä¼šæ”¾åœ¨èƒŒæ™¯çº¿ç¨‹ä¸­è¿è¡Œï¼Œè¿™æ ·çš„è¯ï¼Œå°±ç­‰äºæ˜¯ç”¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¥å†™å…¥ç¼“å­˜äº†ã€‚</li>
<li>å¼€å‘è€…å¯ä»¥æ“æ§ç¼“å­˜åˆ å‡å…¶å†…å®¹çš„æ—¶æœºã€‚æœ‰ä¸¤ä¸ªä¸ç³»ç»Ÿèµ„æºç›¸å…³çš„å°ºåº¦å¯ä¾›è°ƒæ•´ï¼Œå…¶ä¸€æ˜¯ç¼“å­˜ä¸­çš„å¯¹è±¡æ€»æ•°ï¼Œå…¶äºŒæ˜¯æ‰€æœ‰å¯¹è±¡çš„â€œæ€»å¼€é”€â€ï¼ˆoverall cost)ã€‚</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">// EOCNetworkFetcher.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">// Network fetcher class</span><br><span class="line">typedef void(^EOCNetworkFetcherCompletionHandler)</span><br><span class="line">                                (NSData *data);</span><br><span class="line"></span><br><span class="line">@interface EOCNetworkFetcher : NSObject</span><br><span class="line">@property (nonatomic, strong, readonly) NSURL *url;</span><br><span class="line">- (instancetype)initWithURL:(NSURL *)url;</span><br><span class="line">- (void)startWithCompletionHandler:</span><br><span class="line">            (EOCNetworkFetcherCompletionHandler)completion;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// EOCNetworkFetcher.m</span><br><span class="line">#import &quot;EOCNetworkFetcher.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation EOCNetworkFetcher &#123;</span><br><span class="line">    NSCache *_cache;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)init &#123;</span><br><span class="line">    if (self = [super init]) &#123;</span><br><span class="line">        _cache = [NSCache new];</span><br><span class="line">        </span><br><span class="line">        // Cache a maximu of 100 URLs</span><br><span class="line">        // å¯ç¼“å­˜çš„æ€»å¯¹è±¡æ•°ç›®ä¸Šé™</span><br><span class="line">        _cache.countLimit = 100;</span><br><span class="line">        </span><br><span class="line">        /**</span><br><span class="line">         * The size in bytes of data is used as the cost,</span><br><span class="line">         * å¼€é”€å€¼ ä»¥ å­—èŠ‚ ä¸ºå•ä½</span><br><span class="line">         * so this sets a cost limit of 5MB</span><br><span class="line">         * å› æ­¤éœ€è¦å°† MB æ¢ç®—ä¸º å­—èŠ‚</span><br><span class="line">         */</span><br><span class="line">        _cache.totalCostLimit = 5 * 1024 * 1024;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithURL:(NSURL *)url &#123;</span><br><span class="line">    if (self = [super init]) &#123;</span><br><span class="line">        _url = url;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)downloadDataForURL:(NSURL *)url &#123;</span><br><span class="line">    NSData *cacheData = [_cache objectForKey:url];</span><br><span class="line">    if (cacheData) &#123;</span><br><span class="line">        // Cache hit</span><br><span class="line">        [self useData:cacheData];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        // Cache miss,ç¼“å­˜ä¸­æ²¡æœ‰è®¿é—®è€…æ‰€éœ€çš„æ•°æ®</span><br><span class="line">        EOCNetworkFetcher *fetcher = [[EOCNetworkFetcher alloc] initWithURL:url];</span><br><span class="line">        [fetcher startWithCompletionHandler:^(NSData *data) &#123;</span><br><span class="line">            [self useData:data];</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>NSPurgeableData</strong> ç±»ï¼Œ<strong>NSMutableData</strong> çš„å­ç±»ã€‚å¦‚æœæŸä¸ªå¯¹è±¡æ‰€å çš„å†…å­˜èƒ½å¤Ÿæ ¹æ®éœ€è¦éšæ—¶ä¸¢å¼ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç° <strong>NSDiscardableContent</strong> åè®®æ‰€å®šä¹‰çš„æ¥å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- (void)downloadDataForURL:(NSURL *)url &#123;</span><br><span class="line">    NSPurgeableData *cacheData = [_cache objectForKey:url];</span><br><span class="line">    if (cacheData) &#123;</span><br><span class="line">        // Stop the data being purged</span><br><span class="line">        [cacheData beginContentAccess];</span><br><span class="line">        </span><br><span class="line">        // Use the cached data</span><br><span class="line">        [self useData:cacheData];</span><br><span class="line">        </span><br><span class="line">        // Mark that the data may be purged again</span><br><span class="line">        [cacheData endContentAccess];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        // Cache miss</span><br><span class="line">        EOCNetworkFetcher *fetcher = [[EOCNetworkFetcher alloc] initWithURL:url];</span><br><span class="line">        [fetcher startWithCompletionHandler:^(NSData *data) &#123;</span><br><span class="line">            NSPurgeableData *purgeableData = [NSPurgeableData dataWithData:data];</span><br><span class="line">            [_cache setObject:purgeableData</span><br><span class="line">                       forKey:url</span><br><span class="line">                         cost:purgeableData.length];</span><br><span class="line">            </span><br><span class="line">            // Don&apos;t need to beginContentAccess as it begins</span><br><span class="line">            // with access already marked</span><br><span class="line">            </span><br><span class="line">            // Use the retrieved data</span><br><span class="line">            [self useData:data];</span><br><span class="line">            </span><br><span class="line">            // Mark that the data may be purged now</span><br><span class="line">            [cacheData endContentAccess];</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="è¦ç‚¹-3"><a href="#è¦ç‚¹-3" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>å®ç°ç¼“å­˜æ—¶åº”é€‰ç”¨ <strong>NSCache</strong> è€Œé <strong>NSDictionary</strong> å¯¹è±¡ã€‚å› ä¸º <strong>NSCache</strong> å¯ä»¥æä¾›ä¼˜é›…çš„è‡ªåŠ¨åˆ å‡åŠŸèƒ½ï¼Œè€Œä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ­¤å¤–ï¼Œå®ƒä¸å­—å…¸ä¸åŒï¼Œå¹¶ä¸ä¼šæ‹·è´é”®ã€‚</li>
<li>å¯ä»¥ç»™ <strong>NSCache</strong> å¯¹è±¡è®¾ç½®ä¸Šé™ï¼Œç”¨ä»¥é™åˆ¶ç¼“å­˜ä¸­çš„å¯¹è±¡æ€»ä¸ªæ•°åŠæ€»æˆæœ¬ï¼Œè€Œè¿™äº›å°ºåº¦åˆ™å®šä¹‰äº†ç¼“å­˜åˆ å‡å…¶ä¸­å¯¹è±¡çš„æ—¶æœºã€‚ä½†æ˜¯ç»å¯¹ä¸è¦æŠŠè¿™äº›å°ºåº¦å½“æˆå¯é çš„ç¡¬é™åˆ¶ï¼Œä»–ä»¬ä»…å¯¹ <strong>NSCache</strong> èµ·æŒ‡å¯¼ä½œç”¨ã€‚</li>
<li>å°† <strong>NSPurgeableData</strong> ä¸ <strong>NSCache</strong> æ­é…ä½¿ç”¨ï¼Œå¯å®ç°è‡ªåŠ¨æ¸…é™¤æ•°æ®çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“<strong>NSPurgeableData</strong> å¯¹è±¡æ‰€å å†…å­˜ä¸ºç³»ç»Ÿä¸¢å¼ƒæ—¶ï¼Œè¯¥å¯¹è±¡è‡ªèº«ä¹Ÿä¼šä»ç¼“å­˜ä¸­ç§»é™¤ã€‚</li>
<li>å¦‚æœç¼“å­˜ä½¿ç”¨å¾—å½“ã€‚é‚£ä¹ˆåº”ç”¨ç¨‹åºçš„å“åº”é€Ÿåº¦å°±èƒ½æé«˜ã€‚åªæœ‰é‚£ç§é‡æ–°è®¡ç®—èµ·æ¥å¾ˆè´¹äº‹çš„æ•°æ®ï¼Œæ‰å€¼å¾—æ”¾å…¥ç¼“å­˜ï¼Œæ¯”å¦‚é‚£äº›éœ€è¦ä»ç½‘ç»œè·å–æˆ–ä»ç£ç›˜è¯»å–çš„æ•°æ®ã€‚</li>
</ul>
<h3 id="ç¬¬51æ¡ï¼šç²¾ç®€-initialize-ä¸-load-çš„å®ç°ä»£ç "><a href="#ç¬¬51æ¡ï¼šç²¾ç®€-initialize-ä¸-load-çš„å®ç°ä»£ç " class="headerlink" title="ç¬¬51æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç "></a>ç¬¬51æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç </h3><h4 id="load-æ–¹æ³•"><a href="#load-æ–¹æ³•" class="headerlink" title="load æ–¹æ³•"></a>load æ–¹æ³•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (void)load;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äºåŠ å…¥è¿è¡ŒæœŸç³»ç»Ÿä¸­çš„æ¯ä¸ªç±»ï¼ˆclass) åŠåˆ†ç±»ï¼ˆcategory) æ¥è¯´ï¼Œå¿…å®šä¼šè°ƒç”¨æ­¤æ–¹æ³•ï¼Œè€Œä¸”ä»…è°ƒç”¨ä¸€æ¬¡ã€‚å½“åŒ…å«ç±»æˆ–åˆ†ç±»çš„ç¨‹åºåº“è½½å…¥ç³»ç»Ÿæ—¶ï¼Œå°±ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ï¼Œè€Œè¿™é€šå¸¸å°±æ˜¯æŒ‡åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œè‹¥ç¨‹åºæ˜¯ä¸ºiOSå¹³å°è®¾è®¡çš„ï¼Œåˆ™è‚¯å®šä¼šåœ¨æ­¤æ—¶æ‰§è¡Œã€‚</li>
<li>å¦‚æœåˆ†ç±»å’Œå…¶æ‰€å±çš„ç±»éƒ½å®šä¹‰äº† <code>load</code> æ–¹æ³•ï¼Œåˆ™å…ˆè°ƒç”¨ç±»é‡Œçš„ï¼Œå†è°ƒç”¨åˆ†ç±»é‡Œçš„ã€‚</li>
<li>åœ¨ <code>load</code> æ–¹æ³•ä¸­ä½¿ç”¨å…¶ä»–ç±»æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>ä¸éµå¾ªç»§æ‰¿è§„åˆ™ã€‚å¦‚æœæŸä¸ªç±»æœ¬èº«æ²¡å®ç° <code>load</code> æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ç®¡å…¶å„çº§è¶…ç±»æ˜¯å¦å®ç°æ­¤æ–¹æ³•ï¼Œç³»ç»Ÿéƒ½ä¸ä¼šè°ƒç”¨ã€‚æ­¤å¤–ï¼Œåˆ†ç±»å’Œå…¶æ‰€å±çš„ç±»é‡Œï¼Œéƒ½å¯èƒ½å‡ºç° <code>load</code> æ–¹æ³•ã€‚æ­¤æ—¶ä¸¤ç§å®ç°ä»£ç éƒ½ä¼šè°ƒç”¨ï¼Œç±»çš„å®ç°è¦æ¯”åˆ†ç±»çš„å®ç°å…ˆæ‰§è¡Œã€‚</li>
<li>è€Œä¸” <code>load</code> æ–¹æ³•åŠ¡å¿…å®ç°å¾—ç²¾ç®€ä¸€äº›ï¼Œä¹Ÿå°±æ˜¯è¦å°½é‡å‡å°‘å…¶æ‰€æ‰§è¡Œçš„æ“ä½œï¼Œå› ä¸ºæ•´ä¸ªåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œ <code>load</code> æ–¹æ³•æ—¶éƒ½ä¼šé˜»å¡ã€‚åº”ç”¨ç¨‹åºå¿…é¡»é˜»å¡å¹¶ç­‰ç€æ‰€æœ‰ç±»çš„ <code>load</code> éƒ½æ‰§è¡Œå®Œï¼Œæ‰èƒ½ç»§ç»­ã€‚</li>
<li><code>load</code> æ–¹æ³•çœŸæ­£ç”¨é€”ä»…åœ¨äºè°ƒè¯•ç¨‹åºï¼Œæ¯”å¦‚å¯ä»¥åœ¨åˆ†ç±»é‡Œç¼–å†™æ­¤æ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­è¯¥åˆ†ç±»æ˜¯å¦å·²ç»æ­£ç¡®è½½å…¥ç³»ç»Ÿä¸­ã€‚ä¹Ÿè®¸æ­¤æ–¹æ³•ä¸€åº¦å¾ˆæœ‰ç”¨å¤„ï¼Œä½†ç°åœ¨å®Œå…¨å¯ä»¥è¯´ï¼šæ—¶ä¸‹ç¼–å†™ Objective-C ä»£ç æ—¶, ä¸éœ€è¦ç”¨å®ƒã€‚</li>
</ul>
<h4 id="initialize-æ–¹æ³•"><a href="#initialize-æ–¹æ³•" class="headerlink" title="initialize æ–¹æ³•"></a>initialize æ–¹æ³•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (void)initialize;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äºæ¯ä¸ªç±»æ¥è¯´ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨ç¨‹åºé¦–æ¬¡ç”¨è¯¥ç±»ä¹‹å‰è°ƒç”¨ï¼Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚å®ƒæ˜¯ç”±è¿è¡ŒæœŸç³»ç»Ÿæ¥è°ƒç”¨çš„ï¼Œç»ä¸åº”è¯¥é€šè¿‡ä»£ç ç›´æ¥è°ƒç”¨ã€‚</li>
<li>å®ƒæ˜¯â€œæƒ°æ€§è°ƒç”¨çš„â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å½“ç¨‹åºç”¨åˆ°äº†ç›¸å…³çš„ç±»æ—¶ï¼Œæ‰ä¼šè°ƒç”¨ã€‚</li>
<li>è¿è¡ŒæœŸç³»ç»Ÿåœ¨æ‰§è¡Œè¯¥æ–¹æ³•æ—¶ï¼Œæ˜¯å¤„äºæ­£å¸¸çŠ¶æ€çš„ã€‚è€Œä¸”ï¼Œè¿è¡ŒæœŸç³»ç»Ÿä¹Ÿèƒ½ç¡®ä¿ <code>initialize</code> æ–¹æ³•ä¸€å®šä¼šåœ¨<strong>çº¿ç¨‹å®‰å…¨çš„ç¯å¢ƒ</strong>ä¸­æ‰§è¡Œã€‚</li>
<li>éµå¾ªç»§æ‰¿è§„åˆ™ã€‚<code>initialize</code> æ–¹æ³•ä¸å…¶ä»–æ¶ˆæ¯ä¸€æ ·ï¼Œå¦‚æœæŸä¸ªç±»æœªå®ç°å®ƒï¼Œè€Œå…¶è¶…ç±»å®ç°äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¿è¡Œè¶…ç±»çš„å®ç°ä»£ç ã€‚</li>
</ul>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul>
<li>è¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ä»£ç è¦å°½é‡ç²¾ç®€ã€‚åœ¨é‡Œé¢è®¾ç½®ä¸€äº›çŠ¶æ€ï¼Œä½¿æœ¬ç±»èƒ½å¤Ÿæ­£å¸¸è¿ä½œå°±å¯ä»¥äº†ï¼Œä¸è¦æ‰§è¡Œè€—æ—¶å¤ªä¹…æˆ–éœ€è¦åŠ é”çš„ä»»åŠ¡ã€‚</li>
<li>å¼€å‘è€…æ— æ³•æ§åˆ¶ç±»çš„åˆå§‹åŒ–æ—¶æœºã€‚</li>
<li>å¦‚æœæŸä¸ªç±»çš„å®ç°ä»£ç å¾ˆå¤æ‚ï¼Œé‚£ä¹ˆå…¶ä¸­å¯èƒ½ä¼šç›´æ¥æˆ–é—´æ¥ç”¨åˆ°å…¶ä»–ç±»ã€‚</li>
<li><code>initialize</code> æ–¹æ³•åªåº”è¯¥ç”¨æ¥è®¾ç½®å†…éƒ¨æ•°æ®ã€‚è‹¥æŸä¸ªå…¨å±€çŠ¶æ€æ— æ³•åœ¨ç¼–è¯‘æœŸåˆå§‹åŒ–ï¼Œåˆ™å¯ä»¥æ”¾åœ¨ <code>initialize</code> é‡Œæ¥åšã€‚</li>
</ul>
<h4 id="è¦ç‚¹-4"><a href="#è¦ç‚¹-4" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>åœ¨åŠ è½½é˜¶æ®µï¼Œå¦‚æœå®ç°äº† <code>load</code> æ–¹æ³•ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šè°ƒç”¨å®ƒã€‚åˆ†ç±»é‡Œä¹Ÿå¯ä»¥å®šä¹‰æ­¤æ–¹æ³•ï¼Œç±»çš„ <code>load</code>æ–¹æ³•è¦æ¯”åˆ†ç±»ä¸­çš„å…ˆè°ƒç”¨ã€‚ä¸å…¶ä»–æ–¹æ³•ä¸åŒï¼Œ<code>load</code> æ–¹æ³•ä¸å‚ä¸è¦†å†™æœºåˆ¶ã€‚</li>
<li>é¦–æ¬¡ä½¿ç”¨æŸä¸ªç±»ä¹‹å‰ï¼Œç³»ç»Ÿä¼šå‘å…¶å‘é€ <code>initialize</code> æ¶ˆæ¯ã€‚ç”±äºæ­¤æ–¹æ³•éµä»æ™®é€šçš„è¦†å†™è§„åˆ™ï¼Œæ‰€ä»¥é€šå¸¸åº”è¯¥åœ¨é‡Œé¢åˆ¤æ–­å½“å‰è¦åˆå§‹åŒ–çš„æ˜¯å“ªä¸ªç±»ã€‚</li>
<li><code>load</code>ä¸<code>initialize</code>æ–¹æ³•éƒ½åº”è¯¥å®ç°çš„ç²¾ç®€ä¸€äº›ï¼Œè¿™æœ‰åŠ©äºä¿æŒåº”ç”¨ç¨‹åºçš„å“åº”èƒ½åŠ›ï¼Œä¹Ÿèƒ½å‡å°‘å¼•å…¥ä¾èµ–ç¯çš„å‡ ç‡ã€‚</li>
<li>æ— æ³•åœ¨ç¼–è¯‘æœŸè®¾å®šçš„å…¨å±€å¸¸é‡ï¼Œå¯ä»¥æ”¾åœ¨<code>initialize</code>æ–¹æ³•é‡Œåˆå§‹åŒ–ã€‚</li>
</ul>
<h3 id="ç¬¬52æ¡ï¼šåˆ«å¿˜äº†-NSTimer-ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"><a href="#ç¬¬52æ¡ï¼šåˆ«å¿˜äº†-NSTimer-ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡" class="headerlink" title="ç¬¬52æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"></a>ç¬¬52æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡</h3><ul>
<li><strong>Foundation</strong> æ¡†æ¶ä¸­æœ‰ä¸ªç±»å«åš <strong>NSTimer</strong> ï¼Œå¼€å‘è€…å¯ä»¥æŒ‡å®šç»å¯¹çš„æ—¥æœŸä¸æ—¶é—´ï¼Œä»¥ä¾¿åˆ°æ—¶æ‰§è¡Œä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ‰§è¡Œä»»åŠ¡çš„ç›¸å¯¹å»¶è¿Ÿæ—¶é—´ã€‚è®¡æ—¶å™¨è¿˜å¯ä»¥é‡å¤è¿è¡Œä»»åŠ¡ï¼Œæœ‰ä¸ªä¸ä¹‹ç›¸å…³è”çš„â€œé—´éš”å€¼â€ï¼ˆinterval) å¯ç”¨æ¥æŒ‡å®šä»»åŠ¡çš„è§¦å‘é¢‘ç‡ã€‚</li>
<li>åªæœ‰æŠŠè®¡æ—¶å™¨æ”¾åœ¨è¿è¡Œå¾ªç¯é‡Œï¼Œå®ƒæ‰èƒ½æ­£å¸¸è§¦å‘ä»»åŠ¡ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)ti</span><br><span class="line">                                     target:(id)aTarget</span><br><span class="line">                                   selector:(SEL)aSelector</span><br><span class="line">                                   userInfo:(nullable id)userInfo</span><br><span class="line">                                    repeats:(BOOL)yesOrNo;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç”¨æ­¤æ–¹æ³•åˆ›å»ºå‡ºæ¥çš„è®¡æ—¶å™¨ï¼Œä¼šåœ¨æŒ‡å®šçš„é—´éš”æ—¶é—´ä¹‹åæ‰§è¡Œä»»åŠ¡ã€‚ä¹Ÿå¯ä»¥ä»¤å…¶åå¤æ‰§è¡Œä»»åŠ¡ï¼Œç›´åˆ°å¼€å‘è€…ç¨åå°†å…¶æ‰‹åŠ¨å…³é—­ä¸ºæ­¢ã€‚targetä¸selectorå‚æ•°è¡¨ç¤ºè®¡æ—¶å™¨å°†åœ¨å“ªä¸ªå¯¹è±¡ä¸Šè°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚è®¡æ—¶å™¨ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡ï¼Œç­‰åˆ°è‡ªèº«â€œå¤±æ•ˆâ€æ—¶å†é‡Šæ”¾æ­¤å¯¹è±¡ã€‚è°ƒç”¨ <code>invalidate</code> æ–¹æ³•å¯ä»¤è®¡æ—¶å™¨å¤±æ•ˆï¼›æ‰§è¡Œå®Œç›¸å…³ä»»åŠ¡ä¹‹åï¼Œä¸€æ¬¡æ€§çš„è®¡æ—¶å™¨ä¹Ÿä¼šå¤±æ•ˆã€‚å¼€å‘è€…è‹¥å°†è®¡æ—¶å™¨è®¾ç½®æˆé‡å¤æ‰§è¡Œæ¨¡å¼ï¼Œé‚£ä¹ˆå¿…é¡»è‡ªå·±è°ƒç”¨ <code>invalidate</code> æ–¹æ³•ï¼Œæ‰èƒ½ä»¤å…¶åœæ­¢ã€‚</p>
</li>
<li><p>ç”±äºè®¡æ—¶å™¨ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡ï¼Œæ‰€ä»¥åå¤æ‰§è¡Œä»»åŠ¡é€šå¸¸ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå‡ºé—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè®¾ç½®æˆé‡å¤æ‰§è¡Œæ¨¡å¼çš„é‚£ç§è®¡æ—¶å™¨ï¼Œå¾ˆå®¹æ˜“å¼•äººâ€œä¿ç•™ç¯â€ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  EOCClass.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCClass</span> : <span class="title">NSObject</span></span></span><br><span class="line">- (<span class="keyword">void</span>)startPolling;</span><br><span class="line">- (<span class="keyword">void</span>)stopPolling;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  EOCClass.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"EOCClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// â‡ï¸ EOCClass â†’ _pollTimer</span></span><br><span class="line">    <span class="built_in">NSTimer</span> *_pollTimer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line">    [_pollTimer invalidate];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)startPolling &#123;</span><br><span class="line">    <span class="comment">// â‡ï¸ _pollTimer â†’ EOCClass</span></span><br><span class="line">    _pollTimer =</span><br><span class="line">    [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">5.0</span></span><br><span class="line">                                     target:<span class="keyword">self</span></span><br><span class="line">                                   selector:<span class="keyword">@selector</span>(p_doPoll)</span><br><span class="line">                                   userInfo:<span class="literal">nil</span></span><br><span class="line">                                    repeats:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stopPolling &#123;</span><br><span class="line">    [_pollTimer invalidate];</span><br><span class="line">    _pollTimer = <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)p_doPoll &#123;</span><br><span class="line">    <span class="comment">// Poll the resource</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>è§£å†³å¼•ç”¨å¾ªç¯æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//  NSTimer+EOCBlocksSupport.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface NSTimer (EOCBlocksSupport)</span><br><span class="line"></span><br><span class="line">+ (NSTimer *)eoc_scheduledTimerWithTimeInterval:(NSTimeInterval)interval</span><br><span class="line">                                          block:(void(^)())block</span><br><span class="line">                                        repeats:(BOOL)repeats;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">//  NSTimer+EOCBlocksSupport.m</span><br><span class="line">#import &quot;NSTimer+EOCBlocksSupport.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation NSTimer (EOCBlocksSupport)</span><br><span class="line"></span><br><span class="line">+ (NSTimer *)eoc_scheduledTimerWithTimeInterval:(NSTimeInterval)interval</span><br><span class="line">                                          block:(void(^)())block</span><br><span class="line">                                        repeats:(BOOL)repeats &#123;</span><br><span class="line">    return [self scheduledTimerWithTimeInterval:interval</span><br><span class="line">                                         target:self</span><br><span class="line">                                       selector:@selector(eoc_blockInvoke:) userInfo:[block copy] repeats:repeats];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (void)eoc_blockInvoke:(NSTimer *)timer &#123;</span><br><span class="line">    void (^block)() = timer.userInfo;</span><br><span class="line">    if (block) &#123;</span><br><span class="line">        block();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>å°†è®¡æ—¶å™¨æ‰€åº”æ‰§è¡Œçš„ä»»åŠ¡å°è£…æˆ block ã€‚åœ¨è°ƒç”¨è®¡æ—¶å™¨å‡½æ•°æ—¶ï¼ŒæŠŠå®ƒä½œä¸º userlnfo å‚æ•°ä¼ è¿›å»ã€‚è¯¥å‚æ•°å¯ç”¨æ¥å­˜æ”¾ä¸é€æ˜å€¼(opaque value)ï¼Œåªè¦è®¡æ—¶å™¨è¿˜æœ‰æ•ˆï¼Œå°±ä¼šä¸€ç›´ä¿ç•™ç€å®ƒã€‚ä¼ äººå‚æ•°æ—¶è¦é€šè¿‡ copy æ–¹æ³•å°† block æ‹·è´åˆ°â€œå †â€ä¸Šï¼ˆå‚è§ç¬¬37æ¡)ï¼Œå¦åˆ™ç­‰åˆ°ç¨åè¦æ‰§è¡Œå®ƒçš„æ—¶å€™ï¼Œè¯¥å—å¯èƒ½å·²ç»æ— æ•ˆäº†ã€‚è®¡æ—¶å™¨ç°åœ¨çš„ target æ˜¯ NSTimer ç±»å¯¹è±¡ï¼Œè¿™æ˜¯ä¸ªå•ä¾‹ï¼Œå› æ­¤è®¡æ—¶å™¨æ˜¯å¦ä¼šä¿ç•™å®ƒï¼Œå…¶å®éƒ½æ— æ‰€è°“ã€‚æ­¤å¤„ä¾ç„¶æœ‰ä¿ç•™ç¯ï¼Œç„¶è€Œå› ä¸ºç±»å¯¹è±¡ï¼ˆclassobject)æ— é¡»å›æ”¶ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚</p>
<p>ä¼˜åŒ–ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (void)startPolling &#123;</span><br><span class="line">    __weak EOCClass *weakSelf = self;</span><br><span class="line">    _pollTimer =</span><br><span class="line">    [NSTimer eoc_scheduledTimerWithTimeInterval:5.0</span><br><span class="line">                                          block:^&#123;</span><br><span class="line">                                              EOCClass *strongSelf = weakSelf;</span><br><span class="line">                                              [strongSelf p_doPoll];</span><br><span class="line">                                          &#125;</span><br><span class="line">                                        repeats:YES];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="iOS-10-0-ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•"><a href="#iOS-10-0-ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•" class="headerlink" title="iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•"></a>iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSTimer</span> *)timerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval repeats:(<span class="built_in">BOOL</span>)repeats block:(<span class="keyword">void</span> (^)(<span class="built_in">NSTimer</span> *timer))block;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSTimer</span> *)scheduledTimerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval repeats:(<span class="built_in">BOOL</span>)repeats block:(<span class="keyword">void</span> (^)(<span class="built_in">NSTimer</span> *timer))block;</span><br></pre></td></tr></table></figure>
<h4 id="è¦ç‚¹-5"><a href="#è¦ç‚¹-5" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>NSTimer å¯¹è±¡ä¼šä¿ç•™å…¶ç›®æ ‡ï¼Œç›´åˆ°è®¡æ—¶å™¨æœ¬èº«å¤±æ•ˆä¸ºæ­¢ï¼Œè°ƒç”¨ <code>invalidate</code> æ–¹æ³•å¯ä»¤è®¡æ—¶å™¨å¤±æ•ˆï¼Œå¦å¤–ï¼Œä¸€æ¬¡æ€§çš„è®¡æ—¶å™¨åœ¨è§¦å‘å®Œä»»åŠ¡ä¹‹åä¹Ÿä¼šå¤±æ•ˆã€‚</li>
<li>åå¤æ‰§è¡Œä»»åŠ¡çš„è®¡æ—¶å™¨ï¼Œå¾ˆå®¹æ˜“å¼•å…¥ä¿ç•™ç¯ï¼Œå¦‚æœè¿™ç§è®¡æ—¶å™¨çš„ç›®æ ‡å¯¹è±¡åˆä¿ç•™äº†è®¡æ—¶å™¨æœ¬èº«ï¼Œé‚£è‚¯å®šä¼šå¯¼è‡´å¾ªç¯å¼•ç”¨ã€‚è¿™ç§å¾ªç¯å¼•ç”¨ï¼Œå¯èƒ½æ˜¯ç›´æ¥å‘ç”Ÿçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯é€šè¿‡å¯¹è±¡å›¾é‡Œçš„å…¶ä»–å¯¹è±¡é—´æ¥å‘ç”Ÿçš„ã€‚</li>
<li>å¯ä»¥æ‰©å…… NSTimer çš„åŠŸèƒ½ï¼Œç”¨å—æ¥æ‰“ç ´å¾ªç¯å¼•ç”¨ã€‚ä¸è¿‡ï¼Œé™¤é NSTimer å°†æ¥åœ¨å…¬å…±æ¥å£é‡Œæä¾›æ­¤åŠŸèƒ½ï¼Œå¦åˆ™å¿…é¡»åˆ›å»ºåˆ†ç±»ï¼Œå°†ç›¸å…³å®ç°ä»£ç åŠ å…¥å…¶ä¸­ã€‚</li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç‹¬æœ¨èˆŸçš„æœ¨</li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    
    <a href="https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/" title="ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶">https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Objective-C/" rel="tag"># Objective-C</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/20/ã€ŠEffective Objective-C 2.0ã€‹6.å—ä¸å¤§ä¸­æ¢æ´¾å‘/" rel="next" title="ã€ŠEffective Objective-C 2.0ã€‹6.å—ä¸å¤§ä¸­æ¢æ´¾å‘">
                <i class="fa fa-chevron-left"></i> ã€ŠEffective Objective-C 2.0ã€‹6.å—ä¸å¤§ä¸­æ¢æ´¾å‘
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/22/ã€ŠEffective Objective-C 2.0ã€‹2.å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ/" rel="prev" title="ã€ŠEffective Objective-C 2.0ã€‹2.å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ">
                ã€ŠEffective Objective-C 2.0ã€‹2.å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png" alt="ç‹¬æœ¨èˆŸçš„æœ¨">
            
              <p class="site-author-name" itemprop="name">ç‹¬æœ¨èˆŸçš„æœ¨</p>
              <div class="site-description motion-element" itemprop="description">æœ‰æ—¶å€™é˜³å…‰å¾ˆå¥½ æœ‰æ—¶å€™é˜³å…‰å¾ˆæš—</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">317</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">36</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Andy0570" title="GitHub &rarr; https://github.com/Andy0570" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:andywhm@163.com" title="E-Mail &rarr; mailto:andywhm@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¬¬7ç« -ç³»ç»Ÿæ¡†æ¶"><span class="nav-number">1.</span> <span class="nav-text">ç¬¬7ç«  ç³»ç»Ÿæ¡†æ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"><span class="nav-number">1.1.</span> <span class="nav-text">ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹"><span class="nav-number">1.1.1.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨-for-å¾ªç¯"><span class="nav-number">1.2.</span> <span class="nav-text">ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#for-å¾ªç¯"><span class="nav-number">1.2.1.</span> <span class="nav-text">for å¾ªç¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨-Objective-C-1-0-çš„-NSEnumerator-éå†"><span class="nav-number">1.2.2.</span> <span class="nav-text">ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¿«é€Ÿéå†"><span class="nav-number">1.2.3.</span> <span class="nav-text">å¿«é€Ÿéå†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºäºå—çš„éå†æ–¹å¼"><span class="nav-number">1.2.4.</span> <span class="nav-text">åŸºäºå—çš„éå†æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹-1"><span class="nav-number">1.2.5.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„-collection-ä½¿ç”¨æ— ç¼æ¡¥æ¥"><span class="nav-number">1.3.</span> <span class="nav-text">ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¡¥å¼è½¬æ¢"><span class="nav-number">1.3.1.</span> <span class="nav-text">æ¡¥å¼è½¬æ¢</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š"><span class="nav-number">1.3.2.</span> <span class="nav-text">éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹-2"><span class="nav-number">1.3.3.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary"><span class="nav-number">1.4.</span> <span class="nav-text">ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬51æ¡ï¼šç²¾ç®€-initialize-ä¸-load-çš„å®ç°ä»£ç "><span class="nav-number">1.5.</span> <span class="nav-text">ç¬¬51æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#load-æ–¹æ³•"><span class="nav-number">1.5.1.</span> <span class="nav-text">load æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initialize-æ–¹æ³•"><span class="nav-number">1.5.2.</span> <span class="nav-text">initialize æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">1.5.3.</span> <span class="nav-text">æ€»ç»“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹-4"><span class="nav-number">1.5.4.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¬¬52æ¡ï¼šåˆ«å¿˜äº†-NSTimer-ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"><span class="nav-number">1.6.</span> <span class="nav-text">ç¬¬52æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#iOS-10-0-ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•"><span class="nav-number">1.6.1.</span> <span class="nav-text">iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¦ç‚¹-5"><span class="nav-number">1.6.2.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç‹¬æœ¨èˆŸçš„æœ¨</span>

  

  
</div>


  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  



  
    
    
      
    
  
  <script color="17,119,176" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>













  
  <script src="//cdn.jsdelivr.net/npm/jquery@2/dist/jquery.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  
  
  
    
  

  

  
  
  


  


  


  



  
  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">

  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.js"></script>
  

  <script src="/js/algolia-search.js?v=7.1.0"></script>



  
  
  <script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .done(function() {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.time + 1);
              })
            
              .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
              })
          } else {
            
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text('Counter not initialized! More info at console err msg.');
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz',
                'X-LC-Key': 'brOnU8mOQvSjpipJvdKUAIbU',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script>



  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script>pangu.spacingPage();</script>


  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.scrollToMark('auto', "#æ›´å¤š");
  
  </script>


  

  

  


  <!-- red heart -->
  <script type="text/javascript" src="/js/src/love.js"></script>
  
</body>
</html>

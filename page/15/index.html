<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">



  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">













  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">







  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/panda/apple-touch-icon.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda/favicon-32x32.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda/favicon-16x16.png?v=7.1.0">


  <link rel="mask-icon" href="/images/panda/safari-pinned-tab.svg?v=7.1.0" color="#222">


  <link rel="manifest" href="/images/panda/site.webmanifest">


  <meta name="msapplication-config" content="/images/panda/browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有时候阳光很好 有时候阳光很暗">
<meta name="keywords" content="独木舟的木">
<meta property="og:type" content="website">
<meta property="og:title" content="独木舟的木">
<meta property="og:url" content="https://andy0570.com/page/15/index.html">
<meta property="og:site_name" content="独木舟的木">
<meta property="og:description" content="有时候阳光很好 有时候阳光很暗">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="独木舟的木">
<meta name="twitter:description" content="有时候阳光很好 有时候阳光很暗">



  <link rel="alternate" href="/atom.xml" title="独木舟的木" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://andy0570.com/page/15/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>独木舟的木</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8229a094facca297f211d61323fd9fde";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <a href="https://github.com/andy0570" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">独木舟的木</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">iOS Developer</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">15</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">76</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">311</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/15/天天品尝iOS7甜点 Day14：Interactive View Controller Transitions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/15/天天品尝iOS7甜点 Day14：Interactive View Controller Transitions/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day14：Interactive View Controller Transitions</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-15 12:32:00" itemprop="dateCreated datePublished" datetime="2017-09-15T12:32:00+08:00">2017-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:07:17" itemprop="dateModified" datetime="2019-04-17T14:07:17+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/15/天天品尝iOS7甜点 Day14：Interactive View Controller Transitions/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day14：Interactive View Controller Transitions">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>为模态视图控制器添加交互式视图转换</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/18/ios7-day-by-day-day14-interactive-view-controller-transitions/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 14 :: Interactive View Controller Transitions</a></li>
</ul>
<p>这篇文章可能会用到之前两篇文章的知识：</p>
<ul>
<li><a href="http://blog.kingiol.com/2014/01/12/ios7-day-by-day-day10-custom-uiviewcontroller-transitions/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 10 :: Custom UIViewController Transitions</a> - 导航视图控制器自定义转场</li>
<li><a href="http://blog.kingiol.com/2014/01/13/ios7-day-by-day-day11-uiview-key-frame-animations/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 11 :: UIView Key-frame Animations</a> - 关键帧动画</li>
</ul>
<h3 id="Flip-Transition-Animation-翻转过渡效果"><a href="#Flip-Transition-Animation-翻转过渡效果" class="headerlink" title="Flip Transition Animation - 翻转过渡效果"></a>Flip Transition Animation - 翻转过渡效果</h3><h4 id="默认的模态视图翻转效果"><a href="#默认的模态视图翻转效果" class="headerlink" title="默认的模态视图翻转效果"></a>默认的模态视图翻转效果</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-10e898d96c1c956f.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="自定义模态视图翻转效果"><a href="#自定义模态视图翻转效果" class="headerlink" title="自定义模态视图翻转效果"></a>自定义模态视图翻转效果</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-063a3ec6cd579226.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="实现方式："><a href="#实现方式：" class="headerlink" title="实现方式："></a>实现方式：</h4><ol>
<li><p>视图层次结构</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-1be0ede8a3c71401.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</li>
<li><p>自定义渐变动画类，遵守 <code>UIViewControllerAnimatedTransitioning</code> 协议以实现具体的动画效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">// ********************************************</span><br><span class="line">// SCFlipAnimation.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 遵守&lt;UIViewControllerAnimatedTransitioning&gt;协议的自定义渐变动画</span><br><span class="line"> */</span><br><span class="line">@interface SCFlipAnimation : NSObject &lt;UIViewControllerAnimatedTransitioning&gt;</span><br><span class="line"></span><br><span class="line">/** 确定页面的翻转方向 */</span><br><span class="line">@property (nonatomic, assign) BOOL dismissal;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// ********************************************</span><br><span class="line">// SCFlipAnimation.m</span><br><span class="line">#import &quot;SCFlipAnimation.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation SCFlipAnimation</span><br><span class="line"></span><br><span class="line">- (void)animateTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext</span><br><span class="line">     &#123;</span><br><span class="line">    // 获取各自的视图控制器</span><br><span class="line">    UIViewController *fromVC = [transitionContext viewControllerForKey:UITransitionContextFromViewControllerKey];</span><br><span class="line">    UIViewController *toVC = [transitionContext viewControllerForKey:UITransitionContextToViewControllerKey];</span><br><span class="line">    </span><br><span class="line">    // 获取视图</span><br><span class="line">    UIView *containerView = [transitionContext containerView];</span><br><span class="line">    UIView *fromView = fromVC.view;</span><br><span class="line">    UIView *toView = toVC.view;</span><br><span class="line">    </span><br><span class="line">    // 添加 toView 到容器视图</span><br><span class="line">    [containerView addSubview:toView];</span><br><span class="line">    </span><br><span class="line">    // 设置 frames</span><br><span class="line">    CGRect initialFrame = [transitionContext initialFrameForViewController:fromVC];</span><br><span class="line">    fromView.frame = initialFrame;</span><br><span class="line">    toView.frame = initialFrame;</span><br><span class="line">    </span><br><span class="line">    // 构建3D转换需要的视角</span><br><span class="line">    CATransform3D transform = CATransform3DIdentity;</span><br><span class="line">    transform.m34 = -1/CGRectGetHeight(initialFrame);</span><br><span class="line">    containerView.layer.sublayerTransform = transform;</span><br><span class="line">    </span><br><span class="line">    // 翻转方向</span><br><span class="line">    CGFloat direction = self.dismissal ? -1.0 : 1.0;</span><br><span class="line">    </span><br><span class="line">    // toView 反向翻转 pi/2</span><br><span class="line">    toView.layer.transform = CATransform3DMakeRotation(-direction * M_PI_2, 1, 0, 0);</span><br><span class="line">    </span><br><span class="line">    // 关键帧动画</span><br><span class="line">    [UIView animateKeyframesWithDuration:[self transitionDuration:transitionContext]</span><br><span class="line">                                   delay:0.0</span><br><span class="line">                                 options:0</span><br><span class="line">                              animations:^&#123;</span><br><span class="line">                                  // First half is rotating in</span><br><span class="line">            [UIView addKeyframeWithRelativeStartTime:0.0</span><br><span class="line">                                    relativeDuration:0.5</span><br><span class="line">                                          animations:^&#123;</span><br><span class="line">        // fromView 正向翻转 pi/2</span><br><span class="line">        fromView.layer.transform = CATransform3DMakeRotation(direction * M_PI_2, 1, 0, 0);</span><br><span class="line">                                          &#125;];</span><br><span class="line">            [UIView addKeyframeWithRelativeStartTime:0.5</span><br><span class="line">                                    relativeDuration:0.5</span><br><span class="line">                                          animations:^&#123;</span><br><span class="line">        // toView 还原</span><br><span class="line">        toView.layer.transform = CATransform3DMakeRotation(0, 1, 0, 0);</span><br><span class="line">                                          &#125;];</span><br><span class="line">                              &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">                                  [transitionContext completeTransition:![transitionContext transitionWasCancelled]];</span><br><span class="line">                              &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSTimeInterval)transitionDuration:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext</span><br><span class="line">     &#123;</span><br><span class="line">    return 1.0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>First View Controller，遵守 <code>UIViewControllerTransitioningDelegate</code> 协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@interface SCViewController () &lt;UIViewControllerTransitioningDelegate&gt; &#123;</span><br><span class="line">    SCFlipAnimation *_flipAnimation;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation SCViewController</span><br><span class="line"></span><br><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">	// Do any additional setup after loading the view, typically from a nib.</span><br><span class="line">    _flipAnimation = [SCFlipAnimation new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - </span><br><span class="line"></span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    if([segue.destinationViewController isKindOfClass:[SCModalViewController class]]) &#123;</span><br><span class="line">        SCModalViewController *vc = (SCModalViewController *)segue.destinationViewController;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UIViewControllerTransitioningDelegate</span><br><span class="line"></span><br><span class="line">// 弹出模态视图控制器</span><br><span class="line">// 返回遵守 UIViewControllerAnimatedTransitioning 协议的实例</span><br><span class="line">- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source</span><br><span class="line">&#123;</span><br><span class="line">    _flipAnimation.dismissal = NO;</span><br><span class="line">    return _flipAnimation;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 消失模态视图控制器</span><br><span class="line">// 返回遵守 UIViewControllerAnimatedTransitioning 协议的实例</span><br><span class="line">- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForDismissedController:(UIViewController *)dismissed</span><br><span class="line">&#123;</span><br><span class="line">    _flipAnimation.dismissal = YES;</span><br><span class="line">    return _flipAnimation;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Model View Controller 实现按钮方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 使模态视图控制器消失</span><br><span class="line">- (IBAction)handleDismissPressed:(id)sender &#123;</span><br><span class="line">    [self dismissViewControllerAnimated:YES completion:NULL];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Interactive-transitioning-交互式转换"><a href="#Interactive-transitioning-交互式转换" class="headerlink" title="Interactive transitioning - 交互式转换"></a>Interactive transitioning - 交互式转换</h3><p>用手势上滑、下滑操作实现视图转换</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-420374adc092ce3e.gif?imageMogr2/auto-orient/strip" alt></p>
<ol>
<li><p>自定义 <code>UIPercentDrivenInteractiveTransition</code> 子类对象，用于手势处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">// ********************************************</span><br><span class="line">// SCFlipAnimationInteractor.h</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">#import &quot;SCInteractiveTransitionViewControllerDelegate.h&quot;</span><br><span class="line"></span><br><span class="line">@interface SCFlipAnimationInteractor : UIPercentDrivenInteractiveTransition</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readonly) UIPanGestureRecognizer *gestureRecogniser;</span><br><span class="line">@property (nonatomic, assign, readonly) BOOL interactionInProgress;</span><br><span class="line"></span><br><span class="line">// 实现 SCInteractiveTransitionViewControllerDelegate 自定义交互式转场协议的任意视图控制器</span><br><span class="line">@property (nonatomic, weak) UIViewController&lt;SCInteractiveTransitionViewControllerDelegate&gt; *presentingVC;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// ********************************************</span><br><span class="line">// SCFlipAnimationInteractor.m</span><br><span class="line">#import &quot;SCFlipAnimationInteractor.h&quot;</span><br><span class="line"></span><br><span class="line">@interface SCFlipAnimationInteractor ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) UIPanGestureRecognizer *gestureRecogniser;</span><br><span class="line">@property (nonatomic, assign, readwrite) BOOL interactionInProgress;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation SCFlipAnimationInteractor</span><br><span class="line"></span><br><span class="line">- (instancetype)init</span><br><span class="line">&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        self.gestureRecogniser = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Gesture recognition</span><br><span class="line">// 手势操作的方法</span><br><span class="line">- (void)handlePan:(UIPanGestureRecognizer *)pgr</span><br><span class="line">&#123;</span><br><span class="line">    CGPoint translation = [pgr translationInView:pgr.view];</span><br><span class="line">    // 手势百分比，用百分比的方式来激活指定的动画过程。</span><br><span class="line">    CGFloat percentage  = fabs(translation.y / CGRectGetHeight(pgr.view.bounds));</span><br><span class="line">    switch (pgr.state) &#123;</span><br><span class="line">        case UIGestureRecognizerStateBegan: &#123;</span><br><span class="line">            // 手势开始，执行翻转动画</span><br><span class="line">            self.interactionInProgress = YES;</span><br><span class="line">            // 向目标对象传达执行动画的命令</span><br><span class="line">            [self.presentingVC proceedToNextViewController];</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        case UIGestureRecognizerStateChanged: &#123;</span><br><span class="line">            // 手势进行中，更新翻转进度</span><br><span class="line">            [self updateInteractiveTransition:percentage];</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case UIGestureRecognizerStateEnded: &#123;</span><br><span class="line">            // 手势结束，分进度值处理</span><br><span class="line">            if(percentage &lt; 0.5) &#123;</span><br><span class="line">                // 1.进度小于0.5，取消转场动画</span><br><span class="line">                [self cancelInteractiveTransition];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                // 2.进度大于0.5，自动完成转场动画</span><br><span class="line">                [self finishInteractiveTransition];</span><br><span class="line">            &#125;</span><br><span class="line">            self.interactionInProgress = NO;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        case UIGestureRecognizerStateCancelled: &#123;</span><br><span class="line">            // 取消手势</span><br><span class="line">            [self cancelInteractiveTransition];</span><br><span class="line">            self.interactionInProgress = NO;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义交互协议</p>
</li>
</ol>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">// 1.该协议的作用：</span><br><span class="line">// 将手势与目标视图相关联，手势开始时，自定义的手势处理类需要向目标视图发送执行视图转场的命令。</span><br><span class="line">// 2.为什么要将手势与目标视图关联呢？</span><br><span class="line">// 因为手势是添加到 window 上的，这样就可以响应预期的行为。</span><br><span class="line">// 3.为什么手势要添加到 window 上而不是视图上？</span><br><span class="line">// 因为动画发生的时候，视图控制器中的视图将会被移除，因此手势就没有办法响应行为了。</span><br><span class="line">@protocol SCInteractiveTransitionViewControllerDelegate &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">- (void)proceedToNextViewController;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>   ​</p>
<ol start="3">
<li><p>First View Controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">// ********************************************</span><br><span class="line">// SCViewController.h</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface SCViewController : UIViewController</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// ********************************************</span><br><span class="line">// SCViewController.m</span><br><span class="line">#import &quot;SCViewController.h&quot;</span><br><span class="line">#import &quot;SCModalViewController.h&quot;</span><br><span class="line">#import &quot;SCFlipAnimationInteractor.h&quot;</span><br><span class="line">#import &quot;SCFlipAnimation.h&quot;</span><br><span class="line">#import &quot;SCInteractiveTransitionViewControllerDelegate.h&quot;</span><br><span class="line"></span><br><span class="line">@interface SCViewController () &lt;SCInteractiveTransitionViewControllerDelegate, UIViewControllerTransitioningDelegate&gt; &#123;</span><br><span class="line">    SCFlipAnimationInteractor *_animationInteractor;</span><br><span class="line">    SCFlipAnimation *_flipAnimation;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation SCViewController</span><br><span class="line"></span><br><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">	// Do any additional setup after loading the view, typically from a nib.</span><br><span class="line">    _animationInteractor = [SCFlipAnimationInteractor new];</span><br><span class="line">    _flipAnimation = [SCFlipAnimation new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    // 添加手势识别器到window对象中。</span><br><span class="line">    // 这是因为动画发生的时候，视图控制器中的视图将会被移除，因此手势就没有办法响应行为了。</span><br><span class="line">    // 把它添加到window上面，将会确保我们期待的行为。</span><br><span class="line">    if (![self.view.window.gestureRecognizers containsObject:_animationInteractor.gestureRecogniser]) &#123;</span><br><span class="line">        [self.view.window addGestureRecognizer:_animationInteractor.gestureRecogniser];</span><br><span class="line">    &#125;</span><br><span class="line">    // 在第一页中，交互的接收者指向 self 自身</span><br><span class="line">    _animationInteractor.presentingVC = self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - </span><br><span class="line"></span><br><span class="line">- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    if([segue.destinationViewController isKindOfClass:[SCModalViewController class]]) &#123;</span><br><span class="line">        // Set the delegate</span><br><span class="line">        SCModalViewController *vc = (SCModalViewController *)segue.destinationViewController;</span><br><span class="line">        vc.transitioningDelegate = self;</span><br><span class="line">        // 模态视图的手势交互器也指向这个类的手势交互器（弱引用）</span><br><span class="line">        // 也就是说，这两个视图的手势交互器指向的是同一个对象</span><br><span class="line">        vc.interactor = _animationInteractor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - SCInteractiveTransitionViewControllerDelegate</span><br><span class="line"></span><br><span class="line">- (void)proceedToNextViewController</span><br><span class="line">&#123;</span><br><span class="line">    [self performSegueWithIdentifier:@&quot;displayModal&quot; sender:self];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - UIViewControllerTransitioningDelegate</span><br><span class="line"></span><br><span class="line">// 弹出模态视图控制器</span><br><span class="line">- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source</span><br><span class="line">&#123;</span><br><span class="line">    _flipAnimation.dismissal = NO;</span><br><span class="line">    return _flipAnimation;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 消失模态视图控制器</span><br><span class="line">- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForDismissedController:(UIViewController *)dismissed</span><br><span class="line">&#123;</span><br><span class="line">    _flipAnimation.dismissal = YES;</span><br><span class="line">    return _flipAnimation;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 交互式转场方法1：展示</span><br><span class="line">// 返回一个实现 UIViewControllerInteractiveTransitioning 协议的对象</span><br><span class="line">- (id&lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForPresentation:(id&lt;UIViewControllerAnimatedTransitioning&gt;)animator</span><br><span class="line">&#123;</span><br><span class="line">    return _animationInteractor.interactionInProgress ? _animationInteractor : nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 交互式转场方法2：消失</span><br><span class="line">// 返回一个实现 UIViewControllerInteractiveTransitioning 协议的对象</span><br><span class="line">- (id&lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForDismissal:(id&lt;UIViewControllerAnimatedTransitioning&gt;)animator</span><br><span class="line">&#123;</span><br><span class="line">    return _animationInteractor.interactionInProgress ? _animationInteractor : nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>Model View Controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// ********************************************</span><br><span class="line">// SCModalViewController.h</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">#import &quot;SCInteractiveTransitionViewControllerDelegate.h&quot;</span><br><span class="line">#import &quot;SCFlipAnimationInteractor.h&quot;</span><br><span class="line"></span><br><span class="line">@interface SCModalViewController : UIViewController &lt;SCInteractiveTransitionViewControllerDelegate&gt;</span><br><span class="line"></span><br><span class="line">- (IBAction)handleDismissPressed:(id)sender;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, weak) SCFlipAnimationInteractor *interactor;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// ********************************************</span><br><span class="line">// SCModalViewController.m</span><br><span class="line">#import &quot;SCModalViewController.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation SCModalViewController</span><br><span class="line"></span><br><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    // 重新设置哪一个视图控制器是交互式转场的接收者</span><br><span class="line">    // 在模态页面中，交互的接收者又重新设置为模态页面自身</span><br><span class="line">    self.interactor.presentingVC = self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - IBActions</span><br><span class="line"></span><br><span class="line">// 使模态视图控制器消失</span><br><span class="line">- (IBAction)handleDismissPressed:(id)sender &#123;</span><br><span class="line">    [self dismissViewControllerAnimated:YES completion:NULL];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - SCInteractiveTransitionViewControllerDelegate</span><br><span class="line"></span><br><span class="line">- (void)proceedToNextViewController</span><br><span class="line">&#123;</span><br><span class="line">    [self dismissViewControllerAnimated:YES completion:NULL];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>The End.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/14/天天品尝iOS7甜点 Day12：Dynamic Type and Font Descriptors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/14/天天品尝iOS7甜点 Day12：Dynamic Type and Font Descriptors/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day12：Dynamic Type and Font Descriptors</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-14 13:48:00" itemprop="dateCreated datePublished" datetime="2017-09-14T13:48:00+08:00">2017-09-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:07:32" itemprop="dateModified" datetime="2019-04-17T14:07:32+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/14/天天品尝iOS7甜点 Day12：Dynamic Type and Font Descriptors/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day12：Dynamic Type and Font Descriptors">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>关于 <strong>TextKit</strong> 框架中的动态类型和字体描述符特性。</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/14/ios7-day-by-day-day12-dynamic-type-and-font-descriptors/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 12 :: Dynamic Type and Font Descriptors</a></li>
</ul>
<h3 id="Dynamic-Type-动态类型"><a href="#Dynamic-Type-动态类型" class="headerlink" title="Dynamic Type - 动态类型"></a>Dynamic Type - 动态类型</h3><p>动态类型允许用户指定他们设备中应用程序内部的字体类型大小。</p>
<h4 id="UIFontTextStyle-类型"><a href="#UIFontTextStyle-类型" class="headerlink" title="UIFontTextStyle 类型"></a>UIFontTextStyle 类型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// Font text styles</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleTitle1 NS_AVAILABLE_IOS(9_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleTitle2 NS_AVAILABLE_IOS(9_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleTitle3 NS_AVAILABLE_IOS(9_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleHeadline NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleSubheadline NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleBody NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleCallout NS_AVAILABLE_IOS(9_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleFootnote NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleCaption1 NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN UIFontTextStyle const UIFontTextStyleCaption2 NS_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<h4 id="Interface-Builder-设置"><a href="#Interface-Builder-设置" class="headerlink" title="Interface Builder 设置"></a>Interface Builder 设置</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-5a807907124c3e8b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="代码设置"><a href="#代码设置" class="headerlink" title="代码设置"></a>代码设置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 设置子标签上的字体</span><br><span class="line">self.subHeadingLabel.font = [UIFont preferredFontForTextStyle:UIFontTextStyleSubheadline];</span><br></pre></td></tr></table></figure>
<h4 id="样式大小"><a href="#样式大小" class="headerlink" title="样式大小"></a>样式大小</h4><p>当应用支持动态字体后，我们可以到【设置】- 【显示与亮度】-【文字大小】中修改：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-bad3a77a20bd5988.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h5 id="最大号字体（滑块位于最右边）"><a href="#最大号字体（滑块位于最右边）" class="headerlink" title="最大号字体（滑块位于最右边）"></a>最大号字体（滑块位于最右边）</h5><p><img src="http://upload-images.jianshu.io/upload_images/2648731-88c6185ca1f699a7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h5 id="中等字体（滑块位于正中间）"><a href="#中等字体（滑块位于正中间）" class="headerlink" title="中等字体（滑块位于正中间）"></a>中等字体（滑块位于正中间）</h5><p><img src="http://upload-images.jianshu.io/upload_images/2648731-418c17e7dc7712fb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h5 id="最小号字体（滑块位于最左边）"><a href="#最小号字体（滑块位于最左边）" class="headerlink" title="最小号字体（滑块位于最左边）"></a>最小号字体（滑块位于最左边）</h5><p><img src="http://upload-images.jianshu.io/upload_images/2648731-dffc57f4748d1009.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="Font-Descriptors-字体描述符"><a href="#Font-Descriptors-字体描述符" class="headerlink" title="Font Descriptors - 字体描述符"></a>Font Descriptors - 字体描述符</h3><p>可以利用字体描述符改变字体样式，而不需要获取并设置当前字体大小：</p>
<h4 id="修改字体描述符信息"><a href="#修改字体描述符信息" class="headerlink" title="修改字体描述符信息"></a>修改字体描述符信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 用描述符修改字体</span><br><span class="line">// 1.获得 UIFontTextStyleBody 风格的字体描述符信息。</span><br><span class="line">UIFontDescriptor *bodyFontDesciptor = [UIFontDescriptor preferredFontDescriptorWithTextStyle:UIFontTextStyleBody];</span><br><span class="line">// 2.覆盖字体特征。</span><br><span class="line">UIFontDescriptor *boldBodyFontDescriptor = [bodyFontDesciptor fontDescriptorWithSymbolicTraits:UIFontDescriptorTraitBold];</span><br><span class="line">// 3.设置与字体描述符匹配的字体。</span><br><span class="line">// 如果 fontSize 大于0.0，则它在 fontDescriptor 中优先于UIFontDescriptorSizeAttribute。</span><br><span class="line">self.boldBodyTextLabel.font = [UIFont fontWithDescriptor:boldBodyFontDescriptor size:0.0];</span><br></pre></td></tr></table></figure>
<h5 id="UIFontDescriptorSymbolicTraits-部分选项"><a href="#UIFontDescriptorSymbolicTraits-部分选项" class="headerlink" title="UIFontDescriptorSymbolicTraits 部分选项"></a>UIFontDescriptorSymbolicTraits 部分选项</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">UIFontDescriptorTraitItalic = 1u &lt;&lt; 0,</span><br><span class="line">UIFontDescriptorTraitBold = 1u &lt;&lt; 1,</span><br><span class="line">UIFontDescriptorTraitExpanded = 1u &lt;&lt; 5, // expanded and condensed traits are mutually exclusive</span><br><span class="line">UIFontDescriptorTraitCondensed = 1u &lt;&lt; 6,</span><br><span class="line">UIFontDescriptorTraitMonoSpace = 1u &lt;&lt; 10, // Use fixed-pitch glyphs if available. May have multiple glyph advances (most CJK glyphs may contain two spaces)</span><br><span class="line">UIFontDescriptorTraitVertical = 1u &lt;&lt; 11, // Use vertical glyph variants and metrics</span><br><span class="line">UIFontDescriptorTraitUIOptimized = 1u &lt;&lt; 12, // Synthesize appropriate attributes for UI rendering such as control titles if necessary</span><br><span class="line">UIFontDescriptorTraitTightLeading = 1u &lt;&lt; 15, // Use tighter leading values</span><br><span class="line">UIFontDescriptorTraitLooseLeading = 1u &lt;&lt; 16, // Use looser leading values</span><br></pre></td></tr></table></figure>
<h4 id="通过传入字典的方式创建字体描述符"><a href="#通过传入字典的方式创建字体描述符" class="headerlink" title="通过传入字典的方式创建字体描述符"></a>通过传入字典的方式创建字体描述符</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 创建一个字体描述符</span><br><span class="line">UIFontDescriptor *scriptFontDescriptor = [UIFontDescriptor</span><br><span class="line">    fontDescriptorWithFontAttributes:@&#123;</span><br><span class="line">                                       UIFontDescriptorFamilyAttribute: @&quot;Zapfino&quot;,</span><br><span class="line">                                         UIFontDescriptorSizeAttribute: @15.0</span><br><span class="line">                                       &#125;];</span><br><span class="line">self.scriptTextLabel.font = [UIFont fontWithDescriptor:scriptFontDescriptor size:0.0];</span><br></pre></td></tr></table></figure>
<p>其他可以设置的 Attributes 属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UIKIT_EXTERN NSString *const UIFontDescriptorFamilyAttribute NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN NSString *const UIFontDescriptorNameAttribute NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN NSString *const UIFontDescriptorFaceAttribute NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN NSString *const UIFontDescriptorSizeAttribute NS_AVAILABLE_IOS(7_0);</span><br><span class="line">UIKIT_EXTERN NSString *const UIFontDescriptorVisibleNameAttribute NS_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<p>字体描述符效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-7dd956bfeece322d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>The End.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/13/iOS Core Animation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/13/iOS Core Animation/" class="post-title-link" itemprop="url">iOS Core Animation</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-13 14:19:00" itemprop="dateCreated datePublished" datetime="2017-09-13T14:19:00+08:00">2017-09-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:24:34" itemprop="dateModified" datetime="2019-04-17T14:24:34+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/13/iOS Core Animation/" class="leancloud_visitors" data-flag-title="iOS Core Animation">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h2 id="UIView-基本动画"><a href="#UIView-基本动画" class="headerlink" title="UIView 基本动画"></a>UIView 基本动画</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 通过指定动画持续时间、动画延迟、执行动画选项和动画完成后回调的 Block 对象 更改一个或多个视图的动画。</span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);</span><br><span class="line"></span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0); // delay = 0.0, options = 0</span><br><span class="line"></span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations NS_AVAILABLE_IOS(4_0); // delay = 0.0, options = 0, completion = NULL</span><br></pre></td></tr></table></figure>
<h3 id="示例：平移动画"><a href="#示例：平移动画" class="headerlink" title="示例：平移动画"></a>示例：平移动画</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    UIView *view1 = [[UIView alloc] initWithFrame:CGRectMake(22, 22, 100, 100)];</span><br><span class="line">    view1.backgroundColor = [UIColor flatMintColor];</span><br><span class="line">    [self.view addSubview:view1];</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:2.0    // 动画持续时间</span><br><span class="line">                          delay:1.0    // 动画执行的延迟时间</span><br><span class="line">                        options:UIViewAnimationOptionLayoutSubviews    // 执行的动画选项</span><br><span class="line">                     animations:^&#123;</span><br><span class="line">                         // 要执行的动画代码</span><br><span class="line">                         view1.center = self.view.center;</span><br><span class="line">                     &#125;</span><br><span class="line">                     completion:^(BOOL finished) &#123;</span><br><span class="line">                         // 动画执行完毕后的调用</span><br><span class="line"></span><br><span class="line">                     &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-10f6a9144dff63df.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<h3 id="示例：重复动画"><a href="#示例：重复动画" class="headerlink" title="示例：重复动画"></a>示例：重复动画</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    UIView *view1 = [[UIView alloc] initWithFrame:CGRectMake(22, 22, 100, 100)];</span><br><span class="line">    view1.backgroundColor = [UIColor flatMintColor];</span><br><span class="line">    [self.view addSubview:view1];</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:3.0</span><br><span class="line">                          delay:1.0</span><br><span class="line">                        options:UIViewAnimationOptionRepeat |</span><br><span class="line">                                UIViewAnimationOptionAutoreverse |</span><br><span class="line">                                UIViewAnimationOptionCurveEaseInOut</span><br><span class="line">                     animations:^&#123;</span><br><span class="line">                         // 要执行的动画代码</span><br><span class="line">                         view1.center = self.view.center;</span><br><span class="line">                         view1.backgroundColor = [UIColor flatSkyBlueColor];</span><br><span class="line">                     &#125;</span><br><span class="line">                     completion:^(BOOL finished) &#123;</span><br><span class="line">                         // 动画执行完毕后的调用</span><br><span class="line"></span><br><span class="line">                     &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ce3c1fe80f7d6734.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<h3 id="示例：旋转动画"><a href="#示例：旋转动画" class="headerlink" title="示例：旋转动画"></a>示例：旋转动画</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[UIView animateWithDuration:0.25 animations:^&#123;</span><br><span class="line">   cell.arrow.transform = CGAffineTransformMakeRotation(M_PI);</span><br><span class="line">&#125; completion:^(BOOL finished) &#123;</span><br><span class="line"></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h3 id="示例：嵌套动画"><a href="#示例：嵌套动画" class="headerlink" title="示例：嵌套动画"></a>示例：嵌套动画</h3><blockquote>
<p>摘自<a href="https://github.com/ibireme/YYText" target="_blank" rel="noopener">YYText Demo</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (void)showMessage:(NSString *)msg &#123;</span><br><span class="line">    CGFloat padding = 10;</span><br><span class="line">    </span><br><span class="line">    YYLabel *label = [YYLabel new];</span><br><span class="line">    label.text = msg;</span><br><span class="line">    label.font = [UIFont systemFontOfSize:16];</span><br><span class="line">    label.textAlignment = NSTextAlignmentCenter;</span><br><span class="line">    label.textColor = [UIColor whiteColor];</span><br><span class="line">    label.backgroundColor = [UIColor colorWithRed:0.033 green:0.685 blue:0.978 alpha:0.730];</span><br><span class="line">    label.textContainerInset = UIEdgeInsetsMake(padding, padding, padding, padding);</span><br><span class="line">    label.width = self.view.width;</span><br><span class="line">    label.height = [msg heightForFont:label.font width:label.width] + 2 * padding;</span><br><span class="line">    label.bottom = (kiOS7Later ? 64 : 0);</span><br><span class="line">    [self.view addSubview:label];</span><br><span class="line">    </span><br><span class="line">    // 显示label动画</span><br><span class="line">    [UIView animateWithDuration:0.3 animations:^&#123;</span><br><span class="line">        label.top = (kiOS7Later ? 64 : 0);</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        </span><br><span class="line">        // 嵌套动画，2秒后隐藏label动画</span><br><span class="line">        [UIView animateWithDuration:0.2 delay:2 options:UIViewAnimationOptionCurveEaseInOut animations:^&#123;</span><br><span class="line">            label.bottom = (kiOS7Later ? 64 : 0);</span><br><span class="line">        &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">            [label removeFromSuperview];</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9f387b6bcdd352a2.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<h2 id="Spring-动画"><a href="#Spring-动画" class="headerlink" title="Spring 动画"></a>Spring 动画</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/* Performs `animations` using a timing curve described by the motion of a spring. When `dampingRatio` is 1, the animation will smoothly decelerate to its final model values without oscillating. Damping ratios less than 1 will oscillate more and more before coming to a complete stop. You can use the initial spring velocity to specify how fast the object at the end of the simulated spring was moving before it was attached. It&apos;s a unit coordinate system, where 1 is defined as travelling the total animation distance in a second. So if you&apos;re changing an object&apos;s position by 200pt in this animation, and you want the animation to behave as if the object was moving at 100pt/s before the animation started, you&apos;d pass 0.5. You&apos;ll typically want to pass 0 for the velocity. </span><br><span class="line"></span><br><span class="line">大意：使用弹簧运动描述的时序曲线执行动画。当 dampingRatio (阻尼比)为1时，动画将平稳减速到其最终模型没有振荡。小于1的阻尼比在达到完全停止之前会越来越波动。你可以使用初始的弹簧速度来指定模拟弹簧在到达终点之前移动的速度有多快。velocity（动画速率）是一个单位坐标系，其中1定义为在一秒钟内移动总动画距离。所以在动画执行过程中,如果你想改变对象的移动距离为200pt，并且你想要动画表现得像物体一样 以100pt / s 的速度运动，那么你应该设置弹簧的速率为0.5。你通常想通过0的速度。*/ </span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay usingSpringWithDamping:(CGFloat)dampingRatio initialSpringVelocity:(CGFloat)velocity options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<h3 id="两个额外参数："><a href="#两个额外参数：" class="headerlink" title="两个额外参数："></a>两个额外参数：</h3><ul>
<li><code>dampingRatio</code>：弹簧动画中的阻尼比。相当于弹簧的硬度，数值在 0.0 到 1.0 之间，数值越小，弹簧越软，波动幅度越大；反之相反。</li>
<li><code>velocity</code>：弹簧的速率。数值越小，动力越小，弹簧的拉伸幅度就越小。反之相反。比如：总共的动画运行距离是200 points，你希望每秒 100pt ，值为 0.5；</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIView</span> *view1 = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.view.frame.size.width / <span class="number">2</span> - <span class="number">50</span>, <span class="number">22</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    view1.backgroundColor = [<span class="built_in">UIColor</span> flatMintColor];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:view1];</span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">3.0</span></span><br><span class="line">                          delay:<span class="number">1.0</span></span><br><span class="line">         usingSpringWithDamping:<span class="number">0.4</span>    <span class="comment">// 弹簧阻尼比</span></span><br><span class="line">          initialSpringVelocity:<span class="number">0.3</span>    <span class="comment">// 速度</span></span><br><span class="line">                        options:<span class="built_in">UIViewAnimationOptionLayoutSubviews</span></span><br><span class="line">                     animations:^&#123;</span><br><span class="line">                         view1.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">                     &#125;</span><br><span class="line">                     completion:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">                         </span><br><span class="line">                     &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-bc5482327e63cd42.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<h2 id="Transitions-转场动画"><a href="#Transitions-转场动画" class="headerlink" title="Transitions 转场动画"></a>Transitions 转场动画</h2><p>常用于添加、删除子视图或隐藏、显示子视图时的动画。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/** 为指定的容器视图创建转换动画 */  </span><br><span class="line">+ (void)transitionWithView:(UIView *)view duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options animations:(void (^ __nullable)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** 使用给定的参数在指定视图之间创建转换动画 */  </span><br><span class="line">+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0); // toView added to fromView.superview, fromView removed from its superview</span><br></pre></td></tr></table></figure>
<h3 id="示例一："><a href="#示例一：" class="headerlink" title="示例一："></a>示例一：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    [self.view addSubview:self.containerView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated &#123;</span><br><span class="line">    [super viewDidAppear:animated];</span><br><span class="line">    [UIView transitionWithView:self.containerView</span><br><span class="line">                      duration:1.0</span><br><span class="line">                       options:UIViewAnimationOptionTransitionFlipFromLeft |</span><br><span class="line">     UIViewAnimationOptionRepeat |</span><br><span class="line">     UIViewAnimationOptionAutoreverse</span><br><span class="line">                    animations:^&#123;</span><br><span class="line">                        [self.containerView addSubview:self.subView];</span><br><span class="line">                    &#125;</span><br><span class="line">                    completion:^(BOOL finished) &#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Custom Accessors</span><br><span class="line"></span><br><span class="line">- (UIView *)containerView &#123;</span><br><span class="line">    if (!_containerView) &#123;</span><br><span class="line">        _containerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 250, 250)];</span><br><span class="line">        _containerView.center = self.view.center;</span><br><span class="line">    &#125;</span><br><span class="line">    return _containerView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UIView *)subView &#123;</span><br><span class="line">    if (!_subView) &#123;</span><br><span class="line">        _subView = [[UIView alloc] initWithFrame:self.containerView.bounds];</span><br><span class="line">        _subView.backgroundColor = [UIColor flatGreenColor];</span><br><span class="line">    &#125;</span><br><span class="line">    return _subView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-84204eae0af7e78e.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<h3 id="示例二："><a href="#示例二：" class="headerlink" title="示例二："></a>示例二：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    [self.view addSubview:self.view1];</span><br><span class="line">    [self.view addSubview:self.button];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Custom Accessors</span><br><span class="line"></span><br><span class="line">- (UIView *)view1 &#123;</span><br><span class="line">    if (!_view1) &#123;</span><br><span class="line">        _view1 = [[UIView alloc] initWithFrame:CGRectMake(0, [UIScreen mainScreen].bounds.size.height - 450, [UIScreen mainScreen].bounds.size.width, 450)];</span><br><span class="line">        _view1.backgroundColor = [UIColor flatWatermelonColor];</span><br><span class="line">    &#125;</span><br><span class="line">    return _view1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UIView *)view2 &#123;</span><br><span class="line">    if (!_view2) &#123;</span><br><span class="line">        _view2 = [[UIView alloc] initWithFrame:CGRectMake(0, [UIScreen mainScreen].bounds.size.height - 450, [UIScreen mainScreen].bounds.size.width, 450)];</span><br><span class="line">        _view2.backgroundColor = [UIColor flatGreenColor];</span><br><span class="line">    &#125;</span><br><span class="line">    return _view2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - IBActions</span><br><span class="line"></span><br><span class="line">- (void)startAnimation:(id)sender &#123;    </span><br><span class="line">    // 转场动画</span><br><span class="line">    [UIView transitionFromView:self.view1</span><br><span class="line">                        toView:self.view2</span><br><span class="line">                      duration:0.25</span><br><span class="line">                       options:UIViewAnimationOptionTransitionFlipFromRight</span><br><span class="line">                    completion:^(BOOL finished) &#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-b46ed3961dc56d2a.gif?imageMogr2/auto-orient/strip" alt></p>
<p>另外，关于 <strong>UINavigationController</strong> 的 push、pop 动画：</p>
<p><a href="http://www.jianshu.com/p/75d7b0341bc5" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 10 :: Custom UIViewController Transitions</a></p>
<hr>
<h2 id="Keyframe-动画"><a href="#Keyframe-动画" class="headerlink" title="Keyframe 动画"></a>Keyframe 动画</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/** UIView 的关键帧动画 */</span><br><span class="line">@interface UIView (UIViewKeyframeAnimations)</span><br><span class="line"></span><br><span class="line">/** 创建一个动画块对象，可用于为当前视图设置基于关键帧的动画 */ </span><br><span class="line">+ (void)animateKeyframesWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewKeyframeAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);</span><br><span class="line"></span><br><span class="line">/** 添加指定开始时间、持续时间的关键帧动画(起始和持续时间是0.0和1.0之间的值) */ </span><br><span class="line">+ (void)addKeyframeWithRelativeStartTime:(double)frameStartTime relativeDuration:(double)frameDuration animations:(void (^)(void))animations NS_AVAILABLE_IOS(7_0); // start time and duration are values between 0.0 and 1.0 specifying time and duration relative to the overall time of the keyframe animation</span><br><span class="line">// 开始时间和持续时间是相对于关键帧动画的总时间的位于0和1之间的值 </span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="示例一：-1"><a href="#示例一：-1" class="headerlink" title="示例一："></a>示例一：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    [self.view addSubview:self.view1];</span><br><span class="line">    </span><br><span class="line">    [UIView animateKeyframesWithDuration:4.0</span><br><span class="line">                                   delay:1.0</span><br><span class="line">                                 options:UIViewKeyframeAnimationOptionRepeat</span><br><span class="line">                              animations:^&#123;</span><br><span class="line">                                  </span><br><span class="line">      [UIView addKeyframeWithRelativeStartTime:0.0</span><br><span class="line">                              relativeDuration:0.25</span><br><span class="line">                                    animations:^&#123;</span><br><span class="line">                                        self.view1.frame = CGRectMake(50, 250, 100, 100);</span><br><span class="line">                                    &#125;];</span><br><span class="line">      [UIView addKeyframeWithRelativeStartTime:0.25</span><br><span class="line">                              relativeDuration:0.25</span><br><span class="line">                                    animations:^&#123;</span><br><span class="line">                                        self.view1.frame = CGRectMake(250, 250, 100, 100);</span><br><span class="line">                                    &#125;];</span><br><span class="line">      [UIView addKeyframeWithRelativeStartTime:0.5</span><br><span class="line">                              relativeDuration:0.25</span><br><span class="line">                                    animations:^&#123;</span><br><span class="line">                                        self.view1.frame = CGRectMake(250, 50, 100, 100);</span><br><span class="line">                                    &#125;];</span><br><span class="line">      [UIView addKeyframeWithRelativeStartTime:0.75</span><br><span class="line">                              relativeDuration:0.25</span><br><span class="line">                                    animations:^&#123;</span><br><span class="line">                                        self.view1.frame = CGRectMake(50, 50, 100, 100);</span><br><span class="line">                                    &#125;];</span><br><span class="line">                              &#125;</span><br><span class="line">                              completion:^(BOOL finished) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Custom Accessors</span><br><span class="line"></span><br><span class="line">- (UIView *)view1 &#123;</span><br><span class="line">    if (!_view1) &#123;</span><br><span class="line">        _view1 = [[UIView alloc] initWithFrame:CGRectMake(50, 50, 100, 100)];</span><br><span class="line">        _view1.backgroundColor = [UIColor flatWatermelonColor];</span><br><span class="line">    &#125;</span><br><span class="line">    return _view1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-05101b9ec529665a.gif?imageMogr2/auto-orient/strip" alt></p>
<p>关键帧动画的其他示例：</p>
<p><a href="http://www.jianshu.com/p/a60f029e5c72" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 11 :: UIView Key-frame Animations</a></p>
<hr>
<h2 id="Layer-动画"><a href="#Layer-动画" class="headerlink" title="Layer 动画"></a>Layer 动画</h2><h3 id="示例一：CABasicAnimation"><a href="#示例一：CABasicAnimation" class="headerlink" title="示例一：CABasicAnimation"></a>示例一：CABasicAnimation</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CABasicAnimation *basicAnimation = [CABasicAnimation animationWithKeyPath:@&quot;position.x&quot;];</span><br><span class="line">basicAnimation.fromValue = @10;</span><br><span class="line">basicAnimation.toValue = @200;</span><br><span class="line">basicAnimation.duration = 2.0;</span><br><span class="line">// 在动画执行过程中保留最后一帧</span><br><span class="line">basicAnimation.fillMode = kCAFillModeForwards;</span><br><span class="line">basicAnimation.removedOnCompletion = NO;</span><br><span class="line">[self.view1.layer addAnimation:basicAnimation forKey:nil];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-662500c0ca03318a.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="示例二：CAKeyframeAnimation"><a href="#示例二：CAKeyframeAnimation" class="headerlink" title="示例二：CAKeyframeAnimation"></a>示例二：CAKeyframeAnimation</h3><p><strong>UILabel</strong> 的跑马灯效果：</p>
<blockquote>
<p>摘自：<a href="https://github.com/dsxNiubility/Wonderful" target="_blank" rel="noopener">Wonderful</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- (void)moveAction &#123;</span><br><span class="line">    // 以 Label 的中心点运动</span><br><span class="line">    // 贝塞尔曲线 起点</span><br><span class="line">    CGPoint fromPoint = CGPointMake(self.frame.size.width + self.marqueeLbl.frame.size.width/2, self.frame.size.height/2);</span><br><span class="line">    // 贝塞尔曲线 终点</span><br><span class="line">    CGPoint toPoint = CGPointMake(-self.marqueeLbl.frame.size.width/2, self.frame.size.height/2);</span><br><span class="line">    </span><br><span class="line">    self.marqueeLbl.center = fromPoint;</span><br><span class="line">    UIBezierPath *movePath = [UIBezierPath bezierPath];</span><br><span class="line">    [movePath moveToPoint:fromPoint];</span><br><span class="line">    [movePath addLineToPoint:toPoint];</span><br><span class="line">    </span><br><span class="line">    // 创建动画实例</span><br><span class="line">    CAKeyframeAnimation *moveAnim = [CAKeyframeAnimation animationWithKeyPath:@&quot;position&quot;];</span><br><span class="line">    // 设置动画路径</span><br><span class="line">    moveAnim.path = movePath.CGPath;</span><br><span class="line">    // 设置动画时长</span><br><span class="line">    moveAnim.duration = self.marqueeLbl.frame.size.width * self.speedLevel * 0.01;</span><br><span class="line">    // 委托协议，动画完成后重复该动画</span><br><span class="line">    moveAnim.delegate = self;</span><br><span class="line">    // 在图层上添加动画</span><br><span class="line">    [self.marqueeLbl.layer addAnimation:moveAnim forKey:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - CAAnimationDelegate</span><br><span class="line"></span><br><span class="line">- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag&#123;</span><br><span class="line">    if (flag) &#123;</span><br><span class="line">        [self moveAction];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UIView-h-源码解析注释"><a href="#UIView-h-源码解析注释" class="headerlink" title="UIView.h 源码解析注释"></a>UIView.h 源码解析注释</h2><blockquote>
<p>摘自：<a href="http://blog.csdn.net/zeng_zhiming/article/details/73469182" target="_blank" rel="noopener">ios开发 之 UIView详解</a>，部分修改。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br></pre></td><td class="code"><pre><span class="line">//  UIView.h</span><br><span class="line">//  UIKit</span><br><span class="line">//</span><br><span class="line">//  Copyright (c) 2005-2016 Apple Inc. All rights reserved.</span><br><span class="line">//  Created by ZengZhiming on 2017/5/22.  </span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;  </span><br><span class="line">#import &lt;QuartzCore/QuartzCore.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIResponder.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIInterface.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIKitDefines.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIAppearance.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIDynamicBehavior.h&gt;  </span><br><span class="line">#import &lt;UIKit/NSLayoutConstraint.h&gt;  </span><br><span class="line">#import &lt;UIKit/UITraitCollection.h&gt;  </span><br><span class="line">#import &lt;UIKit/UIFocus.h&gt;  </span><br><span class="line">  </span><br><span class="line">NS_ASSUME_NONNULL_BEGIN  </span><br><span class="line">  </span><br><span class="line">/** 动画的曲线枚举 */  </span><br><span class="line">typedef NS_ENUM(NSInteger, UIViewAnimationCurve) &#123;  </span><br><span class="line">    UIViewAnimationCurveEaseInOut,  //!&lt; 慢进慢出（默认值）.  </span><br><span class="line">    UIViewAnimationCurveEaseIn,     //!&lt; 慢进.  </span><br><span class="line">    UIViewAnimationCurveEaseOut,    //!&lt; 慢出.  </span><br><span class="line">    UIViewAnimationCurveLinear,     //!&lt; 匀速.  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">/** UIView 内容填充模式 */</span><br><span class="line">typedef NS_ENUM(NSInteger, UIViewContentMode) &#123;  </span><br><span class="line">    UIViewContentModeScaleToFill,       //!&lt; 缩放内容到合适比例大小.  </span><br><span class="line">    UIViewContentModeScaleAspectFit,    //!&lt; 缩放内容到合适的大小，边界多余部分透明.  </span><br><span class="line">    UIViewContentModeScaleAspectFill,   //!&lt; 缩放内容填充到指定大小，边界多余的部分省略.  </span><br><span class="line">    UIViewContentModeRedraw,            //!&lt; 重绘视图边界 (需调用 -setNeedsDisplay).  </span><br><span class="line">    UIViewContentModeCenter,            //!&lt; 视图保持等比缩放.  </span><br><span class="line">    UIViewContentModeTop,               //!&lt; 视图顶部对齐.  </span><br><span class="line">    UIViewContentModeBottom,            //!&lt; 视图底部对齐.  </span><br><span class="line">    UIViewContentModeLeft,              //!&lt; 视图左侧对齐.  </span><br><span class="line">    UIViewContentModeRight,             //!&lt; 视图右侧对齐.  </span><br><span class="line">    UIViewContentModeTopLeft,           //!&lt; 视图左上角对齐.  </span><br><span class="line">    UIViewContentModeTopRight,          //!&lt; 视图右上角对齐.  </span><br><span class="line">    UIViewContentModeBottomLeft,        //!&lt; 视图左下角对齐.  </span><br><span class="line">    UIViewContentModeBottomRight,       //!&lt; 视图右下角对齐.  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">/** UIView 动画过渡效果 */  </span><br><span class="line">typedef NS_ENUM(NSInteger, UIViewAnimationTransition) &#123;  </span><br><span class="line">    UIViewAnimationTransitionNone,          //!&lt; 无效果.  </span><br><span class="line">    UIViewAnimationTransitionFlipFromLeft,  //!&lt; 沿视图垂直中心轴左到右移动.  </span><br><span class="line">    UIViewAnimationTransitionFlipFromRight, //!&lt; 沿视图垂直中心轴右到左移动.  </span><br><span class="line">    UIViewAnimationTransitionCurlUp,        //!&lt; 由底部向上卷起.  </span><br><span class="line">    UIViewAnimationTransitionCurlDown,      //!&lt; 由顶部向下展开.  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">/** 自动调整大小方式 */  </span><br><span class="line">typedef NS_OPTIONS(NSUInteger, UIViewAutoresizing) &#123;  </span><br><span class="line">    UIViewAutoresizingNone                 = 0,     //!&lt; 不自动调整.  </span><br><span class="line">    UIViewAutoresizingFlexibleLeftMargin   = 1 &lt;&lt; 0,//!&lt; 自动调整与superView左边的距离，保证与superView右边的距离不变.  </span><br><span class="line">    UIViewAutoresizingFlexibleWidth        = 1 &lt;&lt; 1,//!&lt; 自动调整自己的宽度，保证与superView左边和右边的距离不变.  </span><br><span class="line">    UIViewAutoresizingFlexibleRightMargin  = 1 &lt;&lt; 2,//!&lt; 自动调整与superView的右边距离，保证与superView左边的距离不变.  </span><br><span class="line">    UIViewAutoresizingFlexibleTopMargin    = 1 &lt;&lt; 3,//!&lt; 自动调整与superView顶部的距离，保证与superView底部的距离不变.  </span><br><span class="line">    UIViewAutoresizingFlexibleHeight       = 1 &lt;&lt; 4,//!&lt; 自动调整自己的高度，保证与superView顶部和底部的距离不变.  </span><br><span class="line">    UIViewAutoresizingFlexibleBottomMargin = 1 &lt;&lt; 5 //!&lt; 自动调整与superView底部的距离，也就是说，与superView顶部的距离不变.  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">/** UIView动画选项 */  </span><br><span class="line">typedef NS_OPTIONS(NSUInteger, UIViewAnimationOptions) &#123;</span><br><span class="line">    </span><br><span class="line">    // 📌----------------------------------------------------------------------------</span><br><span class="line">    // 1.常规动画属性设置（可以同时选择多个进行设置）</span><br><span class="line">    UIViewAnimationOptionLayoutSubviews            = 1 &lt;&lt;  0, // 动画过程中保证子视图跟随运动。**提交动画的时候布局子控件，表示子控件将和父控件一同动画。**</span><br><span class="line">    UIViewAnimationOptionAllowUserInteraction      = 1 &lt;&lt;  1, // 动画过程中允许用户交互。</span><br><span class="line">    UIViewAnimationOptionBeginFromCurrentState     = 1 &lt;&lt;  2, // 所有视图从当前状态开始运行,而不是从初始状态开始运行。</span><br><span class="line">    UIViewAnimationOptionRepeat                    = 1 &lt;&lt;  3, // 无限重复动画</span><br><span class="line">    UIViewAnimationOptionAutoreverse               = 1 &lt;&lt;  4, // 动画运行到结束点后仍然以动画方式回到初始点。**来回运行动画,前提是设置动画无限重复**</span><br><span class="line">    UIViewAnimationOptionOverrideInheritedDuration = 1 &lt;&lt;  5, // 忽略嵌套动画时间设置。**忽略外层动画嵌套的时间变化曲线**</span><br><span class="line">    UIViewAnimationOptionOverrideInheritedCurve    = 1 &lt;&lt;  6, // 忽略嵌套动画速度设置。**通过改变属性和重绘实现动画效果，如果key没有提交动画将使用快照**</span><br><span class="line">    UIViewAnimationOptionAllowAnimatedContent      = 1 &lt;&lt;  7, // 动画过程中重绘视图（注意仅仅适用于转场动画）。</span><br><span class="line">    UIViewAnimationOptionShowHideTransitionViews   = 1 &lt;&lt;  8, // 视图切换时直接隐藏旧视图、显示新视图，而不是将旧视图从父视图移除（仅仅适用于转场动画）**用显隐的方式替代添加移除图层的动画效果**</span><br><span class="line">    UIViewAnimationOptionOverrideInheritedOptions  = 1 &lt;&lt;  9, // 不继承父动画设置或动画类型。**忽略嵌套继承的选项**</span><br><span class="line">    </span><br><span class="line">    // 📌----------------------------------------------------------------------------</span><br><span class="line">    // 2.动画速度控制（可从其中选择一个设置）时间函数曲线相关**时间曲线函数**</span><br><span class="line">    UIViewAnimationOptionCurveEaseInOut            = 0 &lt;&lt; 16, // 默认，动画先缓慢，然后逐渐加速。</span><br><span class="line">    UIViewAnimationOptionCurveEaseIn               = 1 &lt;&lt; 16, // 动画逐渐变慢。</span><br><span class="line">    UIViewAnimationOptionCurveEaseOut              = 2 &lt;&lt; 16, // 动画逐渐加速。</span><br><span class="line">    UIViewAnimationOptionCurveLinear               = 3 &lt;&lt; 16, // 动画匀速执行。</span><br><span class="line">    </span><br><span class="line">    // 📌-----------------------------------------------------------------------------</span><br><span class="line">    // 3.转场类型（仅适用于转场动画设置，可以从中选择一个进行设置，基本动画、关键帧动画不需要设置）**转场动画相关**</span><br><span class="line">    UIViewAnimationOptionTransitionNone            = 0 &lt;&lt; 20, // 默认，没有转场动画效果。</span><br><span class="line">    UIViewAnimationOptionTransitionFlipFromLeft    = 1 &lt;&lt; 20, // 从左侧翻转效果。</span><br><span class="line">    UIViewAnimationOptionTransitionFlipFromRight   = 2 &lt;&lt; 20, // 从右侧翻转效果。</span><br><span class="line">    UIViewAnimationOptionTransitionCurlUp          = 3 &lt;&lt; 20, // 向后翻页的动画过渡效果。</span><br><span class="line">    UIViewAnimationOptionTransitionCurlDown        = 4 &lt;&lt; 20, // 向前翻页的动画过渡效果。</span><br><span class="line">    UIViewAnimationOptionTransitionCrossDissolve   = 5 &lt;&lt; 20, // 旧视图溶解消失显示下一个新视图的效果。</span><br><span class="line">    UIViewAnimationOptionTransitionFlipFromTop     = 6 &lt;&lt; 20, // 从上方翻转效果。</span><br><span class="line">    UIViewAnimationOptionTransitionFlipFromBottom  = 7 &lt;&lt; 20, // 从底部翻转效果。</span><br><span class="line">    </span><br><span class="line">    // 📌-----------------------------------------------------------------------------</span><br><span class="line">    // 4.设置帧速率</span><br><span class="line">    UIViewAnimationOptionPreferredFramesPerSecondDefault     = 0 &lt;&lt; 24, // 默认的帧每秒.</span><br><span class="line">    UIViewAnimationOptionPreferredFramesPerSecond60          = 3 &lt;&lt; 24, // 60帧每秒的帧速率.</span><br><span class="line">    UIViewAnimationOptionPreferredFramesPerSecond30          = 7 &lt;&lt; 24, // 30帧每秒的帧速率.</span><br><span class="line">    </span><br><span class="line">    /*</span><br><span class="line">      补充：关于转场动画,它一般是用在这个方法中的:</span><br><span class="line">     </span><br><span class="line">    　[UIView transitionFromView: toView: duration: options:  completion:^(****BOOL****finished) &#123;&#125;];</span><br><span class="line">     该方法效果是插入一面视图移除一面视图，期间可以使用一些转场动画效果。</span><br><span class="line">     */</span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(4_0);</span><br><span class="line"></span><br><span class="line">/** UIView 关键帧动画 */ </span><br><span class="line">typedef NS_OPTIONS(NSUInteger, UIViewKeyframeAnimationOptions) &#123;  </span><br><span class="line">    UIViewKeyframeAnimationOptionLayoutSubviews            = UIViewAnimationOptionLayoutSubviews, //!&lt; 动画过程中保证子视图跟随运动.  </span><br><span class="line">    UIViewKeyframeAnimationOptionAllowUserInteraction      = UIViewAnimationOptionAllowUserInteraction, //!&lt; 动画过程中允许用户交互.  </span><br><span class="line">    UIViewKeyframeAnimationOptionBeginFromCurrentState     = UIViewAnimationOptionBeginFromCurrentState, //!&lt; 所有视图从当前状态开始运行.  </span><br><span class="line">    UIViewKeyframeAnimationOptionRepeat                    = UIViewAnimationOptionRepeat, //!&lt; 重复运行动画.  </span><br><span class="line">    UIViewKeyframeAnimationOptionAutoreverse               = UIViewAnimationOptionAutoreverse, //!&lt; 动画运行到结束点后仍然以动画方式回到初始点.  </span><br><span class="line">    UIViewKeyframeAnimationOptionOverrideInheritedDuration = UIViewAnimationOptionOverrideInheritedDuration, //!&lt; 忽略嵌套动画时间设置.  </span><br><span class="line">    UIViewKeyframeAnimationOptionOverrideInheritedOptions  = UIViewAnimationOptionOverrideInheritedOptions, //!&lt; 不继承父动画设置或动画类型.  </span><br><span class="line">      </span><br><span class="line">    UIViewKeyframeAnimationOptionCalculationModeLinear     = 0 &lt;&lt; 10, //!&lt; 连续运算模式, 默认.  </span><br><span class="line">    UIViewKeyframeAnimationOptionCalculationModeDiscrete   = 1 &lt;&lt; 10, //!&lt; 离散运算模式.  </span><br><span class="line">    UIViewKeyframeAnimationOptionCalculationModePaced      = 2 &lt;&lt; 10, //!&lt; 均匀执行运算模式.  </span><br><span class="line">    UIViewKeyframeAnimationOptionCalculationModeCubic      = 3 &lt;&lt; 10, //!&lt; 平滑运算模式.  </span><br><span class="line">    UIViewKeyframeAnimationOptionCalculationModeCubicPaced = 4 &lt;&lt; 10  //!&lt; 平滑均匀运算模式.  </span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">typedef NS_ENUM(NSUInteger, UISystemAnimation) &#123;  </span><br><span class="line">    UISystemAnimationDelete,    //!&lt; 系统删除动画  </span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">typedef NS_ENUM(NSInteger, UIViewTintAdjustmentMode) &#123;  </span><br><span class="line">    UIViewTintAdjustmentModeAutomatic,  //!&lt; 自动的，与父视图相同.  </span><br><span class="line">      </span><br><span class="line">    UIViewTintAdjustmentModeNormal,     //!&lt; 未经修改的.  </span><br><span class="line">    UIViewTintAdjustmentModeDimmed,     //!&lt; 饱和、暗淡的原始色.  </span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">typedef NS_ENUM(NSInteger, UISemanticContentAttribute) &#123;  </span><br><span class="line">    UISemanticContentAttributeUnspecified = 0,  //!&lt; 未指定，默认值  </span><br><span class="line">    UISemanticContentAttributePlayback,         //!&lt; 打开/ RW / FF等播放控制按钮  </span><br><span class="line">    UISemanticContentAttributeSpatial,          //!&lt; 控制导致某种形式的定向改变UI中,如分段控制文本对齐方式或在游戏中方向键  </span><br><span class="line">    UISemanticContentAttributeForceLeftToRight, //!&lt; 视图总是从左向右布局.  </span><br><span class="line">    UISemanticContentAttributeForceRightToLeft  //!&lt; 视图总是从右向左布局.  </span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">@protocol UICoordinateSpace &lt;NSObject&gt;  </span><br><span class="line">  </span><br><span class="line">/** 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值 */  </span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point toCoordinateSpace:(id &lt;UICoordinateSpace&gt;)coordinateSpace NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">/** 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值 */  </span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point fromCoordinateSpace:(id &lt;UICoordinateSpace&gt;)coordinateSpace NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">/** 将rect由rect所在视图转换到目标视图view中，返回在目标视图view中的rect */  </span><br><span class="line">- (CGRect)convertRect:(CGRect)rect toCoordinateSpace:(id &lt;UICoordinateSpace&gt;)coordinateSpace NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">/** 将rect从view中转换到当前视图中，返回在当前视图中的rect */  </span><br><span class="line">- (CGRect)convertRect:(CGRect)rect fromCoordinateSpace:(id &lt;UICoordinateSpace&gt;)coordinateSpace NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">  </span><br><span class="line">/** 获取bounds */  </span><br><span class="line">@property (readonly, nonatomic) CGRect bounds NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">@class UIBezierPath, UIEvent, UIWindow, UIViewController, UIColor, UIGestureRecognizer, UIMotionEffect, CALayer, UILayoutGuide;  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView </span><br><span class="line">NS_CLASS_AVAILABLE_IOS(2_0) @interface UIView : UIResponder &lt;NSCoding, UIAppearance, UIAppearanceContainer, UIDynamicItem, UITraitEnvironment, UICoordinateSpace, UIFocusItem, CALayerDelegate&gt;  </span><br><span class="line">  </span><br><span class="line">/** 返回主 layer 所使用的类 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(class, nonatomic, readonly) Class layerClass;  </span><br><span class="line">#else  </span><br><span class="line">+ (Class)layerClass;  </span><br><span class="line">#endif  </span><br><span class="line">  </span><br><span class="line">/** 通过设置 Frame 初始化 UIView 对象 */  </span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame NS_DESIGNATED_INITIALIZER;  </span><br><span class="line">/** 用于xib初始化 */  </span><br><span class="line">- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder NS_DESIGNATED_INITIALIZER;  </span><br><span class="line">  </span><br><span class="line">/** 设置用户交互，默认YES允许用户交互 */  </span><br><span class="line">@property(nonatomic,getter=isUserInteractionEnabled) BOOL userInteractionEnabled;  </span><br><span class="line">/** 控件标记(父控件可以通过tag找到对应的子控件)，默认为0 */  </span><br><span class="line">@property(nonatomic)                                 NSInteger tag;  </span><br><span class="line">/** 视图图层(可以用来设置圆角效果/阴影效果) */  </span><br><span class="line">@property(nonatomic,readonly,strong)                 CALayer  *layer;  </span><br><span class="line">  </span><br><span class="line">/** 返回是否可以成为焦点, 默认NO */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(nonatomic,readonly) BOOL canBecomeFocused NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">#else  </span><br><span class="line">- (BOOL)canBecomeFocused NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">#endif  </span><br><span class="line">/** 是否可以被聚焦 */  </span><br><span class="line">@property (readonly, nonatomic, getter=isFocused) BOOL focused NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 左右滑动翻转效果 */  </span><br><span class="line">@property (nonatomic) UISemanticContentAttribute semanticContentAttribute NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 获取视图的方向 */  </span><br><span class="line">+ (UIUserInterfaceLayoutDirection)userInterfaceLayoutDirectionForSemanticContentAttribute:(UISemanticContentAttribute)attribute NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 获取相对于指定视图的界面方向 */  </span><br><span class="line">+ (UIUserInterfaceLayoutDirection)userInterfaceLayoutDirectionForSemanticContentAttribute:(UISemanticContentAttribute)semanticContentAttribute relativeToLayoutDirection:(UIUserInterfaceLayoutDirection)layoutDirection NS_AVAILABLE_IOS(10_0);  </span><br><span class="line">  </span><br><span class="line">/** 返回即时内容的布局的方向 */  </span><br><span class="line">@property (readonly, nonatomic) UIUserInterfaceLayoutDirection effectiveUserInterfaceLayoutDirection NS_AVAILABLE_IOS(10_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，几何 </span><br><span class="line">@interface UIView(UIViewGeometry)  </span><br><span class="line">  </span><br><span class="line">/** 位置和尺寸(以父控件的左上角为坐标原点(0, 0)) */  </span><br><span class="line">@property(nonatomic) CGRect            frame;  </span><br><span class="line">  </span><br><span class="line">/** 位置和尺寸(以自己的左上角为坐标原点(0, 0)) */  </span><br><span class="line">@property(nonatomic) CGRect            bounds;  </span><br><span class="line">/** 中心点(以父控件的左上角为坐标原点(0, 0)) */  </span><br><span class="line">@property(nonatomic) CGPoint           center;  </span><br><span class="line">/** 变形属性(平移\缩放\旋转) */  </span><br><span class="line">@property(nonatomic) CGAffineTransform transform;  </span><br><span class="line">/** 视图内容的缩放比例 */  </span><br><span class="line">@property(nonatomic) CGFloat           contentScaleFactor NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** 是否支持多点触摸，默认NO */  </span><br><span class="line">@property(nonatomic,getter=isMultipleTouchEnabled) BOOL multipleTouchEnabled __TVOS_PROHIBITED;  </span><br><span class="line">/** 是否独占整个Touch事件，默认NO */  </span><br><span class="line">@property(nonatomic,getter=isExclusiveTouch) BOOL       exclusiveTouch __TVOS_PROHIBITED;  </span><br><span class="line">  </span><br><span class="line">/** 在指定点上点击测试指定事件 */  </span><br><span class="line">- (nullable UIView *)hitTest:(CGPoint)point withEvent:(nullable UIEvent *)event;  </span><br><span class="line">/** 判断当前的点击或者触摸事件的点是否在当前的view中，默认返回YES */  </span><br><span class="line">- (BOOL)pointInside:(CGPoint)point withEvent:(nullable UIEvent *)event;  </span><br><span class="line">  </span><br><span class="line">/** 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值 */  </span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point toView:(nullable UIView *)view;  </span><br><span class="line">/** 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值 */  </span><br><span class="line">- (CGPoint)convertPoint:(CGPoint)point fromView:(nullable UIView *)view;  </span><br><span class="line">/** 将rect由rect所在视图转换到目标视图view中，返回在目标视图view中的rect */  </span><br><span class="line">- (CGRect)convertRect:(CGRect)rect toView:(nullable UIView *)view;  </span><br><span class="line">/** 将rect从view中转换到当前视图中，返回在当前视图中的rect */  </span><br><span class="line">- (CGRect)convertRect:(CGRect)rect fromView:(nullable UIView *)view;  </span><br><span class="line">  </span><br><span class="line">/** 自动调整子视图尺寸，默认YES，如果 self.bounds 改变了，则会根据 autoresizingMask 属性自动调整子视图尺寸 */  </span><br><span class="line">@property(nonatomic) BOOL               autoresizesSubviews;  </span><br><span class="line">/** 自动调整子视图与父视图的位置，默认 UIViewAutoresizingNone */  </span><br><span class="line">@property(nonatomic) UIViewAutoresizing autoresizingMask;  </span><br><span class="line">  </span><br><span class="line">/** 返回“最佳”尺寸以适应给定尺寸。不实际调整视图大小。默认为返回现有视图大小。*/  </span><br><span class="line">- (CGSize)sizeThatFits:(CGSize)size;  </span><br><span class="line">/** 调整为刚好合适子视图大小 */  </span><br><span class="line">- (void)sizeToFit;  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，视图层次结构</span><br><span class="line">@interface UIView(UIViewHierarchy)  </span><br><span class="line">  </span><br><span class="line">/** 获取父视图 */  </span><br><span class="line">@property(nullable, nonatomic,readonly) UIView       *superview;  </span><br><span class="line">/** 获取所有子视图 */  </span><br><span class="line">@property(nonatomic,readonly,copy) NSArray&lt;__kindof UIView *&gt; *subviews;  </span><br><span class="line">/** 获取视图所在的Window */  </span><br><span class="line">@property(nullable, nonatomic,readonly) UIWindow     *window;  </span><br><span class="line">  </span><br><span class="line">/** 从父视图中移除控件 */  </span><br><span class="line">- (void)removeFromSuperview;  </span><br><span class="line">/** 插入子视图(将子视图插入到subviews数组中index这个位置) */  </span><br><span class="line">- (void)insertSubview:(UIView *)view atIndex:(NSInteger)index;  </span><br><span class="line">/** 交换subviews数组中所存放子视图的位置 */  </span><br><span class="line">- (void)exchangeSubviewAtIndex:(NSInteger)index1 withSubviewAtIndex:(NSInteger)index2;  </span><br><span class="line">  </span><br><span class="line">/** 添加子视图(新添加的视图在subviews数组的后面, 显示在最上面) */  </span><br><span class="line">- (void)addSubview:(UIView *)view;  </span><br><span class="line">/** 插入子视图(将子视图插到siblingSubview之下) */  </span><br><span class="line">- (void)insertSubview:(UIView *)view belowSubview:(UIView *)siblingSubview;  </span><br><span class="line">/** 插入子视图(将子视图插到siblingSubview之上) */  </span><br><span class="line">- (void)insertSubview:(UIView *)view aboveSubview:(UIView *)siblingSubview;  </span><br><span class="line">  </span><br><span class="line">/** 将子视图拉到最上面来显示 */  </span><br><span class="line">- (void)bringSubviewToFront:(UIView *)view;  </span><br><span class="line">/** 将子视图拉到最下面来显示 */  </span><br><span class="line">- (void)sendSubviewToBack:(UIView *)view;  </span><br><span class="line">  </span><br><span class="line">#pragma mark - 系统自动调用(留给子类去实现)  </span><br><span class="line">/** 添加子视图完成后调用 */  </span><br><span class="line">- (void)didAddSubview:(UIView *)subview;  </span><br><span class="line">/** 将要移除子视图时调用 */  </span><br><span class="line">- (void)willRemoveSubview:(UIView *)subview;  </span><br><span class="line">  </span><br><span class="line">/** 将要移动到新父视图时调用 */  </span><br><span class="line">- (void)willMoveToSuperview:(nullable UIView *)newSuperview;  </span><br><span class="line">/** 移动到新父视图完成后调用 */  </span><br><span class="line">- (void)didMoveToSuperview;  </span><br><span class="line">/** 将要移动到新 Window 时调用 */  </span><br><span class="line">- (void)willMoveToWindow:(nullable UIWindow *)newWindow;  </span><br><span class="line">/** 移动到新 Window 完成后调用 */  </span><br><span class="line">- (void)didMoveToWindow;  </span><br><span class="line">  </span><br><span class="line">/** 判断view是否为子类 */  </span><br><span class="line">- (BOOL)isDescendantOfView:(UIView *)view;  </span><br><span class="line">/** 通过tag获得对应的子视图 */  </span><br><span class="line">- (nullable __kindof UIView *)viewWithTag:(NSInteger)tag;  </span><br><span class="line">  </span><br><span class="line">/** 对现在有布局有调整更改后，使用这个方法进行更新 */  </span><br><span class="line">- (void)setNeedsLayout;  </span><br><span class="line">/** 强制进行更新layout */  </span><br><span class="line">- (void)layoutIfNeeded;  </span><br><span class="line">  </span><br><span class="line">/** 控件的frame发生改变的时候就会调用,一般在这里重写布局子控件的位置和尺寸 */  </span><br><span class="line">- (void)layoutSubviews;  </span><br><span class="line">  </span><br><span class="line">/** 设置view之间的间距，该属性只对autolayout布局有效 */  </span><br><span class="line">@property (nonatomic) UIEdgeInsets layoutMargins NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">/** 是否将当前视图的间距和父视图相同，默认是NO */  </span><br><span class="line">@property (nonatomic) BOOL preservesSuperviewLayoutMargins NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">/** 改变view的layoutMargins这个属性时，会触发这个方法 */  </span><br><span class="line">- (void)layoutMarginsDidChange NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">  </span><br><span class="line">/** 视图间距引导 */  </span><br><span class="line">@property(readonly,strong) UILayoutGuide *layoutMarginsGuide NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 获取此区域的内的布局引导 */  </span><br><span class="line">@property (nonatomic, readonly, strong) UILayoutGuide *readableContentGuide  NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，视图渲染</span><br><span class="line">@interface UIView(UIViewRendering)  </span><br><span class="line">  </span><br><span class="line">/** 重写drawRect方法，在可以这里进行绘图操作。*/  </span><br><span class="line">- (void)drawRect:(CGRect)rect;  </span><br><span class="line">  </span><br><span class="line">/** 标记整个视图的边界矩形需要重绘, 调用这个方法会自动调用drawRect方法 */  </span><br><span class="line">- (void)setNeedsDisplay;  </span><br><span class="line">/** 标记在指定区域内的视图的边界需要重绘, 调用这个方法会自动调用drawRect方法 */  </span><br><span class="line">- (void)setNeedsDisplayInRect:(CGRect)rect;  </span><br><span class="line">  </span><br><span class="line">/** 是否裁剪超出Bounds范围的子控件，默认NO */  </span><br><span class="line">@property(nonatomic)                 BOOL              clipsToBounds;  </span><br><span class="line">/** 设置背景颜色，默认nil */  </span><br><span class="line">@property(nullable, nonatomic,copy)  UIColor          *backgroundColor UI_APPEARANCE_SELECTOR;  </span><br><span class="line">/** 设置透明度(范围0.0~1.0)，默认1.0 */  </span><br><span class="line">@property(nonatomic)                 CGFloat           alpha;  </span><br><span class="line">/** 设置是否不透明，默认YES不透明 */  </span><br><span class="line">@property(nonatomic,getter=isOpaque) BOOL              opaque;  </span><br><span class="line">/** 视图重绘前是否先清理以前的内容，默认YES */  </span><br><span class="line">@property(nonatomic)                 BOOL              clearsContextBeforeDrawing;  </span><br><span class="line">/** 设置是否隐藏，默认NO不隐藏 */  </span><br><span class="line">@property(nonatomic,getter=isHidden) BOOL              hidden;  </span><br><span class="line">/** 内容显示的模式，默认UIViewContentModeScaleToFill */  </span><br><span class="line">@property(nonatomic)                 UIViewContentMode contentMode;  </span><br><span class="line">/** 拉伸属性，如图片拉伸 */  </span><br><span class="line">@property(nonatomic)                 CGRect            contentStretch NS_DEPRECATED_IOS(3_0,6_0) __TVOS_PROHIBITED;  </span><br><span class="line">  </span><br><span class="line">/** 蒙板view */  </span><br><span class="line">@property(nullable, nonatomic,strong)          UIView           *maskView NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">  </span><br><span class="line">/** 改变应用程序的外观的颜色。默认为nil */  </span><br><span class="line">@property(null_resettable, nonatomic, strong) UIColor *tintColor NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 可以使tintColor变暗，因此整个视图层次变暗 */  </span><br><span class="line">@property(nonatomic) UIViewTintAdjustmentMode tintAdjustmentMode NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 覆盖这个方法的目的是为了当tintColor改变的时候自定义一些行为 */  </span><br><span class="line">- (void)tintColorDidChange NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，视图动画</span><br><span class="line">@interface UIView(UIViewAnimation)  </span><br><span class="line">  </span><br><span class="line">/** 开始动画 */  </span><br><span class="line">+ (void)beginAnimations:(nullable NSString *)animationID context:(nullable voidvoid *)context;  </span><br><span class="line">/** 提交动画 */  </span><br><span class="line">+ (void)commitAnimations;  </span><br><span class="line">  </span><br><span class="line">/** 设置动画代理, 默认nil */  </span><br><span class="line">+ (void)setAnimationDelegate:(nullable id)delegate;  </span><br><span class="line">/** 动画将要开始时执行方法（必须要先设置动画代理）, 默认NULL */  </span><br><span class="line">+ (void)setAnimationWillStartSelector:(nullable SEL)selector;  </span><br><span class="line">/** 动画已结束时执行方法（必须要先设置动画代理）, 默认NULL */  </span><br><span class="line">+ (void)setAnimationDidStopSelector:(nullable SEL)selector;  </span><br><span class="line">/** 设置动画时长, 默认0.2秒 */  </span><br><span class="line">+ (void)setAnimationDuration:(NSTimeInterval)duration;  </span><br><span class="line">/** 动画延迟执行时间, 默认0.0秒 */  </span><br><span class="line">+ (void)setAnimationDelay:(NSTimeInterval)delay;  </span><br><span class="line">/** 设置在动画块内部动画属性改变的开始时间, 默认now ([NSDate date]) */  </span><br><span class="line">+ (void)setAnimationStartDate:(NSDate *)startDate;  </span><br><span class="line">/** 设置动画曲线, 默认UIViewAnimationCurveEaseInOut */  </span><br><span class="line">+ (void)setAnimationCurve:(UIViewAnimationCurve)curve;  </span><br><span class="line">/** 动画的重复播放次数， 默认0 */  </span><br><span class="line">+ (void)setAnimationRepeatCount:(float)repeatCount;  </span><br><span class="line">/** 设置是否自定翻转当前的动画效果, 默认NO */  </span><br><span class="line">+ (void)setAnimationRepeatAutoreverses:(BOOL)repeatAutoreverses;  </span><br><span class="line">/** 设置动画从当前状态开始播放, 默认NO */  </span><br><span class="line">+ (void)setAnimationBeginsFromCurrentState:(BOOL)fromCurrentState;  </span><br><span class="line">  </span><br><span class="line">/** 在动画块中为视图设置过渡动画 */  </span><br><span class="line">+ (void)setAnimationTransition:(UIViewAnimationTransition)transition forView:(UIView *)view cache:(BOOL)cache;  </span><br><span class="line">  </span><br><span class="line">/** 设置是否激活动画 */  </span><br><span class="line">+ (void)setAnimationsEnabled:(BOOL)enabled;  </span><br><span class="line">/** 返回一个布尔值表示动画是否结束 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(class, nonatomic, readonly) BOOL areAnimationsEnabled;  </span><br><span class="line">#else  </span><br><span class="line">+ (BOOL)areAnimationsEnabled;  </span><br><span class="line">#endif  </span><br><span class="line">/** 先检查动画当前是否启用，然后禁止动画，执行block内的方法，最后重新启用动画，而且这个方法不会阻塞基于CoreAnimation的动画 */  </span><br><span class="line">+ (void)performWithoutAnimation:(void (NS_NOESCAPE ^)(void))actionsWithoutAnimation NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 当前动画的持续时间 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(class, nonatomic, readonly) NSTimeInterval inheritedAnimationDuration NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">#else  </span><br><span class="line">+ (NSTimeInterval)inheritedAnimationDuration NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">#endif  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，用 Blocks 方式实现视图动画</span><br><span class="line">@interface UIView(UIViewAnimationWithBlocks)  </span><br><span class="line"></span><br><span class="line">/** </span><br><span class="line">  通过指定动画持续时间、动画延迟、执行动画选项和动画完成后回调的 Block 对象,更改一个或多个视图的动画。</span><br><span class="line">*/</span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line">  通过指定动画持续时间、动画完成后回调的 Block 对象,更改一个或多个视图的动画。</span><br><span class="line">  </span><br><span class="line">  默认：delay = 0.0, options = 0 </span><br><span class="line">*/  </span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line">  通过指定动画持续时间更改一个或多个视图的动画。</span><br><span class="line">  </span><br><span class="line">  默认：delay = 0.0, options = 0, completion = NULL </span><br><span class="line">*/</span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** 使用与物理弹簧运动相对应的定时曲线执行视图动画 */  </span><br><span class="line">+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay usingSpringWithDamping:(CGFloat)dampingRatio initialSpringVelocity:(CGFloat)velocity options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 为指定的容器视图创建转换动画 */  </span><br><span class="line">+ (void)transitionWithView:(UIView *)view duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options animations:(void (^ __nullable)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);  </span><br><span class="line">  </span><br><span class="line">/** 使用给定的参数在指定视图之间创建转换动画 */  </span><br><span class="line">+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0); // toView added to fromView.superview, fromView removed from its superview  </span><br><span class="line">  </span><br><span class="line">/** 在一个或多个视图上执行指定的系统提供的动画，以及定义的可选并行动画 */  </span><br><span class="line">+ (void)performSystemAnimation:(UISystemAnimation)animation onViews:(NSArray&lt;__kindof UIView *&gt; *)views options:(UIViewAnimationOptions)options animations:(void (^ __nullable)(void))parallelAnimations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 的关键帧动画</span><br><span class="line">@interface UIView (UIViewKeyframeAnimations)  </span><br><span class="line">  </span><br><span class="line">/** 创建一个动画块对象，可用于为当前视图设置基于关键帧的动画 */  </span><br><span class="line">+ (void)animateKeyframesWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewKeyframeAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);  </span><br><span class="line"></span><br><span class="line">/** 添加指定开始时间、持续时间的关键帧动画(起始和持续时间是0.0和1.0之间的值) */  </span><br><span class="line">+ (void)addKeyframeWithRelativeStartTime:(double)frameStartTime relativeDuration:(double)frameDuration animations:(void (^)(void))animations NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，手势识别</span><br><span class="line">@interface UIView (UIViewGestureRecognizers)  </span><br><span class="line">  </span><br><span class="line">/** 当前视图所附加的所有手势识别器 */  </span><br><span class="line">@property(nullable, nonatomic,copy) NSArray&lt;__kindof UIGestureRecognizer *&gt; *gestureRecognizers NS_AVAILABLE_IOS(3_2);  </span><br><span class="line">  </span><br><span class="line">/** 添加一个手势识别器 */  </span><br><span class="line">- (void)addGestureRecognizer:(UIGestureRecognizer*)gestureRecognizer NS_AVAILABLE_IOS(3_2);  </span><br><span class="line">/** 移除一个手势识别器 */  </span><br><span class="line">- (void)removeGestureRecognizer:(UIGestureRecognizer*)gestureRecognizer NS_AVAILABLE_IOS(3_2);  </span><br><span class="line">  </span><br><span class="line">/** 是否开始一个手势识别器 */  </span><br><span class="line">- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 运动效果</span><br><span class="line">@interface UIView (UIViewMotionEffects)  </span><br><span class="line">  </span><br><span class="line">/** 添加运动效果，当倾斜设备时视图稍微改变其位置 */  </span><br><span class="line">- (void)addMotionEffect:(UIMotionEffect *)effect NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 移除运动效果 */  </span><br><span class="line">- (void)removeMotionEffect:(UIMotionEffect *)effect NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">/** 所有添加的运动效果 */  </span><br><span class="line">@property (copy, nonatomic) NSArray&lt;__kindof UIMotionEffect *&gt; *motionEffects NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">typedef NS_ENUM(NSInteger, UILayoutConstraintAxis) &#123;  </span><br><span class="line">    UILayoutConstraintAxisHorizontal = 0,   //!&lt; 水平约束.  </span><br><span class="line">    UILayoutConstraintAxisVertical = 1      //!&lt; 竖直约束.  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 布局约束设置  </span><br><span class="line">@interface UIView (UIConstraintBasedLayoutInstallingConstraints)  </span><br><span class="line">  </span><br><span class="line">/** 获取所有约束 */  </span><br><span class="line">@property(nonatomic,readonly) NSArray&lt;__kindof NSLayoutConstraint *&gt; *constraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 添加一个约束 */  </span><br><span class="line">- (void)addConstraint:(NSLayoutConstraint *)constraint NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 添加多个约束 */  </span><br><span class="line">- (void)addConstraints:(NSArray&lt;__kindof NSLayoutConstraint *&gt; *)constraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 移除一个约束 */  </span><br><span class="line">- (void)removeConstraint:(NSLayoutConstraint *)constraint NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 移除多个约束 */  </span><br><span class="line">- (void)removeConstraints:(NSArray&lt;__kindof NSLayoutConstraint *&gt; *)constraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 基于约束的布局核心方法</span><br><span class="line">@interface UIView (UIConstraintBasedLayoutCoreMethods)  </span><br><span class="line">/** 更新视图和其子视图的约束 */  </span><br><span class="line">- (void)updateConstraintsIfNeeded NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 为视图更新约束，可以重写这个方法来设置当前view局部的布局约束 */  </span><br><span class="line">- (void)updateConstraints NS_AVAILABLE_IOS(6_0) NS_REQUIRES_SUPER;  </span><br><span class="line">/** 视图的约束是否需要更新 */  </span><br><span class="line">- (BOOL)needsUpdateConstraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 设置视图的约束需要更新，调用这个方法，系统会调用updateConstraints去更新布局 */  </span><br><span class="line">- (void)setNeedsUpdateConstraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 约束兼容性设置</span><br><span class="line">@interface UIView (UIConstraintBasedCompatibility)  </span><br><span class="line">  </span><br><span class="line">/** 是否启用自动布局约束，默认YES. IB默认是NO */  </span><br><span class="line">@property(nonatomic) BOOL translatesAutoresizingMaskIntoConstraints NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 是否使用约束布局 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(class, nonatomic, readonly) BOOL requiresConstraintBasedLayout NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#else  </span><br><span class="line">+ (BOOL)requiresConstraintBasedLayout NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#endif  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 布局图层约束  </span><br><span class="line">@interface UIView (UIConstraintBasedLayoutLayering)  </span><br><span class="line">  </span><br><span class="line">/** 返回给定框架的视图的对齐矩阵 */  </span><br><span class="line">- (CGRect)alignmentRectForFrame:(CGRect)frame NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 返回给定对齐矩形的视图的frame */  </span><br><span class="line">- (CGRect)frameForAlignmentRect:(CGRect)alignmentRect NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 返回从视图的frame上定义的对齐矩阵的边框 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(nonatomic, readonly) UIEdgeInsets alignmentRectInsets NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#else  </span><br><span class="line">- (UIEdgeInsets)alignmentRectInsets NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#endif  </span><br><span class="line">  </span><br><span class="line">/** 返回满足基线约束条件的视图 */  </span><br><span class="line">- (UIView *)viewForBaselineLayout NS_DEPRECATED_IOS(6_0, 9_0, &quot;Override -viewForFirstBaselineLayout or -viewForLastBaselineLayout as appropriate, instead&quot;) __TVOS_PROHIBITED;  </span><br><span class="line">  </span><br><span class="line">/** 返回用于满足第一基线约束的视图 */  </span><br><span class="line">@property(readonly,strong) UIView *viewForFirstBaselineLayout NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 返回用于满足上次基线约束的视图 */  </span><br><span class="line">@property(readonly,strong) UIView *viewForLastBaselineLayout NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">UIKIT_EXTERN const CGFloat UIViewNoIntrinsicMetric NS_AVAILABLE_IOS(6_0); // -1  </span><br><span class="line">/** 返回接收对象的原本大小 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(nonatomic, readonly) CGSize intrinsicContentSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#else  </span><br><span class="line">- (CGSize)intrinsicContentSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#endif  </span><br><span class="line">/** 废除视图原本内容的size */  </span><br><span class="line">- (void)invalidateIntrinsicContentSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 设置当视图要变大时，视图的压缩改变方式，返回一个优先权（确定view有多大的优先级阻止自己变大） */  </span><br><span class="line">- (UILayoutPriority)contentHuggingPriorityForAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 设置放先权 */  </span><br><span class="line">- (void)setContentHuggingPriority:(UILayoutPriority)priority forAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 设置当视图要变小时，视图的压缩改变方式，是水平缩小还是垂直缩小，并返回一个优先权（确定有多大的优先级阻止自己变小） */  </span><br><span class="line">- (UILayoutPriority)contentCompressionResistancePriorityForAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 设置优先权 */  </span><br><span class="line">- (void)setContentCompressionResistancePriority:(UILayoutPriority)priority forAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">// Size To Fit  </span><br><span class="line">  </span><br><span class="line">UIKIT_EXTERN const CGSize UILayoutFittingCompressedSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">UIKIT_EXTERN const CGSize UILayoutFittingExpandedSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 布局拟合尺寸 </span><br><span class="line">@interface UIView (UIConstraintBasedLayoutFittingSize)  </span><br><span class="line">/** 返回满足持有约束的视图的size */  </span><br><span class="line">- (CGSize)systemLayoutSizeFittingSize:(CGSize)targetSize NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 返回满足它所包含的约束的视图的大小 */  </span><br><span class="line">- (CGSize)systemLayoutSizeFittingSize:(CGSize)targetSize withHorizontalFittingPriority:(UILayoutPriority)horizontalFittingPriority verticalFittingPriority:(UILayoutPriority)verticalFittingPriority NS_AVAILABLE_IOS(8_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 布局指南支持 </span><br><span class="line">@interface UIView (UILayoutGuideSupport)  </span><br><span class="line">  </span><br><span class="line">/** 此视图拥有布局向导对象的数组 */  </span><br><span class="line">@property(nonatomic,readonly,copy) NSArray&lt;__kindof UILayoutGuide *&gt; *layoutGuides NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 向视图中添加布局向导 */  </span><br><span class="line">- (void)addLayoutGuide:(UILayoutGuide *)layoutGuide NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">/** 向视图中添加布局向导 */  </span><br><span class="line">- (void)removeLayoutGuide:(UILayoutGuide *)layoutGuide NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">@class NSLayoutXAxisAnchor,NSLayoutYAxisAnchor,NSLayoutDimension;  </span><br><span class="line">@interface UIView (UIViewLayoutConstraintCreation)  </span><br><span class="line">/** 布局视图的前缘框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutXAxisAnchor *leadingAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的后缘边框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutXAxisAnchor *trailingAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的左边框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutXAxisAnchor *leftAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的右边框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutXAxisAnchor *rightAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的顶边框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutYAxisAnchor *topAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的底边框的布局锚点 */  </span><br><span class="line">@property(readonly, strong) NSLayoutYAxisAnchor *bottomAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的宽度 */  </span><br><span class="line">@property(readonly, strong) NSLayoutDimension *widthAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的高度 */  </span><br><span class="line">@property(readonly, strong) NSLayoutDimension *heightAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的水平中心轴 */  </span><br><span class="line">@property(readonly, strong) NSLayoutXAxisAnchor *centerXAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 布局视图的垂直中心轴 */  </span><br><span class="line">@property(readonly, strong) NSLayoutYAxisAnchor *centerYAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 一个代表对视图中的文本的最高线基线布置锚 */  </span><br><span class="line">@property(readonly, strong) NSLayoutYAxisAnchor *firstBaselineAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">/** 一个代表对视图中的文本的最低线基线布置锚 */  </span><br><span class="line">@property(readonly, strong) NSLayoutYAxisAnchor *lastBaselineAnchor NS_AVAILABLE_IOS(9_0);  </span><br><span class="line">  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">// UIView 范畴类，UIView 布局调试   </span><br><span class="line">@interface UIView (UIConstraintBasedLayoutDebugging)  </span><br><span class="line">  </span><br><span class="line">/** 获得实体在不同方向上所有的布局约束 */  </span><br><span class="line">- (NSArray&lt;__kindof NSLayoutConstraint *&gt; *)constraintsAffectingLayoutForAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">  </span><br><span class="line">/** 可以知道当前视图的布局是否会有歧义 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(nonatomic, readonly) BOOL hasAmbiguousLayout NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#else  </span><br><span class="line">- (BOOL)hasAmbiguousLayout NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">#endif  </span><br><span class="line">  </span><br><span class="line">/** 这个方法会随机改变视图的layout到另外一个有效的layout。这样我们就可以很清楚的看到哪一个layout导致了整体的布局约束出现了错误，或者我们应该增加更多的布局约束 */  </span><br><span class="line">- (void)exerciseAmbiguityInLayout NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">/** 约束调试，只在DEBUG环境下被调用 */  </span><br><span class="line">@interface UILayoutGuide (UIConstraintBasedLayoutDebugging)  </span><br><span class="line">  </span><br><span class="line">/** 获得实体在不同方向上所有的布局约束 */  </span><br><span class="line">- (NSArray&lt;__kindof NSLayoutConstraint *&gt; *)constraintsAffectingLayoutForAxis:(UILayoutConstraintAxis)axis NS_AVAILABLE_IOS(10_0);  </span><br><span class="line">  </span><br><span class="line">/** 可以知道当前视图的布局是否会有歧义 */  </span><br><span class="line">#if UIKIT_DEFINE_AS_PROPERTIES  </span><br><span class="line">@property(nonatomic, readonly) BOOL hasAmbiguousLayout NS_AVAILABLE_IOS(10_0);  </span><br><span class="line">#else  </span><br><span class="line">- (BOOL)hasAmbiguousLayout NS_AVAILABLE_IOS(10_0);  </span><br><span class="line">#endif  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------</span><br><span class="line">#pragma mark - View状态保存恢复  </span><br><span class="line">@interface UIView (UIStateRestoration)  </span><br><span class="line">/** 标示是否支持保存,恢复视图状态信息 */  </span><br><span class="line">@property (nullable, nonatomic, copy) NSString *restorationIdentifier NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 保存视图状态相关的信息 */  </span><br><span class="line">- (void) encodeRestorableStateWithCoder:(NSCoder *)coder NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">/** 恢复和保持视图状态相关信息 */  </span><br><span class="line">- (void) decodeRestorableStateWithCoder:(NSCoder *)coder NS_AVAILABLE_IOS(6_0);  </span><br><span class="line">@end  </span><br><span class="line"></span><br><span class="line">// 📌----------------------------------------------------------------------------  </span><br><span class="line">#pragma mark - View快照  </span><br><span class="line">@interface UIView (UISnapshotting)  </span><br><span class="line">/** 将当前显示的view截取成一个新的view */  </span><br><span class="line">- (nullable UIView *)snapshotViewAfterScreenUpdates:(BOOL)afterUpdates NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">/** 缩放一个view默认是从中心点进行缩放的 */  </span><br><span class="line">- (nullable UIView *)resizableSnapshotViewFromRect:(CGRect)rect afterScreenUpdates:(BOOL)afterUpdates withCapInsets:(UIEdgeInsets)capInsets NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">/** 屏幕快照 */  </span><br><span class="line">- (BOOL)drawViewHierarchyInRect:(CGRect)rect afterScreenUpdates:(BOOL)afterUpdates NS_AVAILABLE_IOS(7_0);  </span><br><span class="line">@end  </span><br><span class="line">  </span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://zsisme.gitbooks.io/ios-/" target="_blank" rel="noopener">iOS Core Animation: Advanced Techniques中文译本</a></li>
<li><a href="http://blog.wangtuyao.com/post/2015/12/10/ios-animation-tutorial-1.html" target="_blank" rel="noopener">iOS动画教程（1）—王土垚的博客</a></li>
<li><a href="http://blog.wangtuyao.com/post/2015/12/19/ios-animation-tutorial-2.html" target="_blank" rel="noopener">iOS动画教程（2）—王土垚的博客</a></li>
<li><a href="http://blog.csdn.net/zeng_zhiming/article/details/73469182" target="_blank" rel="noopener">ios开发 之 UIView详解</a></li>
<li><a href="http://www.jianshu.com/p/8c1c1697c0ce" target="_blank" rel="noopener">iOS开发基础知识：Core Animation(核心动画)</a></li>
<li><a href="http://bihongbo.com/2016/01/03/memoryGhostdrawRect/" target="_blank" rel="noopener">内存恶鬼drawRect</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/13/天天品尝iOS7甜点 Day11：UIView Key-frame Animations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/13/天天品尝iOS7甜点 Day11：UIView Key-frame Animations/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day11：UIView Key-frame Animations</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-13 11:12:00" itemprop="dateCreated datePublished" datetime="2017-09-13T11:12:00+08:00">2017-09-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:07:45" itemprop="dateModified" datetime="2019-04-17T14:07:45+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/13/天天品尝iOS7甜点 Day11：UIView Key-frame Animations/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day11：UIView Key-frame Animations">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>视图关键帧动画</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/13/ios7-day-by-day-day11-uiview-key-frame-animations/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 11 :: UIView Key-frame Animations</a></li>
</ul>
<h3 id="2个方法"><a href="#2个方法" class="headerlink" title="2个方法"></a>2个方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@interface UIView (UIViewKeyframeAnimations)</span><br><span class="line"></span><br><span class="line">// 关键帧动画方法</span><br><span class="line">+ (void)animateKeyframesWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewKeyframeAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(7_0);</span><br><span class="line"></span><br><span class="line">// 内部块方法</span><br><span class="line">+ (void)addKeyframeWithRelativeStartTime:(double)frameStartTime relativeDuration:(double)frameDuration animations:(void (^)(void))animations NS_AVAILABLE_IOS(7_0); // start time and duration are values between 0.0 and 1.0 specifying time and duration relative to the overall time of the keyframe animation</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="UIViewKeyframeAnimationOptions-部分选项参数"><a href="#UIViewKeyframeAnimationOptions-部分选项参数" class="headerlink" title="UIViewKeyframeAnimationOptions 部分选项参数"></a>UIViewKeyframeAnimationOptions 部分选项参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UIViewKeyframeAnimationOptionCalculationModeLinear     = 0 &lt;&lt; 10, // 线性动画，默认</span><br><span class="line">UIViewKeyframeAnimationOptionCalculationModeDiscrete   = 1 &lt;&lt; 10, // 分离动画</span><br><span class="line">UIViewKeyframeAnimationOptionCalculationModePaced      = 2 &lt;&lt; 10, // 进度动画</span><br><span class="line">UIViewKeyframeAnimationOptionCalculationModeCubic      = 3 &lt;&lt; 10, // 立体动画</span><br><span class="line">UIViewKeyframeAnimationOptionCalculationModeCubicPaced = 4 &lt;&lt; 10  // 立体+进度动画</span><br></pre></td></tr></table></figure>
<h4 id="不同选项的行为示意图"><a href="#不同选项的行为示意图" class="headerlink" title="不同选项的行为示意图"></a>不同选项的行为示意图</h4><p>水平轴代表了动画的时长，而竖直轴代表动画的参数(可以是视图的透明度，宽度)。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-37db268084e27c83.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="Rainbow-Changer-彩虹变色器"><a href="#Rainbow-Changer-彩虹变色器" class="headerlink" title="Rainbow Changer - 彩虹变色器"></a>Rainbow Changer - 彩虹变色器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// 彩虹变色器方法</span><br><span class="line">- (IBAction)handleRainbow:(id)sender &#123;</span><br><span class="line">    [self enableToolbarItems:NO];</span><br><span class="line">    </span><br><span class="line">    // 执行动画的 block</span><br><span class="line">    void (^animationBlock)() = ^&#123;</span><br><span class="line">        NSArray *rainbowColors = @[[UIColor orangeColor],</span><br><span class="line">                                   [UIColor yellowColor],</span><br><span class="line">                                   [UIColor greenColor],</span><br><span class="line">                                   [UIColor blueColor],</span><br><span class="line">                                   [UIColor purpleColor],</span><br><span class="line">                                   [UIColor redColor]];</span><br><span class="line">        </span><br><span class="line">        NSUInteger colorCount = [rainbowColors count];</span><br><span class="line">        for (NSUInteger i=0; i&lt;colorCount; i++) &#123;</span><br><span class="line">            // ❇️ 内部块方法，指定每一帧动画的相对起始时间、相对持续时间</span><br><span class="line">            [UIView addKeyframeWithRelativeStartTime:i/(CGFloat)colorCount</span><br><span class="line">                                    relativeDuration:1/(CGFloat)colorCount</span><br><span class="line">                                          animations:^&#123;</span><br><span class="line">                                              self.rainbowView.backgroundColor = rainbowColors[i];</span><br><span class="line">                                          &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    // ❇️ 关键帧动画方法</span><br><span class="line">    [UIView animateKeyframesWithDuration:4.0</span><br><span class="line">                                   delay:0.0</span><br><span class="line">                                 options:UIViewKeyframeAnimationOptionCalculationModeLinear | UIViewAnimationCurveLinear //线性、曲线</span><br><span class="line">                              animations:animationBlock</span><br><span class="line">                              completion:^(BOOL finished) &#123;</span><br><span class="line">                                  [self enableToolbarItems:YES];</span><br><span class="line">                              &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Private</span><br><span class="line"></span><br><span class="line">- (void)enableToolbarItems:(BOOL)enabled &#123;</span><br><span class="line">    for (UIBarButtonItem *item in self.toolbar.items) &#123;</span><br><span class="line">        item.enabled = enabled;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ac63a9580d17f4d8.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="Rotation-Directions-旋转方向"><a href="#Rotation-Directions-旋转方向" class="headerlink" title="Rotation Directions - 旋转方向"></a>Rotation Directions - 旋转方向</h3><h4 id="1-顺时针旋转"><a href="#1-顺时针旋转" class="headerlink" title="1. 顺时针旋转"></a>1. 顺时针旋转</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)handleRotateCW:(id)sender &#123;</span><br><span class="line">    [self enableToolbarItems:NO];</span><br><span class="line">    [UIView animateKeyframesWithDuration:2.0</span><br><span class="line">                                   delay:0.0</span><br><span class="line">                                 options:UIViewKeyframeAnimationOptionCalculationModeLinear</span><br><span class="line">                              animations:^&#123;</span><br><span class="line">          // 0 ~ 2π/3</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:0.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(2.0 * M_PI / 3.0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">          // 2π/3 ~ 4π/3</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:1/3.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(4.0 * M_PI / 3.0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">          // 4π/3 ~ 0</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:2/3.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">                              &#125;</span><br><span class="line">                              completion:^(BOOL finished) &#123;</span><br><span class="line">                                  [self enableToolbarItems:YES];</span><br><span class="line">                              &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-2e30d3f2c8cb81a0.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="2-逆时针旋转"><a href="#2-逆时针旋转" class="headerlink" title="2. 逆时针旋转"></a>2. 逆时针旋转</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)handleRotateCCW:(id)sender &#123;</span><br><span class="line">    [self enableToolbarItems:NO];</span><br><span class="line">    [UIView animateKeyframesWithDuration:2.0</span><br><span class="line">                                   delay:0.0</span><br><span class="line">                                 options:UIViewKeyframeAnimationOptionCalculationModeLinear</span><br><span class="line">                              animations:^&#123;</span><br><span class="line">          // 0 ~ 4π/3</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:0.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(4.0 * M_PI / 3.0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">          // 4π/3 ~ 2π/3</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:1/3.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(2.0 * M_PI / 3.0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">          // 2π/3 ~ 0</span><br><span class="line">          [UIView addKeyframeWithRelativeStartTime:2/3.0</span><br><span class="line">                                  relativeDuration:1/3.0</span><br><span class="line">                                        animations:^&#123;</span><br><span class="line">                                            self.rotatingImageView.transform = CGAffineTransformMakeRotation(0);</span><br><span class="line">                                        &#125;];</span><br><span class="line">                              &#125;</span><br><span class="line">                              completion:^(BOOL finished) &#123;</span><br><span class="line">                                  [self enableToolbarItems:YES];</span><br><span class="line">                              &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-c8c72779a633aaa9.gif?imageMogr2/auto-orient/strip" alt></p>
<hr>
<p>The End.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/12/天天品尝iOS7甜点 Day10：Custom UIViewController Transitions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/12/天天品尝iOS7甜点 Day10：Custom UIViewController Transitions/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day10：Custom UIViewController Transitions</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-12 17:42:00" itemprop="dateCreated datePublished" datetime="2017-09-12T17:42:00+08:00">2017-09-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:25:50" itemprop="dateModified" datetime="2019-04-17T14:25:50+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/12/天天品尝iOS7甜点 Day10：Custom UIViewController Transitions/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day10：Custom UIViewController Transitions">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>自定义视图控制器转场</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/12/ios7-day-by-day-day10-custom-uiviewcontroller-transitions/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 10 :: Custom UIViewController Transitions</a></li>
</ul>
<h3 id="转场效果"><a href="#转场效果" class="headerlink" title="转场效果"></a>转场效果</h3><p>默认的 <strong>UINavigationController</strong> 转场 push/pop 是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-7ae4510fe6bab92b.gif?imageMogr2/auto-orient/strip" alt></p>
<p>现在我们要实现自定义实现视图控制器转场效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-21ea04ffcb2db9c4.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="视图层次结构"><a href="#视图层次结构" class="headerlink" title="视图层次结构"></a>视图层次结构</h3><p>视图层次结构很简单：一个 UINavigationController 作为窗口的根视图控制器、而首页是 UINavigationController 的根视图控制器、首页可以 push 到第二页：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-26712bd54b654430.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="要想实现自定义视图控制器转场效果，需要实现-UINavigationControllerDelegate-协议。"><a href="#要想实现自定义视图控制器转场效果，需要实现-UINavigationControllerDelegate-协议。" class="headerlink" title="要想实现自定义视图控制器转场效果，需要实现 UINavigationControllerDelegate 协议。"></a>要想实现自定义视图控制器转场效果，需要实现 <code>UINavigationControllerDelegate</code> 协议。</h4><p>在 <strong>UINavigationController</strong> 实例对象中声明某个类（<code>HQLNavControllerDelegate</code>）实现了<code>UINavigationControllerDelegate</code> 协议：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;HQLNavigationController.h&quot;</span><br><span class="line">#import &quot;HQLNavControllerDelegate.h&quot;</span><br><span class="line"></span><br><span class="line">@interface HQLNavigationController () &#123;</span><br><span class="line">    id&lt;UINavigationControllerDelegate&gt; _navDelegate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation HQLNavigationController</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithCoder:(NSCoder *)aDecoder &#123;</span><br><span class="line">    self = [super initWithCoder:aDecoder];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        _navDelegate = [HQLNavControllerDelegate new];</span><br><span class="line">        self.delegate = _navDelegate;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="上面代码中把实现转场效果的协议方法封装成了一个类HQLNavControllerDelegate："><a href="#上面代码中把实现转场效果的协议方法封装成了一个类HQLNavControllerDelegate：" class="headerlink" title="上面代码中把实现转场效果的协议方法封装成了一个类HQLNavControllerDelegate："></a>上面代码中把实现转场效果的协议方法封装成了一个类<code>HQLNavControllerDelegate</code>：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// ****************************************************</span><br><span class="line">//  HQLNavControllerDelegate.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface HQLNavControllerDelegate : NSObject &lt;UINavigationControllerDelegate&gt;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ****************************************************</span><br><span class="line">//  HQLNavControllerDelegate.m</span><br><span class="line">#import &quot;HQLNavControllerDelegate.h&quot;</span><br><span class="line">#import &quot;HQLFadeTransition.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation HQLNavControllerDelegate</span><br><span class="line"></span><br><span class="line">- (nullable id &lt;UIViewControllerAnimatedTransitioning&gt;)navigationController:(UINavigationController *)navigationController</span><br><span class="line">                                            animationControllerForOperation:(UINavigationControllerOperation)operation</span><br><span class="line">                                                         fromViewController:(UIViewController *)fromVC</span><br><span class="line">                                                           toViewController:(UIViewController *)toVC&#123;</span><br><span class="line">    return [HQLFadeTransition new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h4 id="而在-HQLNavControllerDelegate-类中又把实现自定义转场效果的转场动画封装成了一个类-HQLFadeTransition"><a href="#而在-HQLNavControllerDelegate-类中又把实现自定义转场效果的转场动画封装成了一个类-HQLFadeTransition" class="headerlink" title="而在 HQLNavControllerDelegate 类中又把实现自定义转场效果的转场动画封装成了一个类 HQLFadeTransition"></a>而在 <code>HQLNavControllerDelegate</code> 类中又把实现自定义转场效果的转场动画封装成了一个类 <code>HQLFadeTransition</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">// ****************************************************</span><br><span class="line">//  HQLFadeTransition.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface HQLFadeTransition : NSObject &lt;UIViewControllerAnimatedTransitioning&gt;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">// ****************************************************</span><br><span class="line">//  HQLFadeTransition.m</span><br><span class="line">#import &quot;HQLFadeTransition.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation HQLFadeTransition</span><br><span class="line"></span><br><span class="line">// @required 方法：返回动画的时长</span><br><span class="line">- (NSTimeInterval)transitionDuration:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123;</span><br><span class="line">    return 2.0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// @required 方法：实现视图控制器之间的转场效果</span><br><span class="line">- (void)animateTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123;</span><br><span class="line">    </span><br><span class="line">    // 1️⃣ viewControllerForKey:获取与转场相关的两个视图控制器</span><br><span class="line">    // UITransitionContextFromViewControllerKey</span><br><span class="line">    UIViewController *fromVC = [transitionContext viewControllerForKey:UITransitionContextFromViewControllerKey];</span><br><span class="line">    // UITransitionContextToViewControllerKey</span><br><span class="line">    UIViewController *toVC = [transitionContext viewControllerForKey:UITransitionContextToViewControllerKey];</span><br><span class="line">    </span><br><span class="line">    // 2️⃣ containerView - 动画发生的容器视图</span><br><span class="line">    UIView *containerView = [transitionContext containerView];</span><br><span class="line">    </span><br><span class="line">    // 3️⃣ 将两个视图控制器的子视图添加到容器视图</span><br><span class="line">    [containerView addSubview:fromVC.view];</span><br><span class="line">    [containerView addSubview:toVC.view];</span><br><span class="line">    // 4️⃣ 将要转换到的那个视图设置为透明</span><br><span class="line">    toVC.view.alpha = 0.0;</span><br><span class="line">    </span><br><span class="line">    // 5️⃣ 执行动画</span><br><span class="line">    [UIView animateWithDuration:[self transitionDuration:transitionContext]</span><br><span class="line">                          delay:0</span><br><span class="line">                        options:0</span><br><span class="line">                     animations:^&#123;</span><br><span class="line">                         // 动画效果</span><br><span class="line">                         toVC.view.alpha = 1.f;</span><br><span class="line">                     &#125;</span><br><span class="line">                     completion:^(BOOL finished) &#123;</span><br><span class="line">                         // 移除旧视图控制器视图</span><br><span class="line">                         [fromVC.view removeFromSuperview];</span><br><span class="line">                         // 告诉 transitionContext 上下文，动画完成啦!</span><br><span class="line">                         [transitionContext completeTransition:YES];</span><br><span class="line">                     &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 转换完成后调用</span><br><span class="line">- (void)animationEnded:(BOOL) transitionCompleted &#123;</span><br><span class="line">    NSLog(@&quot;Transition Completed!&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>The end.</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/12/天天品尝iOS7甜点 Day9：Device Identification/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/12/天天品尝iOS7甜点 Day9：Device Identification/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day9：Device Identification</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-12 10:24:00" itemprop="dateCreated datePublished" datetime="2017-09-12T10:24:00+08:00">2017-09-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:26:32" itemprop="dateModified" datetime="2019-04-17T14:26:32+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/12/天天品尝iOS7甜点 Day9：Device Identification/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day9：Device Identification">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/10/ios7-day-by-day-day9-device-identification/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 9 :: Device Identification</a></li>
</ul>
<h3 id="Vendor-Identification"><a href="#Vendor-Identification" class="headerlink" title="Vendor Identification"></a>Vendor Identification</h3><p><code>UIDevice</code>中的<code>identifierForVendor</code>方法是最接近替代<code>uniqueIdentifier</code>的另外一个方法，它返回<code>NSUUID</code>。在相同的设备中相同供应商的app共享一个UUID。不同的供应商在同一个设备上面将会返回不同的<code>identifierForVendor</code>值，就像相同供应商在不同设备上面一样。</p>
<p>对于开发者来说，这个值提供了和原来相似的功能，而且没有用户隐私的问题。</p>
<p>但是美中不足的是<strong>如果用卸载了供应商下面所有的app，这个id就会被销毁，重新安装之后就会生成一个新的供应商ID。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *identifeir = [[[UIDevice currentDevice] identifierForVendor] UUIDString];</span><br></pre></td></tr></table></figure>
<h3 id="Advertising-Identification"><a href="#Advertising-Identification" class="headerlink" title="Advertising Identification"></a>Advertising Identification</h3><p><code>ADSupprt</code>模块包含了<code>ASIdentifierManager</code>类，它有一个<code>advertisingIdentifier</code>方法。它返回一个<code>NSUUID</code>可以用来达到追踪广告的目的。</p>
<p>还有一个方法<code>avertisingTrackingEnable</code>.它返回一个BOOL类型的数据用来指定是否用户允许进行广告追踪。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@import AdSupport;</span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">NSString *identifier = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];</span><br><span class="line"></span><br><span class="line">NSString *isEnabled = [[ASIdentifierManager sharedManager] isAdvertisingTrackingEnabled] ? @&quot;YES&quot; : @&quot;NO&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="Network-Identification"><a href="#Network-Identification" class="headerlink" title="Network Identification"></a>Network Identification</h3><p>当 <code>uniqueIdentifier</code> 被弃用了，通过使用MAC地址变得很流行。一个MAC地址是恒定不变的且唯一的，可以用来跟踪用户。但是在iOS7中Apple对这个也添加了限制，所以实际返回的MAC地址为: 02:00:00:00:00:00. 关闭这个“漏洞”，将会推动开发者运用Apple提供的优先方法来进行获得设备标识.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys/socket.h&gt;</span><br><span class="line">#include &lt;sys/sysctl.h&gt;</span><br><span class="line">#include &lt;net/if.h&gt;</span><br><span class="line">#include &lt;net/if_dl.h&gt;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">- (NSString *)getMacAddress &#123;</span><br><span class="line">    int                 mgmtInfoBase[6];</span><br><span class="line">    char                *msgBuffer = NULL;</span><br><span class="line">    NSString            *errorFlag = NULL;</span><br><span class="line">    size_t              length;</span><br><span class="line">    </span><br><span class="line">    // Setup the management Information Base (mib)</span><br><span class="line">    mgmtInfoBase[0] = CTL_NET;        // Request network subsystem</span><br><span class="line">    mgmtInfoBase[1] = AF_ROUTE;       // Routing table info</span><br><span class="line">    mgmtInfoBase[2] = 0;</span><br><span class="line">    mgmtInfoBase[3] = AF_LINK;        // Request link layer information</span><br><span class="line">    mgmtInfoBase[4] = NET_RT_IFLIST;  // Request all configured interfaces</span><br><span class="line">    </span><br><span class="line">    // With all configured interfaces requested, get handle index</span><br><span class="line">    if ((mgmtInfoBase[5] = if_nametoindex(&quot;en0&quot;)) == 0)</span><br><span class="line">        errorFlag = @&quot;if_nametoindex failure&quot;;</span><br><span class="line">    // Get the size of the data available (store in len)</span><br><span class="line">    else if (sysctl(mgmtInfoBase, 6, NULL, &amp;length, NULL, 0) &lt; 0)</span><br><span class="line">        errorFlag = @&quot;sysctl mgmtInfoBase failure&quot;;</span><br><span class="line">    // Alloc memory based on above call</span><br><span class="line">    else if ((msgBuffer = malloc(length)) == NULL)</span><br><span class="line">        errorFlag = @&quot;buffer allocation failure&quot;;</span><br><span class="line">    // Get system information, store in buffer</span><br><span class="line">    else if (sysctl(mgmtInfoBase, 6, msgBuffer, &amp;length, NULL, 0) &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        free(msgBuffer);</span><br><span class="line">        errorFlag = @&quot;sysctl msgBuffer failure&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        // Map msgbuffer to interface message structure</span><br><span class="line">        struct if_msghdr *interfaceMsgStruct = (struct if_msghdr *) msgBuffer;</span><br><span class="line">        </span><br><span class="line">        // Map to link-level socket structure</span><br><span class="line">        struct sockaddr_dl *socketStruct = (struct sockaddr_dl *) (interfaceMsgStruct + 1);</span><br><span class="line">        </span><br><span class="line">        // Copy link layer address data in socket structure to an array</span><br><span class="line">        unsigned char macAddress[6];</span><br><span class="line">        memcpy(&amp;macAddress, socketStruct-&gt;sdl_data + socketStruct-&gt;sdl_nlen, 6);</span><br><span class="line">        </span><br><span class="line">        // Read from char array into a string object, into traditional Mac address format</span><br><span class="line">        NSString *macAddressString = [NSString stringWithFormat:@&quot;%02X:%02X:%02X:%02X:%02X:%02X&quot;,</span><br><span class="line">                                      macAddress[0], macAddress[1], macAddress[2], macAddress[3], macAddress[4], macAddress[5]];</span><br><span class="line">        </span><br><span class="line">        // Release the buffer memory</span><br><span class="line">        free(msgBuffer);</span><br><span class="line">        </span><br><span class="line">        return macAddressString;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return errorFlag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="关于-identity"><a href="#关于-identity" class="headerlink" title="关于 identity"></a>关于 identity</h3><p>关于 UUID （设备唯一标识符）我之前也有研究过，可以戳这里：</p>
<p><a href="http://www.jianshu.com/p/40b9f8ec1c78" target="_blank" rel="noopener">iOS—获取设备型号和App版本号等信息</a></p>
<p>得到的最终方案是： <code>UIDevice</code>中的<code>identifierForVendor</code>方法配合 keychain（钥匙串）存储标识符。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/08/天天品尝iOS7甜点 Day7：Taking Snapshots of UIViews/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/08/天天品尝iOS7甜点 Day7：Taking Snapshots of UIViews/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day7：Taking Snapshots of UIViews</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-08 17:31:00" itemprop="dateCreated datePublished" datetime="2017-09-08T17:31:00+08:00">2017-09-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:27:53" itemprop="dateModified" datetime="2019-04-17T14:27:53+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/08/天天品尝iOS7甜点 Day7：Taking Snapshots of UIViews/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day7：Taking Snapshots of UIViews">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>获取UIView对象的快照</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
</ul>
<ul>
<li><a href="http://blog.kingiol.com/2014/01/09/ios7-day-by-day-day7-taking-snapshots-of-uiviews/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 7 :: Taking Snapshots of UIViews</a></li>
</ul>
<h2 id="API方法"><a href="#API方法" class="headerlink" title="API方法"></a>API方法</h2><h3 id="UIScreen"><a href="#UIScreen" class="headerlink" title="UIScreen"></a>UIScreen</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(UIView *)</span>snapshotViewAfterScreenUpdates:<span class="params">(BOOL)</span>afterUpdates;</span><br></pre></td></tr></table></figure>
<h3 id="UIView"><a href="#UIView" class="headerlink" title="UIView"></a>UIView</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前文本的快照视图</span></span><br><span class="line"><span class="selector-tag">-</span> (UIView *)<span class="selector-tag">snapshotViewAfterScreenUpdates</span><span class="selector-pseudo">:(BOOL)afterUpdates</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给定一个可伸缩插值，返回基于当前视图的指定内容的快照视图，</span></span><br><span class="line"><span class="selector-tag">-</span> (UIView *)<span class="selector-tag">resizableSnapshotViewFromRect</span><span class="selector-pseudo">:(CGRect)rect</span> <span class="selector-tag">afterScreenUpdates</span><span class="selector-pseudo">:(BOOL)afterUpdates</span> <span class="selector-tag">withCapInsets</span><span class="selector-pseudo">:(UIEdgeInsets)capInsets</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将完整视图层次结构的快照呈现在当前上下文中。</span></span><br><span class="line"><span class="selector-tag">-</span> (BOOL)<span class="selector-tag">drawViewHierarchyInRect</span><span class="selector-pseudo">:(CGRect)rect</span> <span class="selector-tag">afterScreenUpdates</span><span class="selector-pseudo">:(BOOL)afterUpdates</span>;</span><br></pre></td></tr></table></figure>
<h2 id="Demo-示例"><a href="#Demo-示例" class="headerlink" title="Demo 示例"></a>Demo 示例</h2><h3 id="Snapshotting-for-Animation-动画快照"><a href="#Snapshotting-for-Animation-动画快照" class="headerlink" title="Snapshotting for Animation - 动画快照"></a>Snapshotting for Animation - 动画快照</h3><p><img src="http://upload-images.jianshu.io/upload_images/2648731-7b49a1cfa02d24b4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>自定义视图绘制方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 生成旋转视图</span><br><span class="line">- (void)generateRotations &#123;</span><br><span class="line">    for (CGFloat angle = 0; angle &lt; 2 * M_PI; angle += M_PI / 20.0) &#123;</span><br><span class="line">        UIView *newView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 250)];</span><br><span class="line">        newView.center = CGPointMake(CGRectGetMidX(self.bounds), CGRectGetMidY(self.bounds));</span><br><span class="line">        newView.layer.borderColor = [UIColor grayColor].CGColor;</span><br><span class="line">        newView.layer.borderWidth = 1;</span><br><span class="line">        newView.backgroundColor = [UIColor colorWithWhite:0.8 alpha:0.4];</span><br><span class="line">        newView.transform = CGAffineTransformMakeRotation(angle);</span><br><span class="line">        newView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;</span><br><span class="line">        [self addSubview:newView];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重新设置所有子视图的背景色:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)recolorSubviews:(UIColor *)newColor &#123;</span><br><span class="line">    for (UIView *subview in self.subviews) &#123;</span><br><span class="line">        subview.backgroundColor = newColor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="在动画中使用UIView快照以简化复杂的视图"><a href="#在动画中使用UIView快照以简化复杂的视图" class="headerlink" title="在动画中使用UIView快照以简化复杂的视图"></a>在动画中使用UIView快照以简化复杂的视图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line">#import &quot;HQLRotatingViews.h&quot;</span><br><span class="line"></span><br><span class="line">@interface ViewController ()</span><br><span class="line">@property (weak, nonatomic) IBOutlet UIView *containerView;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController &#123;</span><br><span class="line">    HQLRotatingViews *_complexView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // Do any additional setup after loading the view, typically from a nib.</span><br><span class="line">    [self createComplexView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Utility methods</span><br><span class="line"></span><br><span class="line">// 向容器视图中添加旋转视图</span><br><span class="line">- (void)createComplexView &#123;</span><br><span class="line">    _complexView = [[HQLRotatingViews alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    [self.containerView addSubview:_complexView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)animateViewAwayAndReset:(UIView *)view &#123;</span><br><span class="line">    [UIView animateWithDuration:2.0</span><br><span class="line">                     animations:^&#123;</span><br><span class="line">                         view.bounds = CGRectZero;</span><br><span class="line">                     &#125;</span><br><span class="line">                     completion:^(BOOL finished) &#123;</span><br><span class="line">                         // 动画完成后删除视图并创建新视图</span><br><span class="line">                         [view removeFromSuperview];</span><br><span class="line">                         [self performSelector:@selector(createComplexView)</span><br><span class="line">                                    withObject:nil</span><br><span class="line">                                    afterDelay:1];</span><br><span class="line">                     &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - IBActions</span><br><span class="line"></span><br><span class="line">/** </span><br><span class="line"> 这两个方法演示了如何在动画中使用UIView快照以简化复杂的视图</span><br><span class="line"> */</span><br><span class="line">// ❇️ Animate 按钮——直接对 UIView 进行旋转</span><br><span class="line">- (IBAction)handleAnimate:(id)sender &#123;</span><br><span class="line">    [self animateViewAwayAndReset:_complexView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ❇️ 生成当前 UIView 的快照之后，对快照进行旋转</span><br><span class="line">- (IBAction)handleSnapshot:(id)sender &#123;</span><br><span class="line">    // 创建复合视图的快照</span><br><span class="line">    UIView *snapshotView = [_complexView snapshotViewAfterScreenUpdates:NO];</span><br><span class="line">    [self.containerView addSubview:snapshotView];</span><br><span class="line">    [_complexView removeFromSuperview];</span><br><span class="line">    [self animateViewAwayAndReset:snapshotView];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例一：Animate-按钮——直接对-UIView-进行旋转"><a href="#示例一：Animate-按钮——直接对-UIView-进行旋转" class="headerlink" title="示例一：Animate 按钮——直接对 UIView 进行旋转"></a>示例一：Animate 按钮——直接对 UIView 进行旋转</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-9434f6d5613c3eeb.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="示例二：生成当前-UIView-的快照之后，对快照进行旋转"><a href="#示例二：生成当前-UIView-的快照之后，对快照进行旋转" class="headerlink" title="示例二：生成当前 UIView 的快照之后，对快照进行旋转"></a>示例二：生成当前 UIView 的快照之后，对快照进行旋转</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-d98f3ab67eb52dfd.gif?imageMogr2/auto-orient/strip" alt></p>
<p>快照方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (nullable UIView *)snapshotViewAfterScreenUpdates:(BOOL)afterUpdates;</span><br></pre></td></tr></table></figure>
<h3 id="测试快照方法中的-BOOL-参数"><a href="#测试快照方法中的-BOOL-参数" class="headerlink" title="测试快照方法中的 BOOL 参数"></a>测试快照方法中的 BOOL 参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> 这两种方法比较了是否允许屏幕更新的区别</span><br><span class="line"> - (nullable UIView *)snapshotViewAfterScreenUpdates:(BOOL)afterUpdates;</span><br><span class="line"> */</span><br><span class="line">- (IBAction)handlePreUpdateSnapshot:(id)sender &#123;</span><br><span class="line">    // 更新视图</span><br><span class="line">    [_complexView recolorSubviews:[[UIColor redColor] colorWithAlphaComponent:0.3]];</span><br><span class="line">    // 创建快照，不等待更改被应用。</span><br><span class="line">    UIView *snapshotView = [_complexView snapshotViewAfterScreenUpdates:NO];</span><br><span class="line">    [self.containerView addSubview:snapshotView];</span><br><span class="line">    [_complexView removeFromSuperview];</span><br><span class="line">    [self animateViewAwayAndReset:snapshotView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IBAction)handlePostUpdateSnapshot:(id)sender &#123;</span><br><span class="line">    // 更新视图</span><br><span class="line">    [_complexView recolorSubviews:[[UIColor redColor] colorWithAlphaComponent:0.3]];</span><br><span class="line">    // 创建快照，等待渲染完成。</span><br><span class="line">    UIView *snapshotView = [_complexView snapshotViewAfterScreenUpdates:YES];</span><br><span class="line">    [self.containerView addSubview:snapshotView];</span><br><span class="line">    [_complexView removeFromSuperview];</span><br><span class="line">    [self animateViewAwayAndReset:snapshotView];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Pre-按钮——设置为-NO"><a href="#Pre-按钮——设置为-NO" class="headerlink" title="Pre 按钮——设置为 NO"></a>Pre 按钮——设置为 NO</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-ee922968161e66d2.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="Post-按钮——设置为-YES"><a href="#Post-按钮——设置为-YES" class="headerlink" title="Post 按钮——设置为 YES"></a>Post 按钮——设置为 YES</h4><p><img src="http://upload-images.jianshu.io/upload_images/2648731-d3f6cffc78a9039e.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="生成快照图片"><a href="#生成快照图片" class="headerlink" title="生成快照图片"></a>生成快照图片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> 此方法演示了如何向UIView快照添加图像效果</span><br><span class="line"> */</span><br><span class="line">- (IBAction)handleImageSnapshot:(id)sender &#123;</span><br><span class="line">    // 创建一个图像上下文 - 复合视图的大小和缩放比例</span><br><span class="line">    UIGraphicsBeginImageContextWithOptions(_complexView.bounds.size, NO, 0.0);</span><br><span class="line">    // 将快照渲染到图像上下文中</span><br><span class="line">    [_complexView drawViewHierarchyInRect:_complexView.bounds afterScreenUpdates:NO];</span><br><span class="line">    </span><br><span class="line">    // 从图像上下文中抓取图像</span><br><span class="line">    UIImage *complexViewImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    // 结束使用图像上下文</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    </span><br><span class="line">    // 在生成快照之前让当前的视图模糊化</span><br><span class="line">    UIImageView *iv = [[UIImageView alloc] initWithImage:[self applyBlurToImage:complexViewImage]];</span><br><span class="line">    iv.center = _complexView.center;</span><br><span class="line">    [self.containerView addSubview:iv];</span><br><span class="line">    [_complexView removeFromSuperview];</span><br><span class="line">    [self performSelector:@selector(animateViewAwayAndReset:)</span><br><span class="line">               withObject:iv</span><br><span class="line">               afterDelay:1.0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 模糊化UIImage</span><br><span class="line">- (UIImage *)applyBlurToImage:(UIImage *)image &#123;</span><br><span class="line">    CIContext *context = [CIContext contextWithOptions:nil];</span><br><span class="line">    CIImage *ci_image = [CIImage imageWithCGImage:image.CGImage];</span><br><span class="line">    CIFilter *filter = [CIFilter filterWithName:@&quot;CIGaussianBlur&quot;];</span><br><span class="line">    [filter setValue:ci_image forKey:kCIInputImageKey];</span><br><span class="line">    [filter setValue:@5 forKey:kCIInputRadiusKey];</span><br><span class="line">    CIImage *result = [filter valueForKey:kCIOutputImageKey];</span><br><span class="line">    CGImageRef cgImage = [context createCGImage:result fromRect:[result extent]];</span><br><span class="line">    return [UIImage imageWithCGImage:cgImage</span><br><span class="line">                               scale:image.scale</span><br><span class="line">                         orientation:image.imageOrientation];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-d5876cc900745051.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="Limitaions-局限性"><a href="#Limitaions-局限性" class="headerlink" title="Limitaions - 局限性"></a>Limitaions - 局限性</h3><p>创建的快照必须在屏幕范围之内</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/07/天天品尝iOS7甜点 Day6：Tint Color/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/07/天天品尝iOS7甜点 Day6：Tint Color/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day6：Tint Color</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-07 16:00:00" itemprop="dateCreated datePublished" datetime="2017-09-07T16:00:00+08:00">2017-09-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 14:29:03" itemprop="dateModified" datetime="2019-04-17T14:29:03+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/07/天天品尝iOS7甜点 Day6：Tint Color/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day6：Tint Color">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>学习使用 <code>tintColor</code> 属性 </p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
</ul>
<ul>
<li><a href="http://blog.kingiol.com/2014/01/09/ios7-day-by-day-day6-tint-color/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 6 :: Tint Color</a></li>
</ul>
<h3 id="tintColor-属性"><a href="#tintColor-属性" class="headerlink" title="tintColor 属性"></a>tintColor 属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@property(null_resettable, nonatomic, strong) UIColor *tintColor NS_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>tintColor</code> 属性是 iOS 7.0 新增属性，被使用在<code>UIView</code>中以改变应用程序的外观（我的理解是，类似于给所有 UI 控件统一设置主题色效果）；</li>
<li>该属性是 <code>UIColor</code> 类型，默认为系统颜色（蓝色）；</li>
<li>它将会运用父视图层次的颜色来进行着色。可以通过设置 root view controller 的 <code>tintColor</code> 来改变系统整体的颜色。</li>
</ul>
<h3 id="特点：继承、重写、传播。"><a href="#特点：继承、重写、传播。" class="headerlink" title="特点：继承、重写、传播。"></a>特点：<strong>继承</strong>、<strong>重写</strong>、<strong>传播</strong>。</h3><blockquote>
<ul>
<li><p><strong>继承</strong>：只要一个 <strong>UIView</strong> 的 subview 没有明确指定 <code>tintColor</code>，那么这个 <strong>UIView</strong> 的 <code>tintColor</code> 就会被它的 subview 所继承！在一个 App 中，最顶层的 view 就是 window，因此，只要修改 window 的 <code>tintColor</code>，那么所有 view 的 <code>tintColor</code> 就都会跟着改变。(这种说法其实并不严谨，请耐心继续看下去^_^)。</p>
</li>
<li><p><strong>重写</strong>：如果明确指定了某个 view 的 <code>tintColor</code>， 那么这个 view 就不会继承其 superview 的 <code>tintColor</code>。而且自此, 这个 view 的 subview 的 <code>tintColor</code> 会发生改变。</p>
</li>
<li><p>传播：一个 view 的 <code>tintColor</code> 的改变会立即向下传播, 影响其所有的 subview，直至它的一个 subview 明确指定了 <code>tintColor</code> 为止。</p>
<p>——<a href="http://www.jianshu.com/p/4bcaf6349133" target="_blank" rel="noopener">UIView并没想的那么简单 - tintColor揭秘</a></p>
</li>
</ul>
</blockquote>
<h3 id="Tint-color-of-existing-iOS-controller-使用tint-color为iOS中已经存在的控件进行着色"><a href="#Tint-color-of-existing-iOS-controller-使用tint-color为iOS中已经存在的控件进行着色" class="headerlink" title="Tint color of existing iOS controller - 使用tint color为iOS中已经存在的控件进行着色"></a>Tint color of existing iOS controller - 使用tint color为iOS中已经存在的控件进行着色</h3><p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)changeColorHandle:(id)sender &#123;</span><br><span class="line">    // 生成随机色</span><br><span class="line">    CGFloat hue = ( arc4random() % 256 / 256.0 );</span><br><span class="line">    CGFloat saturation = ( arc4random() % 128 / 256.0 ) + 0.5;</span><br><span class="line">    CGFloat brightness = ( arc4random() % 128 / 256.0 ) + 0.5;</span><br><span class="line">    UIColor *color = [UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:1];</span><br><span class="line">    // 设置 tintColor</span><br><span class="line">    self.view.tintColor = color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：只要修改根视图控制器的 <code>tintColor</code> 属性，该页面下的所有 UI 控件颜色都会随之改变。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ae94855287241127.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="关于-UIProgressView"><a href="#关于-UIProgressView" class="headerlink" title="关于 UIProgressView"></a>关于 UIProgressView</h3><p>参考的文章称 <code>tintColor</code> 属性并不会影响 UIProgressView，因为其有两个描述 <code>tintColor</code> 的属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 填充进度条的颜色</span><br><span class="line">@property(nonatomic, strong, nullable) UIColor* progressTintColor;</span><br><span class="line">// 未填充进度条的颜色</span><br><span class="line">@property(nonatomic, strong, nullable) UIColor* trackTintColor;</span><br></pre></td></tr></table></figure>
<p>需要进行额外设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)updateProgressViewTint &#123;</span><br><span class="line">    self.progressView.progressTintColor = self.view.tintColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="✏️-更正"><a href="#✏️-更正" class="headerlink" title="✏️ 更正"></a>✏️ 更正</h4><p>注释以上代码后测试，结果并不是这样，UIProgressView 的 <code>progressTintColor</code> 值是会跟随 <code>tintColor</code> 的变化而变化的。</p>
<h3 id="Tint-Dimming-颜色变暗"><a href="#Tint-Dimming-颜色变暗" class="headerlink" title="Tint Dimming - 颜色变暗"></a>Tint Dimming - 颜色变暗</h3><h4 id="UIViewTintAdjustmentMode"><a href="#UIViewTintAdjustmentMode" class="headerlink" title="UIViewTintAdjustmentMode"></a>UIViewTintAdjustmentMode</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSInteger, UIViewTintAdjustmentMode) &#123;</span><br><span class="line">    UIViewTintAdjustmentModeAutomatic,</span><br><span class="line">    </span><br><span class="line">    UIViewTintAdjustmentModeNormal,</span><br><span class="line">    UIViewTintAdjustmentModeDimmed,</span><br><span class="line">&#125; NS_ENUM_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)dimTintHandle:(id)sender &#123;</span><br><span class="line">    if (self.dimTintSwitch.isOn) &#123;</span><br><span class="line">        self.view.tintAdjustmentMode = UIViewTintAdjustmentModeDimmed;</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        self.view.tintAdjustmentMode = UIViewTintAdjustmentModeNormal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：设置<code>UIViewTintAdjustmentModeDimmed</code> 属性以后，所有 UI 控件的颜色会变暗，适合沉浸式体验的场景。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-a1d0b4b0ee48936f.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="Using-tint-color-in-custom-views-给自定义视图进行着色"><a href="#Using-tint-color-in-custom-views-给自定义视图进行着色" class="headerlink" title="Using tint color in custom views - 给自定义视图进行着色"></a>Using tint color in custom views - 给自定义视图进行着色</h3><p>自定义 UIView 子类需要覆盖以下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> The -tintColorDidChange message is sent to appropriate subviews of a view when its tintColor is changed by client code or to subviews in the view hierarchy of a view whose tintColor is implicitly changed when its superview or tintAdjustmentMode changes.</span><br><span class="line"> */</span><br><span class="line">- (void)tintColorDidChange NS_AVAILABLE_IOS(7_0);</span><br></pre></td></tr></table></figure>
<p>创建一个自定义视图类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">//  ***********************************</span><br><span class="line">//  HQLCustomView.h</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line">@interface HQLCustomView : UIView</span><br><span class="line">@end</span><br><span class="line">  </span><br><span class="line">//  ***********************************</span><br><span class="line">//  HQLCustomView.m</span><br><span class="line">#import &quot;HQLCustomView.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation HQLCustomView &#123;</span><br><span class="line">    UIView *_tintColorBlock;</span><br><span class="line">    UILabel *_greyLabel;</span><br><span class="line">    UILabel *_tintColorLabel;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (id)initWithCoder:(NSCoder *)aDecoder &#123;</span><br><span class="line">    self = [super initWithCoder:aDecoder];</span><br><span class="line">    if (!self) &#123;</span><br><span class="line">        return nil;</span><br><span class="line">    &#125;</span><br><span class="line">    self.backgroundColor = [UIColor clearColor];</span><br><span class="line">    [self prepareSubviews];</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)prepareSubviews &#123;</span><br><span class="line">    _tintColorBlock = [[UIView alloc] init];</span><br><span class="line">    _tintColorBlock.backgroundColor = self.tintColor;</span><br><span class="line">    [self addSubview:_tintColorBlock];</span><br><span class="line">    </span><br><span class="line">    _greyLabel = [UILabel new];</span><br><span class="line">    _greyLabel.text = @&quot;Grey Label&quot;;</span><br><span class="line">    _greyLabel.textColor = [UIColor grayColor];</span><br><span class="line">    [_greyLabel sizeToFit];</span><br><span class="line">    [self addSubview:_greyLabel];</span><br><span class="line">    </span><br><span class="line">    _tintColorLabel = [UILabel new];</span><br><span class="line">    _tintColorLabel.text = @&quot;Tint Color Label&quot;;</span><br><span class="line">    _tintColorLabel.textColor = self.tintColor;</span><br><span class="line">    [_tintColorLabel sizeToFit];</span><br><span class="line">    [self addSubview:_tintColorLabel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)layoutSubviews &#123;</span><br><span class="line">    _tintColorBlock.frame = CGRectMake(0, 0, CGRectGetWidth(self.bounds) / 3, CGRectGetHeight(self.bounds));</span><br><span class="line">    </span><br><span class="line">    CGRect frame = _greyLabel.frame;</span><br><span class="line">    frame.origin.x = CGRectGetWidth(self.bounds) / 3 + 10;</span><br><span class="line">    frame.origin.y = 0;</span><br><span class="line">    _greyLabel.frame = frame;</span><br><span class="line">    </span><br><span class="line">    frame = _tintColorLabel.frame;</span><br><span class="line">    frame.origin.x = CGRectGetWidth(self.bounds) / 3 + 10;</span><br><span class="line">    frame.origin.y = CGRectGetHeight(self.bounds) / 2;</span><br><span class="line">    _tintColorLabel.frame = frame;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 当tintColor或者tintAdjustmentMode属性发生变化时调用</span><br><span class="line">- (void)tintColorDidChange &#123;</span><br><span class="line">    _tintColorBlock.backgroundColor = self.tintColor;</span><br><span class="line">    _tintColorLabel.textColor = self.tintColor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-6174f42818ec8b61.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="Tinting-images-with-tintColor-给图像着色"><a href="#Tinting-images-with-tintColor-给图像着色" class="headerlink" title="Tinting images with tintColor - 给图像着色"></a>Tinting images with tintColor - 给图像着色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 加载图片</span><br><span class="line">UIImage *gitHubImg = [UIImage imageNamed:@&quot;gitHub&quot;];</span><br><span class="line">// 设置图片渲染模式</span><br><span class="line">gitHubImg = [gitHubImg imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate];</span><br><span class="line">// 添加到视图</span><br><span class="line">self.tintedImageView.image = gitHubImg;</span><br><span class="line">self.tintedImageView.contentMode = UIViewContentModeScaleAspectFit;</span><br></pre></td></tr></table></figure>
<p>原图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-6d989755b29f8caa.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>实际效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-fc6008938b1e272f.gif?imageMogr2/auto-orient/strip" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/05/Mac 截屏应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/05/Mac 截屏应用/" class="post-title-link" itemprop="url">Mac 截屏应用</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-05 11:00:00" itemprop="dateCreated datePublished" datetime="2017-09-05T11:00:00+08:00">2017-09-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-16 15:35:08" itemprop="dateModified" datetime="2019-04-16T15:35:08+08:00">2019-04-16</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/开发工具-Mac应用/" itemprop="url" rel="index"><span itemprop="name">开发工具&Mac应用</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/05/Mac 截屏应用/" class="leancloud_visitors" data-flag-title="Mac 截屏应用">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="系统截屏"><a href="#系统截屏" class="headerlink" title="系统截屏"></a>系统截屏</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-5b36aee64aa0fbfd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<hr>
<h2 id="Snappy"><a href="#Snappy" class="headerlink" title="Snappy"></a>Snappy</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-b8c96ffdd9bbe277.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li><a href="http://snappy-app.com" target="_blank" rel="noopener">Snappy 官网</a></li>
<li><a href="http://www.ifanr.com/app/891044" target="_blank" rel="noopener">Snappy：满足你 99% 截图需求的电脑工具，比系统自带更好用 #macOS</a></li>
</ul>
<hr>
<h2 id="Snip"><a href="#Snip" class="headerlink" title="Snip"></a>Snip</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-923eac130193a7a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li><a href="http://snip.qq.com" target="_blank" rel="noopener">Tencent ：Snip</a></li>
</ul>
<hr>
<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-381e036cbea68c38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<ul>
<li><a href="http://jietu.qq.com" target="_blank" rel="noopener">Tencent：截图</a></li>
<li><a href="https://appso.gitbooks.io/macos/content/xi-tong-zeng-qiang-app/qing-liang-3001-qiang-da-de-mian-fei-jie-tu-biao-zhu-ruan-jian-ff0c-huan-bu-kuai-shou-le-ff1f.html" target="_blank" rel="noopener">轻量、强大的免费截图标注软件</a></li>
</ul>
<hr>
<p>另外，Mac 版的 QQ 和 微信 也自带截图功能，而且上面两款腾讯出品的截图应用其实就是从QQ中单独提取出来的。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/09/04/天天品尝iOS7甜点 Day3：Background Fetch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/09/04/天天品尝iOS7甜点 Day3：Background Fetch/" class="post-title-link" itemprop="url">天天品尝iOS7甜点 Day3：Background Fetch</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-09-04 10:03:00" itemprop="dateCreated datePublished" datetime="2017-09-04T10:03:00+08:00">2017-09-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 15:11:46" itemprop="dateModified" datetime="2019-04-17T15:11:46+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/09/04/天天品尝iOS7甜点 Day3：Background Fetch/" class="leancloud_visitors" data-flag-title="天天品尝iOS7甜点 Day3：Background Fetch">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>后台提取特性：iOS 可以根据 App 的使用情况自动更新内容，不管app是否正在运行。</p>
</blockquote>
<p>后台提取功能可以让你的程序用户体验效果更加的好，如果你的应用是基于互联网数据更新，那么这非常简单的方法，让应用程序时刻获得最新的信息。</p>
<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ul>
<li><a href="https://github.com/ShinobiControls/iOS7-day-by-day" target="_blank" rel="noopener">GitHub 源码：shinobicontrols/iOS7-day-by-day</a></li>
<li><a href="http://blog.kingiol.com/2014/01/06/ios7-day-by-day-day1-nsurlsession/" target="_blank" rel="noopener">天天品尝iOS7甜点 :: Day 1 :: NSURLSession</a></li>
</ul>
<h3 id="Enabling-background-fetch-开启后台提取功能"><a href="#Enabling-background-fetch-开启后台提取功能" class="headerlink" title="Enabling background fetch - 开启后台提取功能"></a>Enabling background fetch - 开启后台提取功能</h3><p><img src="http://upload-images.jianshu.io/upload_images/2648731-a0ae905e1631ed12.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="指定后台提取功能运行的频率"><a href="#指定后台提取功能运行的频率" class="headerlink" title="指定后台提取功能运行的频率"></a>指定后台提取功能运行的频率</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    // 指定后台提取功能运行的频率</span><br><span class="line">    [[UIApplication sharedApplication] setMinimumBackgroundFetchInterval:UIApplicationBackgroundFetchIntervalMinimum];</span><br><span class="line">    </span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="后台提取功能需要实现的代理协议"><a href="#后台提取功能需要实现的代理协议" class="headerlink" title="后台提取功能需要实现的代理协议"></a>后台提取功能需要实现的代理协议</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// application:performFetchWithCompletionHandler:</span><br><span class="line">- (void)application:(UIApplication *)application performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler</span><br><span class="line">&#123;</span><br><span class="line">    // 得到要更新的视图控制器</span><br><span class="line">    SCViewController *vc = (SCViewController *)self.window.rootViewController;</span><br><span class="line">    // Insert status updates and pass in the completion handler block</span><br><span class="line">    // 更新状态，并回传更新完成后的处理程序</span><br><span class="line">    NSUInteger numberInserted = [vc insertStatusObjectsForFetchWithCompletionHandler:completionHandler];</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 分 iOS 版本，设置 applicationIconBadgeNumber</span><br><span class="line">    float version = [[[UIDevice currentDevice] systemVersion] floatValue];</span><br><span class="line">    </span><br><span class="line">    if (version &gt;= 8.0) &#123;</span><br><span class="line">        UIUserNotificationSettings *settings = [UIUserNotificationSettings settingsForTypes:UIUserNotificationTypeBadge categories:nil];</span><br><span class="line">        // 注册用户通知：</span><br><span class="line">        [[UIApplication sharedApplication] registerUserNotificationSettings:settings];</span><br><span class="line">        // 注册消息推送：</span><br><span class="line">        [application registerForRemoteNotifications];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 应用程序右上角数字</span><br><span class="line">    [UIApplication sharedApplication].applicationIconBadgeNumber += numberInserted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Testing-测试"><a href="#Testing-测试" class="headerlink" title="Testing - 测试"></a>Testing - 测试</h3><p>需要测试两种情况：</p>
<ol>
<li>App currently runing in background - app当前在后台运行</li>
<li>App currently in terminated state - app当前已经终止进程</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/14/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/16/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg" alt="独木舟的木">
            
              <p class="site-author-name" itemprop="name">独木舟的木</p>
              <div class="site-description motion-element" itemprop="description">有时候阳光很好 有时候阳光很暗</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">311</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">74</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Andy0570" title="GitHub &rarr; https://github.com/Andy0570" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:andywhm@163.com" title="E-Mail &rarr; mailto:andywhm@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">独木舟的木</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  



  
    
    
      
    
  
  <script color="17,119,176" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>













  
  <script src="//cdn.jsdelivr.net/npm/jquery@2/dist/jquery.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  
  
  
    
  

  
    
      
    
  

  
  
  
    <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
    <script>
      
        window.addEventListener('load', () => {
      
        quicklink({
          timeout: 3000,
          priority: true,
          ignores: [uri => uri.includes('#'),uri => uri == 'https://andy0570.com/page/15/',]
        });
      
        });
      
    </script>
  


  



  



  
  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">

  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.js"></script>
  

  <script src="/js/algolia-search.js?v=7.1.0"></script>



  
  
  <script>
    
    function showTime(Counter) {
      var entries = [];
      var $visitors = $('.leancloud_visitors');

      $visitors.each(function() {
        entries.push( $(this).attr('id').trim() );
      });

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url: { '$in': entries } }) })
        .done(function({ results }) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.url;
            var time = item.time;
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for (var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if (countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz',
                'X-LC-Key': 'brOnU8mOQvSjpipJvdKUAIbU',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            if ($('.post-title-link').length >= 1) {
              showTime(Counter);
            }
          
        });
    });
  </script>



  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script>pangu.spacingPage();</script>


  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.loadBookmark();
  
  </script>


  

  

  


  <!-- red heart -->
  <script type="text/javascript" src="/js/src/love.js"></script>
  
</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="google-site-verification" content="wioXOS3Gv2wXUpJ3sLtfZ4ft6YJYKNLLWSw6QoZTFYM">
  <meta name="msvalidate.01" content="C96491A81239C517A50597C54EE53CD1">
  <meta name="baidu-site-verification" content="h8asiToN1b">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"andy0570.com","root":"/","scheme":"Gemini","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":"mac","bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false};
  </script>

  <meta name="description" content="GitHub源码: Masonry  star:17000+                               ⭐️⭐️⭐️  以下内容来源于官方源码、 README 文档、测试 Demo或个人使用总结 ！">
<meta property="og:type" content="article">
<meta property="og:title" content="Masonry——简化自动布局代码框架">
<meta property="og:url" content="https://andy0570.com/2017/01/19/Masonry%E2%80%94%E2%80%94%E7%AE%80%E5%8C%96%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6/index.html">
<meta property="og:site_name" content="独木舟的木">
<meta property="og:description" content="GitHub源码: Masonry  star:17000+                               ⭐️⭐️⭐️  以下内容来源于官方源码、 README 文档、测试 Demo或个人使用总结 ！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074042.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074055.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074106.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074117.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074129.gif">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074132.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074133.jpg">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074138.gif">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074149.gif">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074202.gif">
<meta property="article:published_time" content="2017-01-19T09:57:00.000Z">
<meta property="article:modified_time" content="2019-05-01T14:10:05.000Z">
<meta property="article:author" content="独木舟的木">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="GitHub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074042.jpg">

<link rel="canonical" href="https://andy0570.com/2017/01/19/Masonry%E2%80%94%E2%80%94%E7%AE%80%E5%8C%96%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Masonry——简化自动布局代码框架 | 独木舟的木</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="独木舟的木" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">独木舟的木</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">iOS Developer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">36</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">310</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Masonry"><span class="nav-number">1.</span> <span class="nav-text">Masonry</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NSLayoutConstraints-%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">1.0.1.</span> <span class="nav-text">NSLayoutConstraints 的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-NSLayoutConstraints"><span class="nav-number">1.0.1.1.</span> <span class="nav-text">使用 NSLayoutConstraints</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Masonry"><span class="nav-number">1.0.1.2.</span> <span class="nav-text">使用Masonry</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E7%9F%AD%E7%9A%84%E5%86%99%E6%B3%95"><span class="nav-number">1.0.1.3.</span> <span class="nav-text">更短的写法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Masonry%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.0.2.</span> <span class="nav-text">Masonry实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E7%9A%84%E6%BA%90%E7%A0%81"><span class="nav-number">1.0.2.1.</span> <span class="nav-text">需要的源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%B1%85%E4%B8%AD%E6%98%BE%E7%A4%BA%E4%B8%80%E4%B8%AA300-300%E7%9A%84superview"><span class="nav-number">1.0.2.2.</span> <span class="nav-text">1. 居中显示一个300*300的superview</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%AE%A9superview1%E7%95%A5%E5%B0%8F%E4%BA%8E%E5%85%B6superview-%E8%BE%B9%E8%B7%9D%E4%B8%BA20"><span class="nav-number">1.0.2.3.</span> <span class="nav-text">2.让superview1略小于其superview(边距为20)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E8%AE%A9%E4%B8%A4%E4%B8%AA%E9%AB%98%E5%BA%A6%E4%B8%BA150%E7%9A%84view%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD%E3%80%81%E7%AD%89%E5%AE%BD%E3%80%81%E7%AD%89%E9%97%B4%E9%9A%94%E6%8E%92%E5%88%97-%E9%97%B4%E9%9A%94%E4%B8%BA10-%E8%87%AA%E5%8A%A8%E8%AE%A1%E7%AE%97%E5%85%B6%E5%AE%BD%E5%BA%A6"><span class="nav-number">1.0.2.4.</span> <span class="nav-text">3.让两个高度为150的view垂直居中、等宽、等间隔排列 (间隔为10 ),自动计算其宽度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%9C%A8UIScrollView-%E4%B8%8A%E9%A1%BA%E5%BA%8F%E6%8E%92%E5%88%97%E4%B8%80%E4%BA%9Bview%E5%B9%B6%E8%87%AA%E5%8A%A8%E8%AE%A1%E7%AE%97contentSize"><span class="nav-number">1.0.2.5.</span> <span class="nav-text">4.在UIScrollView 上顺序排列一些view并自动计算contentSize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E6%A8%AA%E5%90%91%E6%88%96%E8%80%85%E7%BA%B5%E5%90%91%E7%AD%89%E9%97%B4%E9%9A%99%E7%9A%84%E6%8E%92%E5%88%97%E4%B8%80%E7%BB%84view"><span class="nav-number">1.0.2.6.</span> <span class="nav-text">5.横向或者纵向等间隙的排列一组view</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-Masonry%E7%9A%84%E6%AF%94%E4%BE%8B%E4%BD%BF%E7%94%A8-multipliedBy"><span class="nav-number">1.0.2.7.</span> <span class="nav-text">6.Masonry的比例使用 multipliedBy</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-%E4%BD%BF%E7%94%A8priority%E4%BC%98%E5%85%88%E7%BA%A7%E5%B1%9E%E6%80%A7%E6%9D%A5%E5%81%9A%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%A8%E7%94%BB"><span class="nav-number">1.0.2.8.</span> <span class="nav-text">7.使用priority优先级属性来做简单的动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-Masonry%E6%9B%B4%E6%96%B0%E7%BA%A6%E6%9D%9F%E6%96%B9%E6%B3%95%EF%BC%9Amas-updateConstraints"><span class="nav-number">1.0.2.9.</span> <span class="nav-text">8.Masonry更新约束方法：mas_updateConstraints</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E7%BA%A6%E6%9D%9F%E5%92%8C%E5%B8%83%E5%B1%80%E7%9A%84%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95"><span class="nav-number">1.0.2.9.1.</span> <span class="nav-text">更新约束和布局的相关方法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-Masonry%E7%9A%84%E9%87%8D%E5%86%99%E7%BA%A6%E6%9D%9F%EF%BC%9Amas-remakeConstraints"><span class="nav-number">1.0.2.10.</span> <span class="nav-text">9.Masonry的重写约束：mas_remakeConstraints</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">1.0.3.</span> <span class="nav-text">其他</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">1.0.4.</span> <span class="nav-text">参考文章</span></a></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="独木舟的木"
      src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
  <p class="site-author-name" itemprop="name">独木舟的木</p>
  <div class="site-description" itemprop="description">生若直木，不语斧凿。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">310</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FuZHkwNTcw" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Andy0570"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS91c2Vycy83MjY1NDAwL2FuZHkwNTcw" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;7265400&#x2F;andy0570"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vdS84NGM1ZmFkYzdjMTg=" title="简书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;84c5fadc7c18"><i class="heartbeat fa-fw"></i>简书</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmFuZHl3aG1AMTYzLmNvbQ==" title="E-Mail → mailto:andywhm@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/19/Masonry%E2%80%94%E2%80%94%E7%AE%80%E5%8C%96%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="生若直木，不语斧凿。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Masonry——简化自动布局代码框架
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-01-19 17:57:00" itemprop="dateCreated datePublished" datetime="2017-01-19T17:57:00+08:00">2017-01-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-05-01 22:10:05" itemprop="dateModified" datetime="2019-05-01T22:10:05+08:00">2019-05-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS-%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">iOS 开源框架</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>21k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>19 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <ul>
<li>GitHub源码: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NuYXBLaXQvTWFzb25yeQ==">Masonry<i class="fa fa-external-link-alt"></i></span> </li>
<li>star:17000+</li>
</ul>
<blockquote>
<pre><code>                            ⭐️⭐️⭐️ </code></pre>
<p>以下内容来源于官方源码、 README 文档、测试 Demo或个人使用总结 ！</p>
</blockquote>
<a id="more"></a>

<h1 id="Masonry"><a href="#Masonry" class="headerlink" title="Masonry"></a>Masonry</h1><p><strong>Masonry</strong> 是一个轻量级的布局框架，拥有自己的描述语法，采用更优雅的链式语法封装自动布局，简洁明了并具有高可读性。</p>
<p>Masonry利用简化、可链接和表达式的语法发挥 <strong>Auto Layout</strong> 和 <strong>NSLayoutConstraints</strong> 的力量。支持iOS和OSX <strong>Auto Layout</strong>。</p>
<p>总的来说，就是当你在 <strong>Interface Bulider</strong> 上使用 <strong>Auto Layout</strong> 的时候基本上是非常方便的，但是当我们的 <strong>UI</strong> 是用手写代码生成时，或是<strong>UI界面</strong>需要随用户交互而更改，这时候做自动布局的时候使用原生的 <strong>NSLayoutConstraints</strong> 类及其的繁琐，<strong>Masonry</strong> 用简洁的语法对<strong>Auto Layout</strong> 进行了封装，使用相对更方便。</p>
<h3 id="NSLayoutConstraints-的问题"><a href="#NSLayoutConstraints-的问题" class="headerlink" title="NSLayoutConstraints 的问题"></a>NSLayoutConstraints 的问题</h3><p>添加一个子视图，跟随父视图的大小变化，但是与父视图边距有10个点的距离：<br><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074042.jpg"></p>
<h4 id="使用-NSLayoutConstraints"><a href="#使用-NSLayoutConstraints" class="headerlink" title="使用 NSLayoutConstraints"></a>使用 NSLayoutConstraints</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    UIView *superview &#x3D; self.view;</span><br><span class="line">    UIView *view1 &#x3D; [[UIView alloc] init];</span><br><span class="line">    &#x2F;&#x2F; 设置为NO，表示通过添加自己的约束以使用 Auto Layout 定位视图</span><br><span class="line">    view1.translatesAutoresizingMaskIntoConstraints &#x3D; NO;</span><br><span class="line">    view1.backgroundColor &#x3D; [UIColor greenColor];</span><br><span class="line">    [superview addSubview:view1];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; 指定每个边缘的插入量（正），值可以是负的到“起点”</span><br><span class="line">    UIEdgeInsets padding &#x3D; UIEdgeInsetsMake(10, 10, 10, 10);</span><br><span class="line">    </span><br><span class="line">    [superview addConstraints:@[</span><br><span class="line">                                </span><br><span class="line">        &#x2F;&#x2F; view1 constraints</span><br><span class="line">        &#x2F;&#x2F; view1.attribute1 &#x3D; multiplier × superview.attribute2 + constant</span><br><span class="line">        &#x2F;&#x2F; view1的顶部距离父视图的顶部10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeTop</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeTop</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:padding.top],</span><br><span class="line">        &#x2F;&#x2F; 左边距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeLeft</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeLeft</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:padding.left],</span><br><span class="line">        &#x2F;&#x2F; 底部距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeBottom</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeBottom</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:-padding.bottom],</span><br><span class="line">        &#x2F;&#x2F; 右边距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeRight</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeRight</span><br><span class="line">                                    multiplier:1</span><br><span class="line">                                      constant:-padding.right],</span><br><span class="line">        ]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用Masonry"><a href="#使用Masonry" class="headerlink" title="使用Masonry"></a>使用Masonry</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.equalTo(superview.mas_top).with.offset(padding.top);</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding.left);</span><br><span class="line">    make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding.right);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h4 id="更短的写法"><a href="#更短的写法" class="headerlink" title="更短的写法"></a>更短的写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(superview).with.insets(padding);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>



<h3 id="Masonry实践"><a href="#Masonry实践" class="headerlink" title="Masonry实践"></a>Masonry实践</h3><p>下面参考<span class="exturl" data-url="aHR0cDovL2FkYWQxODQuY29tLzIwMTQvMDkvMjgvdXNlLW1hc29ucnktdG8tcXVpY2stc29sdmUtYXV0b2xheW91dC8=">Masonry介绍与使用实践(快速上手Autolayout) @里脊串的开发随笔<i class="fa fa-external-link-alt"></i></span>，练习使用Masonry。</p>
<h4 id="需要的源码"><a href="#需要的源码" class="headerlink" title="需要的源码"></a>需要的源码</h4><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NuYXBLaXQvTWFzb25yeQ==">GitHub:Masonry<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FkYWQxODQvTU1QbGFjZUhvbGRlcg==">GitHub:MMPlaceHolder<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FkYWQxODQvRGVtb01hc29ucnk=">GitHub:DemoMasonry<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h4 id="1-居中显示一个300-300的superview"><a href="#1-居中显示一个300-300的superview" class="headerlink" title="1. 居中显示一个300*300的superview"></a>1. 居中显示一个300*300的superview</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview &#x3D; [UIView new];</span><br><span class="line">[superview showPlaceHolder];    &#x2F;&#x2F; 需要导入MMPlaceHolder框架</span><br><span class="line">superview.backgroundColor &#x3D; [UIColor blackColor];</span><br><span class="line">[self.view addSubview:superview];</span><br><span class="line">[superview mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.center.equalTo(self.view);</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(300, 300));</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074055.jpg"></p>
<h4 id="2-让superview1略小于其superview-边距为20"><a href="#2-让superview1略小于其superview-边距为20" class="headerlink" title="2.让superview1略小于其superview(边距为20)"></a>2.让superview1略小于其superview(边距为20)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview1 &#x3D;[UIView new];</span><br><span class="line">superview1.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">[superview addSubview:superview1];</span><br><span class="line">[superview1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    &#x2F;&#x2F; 写法一</span><br><span class="line">   make.edges.equalTo(superview).with.insets(UIEdgeInsetsMake(20, 20, 20, 20));</span><br><span class="line"></span><br><span class="line">    &#x2F;** 写法二</span><br><span class="line">    make.top.equalTo(superview).with.offset(20);</span><br><span class="line">    make.left.equalTo(superview).with.offset(20);</span><br><span class="line">    make.bottom.equalTo(superview).with.offset(-20);</span><br><span class="line">    make.right.equalTo(superview).with.offset(-20);</span><br><span class="line">    **&#x2F;</span><br><span class="line"></span><br><span class="line">    &#x2F;** 写法三</span><br><span class="line">     make.top.left.bottom.and.right.equalTo(superview).with.insets(UIEdgeInsetsMake(20, 20, 20, 20));</span><br><span class="line">    **&#x2F;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074106.jpg"></p>
<h4 id="3-让两个高度为150的view垂直居中、等宽、等间隔排列-间隔为10-自动计算其宽度"><a href="#3-让两个高度为150的view垂直居中、等宽、等间隔排列-间隔为10-自动计算其宽度" class="headerlink" title="3.让两个高度为150的view垂直居中、等宽、等间隔排列 (间隔为10 ),自动计算其宽度"></a>3.让两个高度为150的view垂直居中、等宽、等间隔排列 (间隔为10 ),自动计算其宽度</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview2 &#x3D;[UIView new];</span><br><span class="line">superview2.backgroundColor &#x3D; [UIColor orangeColor];</span><br><span class="line">[superview addSubview:superview2];</span><br><span class="line"></span><br><span class="line">UIView *superview3 &#x3D;[UIView new];</span><br><span class="line">superview3.backgroundColor &#x3D; [UIColor orangeColor];</span><br><span class="line">[superview addSubview:superview3];</span><br><span class="line"></span><br><span class="line">int padding1 &#x3D; 10;</span><br><span class="line">[superview2 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.mas_equalTo(superview.mas_centerY);</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding1);</span><br><span class="line">    make.right.equalTo(superview3.mas_left).with.offset(-padding1);</span><br><span class="line">    make.height.mas_equalTo(@150);</span><br><span class="line">    make.width.equalTo(superview3);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[superview3 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.mas_equalTo(superview.mas_centerY);</span><br><span class="line">    make.left.equalTo(superview2.mas_right).with.offset(padding1);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding1);</span><br><span class="line">    make.height.mas_equalTo(@150);</span><br><span class="line">    make.width.equalTo(superview2);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074117.jpg"></p>
<h4 id="4-在UIScrollView-上顺序排列一些view并自动计算contentSize"><a href="#4-在UIScrollView-上顺序排列一些view并自动计算contentSize" class="headerlink" title="4.在UIScrollView 上顺序排列一些view并自动计算contentSize"></a>4.在UIScrollView 上顺序排列一些view并自动计算contentSize</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">UIScrollView *scrollView &#x3D; [UIScrollView new];</span><br><span class="line">scrollView.backgroundColor &#x3D; [UIColor whiteColor];</span><br><span class="line">[superview addSubview:scrollView];</span><br><span class="line">[scrollView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(superview).with.insets(UIEdgeInsetsMake(5, 5, 5, 5));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">UIView *container &#x3D; [UIView new];</span><br><span class="line">[scrollView addSubview:container];</span><br><span class="line">[container mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(scrollView);</span><br><span class="line">    make.width.equalTo(scrollView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">int count &#x3D; 10;</span><br><span class="line">UIView *lastView &#x3D; nil;</span><br><span class="line"></span><br><span class="line">for (int i &#x3D; 1;  i &lt;&#x3D; count; i++) &#123;</span><br><span class="line">    UIView *subView &#x3D; [UIView new];</span><br><span class="line">    [container addSubview:subView];</span><br><span class="line">    subView.backgroundColor &#x3D; [UIColor colorWithHue:(arc4random() % 256 &#x2F; 256.0)</span><br><span class="line">                                         saturation:(arc4random() % 128 &#x2F; 256.0) + 0.5</span><br><span class="line">                                         brightness:(arc4random() % 128 &#x2F; 256.0) + 0.5</span><br><span class="line">                                              alpha:1];</span><br><span class="line"></span><br><span class="line">    [subView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.left.and.right.equalTo(container);</span><br><span class="line">        make.height.mas_equalTo(@(20 * i)); &#x2F;&#x2F; 每个子视图的高度是20的倍数</span><br><span class="line"></span><br><span class="line">        if (lastView) &#123;</span><br><span class="line">            &#x2F;&#x2F; 下一个子视图的顶部 &#x3D; 上一个子视图的底部</span><br><span class="line">            make.top.mas_equalTo(lastView.mas_bottom);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            &#x2F;&#x2F; 第一次执行，lastView &#x3D; nil,因此第一个子视图的顶部是容器的顶部</span><br><span class="line">            make.top.mas_equalTo(container.mas_top);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    lastView &#x3D; subView;</span><br><span class="line">&#125;</span><br><span class="line">[container mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    &#x2F;&#x2F; 容器的底部是最后一个视图的底部</span><br><span class="line">    make.bottom.equalTo(lastView.mas_bottom);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074129.gif"></p>
<h4 id="5-横向或者纵向等间隙的排列一组view"><a href="#5-横向或者纵向等间隙的排列一组view" class="headerlink" title="5.横向或者纵向等间隙的排列一组view"></a>5.横向或者纵向等间隙的排列一组view</h4><blockquote>
<p>11/15 添加<br>均匀分布一组view推荐使用 <code>NSArray+MASAdditions.h</code> 类中的两个方法:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> *  distribute with fixed spacing</span><br><span class="line"> *</span><br><span class="line"> *  @param axisType     which axis to distribute items along</span><br><span class="line"> *  @param fixedSpacing the spacing between each item</span><br><span class="line"> *  @param leadSpacing  the spacing before the first item and the container</span><br><span class="line"> *  @param tailSpacing  the spacing after the last item and the container</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)mas_distributeViewsAlongAxis:(MASAxisType)axisType withFixedSpacing:(CGFloat)fixedSpacing leadSpacing:(CGFloat)leadSpacing tailSpacing:(CGFloat)tailSpacing;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> *  distribute with fixed item size</span><br><span class="line"> *</span><br><span class="line"> *  @param axisType        which axis to distribute items along</span><br><span class="line"> *  @param fixedItemLength the fixed length of each item</span><br><span class="line"> *  @param leadSpacing     the spacing before the first item and the container</span><br><span class="line"> *  @param tailSpacing     the spacing after the last item and the container</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)mas_distributeViewsAlongAxis:(MASAxisType)axisType withFixedItemLength:(CGFloat)fixedItemLength leadSpacing:(CGFloat)leadSpacing tailSpacing:(CGFloat)tailSpacing;</span><br></pre></td></tr></table></figure>


<p><del>需要使用封装的 category 类:</del></p>
<ul>
<li><strong>UIView+LJC.h</strong>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit&#x2F;UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> 横向或者纵向等间隙的排列一组view</span><br><span class="line"> *&#x2F;</span><br><span class="line">@interface UIView (LJC)</span><br><span class="line"></span><br><span class="line">- (void) distributeSpacingHorizontallyWith:(NSArray*)views;</span><br><span class="line"></span><br><span class="line">- (void) distributeSpacingVerticallyWith:(NSArray*)views;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>UIView+LJC.m</strong>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;UIView+LJC.h&quot;</span><br><span class="line">#import &lt;Masonry&#x2F;Masonry.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation UIView (LJC)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> 横向排列一组view</span><br><span class="line"></span><br><span class="line"> @param views view数组</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void) distributeSpacingHorizontallyWith:(NSArray*)views</span><br><span class="line">&#123;</span><br><span class="line">    NSMutableArray *spaces &#x3D; [NSMutableArray arrayWithCapacity:views.count+1];</span><br><span class="line">    </span><br><span class="line">    for ( int i &#x3D; 0 ; i &lt; views.count+1 ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *v &#x3D; [UIView new];</span><br><span class="line">        [spaces addObject:v];</span><br><span class="line">        [self addSubview:v];</span><br><span class="line">        </span><br><span class="line">        [v mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.width.equalTo(v.mas_height);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    UIView *v0 &#x3D; spaces[0];</span><br><span class="line">    </span><br><span class="line">    [v0 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.left.equalTo(self.mas_left);</span><br><span class="line">        make.centerY.equalTo(((UIView*)views[0]).mas_centerY);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    UIView *lastSpace &#x3D; v0;</span><br><span class="line">    for ( int i &#x3D; 0 ; i &lt; views.count; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *obj &#x3D; views[i];</span><br><span class="line">        UIView *space &#x3D; spaces[i+1];</span><br><span class="line">        </span><br><span class="line">        [obj mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(lastSpace.mas_right);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        [space mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(obj.mas_right);</span><br><span class="line">            make.centerY.equalTo(obj.mas_centerY);</span><br><span class="line">            make.width.equalTo(v0);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        lastSpace &#x3D; space;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [lastSpace mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.right.equalTo(self.mas_right);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> 垂直排列一组view</span><br><span class="line"></span><br><span class="line"> @param views view数组</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void) distributeSpacingVerticallyWith:(NSArray*)views</span><br><span class="line">&#123;</span><br><span class="line">    NSMutableArray *spaces &#x3D; [NSMutableArray arrayWithCapacity:views.count+1];</span><br><span class="line">    </span><br><span class="line">    for ( int i &#x3D; 0 ; i &lt; views.count+1 ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *v &#x3D; [UIView new];</span><br><span class="line">        [spaces addObject:v];</span><br><span class="line">        [self addSubview:v];</span><br><span class="line">        </span><br><span class="line">        [v mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.width.equalTo(v.mas_height);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    UIView *v0 &#x3D; spaces[0];</span><br><span class="line">    </span><br><span class="line">    [v0 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.top.equalTo(self.mas_top);</span><br><span class="line">        make.centerX.equalTo(((UIView*)views[0]).mas_centerX);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    UIView *lastSpace &#x3D; v0;</span><br><span class="line">    for ( int i &#x3D; 0 ; i &lt; views.count; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *obj &#x3D; views[i];</span><br><span class="line">        UIView *space &#x3D; spaces[i+1];</span><br><span class="line">        </span><br><span class="line">        [obj mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.top.equalTo(lastSpace.mas_bottom);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        [space mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.top.equalTo(obj.mas_bottom);</span><br><span class="line">            make.centerX.equalTo(obj.mas_centerX);</span><br><span class="line">            make.height.equalTo(v0);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        lastSpace &#x3D; space;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [lastSpace mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.bottom.equalTo(self.mas_bottom);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<ul>
<li>实例测试：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">UIView *subView11 &#x3D; [UIView new];</span><br><span class="line">UIView *subView12 &#x3D; [UIView new];</span><br><span class="line">UIView *subView13 &#x3D; [UIView new];</span><br><span class="line">UIView *subView21 &#x3D; [UIView new];</span><br><span class="line">UIView *subView31 &#x3D; [UIView new];</span><br><span class="line"></span><br><span class="line">subView11.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">subView12.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">subView13.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">subView21.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">subView31.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line"></span><br><span class="line">[superview addSubview:subView11];</span><br><span class="line">[superview addSubview:subView12];</span><br><span class="line">[superview addSubview:subView13];</span><br><span class="line">[superview addSubview:subView21];</span><br><span class="line">[superview addSubview:subView31];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;给予不同的大小，测试结果</span><br><span class="line"></span><br><span class="line">[subView11 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.equalTo(@[subView12,subView13]); &#x2F;&#x2F; 11、12、13 Y方向对齐</span><br><span class="line">    make.centerX.equalTo(@[subView21,subView31]); &#x2F;&#x2F; 11、21、31 X方向对齐</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(40, 40));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView12 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(30, 30));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView13 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(20, 20));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView21 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(50, 50));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView31 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(60, 60));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[superview distributeSpacingHorizontallyWith:@[subView11,subView12,subView13]];</span><br><span class="line">[superview distributeSpacingVerticallyWith:@[subView11,subView21,subView31]];</span><br><span class="line"></span><br><span class="line">[superview showPlaceHolderWithAllSubviews];</span><br><span class="line">[superview hidePlaceHolder];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用空白的占位view填充目标view的旁边</p>
</blockquote>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074132.jpg"></p>
<p>继续参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuenlidWx1by5jb20va2V6aGVuL25vdGUvMTQ3MTY3">Masonry使用总结<i class="fa fa-external-link-alt"></i></span>，学习使用 Masonry；</p>
<h4 id="6-Masonry的比例使用-multipliedBy"><a href="#6-Masonry的比例使用-multipliedBy" class="headerlink" title="6.Masonry的比例使用 multipliedBy"></a>6.Masonry的比例使用 multipliedBy</h4><p>使用<strong>multipliedBy</strong>必须是对<strong>同一个控件本身</strong>，如果修改成相对于其它控件会导致Crash。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">UIView *topView &#x3D; [UIView new];</span><br><span class="line">[topView setBackgroundColor:[UIColor redColor]];</span><br><span class="line">[self.view addSubview:topView];</span><br><span class="line"></span><br><span class="line">UIView *topInnerView &#x3D; [UIView new];</span><br><span class="line">[topInnerView setBackgroundColor:[UIColor greenColor]];</span><br><span class="line">[topInnerView showPlaceHolder];</span><br><span class="line">[self.view addSubview:topInnerView];</span><br><span class="line"></span><br><span class="line">UIView *bottomView &#x3D;[UIView new];</span><br><span class="line">[bottomView setBackgroundColor:[UIColor blueColor]];</span><br><span class="line">[self.view addSubview:bottomView];</span><br><span class="line"></span><br><span class="line">UIView *bottomInnerView &#x3D;[UIView new];</span><br><span class="line">[bottomInnerView setBackgroundColor:[UIColor blackColor]];</span><br><span class="line">[bottomInnerView showPlaceHolder];</span><br><span class="line">[self.view addSubview:bottomInnerView];</span><br><span class="line"></span><br><span class="line">[topView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.left.and.right.mas_equalTo(0);</span><br><span class="line">    make.height.mas_equalTo(bottomView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[topInnerView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.and.right.mas_equalTo(0);</span><br><span class="line">    make.width.mas_equalTo(topInnerView.mas_height).multipliedBy(3);</span><br><span class="line">    make.center.mas_equalTo(topView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[bottomView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.bottom.and.right.mas_equalTo(0);</span><br><span class="line">    make.height.mas_equalTo(topView);</span><br><span class="line">    make.top.mas_equalTo(topView.mas_bottom);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[bottomInnerView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.and.bottom.mas_equalTo(bottomView);</span><br><span class="line">    make.height.mas_equalTo(bottomInnerView.mas_width).multipliedBy(3);</span><br><span class="line">    make.center.mas_equalTo(bottomView);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074133.jpg"></p>
<h4 id="7-使用priority优先级属性来做简单的动画"><a href="#7-使用priority优先级属性来做简单的动画" class="headerlink" title="7.使用priority优先级属性来做简单的动画"></a>7.使用priority优先级属性来做简单的动画</h4><blockquote>
<p>.priority allows you to specify an exact priority</p>
<p>.priorityHigh equivalent to <strong>UILayoutPriorityDefaultHigh</strong></p>
<p>.priorityMedium is half way between high and low</p>
<p>.priorityLow equivalent to <strong>UILayoutPriorityDefaultLow</strong></p>
</blockquote>
<ol>
<li>先为blueView设置属性：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic,strong) UIView *blueView;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p>2.创建视图并设置约束：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 红色视图</span><br><span class="line">UIView *redView &#x3D; [UIView new];</span><br><span class="line">redView.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">[self.view addSubview:redView];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 蓝色视图</span><br><span class="line">self.blueView &#x3D; [UIView new];</span><br><span class="line">self.blueView.backgroundColor &#x3D; [UIColor blueColor];</span><br><span class="line">[self.view addSubview:self.blueView];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 黄色视图</span><br><span class="line">UIView *yellowView &#x3D; [UIView new];</span><br><span class="line">yellowView.backgroundColor &#x3D; [UIColor yellowColor];</span><br><span class="line">[self.view addSubview:yellowView];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ————红色视图约束————</span><br><span class="line">[redView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.mas_equalTo(self.view.mas_left).with.offset(20);</span><br><span class="line">    make.bottom.mas_equalTo(self.view.mas_bottom).with.offset(-80);</span><br><span class="line">    make.height.mas_equalTo(50);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ————蓝色视图约束————</span><br><span class="line">[self.blueView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.mas_equalTo(redView.mas_right).with.offset(40);</span><br><span class="line">    make.bottom.width.and.height.with.height.mas_equalTo(redView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ————黄色视图约束————</span><br><span class="line">[yellowView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">      &#x2F;&#x2F; 默认满足高优先级约束</span><br><span class="line">    make.left.mas_equalTo(self.blueView.mas_right).with.offset(40);</span><br><span class="line">    make.right.mas_equalTo(self.view.mas_right).with.offset(-20);</span><br><span class="line">    make.bottom.width.and.height.mas_equalTo(redView);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;** priority设置为250，最高1000（默认）**</span><br><span class="line">    make.left.mas_equalTo(redView.mas_right).with.offset(20).priority(250);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>3.点击屏幕移除蓝色视图方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    [self.blueView removeFromSuperview];</span><br><span class="line">    [UIView animateWithDuration:1.0 animations:^&#123;</span><br><span class="line">        [self.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注释：黄色视图的<strong>left</strong>属性分别设置了两个约束，一个相对于蓝色视图的高优先级约束：<code>make.left.mas_equalTo(self.blueView.mas_right).with.offset(40);</code></p>
<p>另一个相对于红色视图的低优先级约束：<code>make.left.mas_equalTo(redView.mas_right).with.offset(20).priority(250);</code></p>
<p>当蓝色视图存在时，两个约束同时存在，为避免约束冲突，系统默认满足高优先级的约束；</p>
<p>当点击屏幕，蓝色视图被移除后，低优先级的约束就会生效。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074138.gif"></p>
<h4 id="8-Masonry更新约束方法：mas-updateConstraints"><a href="#8-Masonry更新约束方法：mas-updateConstraints" class="headerlink" title="8.Masonry更新约束方法：mas_updateConstraints"></a>8.Masonry更新约束方法：mas_updateConstraints</h4><p>如果你只想更新约束的常量值，则可以使用更方便的方法:<code>mas_updateConstraints</code>而不是<code>mas_makeConstraints</code>。</p>
<ol>
<li><p>创建一个Button属性、scale属性用于记录放大比例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line">@property (nonatomic,strong) UIButton *growingButton;</span><br><span class="line">@property (nonatomic,assign) CGFloat scale;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol start="2">
<li><p>创建Button实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">self.growingButton &#x3D; [UIButton buttonWithType:UIButtonTypeSystem];</span><br><span class="line">[self.growingButton setTitle:@&quot;点我放大&quot; forState:UIControlStateNormal];</span><br><span class="line">self.growingButton.layer.borderColor &#x3D; UIColor.greenColor.CGColor;</span><br><span class="line">self.growingButton.layer.borderWidth &#x3D; 3;</span><br><span class="line">[self.growingButton addTarget:self action:@selector(onGrowButtonTaped:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">[self.view addSubview:self.growingButton];</span><br><span class="line">self.scale &#x3D; 1.0;</span><br><span class="line"></span><br><span class="line">[self.growingButton mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.center.mas_equalTo(self.view);</span><br><span class="line">    &#x2F;&#x2F; 初始宽、高为100，优先级最低</span><br><span class="line">    make.width.height.mas_equalTo(100 * self.scale);</span><br><span class="line">    &#x2F;&#x2F; 最大放大到整个view</span><br><span class="line">    make.width.and.height.lessThanOrEqualTo(self.view);</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击Button方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)onGrowButtonTaped:(UIButton *)sender &#123;</span><br><span class="line">    self.scale +&#x3D; 1.0;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;告诉self.view约束需要更新</span><br><span class="line">    [self.view setNeedsUpdateConstraints];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;调用此方法告诉self.view检测是否需要更新约束，若需要则更新。下面添加的动画效果才起作用</span><br><span class="line">    [self.view updateConstraintsIfNeeded];</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:0.3 animations:^&#123;</span><br><span class="line">        [self.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新约束：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 这是Apple推荐的添加&#x2F;更新约束的地方</span><br><span class="line">&#x2F;&#x2F; 此方法可以被多次调用，以响应 setNeedsUpdateConstraints</span><br><span class="line">&#x2F;&#x2F; 如果您需要触发对约束的更新，可以在UIKit内部或你的代码中调用该方法</span><br><span class="line">- (void)updateViewConstraints &#123;</span><br><span class="line">    [self.growingButton mas_updateConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        &#x2F;&#x2F;这里写需要更新的约束，不用更新的约束将继续存在，并不会被取代</span><br><span class="line">        make.width.and.height.mas_equalTo(100*self.scale);</span><br><span class="line">    &#125;];</span><br><span class="line">      &#x2F;&#x2F; &#x2F;&#x2F;根据Apple要求，super方法应该在方法结束时调用</span><br><span class="line">    [super updateViewConstraints];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<p>   <img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074149.gif"></p>
<p>代码执行顺序：</p>
<blockquote>
<p><strong>-[ViewController viewDidLoad]</strong></p>
<p><strong>-[ViewController createGrowingButton]</strong></p>
<p><strong>mas_makeConstraints</strong></p>
<p> <strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
<p>点击按钮</p>
<p><strong>-[ViewController onGrowButtonTaped:]</strong></p>
<p><strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
<p>点击按钮</p>
<p><strong>-[ViewController onGrowButtonTaped:]</strong></p>
<p><strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
</blockquote>
<h5 id="更新约束和布局的相关方法"><a href="#更新约束和布局的相关方法" class="headerlink" title="更新约束和布局的相关方法"></a>更新约束和布局的相关方法</h5><ul>
<li>关于UIView重新布局相关的API，主要用以下三个API：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)setNeedsLayout  标记为需要在下一个周期重新布局</span><br><span class="line">- (void)layoutIfNeeded  查看当前视图是否被标记需要重新布局，有则在内部调用layoutSubviews方法立即进行重新布局</span><br><span class="line">- (void)layoutSubviews  重写当前方法，在内部完成重新布局操作,不要直接调用，如果需要强制更新布局，调用 setNeedsLayout()</span><br></pre></td></tr></table></figure>

<ul>
<li>关于更新约束布局相关的API，主要用以下四个API：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)setNeedsUpdateConstraints  标记需要进行重新布局，系统会调用 updateConstraints()方法，修改多个约束后调用该方法批量更新有助于提升性能</span><br><span class="line">- (BOOL)needsUpdateConstraints     当前是否需要重新布局，内部会判断当前有没有被标记的约束</span><br><span class="line">- (void)updateConstraintsIfNeeded  调用此方法，如果有标记为需要重新布局的约束，则立即进行重新布局，内部会调用  updateConstraints方法</span><br><span class="line">- (void)updateConstraints          重写此方法，内部实现自定义布局过程</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="9-Masonry的重写约束：mas-remakeConstraints"><a href="#9-Masonry的重写约束：mas-remakeConstraints" class="headerlink" title="9.Masonry的重写约束：mas_remakeConstraints"></a>9.Masonry的重写约束：mas_remakeConstraints</h4><blockquote>
<p><code>mas_updateConstraints</code> is useful for updating a set of constraints, but doing anything <em>beyond updating constant values</em>  can get exhausting. That’s where <code>mas_remakeConstraints</code> comes in.</p>
<p><code>mas_remakeConstraints</code> is similar to <code>mas_updateConstraints</code>, but instead of updating constant values, it will remove all of its constraints before installing them again. This lets you provide different constraints without having to keep around references to ones which you want to remove.</p>
</blockquote>
<ol>
<li>创建一个Button属性、isExpanded属性用于记录按钮状态：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic,strong) UIButton *growingButton;</span><br><span class="line">@property (nonatomic,assign) BOOL isExpanded;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建Button实例：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">self.isExpanded &#x3D; NO;</span><br><span class="line">self.growingButton &#x3D; [UIButton buttonWithType:UIButtonTypeSystem];</span><br><span class="line">[self.growingButton setTitle:@&quot;点我展开&quot; forState:UIControlStateNormal];</span><br><span class="line">self.growingButton.layer.borderColor &#x3D; UIColor.greenColor.CGColor;</span><br><span class="line">self.growingButton.layer.borderWidth &#x3D; 3;</span><br><span class="line">self.growingButton.backgroundColor &#x3D; [UIColor redColor];</span><br><span class="line">[self.growingButton addTarget:self action:@selector(onGrowButtonTaped:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">[self.view addSubview:_growingButton];</span><br><span class="line"></span><br><span class="line">[self.growingButton mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.and.left.mas_equalTo(100);</span><br><span class="line">    make.bottom.mas_equalTo(-350);</span><br><span class="line">    make.right.mas_equalTo(-100);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>点击Button方法：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (void)onGrowButtonTaped:(UIButton *)sender &#123;</span><br><span class="line">    self.isExpanded &#x3D; !self.isExpanded;</span><br><span class="line">    if (!self.isExpanded) &#123;</span><br><span class="line">        [self.growingButton setTitle:@&quot;点我展开&quot; forState:UIControlStateNormal];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        [self.growingButton setTitle:@&quot;点我收起&quot; forState:UIControlStateNormal];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [self.view setNeedsUpdateConstraints];</span><br><span class="line">    [self.view updateConstraintsIfNeeded];</span><br><span class="line">    [UIView animateWithDuration:0.3 animations:^&#123;</span><br><span class="line">        [self.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>更新约束：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (void)updateViewConstraints &#123;</span><br><span class="line">    NSLog(@&quot;%s&quot;,__func__);</span><br><span class="line">    &#x2F;&#x2F; 这里使用update也能实现效果，而remark会将之前的约束全部移除，然后重新添加</span><br><span class="line">    __weak typeof (self)weakself &#x3D; self;</span><br><span class="line">    [self.growingButton mas_remakeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        &#x2F;&#x2F; 重写全部约束</span><br><span class="line">        if (weakself.isExpanded) &#123;</span><br><span class="line">            make.top.and.left.mas_equalTo(0);</span><br><span class="line">            make.bottom.mas_equalTo(10);</span><br><span class="line">            make.right.mas_equalTo(0);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            make.top.and.left.mas_equalTo(100);</span><br><span class="line">            make.bottom.mas_equalTo(-350);</span><br><span class="line">            make.right.mas_equalTo(-100);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    [super updateViewConstraints];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现结果：</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/074202.gif"></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><blockquote>
<p>By default, macros which support <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQXV0b2JveGluZyNBdXRvYm94aW5n">autoboxing<i class="fa fa-external-link-alt"></i></span> are prefixed with mas_. Unprefixed versions are available by defining MAS_SHORTHAND_GLOBALS before importing Masonry.</p>
<p>​                                                            ——摘自<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NuYXBLaXQvTWFzb25yeQ==">Masonary:README.md<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li>为了增加代码的可读性这里有两个简化代码的宏：<code>#define MAS_SHORTHAND</code>和<code>#define MAS_SHORTHAND_GLOBALS</code></li>
</ul>
<ul>
<li><p><code>MAS_SHORTHAND</code>：只要在导入<strong>Masonry</strong>主头文件之前定义这个宏, 那么以后在使用<strong>Masonry</strong>框架中的属性和方法的时候, 就可以省略<strong>mas_</strong>前缀</p>
</li>
<li><p><code>MAS_SHORTHAND_GLOBALS</code>：只要在导入Masonry主头文件之前定义这个宏,那么就可以让<code>equalTo</code>函数接收基本数据类型, 内部会对基本数据类型进行包装 </p>
</li>
<li><p>注意：这两个宏如果想有效使用，必须要在添加<strong>Masonry</strong>头文件之前导入进去。在没有增加宏<code>MAS_SHORTHAND_GLOBALS</code>时，下面这句是会报错的。 </p>
</li>
<li><p><code>make.top.equalTo(42); --&gt; make.top.equalTo([NSNumber numberWithInt:42]);</code></p>
<p>​                                                    ——摘自<span class="exturl" data-url="aHR0cHM6Ly93d3cuenlidWx1by5jb20va2V6aGVuL25vdGUvMTQ3MTY3">Masonry使用总结<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
</blockquote>
<p>注意：有时候写约束语法的时候 <strong>with</strong> 经常会不小心写成 <strong>width</strong>,就像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make.bottom.mas_equalTo(self.view.mas_bottom).width.offset(-80);</span><br></pre></td></tr></table></figure>

<p>于是会报这样的错误：</p>
<blockquote>
<p>Attributes should be chained before defining the constraint relation.</p>
<p>属性应该在定义约束关系之前链接.</p>
</blockquote>
<p>记得仔细查找这种错误并改正。</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><span class="exturl" data-url="aHR0cDovL2Jsb2cubGVzc2Z1bi5jb20vYmxvZy8yMDE0LzEwLzE3L2lvcy1hdXRvbGF5b3V0LXZzLWF1dG9zaXppbmcv">iOS AutoLayout与AutoSizing：自动布局，想说爱你真的好难<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL2FkYWQxODQuY29tLzIwMTQvMDkvMjgvdXNlLW1hc29ucnktdG8tcXVpY2stc29sdmUtYXV0b2xheW91dC8=">Masonry介绍与使用实践(快速上手Autolayout) @里脊串的开发随笔<i class="fa fa-external-link-alt"></i></span> ⭐️⭐️⭐️</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuenlidWx1by5jb20va2V6aGVuL25vdGUvMTQ3MTY3">Masonry使用总结<i class="fa fa-external-link-alt"></i></span> ⭐️⭐️⭐️</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5qaWFuc2h1LmNvbS9wL2VhNzRiMjMwYzcwZA==">简书：iOS自动布局框架-Masonry详解 @刘小壮<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL2hhby5qb2Jib2xlLmNvbS9tYXNvbnJ5LWlvcy8=">Masonry:使用纯代码进行iOS应用的autolayout自适应布局 @伯乐在线<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5jb2NvYWNoaW5hLmNvbS9pb3MvMjAxNTA3MDIvMTIyMTcuaHRtbA==">iOS自适应前段库-Masonry的使用<i class="fa fa-external-link-alt"></i></span></li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>独木舟的木
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://andy0570.com/2017/01/19/Masonry%E2%80%94%E2%80%94%E7%AE%80%E5%8C%96%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6/" title="Masonry——简化自动布局代码框架">https://andy0570.com/2017/01/19/Masonry——简化自动布局代码框架/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/iOS/" rel="tag"># iOS</a>
              <a href="/tags/GitHub/" rel="tag"># GitHub</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/01/18/%E7%BF%BB%E8%AF%91%E6%96%87%E7%AB%A0%EF%BC%9AiOS-7%E4%B8%AD%E7%9A%84%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E6%95%99%E7%A8%8B%E7%AC%AC1%E9%83%A8%E5%88%86%EF%BC%9A%E5%85%A5%E9%97%A8/" rel="prev" title="翻译文章：iOS 7 中的自动布局教程第1部分：入门">
      <i class="fa fa-chevron-left"></i> 翻译文章：iOS 7 中的自动布局教程第1部分：入门
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/02/03/%E4%B8%BA%20Windows%20%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%90%AF%20Intel%C2%AE%20Rapid%20Start%20Technology/" rel="next" title="为 Windows 系统开启 Intel® Rapid Start Technology">
      为 Windows 系统开启 Intel® Rapid Start Technology <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">独木舟的木</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">2.1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">31:21</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>















  

  

</body>
</html>

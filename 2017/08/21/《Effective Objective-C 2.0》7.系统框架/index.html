<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="google-site-verification" content="wioXOS3Gv2wXUpJ3sLtfZ4ft6YJYKNLLWSw6QoZTFYM">
  <meta name="msvalidate.01" content="C96491A81239C517A50597C54EE53CD1">
  <meta name="baidu-site-verification" content="pfEqqWwotH">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//unpkg.com/pace-js@1/pace.min.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"andy0570.com","root":"/","scheme":"Gemini","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":"mac","bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":true,"nav":null,"activeClass":"valine"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"algolia":{"appID":"0E2AON8EZF","apiKey":"22fbefd84c8343239f5c04365b9728de","indexName":"MyBlogPlatform","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false}};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="ã€ŠEffective Objective-C 2.0ã€‹7. ç³»ç»Ÿæ¡†æ¶">
<meta property="og:url" content="https://andy0570.com/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/index.html">
<meta property="og:site_name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg">
<meta property="article:published_time" content="2017-08-21T02:56:00.000Z">
<meta property="article:modified_time" content="2019-04-28T07:45:00.000Z">
<meta property="article:author" content="ç‹¬æœ¨èˆŸçš„æœ¨">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="Objective-C">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg">

<link rel="canonical" href="https://andy0570.com/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ã€ŠEffective Objective-C 2.0ã€‹7. ç³»ç»Ÿæ¡†æ¶ | ç‹¬æœ¨èˆŸçš„æœ¨</title>
  


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8229a094facca297f211d61323fd9fde";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="ç‹¬æœ¨èˆŸçš„æœ¨" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">ç‹¬æœ¨èˆŸçš„æœ¨</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">iOS Developer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">36</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">310</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC7%E7%AB%A0-%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6"><span class="nav-number">1.</span> <span class="nav-text">ç¬¬ 7 ç«  ç³»ç»Ÿæ¡†æ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC47%E6%9D%A1%EF%BC%9A%E7%86%9F%E6%82%89%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6"><span class="nav-number">1.1.</span> <span class="nav-text">ç¬¬ 47 æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9"><span class="nav-number">1.1.1.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC48%E6%9D%A1%EF%BC%9A%E5%A4%9A%E7%94%A8%E5%9D%97%E6%9E%9A%E4%B8%BE%EF%BC%8C%E5%B0%91%E7%94%A8-for-%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.2.</span> <span class="nav-text">ç¬¬ 48 æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#for-%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.2.1.</span> <span class="nav-text">for å¾ªç¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Objective-C-1-0-%E7%9A%84-NSEnumerator-%E9%81%8D%E5%8E%86"><span class="nav-number">1.2.2.</span> <span class="nav-text">ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E9%81%8D%E5%8E%86"><span class="nav-number">1.2.3.</span> <span class="nav-text">å¿«é€Ÿéå†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%9D%97%E7%9A%84%E9%81%8D%E5%8E%86%E6%96%B9%E5%BC%8F"><span class="nav-number">1.2.4.</span> <span class="nav-text">åŸºäºå—çš„éå†æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9-1"><span class="nav-number">1.2.5.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC49%E6%9D%A1%EF%BC%9A%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%B6%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E8%AF%AD%E4%B9%89%E7%9A%84-collection-%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BC%9D%E6%A1%A5%E6%8E%A5"><span class="nav-number">1.3.</span> <span class="nav-text">ç¬¬ 49 æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%A5%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.3.1.</span> <span class="nav-text">æ¡¥å¼è½¬æ¢</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BC%9D%E6%A1%A5%E6%8E%A5%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%9A"><span class="nav-number">1.3.2.</span> <span class="nav-text">éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9-2"><span class="nav-number">1.3.3.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC50%E6%9D%A1%EF%BC%9A%E6%9E%84%E5%BB%BA%E7%BC%93%E5%AD%98%E6%97%B6%E9%80%89%E7%94%A8-NSCache-%E8%80%8C%E9%9D%9E-NSDictionary"><span class="nav-number">1.4.</span> <span class="nav-text">ç¬¬ 50 æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC51%E6%9D%A1%EF%BC%9A%E7%B2%BE%E7%AE%80-initialize-%E4%B8%8E-load-%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81"><span class="nav-number">1.5.</span> <span class="nav-text">ç¬¬ 51 æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#load-%E6%96%B9%E6%B3%95"><span class="nav-number">1.5.1.</span> <span class="nav-text">load æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initialize-%E6%96%B9%E6%B3%95"><span class="nav-number">1.5.2.</span> <span class="nav-text">initialize æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.5.3.</span> <span class="nav-text">æ€»ç»“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9-4"><span class="nav-number">1.5.4.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC52%E6%9D%A1%EF%BC%9A%E5%88%AB%E5%BF%98%E4%BA%86-NSTimer-%E4%BC%9A%E4%BF%9D%E7%95%99%E5%85%B6%E7%9B%AE%E6%A0%87%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.6.</span> <span class="nav-text">ç¬¬ 52 æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#iOS-10-0-%E4%B8%AD%E5%B7%B2%E7%BB%8F%E5%BC%95%E5%85%A5%E4%BA%86%E8%AF%A5%E6%96%B9%E6%B3%95"><span class="nav-number">1.6.1.</span> <span class="nav-text">iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%81%E7%82%B9-5"><span class="nav-number">1.6.2.</span> <span class="nav-text">è¦ç‚¹</span></a></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ç‹¬æœ¨èˆŸçš„æœ¨"
      src="https://static01.imgkr.com/temp/88aab3c08a3f43f5a14f21c6c357c816.JPG">
  <p class="site-author-name" itemprop="name">ç‹¬æœ¨èˆŸçš„æœ¨</p>
  <div class="site-description" itemprop="description">ç”Ÿè‹¥ç›´æœ¨ï¼Œä¸è¯­æ–§å‡¿ã€‚</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">310</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FuZHkwNTcw" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Andy0570"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS91c2Vycy83MjY1NDAwL2FuZHkwNTcw" title="StackOverflow â†’ https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;7265400&#x2F;andy0570"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vdS84NGM1ZmFkYzdjMTg=" title="ç®€ä¹¦ â†’ https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;84c5fadc7c18"><i class="heartbeat fa-fw"></i>ç®€ä¹¦</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmFuZHl3aG1AMTYzLmNvbQ==" title="E-Mail â†’ mailto:andywhm@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://static01.imgkr.com/temp/88aab3c08a3f43f5a14f21c6c357c816.JPG">
      <meta itemprop="name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
      <meta itemprop="description" content="ç”Ÿè‹¥ç›´æœ¨ï¼Œä¸è¯­æ–§å‡¿ã€‚">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç‹¬æœ¨èˆŸçš„æœ¨">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ã€ŠEffective Objective-C 2.0ã€‹7. ç³»ç»Ÿæ¡†æ¶
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-08-21 10:56:00" itemprop="dateCreated datePublished" datetime="2017-08-21T10:56:00+08:00">2017-08-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-04-28 15:45:00" itemprop="dateModified" datetime="2019-04-28T15:45:00+08:00">2019-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E3%80%8AEffective-Objective-C-2-0%E3%80%8B/" itemprop="url" rel="index"><span itemprop="name">ã€ŠEffective Objective-C 2.0ã€‹</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>17k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>15 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><img data-src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/073029-1.jpg"></p>
<a id="more"></a>

<h2 id="ç¬¬7ç« -ç³»ç»Ÿæ¡†æ¶"><a href="#ç¬¬7ç« -ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç¬¬7ç«  ç³»ç»Ÿæ¡†æ¶"></a>ç¬¬ 7 ç«  ç³»ç»Ÿæ¡†æ¶</h2><h3 id="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"><a href="#ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"></a>ç¬¬ 47 æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶</h3><p><strong>æ¡†æ¶</strong>ï¼šå°†ä¸€ç³»åˆ—ä»£ç å°è£…ä¸ºåŠ¨æ€åº“ï¼ˆdynamic library)ï¼Œå¹¶åœ¨å…¶ä¸­æ”¾å…¥æè¿°å…¶æ¥å£çš„å¤´æ–‡ä»¶ã€‚</p>
<p><strong>é™æ€åº“</strong>ï¼šæœ‰æ—¶ä¸º iOS å¹³å°æ„å»ºçš„ç¬¬ä¸‰æ–¹æ¡†æ¶æ‰€ä½¿ç”¨çš„æ˜¯é™æ€åº“ï¼ˆstatic library)ï¼Œè¿™æ˜¯å› ä¸º iOS åº”ç”¨ç¨‹åºä¸å…è®¸åœ¨å…¶ä¸­åŒ…å«åŠ¨æ€åº“ã€‚è¿™äº›ä¸œè¥¿ä¸¥æ ¼æ¥è®²å¹¶ä¸æ˜¯çœŸæ­£çš„æ¡†æ¶ï¼Œç„¶è€Œä¹Ÿç»å¸¸è§†ä¸ºæ¡†æ¶ã€‚ä¸è¿‡ï¼Œæ‰€æœ‰ iOS å¹³å°çš„ç³»ç»Ÿæ¡†æ¶ä»ç„¶ä½¿ç”¨åŠ¨æ€åº“ã€‚</p>
<ul>
<li><p><strong>Cocoa</strong>ï¼šåœ¨ä¸º Mac OS X æˆ– iOS ç³»ç»Ÿå¼€å‘ â€œå¸¦å›¾å½¢ç•Œé¢çš„åº”ç”¨ç¨‹åºâ€ï¼ˆgraphical application) æ—¶ï¼Œä¼šç”¨åˆ°åä¸º <strong>Cocoa</strong> çš„æ¡†æ¶ï¼Œåœ¨ iOS ä¸Šç§°ä¸º <strong>Cocoa Touch</strong>ã€‚</p>
</li>
<li><p><strong>Foundation</strong>ï¼šå®ƒæ˜¯æ‰€æœ‰ Objectice-C åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚<strong>Foundation</strong> æ¡†æ¶ä¸­çš„ç±»ä½¿ç”¨ <strong>NS</strong> å‰ç¼€ã€‚</p>
</li>
<li><p><strong>CoreFoundation</strong>ï¼šä»æŠ€æœ¯ä¸Šè®²ï¼Œ<strong>CoreFoundation</strong> æ¡†æ¶ä¸æ˜¯ Objective-C æ¡†æ¶ï¼Œä½†å®ƒå´æ˜¯ç¼–å†™ Objectice-C åº”ç”¨ç¨‹åºæ—¶æ‰€åº”ç†Ÿæ‚‰çš„é‡è¦æ¡†æ¶ï¼Œ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„è®¸å¤šåŠŸèƒ½ï¼Œéƒ½å¯ä»¥åœ¨æ­¤æ¡†æ¶ä¸­æ‰¾åˆ°å¯¹åº”çš„ C è¯­è¨€ APIã€‚</p>
<blockquote>
<p><strong>æ— ç¼æ¡¥æ¥</strong>ï¼ˆtoll- free bridging ) åŠŸèƒ½:</p>
<p>æŠŠ <strong>CoreFoundation</strong> ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„å¹³æ»‘è½¬æ¢ä¸º <strong>Foundation</strong> ä¸­çš„ Objective-C å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åå‘è½¬æ¢ã€‚</p>
<p>æ— ç¼æ¡¥æ¥æŠ€æœ¯æ‰€å®ç°çš„ä»£ç å¯ä»¥ä½¿è¿è¡ŒæœŸç³»ç»ŸæŠŠ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„å¯¹è±¡è§†ä¸ºæ™®é€šçš„ Objective-C å¯¹è±¡ã€‚</p>
<p>ä¾‹å¦‚ï¼šNSString  &lt;â€”&gt; CFString</p>
</blockquote>
</li>
<li><p><strong>CFNetwork</strong>ï¼šæ­¤æ¡†æ¶æä¾›äº† C è¯­è¨€çº§åˆ«çš„ç½‘ç»œé€šä¿¡èƒ½åŠ›ï¼Œå®ƒå°† <strong>BSD å¥—æ¥å­—</strong>ï¼ˆBSD socketï¼‰æŠ½è±¡æˆæ˜“äºä½¿ç”¨çš„ç½‘ç»œæ¥å£ã€‚è€Œ <strong>Foundation</strong> åˆ™å°†è¯¥æ¡†æ¶é‡Œçš„éƒ¨åˆ†å†…å®¹å°è£…ä¸º Objective-C è¯­è¨€çš„æ¥å£ï¼Œä»¥ä¾¿è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œä¾‹å¦‚å¯ä»¥ç”¨ <strong>NSURLConnection</strong> ä» URL ä¸­ä¸‹è½½æ•°æ®ã€‚</p>
</li>
<li><p><strong>CoreAudio</strong>ï¼šè¯¥æ¡†æ¶æ‰€æä¾›çš„ C è¯­è¨€ API å¯ç”¨æ¥æ“ä½œè®¾å¤‡ä¸Šçš„éŸ³é¢‘ç¡¬ä»¶ã€‚è¿™ä¸ªæ¡†æ¶å±äºæ¯”è¾ƒéš¾ç”¨çš„é‚£ç§ï¼Œå› ä¸ºéŸ³é¢‘å¤„ç†æœ¬èº«å°±å¾ˆå¤æ‚ã€‚æ‰€å¹¸ç”±è¿™å¥— API å¯ä»¥æŠ½è±¡å‡ºå¦å¤–ä¸€ å¥— Objective-C å¼ APIï¼Œç”¨åè€…æ¥å¤„ç†éŸ³é¢‘é—®é¢˜ä¼šæ›´ç®€å•äº›ã€‚</p>
</li>
<li><p><strong>AVFoundation</strong>ï¼šæ­¤æ¡†æ¶æ‰€æä¾›çš„ Objective-C å¯¹è±¡å¯ç”¨æ¥å›æ”¾å¹¶å½•åˆ¶éŸ³é¢‘åŠè§†é¢‘ï¼Œæ¯”å¦‚èƒ½å¤Ÿåœ¨ UI è§†å›¾ç±»é‡Œæ’­æ”¾è§†é¢‘ã€‚</p>
</li>
<li><p><strong>CoreData</strong>ï¼šæ­¤æ¡†æ¶æ‰€æä¾›çš„ Objective-C æ¥å£å¯å°†å¯¹è±¡æ”¾äººæ•°æ®åº“ï¼Œä¾¿äºæŒä¹…ä¿å­˜ã€‚ <strong>CoreData</strong> ä¼šå¤„ç†æ•°æ®çš„è·å–åŠå­˜å‚¨äº‹å®œï¼Œè€Œä¸”å¯ä»¥è·¨è¶Š Mac OS X åŠ iOS å¹³å°ã€‚</p>
</li>
<li><p><strong>CoreText</strong>ï¼šæ­¤æ¡†æ¶æä¾›çš„ C è¯­è¨€æ¥å£å¯ä»¥é«˜æ•ˆæ‰§è¡Œæ–‡å­—æ’ç‰ˆåŠæ¸²æŸ“æ“ä½œã€‚</p>
</li>
</ul>
<p>Objective-C ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§ï¼šç»å¸¸éœ€è¦ä½¿ç”¨åº•å±‚çš„ C è¯­è¨€çº§ APIã€‚ç”¨ C è¯­è¨€æ¥å®ç° API çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥ç»•è¿‡ Objective-C çš„è¿è¡ŒæœŸç³»ç»Ÿï¼Œä»è€Œæå‡æ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p>è¯»è€…å¯èƒ½ä¼šç¼–å†™ä½¿ç”¨ UI æ¡†æ¶çš„ Mac OS X æˆ– iOS åº”ç”¨ç¨‹åºã€‚è¿™ä¸¤ä¸ªå¹³å°çš„æ ¸å¿ƒ UI æ¡†æ¶åˆ†åˆ«å«åš <strong>AppKit</strong> åŠ <strong>UIKit</strong> , å®ƒä»¬éƒ½æä¾›äº†æ„å»ºåœ¨ <strong>Foundation</strong> ä¸ <strong>CoreFoundation</strong> ä¹‹ä¸Šçš„ Objective-C ç±»ã€‚æ¡†æ¶é‡Œå«æœ‰ UI å…ƒç´ ï¼Œä¹Ÿå«æœ‰ç²˜åˆæœºåˆ¶ï¼Œä»¤å¼€å‘è€…å¯å°†æ‰€æœ‰ç›¸å…³å†…å®¹ç»„è£…ä¸ºåº”ç”¨ç¨‹åºã€‚åœ¨è¿™äº›ä¸»è¦çš„ UI æ¡†æ¶ä¹‹ä¸‹ï¼Œæ˜¯ <strong>CoreAnimation</strong> ä¸ <strong>CoreGraphics</strong> æ¡†æ¶ã€‚</p>
<ul>
<li><strong>CoreAnimation</strong> æ˜¯ç”¨ Objective-C è¯­è¨€å†™æˆçš„ï¼Œå®ƒæä¾›äº†ä¸€äº›å·¥å…·ï¼Œè€Œ UI æ¡†æ¶åˆ™ç”¨è¿™äº›å·¥å…·æ¥æ¸²æŸ“å›¾å½¢å¹¶æ’­æ”¾åŠ¨ç”»ã€‚å¼€å‘è€…ç¼–ç¨‹æ—¶å¯èƒ½ä»æ¥ä¸ä¼šæ·±å…¥åˆ°è¿™ç§çº§åˆ«ï¼Œä¸è¿‡çŸ¥é“è¯¥æ¡†æ¶æ€»æ˜¯å¥½çš„ã€‚<strong>CoreAnimation</strong> æœ¬èº«å¹¶ä¸æ˜¯æ¡†æ¶ï¼Œå®ƒæ˜¯ <strong>QuartzCore</strong> æ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œåœ¨æ¡†æ¶çš„å›½åº¦é‡Œï¼Œ<strong>CoreAnimation</strong> ä»åº”ç®—ä½œ â€œä¸€ç­‰å…¬æ°‘â€ï¼ˆfirst-class citizen)ã€‚</li>
<li><strong>CoreGraphics</strong> æ¡†æ¶ä»¥ C è¯­è¨€å†™æˆï¼Œå…¶ä¸­æä¾›äº† 2D æ¸²æŸ“æ‰€å¿…å¤‡çš„æ•°æ®ç»“æ„ä¸å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå…¶ä¸­å®šä¹‰äº† CGPointã€CGSizeã€CGRect ç­‰æ•°æ®ç»“æ„ï¼Œè€Œ <strong>UllKit</strong> æ¡†æ¶ä¸­çš„ <strong>UlView</strong> ç±»åœ¨ç¡®å®šè§†å›¾æ§ä»¶ä¹‹é—´çš„ç›¸å¯¹ä½ç½®æ—¶ï¼Œè¿™äº›æ•°æ®ç»“æ„éƒ½è¦ç”¨åˆ°ã€‚</li>
</ul>
<p>è¿˜æœ‰å¾ˆå¤šæ¡†æ¶æ„å»ºåœ¨ UI æ¡†æ¶ä¹‹ä¸Šï¼Œæ¯”æ–¹è¯´ <strong>MapKit</strong> æ¡†æ¶ï¼Œå®ƒå¯ä»¥ä¸º iOS ç¨‹åºæä¾›åœ°å›¾åŠŸèƒ½ã€‚åˆæ¯”å¦‚ <strong>Social</strong> æ¡†æ¶ï¼Œå®ƒä¸º Mac OS X åŠ iOS ç¨‹åºæä¾›äº†ç¤¾äº¤ç½‘ç»œï¼ˆsocial networking) åŠŸèƒ½ã€‚å¼€å‘è€…é€šå¸¸ä¼šå°†è¿™äº›æ¡†æ¶ä¸æ“ä½œç³»ç»Ÿå¹³å°æ‰€å¯¹åº”çš„æ ¸å¿ƒ UI æ¡†æ¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè®¸å¤šæ¡†æ¶éƒ½æ˜¯å®‰è£… Mac OS X ä¸ iOS ç³»ç»Ÿæ—¶çš„æ ‡å‡†é…ç½®ã€‚æ‰€ä»¥ï¼Œåœ¨æ‰“ç®—ç¼–å†™æ–°çš„å·¥å…·ç±»ä¹‹å‰ï¼Œæœ€å¥½åœ¨ç³»ç»Ÿæ¡†æ¶é‡Œæœä¸€ä¸‹ï¼Œé€šå¸¸éƒ½æœ‰å†™å¥½çš„ç±»å¯ä¾›ç›´æ¥ä½¿ç”¨ã€‚</p>
<h4 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>è®¸å¤šç³»ç»Ÿæ¡†æ¶éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯ <strong>Foundation</strong> ä¸ <strong>CoreFoundation</strong>ï¼Œè¿™ä¸¤ä¸ªæ¡†æ¶æä¾›äº†æ„å»ºåº”ç”¨ç¨‹åºæ‰€éœ€çš„è®¸å¤šæ ¸å¿ƒåŠŸèƒ½ã€‚</li>
<li>å¾ˆå¤šå¸¸è§ä»»åŠ¡éƒ½èƒ½ç”¨æ¡†æ¶æ¥åšï¼Œä¾‹å¦‚éŸ³é¢‘ä¸è§†é¢‘å¤„ç†ã€ç½‘ç»œé€šä¿¡ã€æ•°æ®ç®¡ç†ç­‰ã€‚</li>
</ul>
<ul>
<li>è¯·è®°ä½ï¼Œ<strong>ç”¨çº¯ C å†™æˆçš„æ¡†æ¶ä¸ç”¨ Objective-C å†™æˆçš„ä¸€æ ·é‡è¦ï¼Œè‹¥æƒ³æˆä¸ºä¼˜ç§€çš„ Objective-C å¼€å‘è€…ï¼Œåº”è¯¥æŒæ¡ C è¯­è¨€çš„æ ¸å¿ƒæ¦‚å¿µ</strong>ã€‚</li>
</ul>
<h3 id="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨-for-å¾ªç¯"><a href="#ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨-for-å¾ªç¯" class="headerlink" title="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯"></a>ç¬¬ 48 æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨ for å¾ªç¯</h3><p>å®ç°æšä¸¾çš„æ–¹æ³•ï¼š</p>
<ol>
<li>æ ‡å‡†çš„ C è¯­è¨€å¾ªç¯ï¼›</li>
<li>Objective-C 1.0 çš„ <strong>NSEnumerator</strong> æ–¹æ³•ï¼›</li>
<li>Objective-C 2.0 çš„å¿«é€Ÿéå†æ³•ï¼ˆfast enumeration)ã€‚</li>
<li>åŸºäºå—çš„éå†æ–¹å¼ã€‚</li>
</ol>
<h4 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h4><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
NSArray *array;
for (int i = 0; i &lt; array.count; i++) {
    id object = array[i];
    // Do something with 'object'
}

/** NSDictionary */
NSDictionary *dictionary;
NSArray *keys = [dictionary allKeys];
for (int i = 0; i &lt; keys.count; i++) {
    id key = keys[i];
    id value = dictionary[key];
    // Do something with 'key' and 'value'
}

/** NSSet */
NSSet *set;
NSArray *objects = [set allObjects];
for (int i = 0; i &lt; objects.count; i++) {
    id object = object[i];
    // Do something with 'object'
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>æ ¹æ®å®šä¹‰ï¼Œå­—å…¸ä¸ set éƒ½æ˜¯ â€œæ— åºçš„â€ï¼ˆimoniered)ï¼Œæ‰€ä»¥æ— æ³•æ ¹æ®ç‰¹å®šçš„æ•´æ•°ä¸‹æ ‡æ¥ç›´æ¥è®¿é—®å…¶ä¸­çš„å€¼ã€‚äºæ˜¯ï¼Œå°±éœ€è¦å…ˆè·å–å­—å…¸é‡Œçš„æ‰€æœ‰é”®æˆ–æ˜¯ set é‡Œçš„æ‰€æœ‰å¯¹è±¡ï¼Œè¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥åœ¨è·å–åˆ°çš„æœ‰åºæ•°ç»„ä¸Šéå†ï¼Œä»¥ä¾¿å€Ÿæ­¤è®¿é—®åŸå­—å…¸åŠåŸ set ä¸­çš„å€¼ã€‚åˆ›å»ºè¿™ä¸ªé™„åŠ æ•°ç»„ä¼šæœ‰é¢å¤–å¼€é”€ï¼Œè€Œä¸”è¿˜ä¼šå¤šåˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå®ƒä¼šä¿ç•™ collection ä¸­çš„æ‰€æœ‰å…ƒç´ å¯¹è±¡ã€‚</p>
</blockquote>
<h4 id="ä½¿ç”¨-Objective-C-1-0-çš„-NSEnumerator-éå†"><a href="#ä½¿ç”¨-Objective-C-1-0-çš„-NSEnumerator-éå†" class="headerlink" title="ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†"></a>ä½¿ç”¨ Objective-C 1.0 çš„ NSEnumerator éå†</h4><p><strong>NSEnumerator.h</strong></p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">typedef struct {
    unsigned long state;
    id __unsafe_unretained _Nullable * _Nullable itemsPtr;
    unsigned long * _Nullable mutationsPtr;
    unsigned long extra[5];
} NSFastEnumerationState;

@protocol NSFastEnumeration

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(id __unsafe_unretained _Nullable [_Nonnull])buffer count:(NSUInteger)len;

@end

@interface NSEnumerator&lt;ObjectType&gt; : NSObject &lt;NSFastEnumeration&gt;

//â‡ï¸ è¿”å›æšä¸¾é‡Œçš„ä¸‹ä¸ªå¯¹è±¡ã€‚æ¯æ¬¡è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå…¶å†…éƒ¨æ•°æ®ç»“æ„éƒ½ä¼šæ›´æ–°ï¼Œä½¿å¾—ä¸‹æ¬¡è°ƒç”¨æ–¹æ³•æ—¶èƒ½è¿”å›ä¸‹ä¸ªå¯¹è±¡ã€‚ç­‰åˆ°æšä¸¾ä¸­çš„å…¨éƒ¨å¯¹è±¡éƒ½å·²è¿”å›ä¹‹åï¼Œå†è°ƒç”¨å°±å°†è¿”å›nilï¼Œè¿™è¡¨ç¤ºè¾¾åˆ°æšä¸¾æœ«ç«¯äº†ã€‚
- (nullable ObjectType)nextObject;

@end

@interface NSEnumerator&lt;ObjectType&gt; (NSExtendedEnumerator)

@property (readonly, copy) NSArray&lt;ObjectType&gt; *allObjects;

@end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
NSArray *array;
NSEnumerator *enumerator = [array objectEnumerator];
id object;
while ((object = [enumerator nextObject]) != nil) {
    // Do something with 'object'
}

/** NSDictionary */
NSDictionary *dictionary;
NSEnumerator *enumerator = [dictionary keyEnumerator];
id key;
while ((key = [enumerator nextObject]) != nil) {
    id value = dictionary[key];
    // Do something with 'key' and 'value'
}

/** NSSet */
NSSet *set;
NSEnumerator *enumerator = [set objectEnumerator];
id object;
while ((object = [enumerator nextObject]) != nil) {
    // Do something with 'object'
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>ä¼˜ç‚¹ï¼šä¸è®ºéå†å“ªç§ collectionï¼Œéƒ½å¯ä»¥é‡‡ç”¨è¿™å¥—ç›¸ä¼¼çš„è¯­æ³•ã€‚</p>
</li>
<li><p><strong>NSEnumerator</strong> è¿˜æœ‰å¤šç§ â€œæšä¸¾å™¨â€ï¼ˆenumerator) å¯ä¾›ä½¿ç”¨ï¼Œå¦‚åå‘éå†æ•°ç»„ï¼š</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
NSArray *array;
// reverseObjectEnumeratorï¼šåå‘éå†æ•°ç»„
NSEnumerator *enumerator = [array reverseObjectEnumerator];
id object;
while ((object = [enumerator nextObject]) != nil) {
  // Do something with 'object'
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</li>
</ul>
<h4 id="å¿«é€Ÿéå†"><a href="#å¿«é€Ÿéå†" class="headerlink" title="å¿«é€Ÿéå†"></a>å¿«é€Ÿéå†</h4><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
NSArray *array;
for (id object in array) {
    // Do something with 'object'
}

/** NSDictionary */
NSDictionary *dictionary;
for (id key in dictionary) {
    id value = dictionary[key];
    // Do something with 'key' and 'value'
}

/** NSSet */
NSSet *set;
for (id object in set) {
    // Do something with 'object'
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæŸä¸ªç±»çš„å¯¹è±¡æ”¯æŒå¿«é€Ÿéå†ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®£ç§°è‡ªå·±éµä»åä¸º <strong>NSFastEmimeraticm</strong> çš„åè®®ï¼Œä»è€Œä»¤å¼€å‘è€…å¯ä»¥é‡‡ç”¨æ­¤è¯­æ³•æ¥è¿­ä»£è¯¥å¯¹è±¡ã€‚</p>
<p><strong>è¯¥æ–¹æ³•å…è®¸ç±»å®ä¾‹åŒæ—¶è¿”å›å¤šä¸ªå¯¹è±¡ï¼Œä½¿å¾—å¾ªç¯éå†æ“ä½œæ›´ä¸ºé«™æ•ˆã€‚</strong></p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">@protocol NSFastEnumeration

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state
                                  objects:(id __unsafe_unretained _Nullable [_Nonnull])buffer
                                    count:(NSUInteger)len;

@end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åŸºäºå—çš„éå†æ–¹å¼"><a href="#åŸºäºå—çš„éå†æ–¹å¼" class="headerlink" title="åŸºäºå—çš„éå†æ–¹å¼"></a>åŸºäºå—çš„éå†æ–¹å¼</h4><p><strong>æ–¹æ³•åˆ—è¡¨</strong>:</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
- (void)enumerateObjectsUsingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;
- (void)enumerateObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;
- (void)enumerateObjectsAtIndexes:(NSIndexSet *)s options:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, NSUInteger idx, BOOL *stop))block;

/** NSDictionary */
- (void)enumerateKeysAndObjectsUsingBlock:(void (NS_NOESCAPE ^)(KeyType key, ObjectType obj, BOOL *stop))block;
- (void)enumerateKeysAndObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(KeyType key, ObjectType obj, BOOL *stop))block;

/** NSSet */
- (void)enumerateObjectsUsingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, BOOL *stop))block;
- (void)enumerateObjectsWithOptions:(NSEnumerationOptions)opts usingBlock:(void (NS_NOESCAPE ^)(ObjectType obj, BOOL *stop))block;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">/** NSArray */
NSArray *array;
[array enumerateObjectsUsingBlock:^(id  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
    // Do something with 'object'
    if (shouldStop) {
        *stop = YES;
    }
}];

/** NSDictionary */
NSDictionary *dictionary;
[dictionary enumerateKeysAndObjectsUsingBlock:^(id  _Nonnull key, id  _Nonnull obj, BOOL * _Nonnull stop) {
    // Do something with 'key' and 'value'
    if (shouldStop) {
        *stop = YES;
    }
}];

/** NSSet */
NSSet *set;
[set enumerateObjectsUsingBlock:^(id  _Nonnull obj, BOOL * _Nonnull stop) {
    // Do something with 'object'
    if (shouldStop) {
        *stop = YES;
    }
}];<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ–¹å¼çš„ä¼˜ç‚¹ï¼š</p>
<ol>
<li><p>éå†æ—¶å¯ä»¥ç›´æ¥ä»å—é‡Œè·å–æ›´å¤šä¿¡æ¯ã€‚</p>
</li>
<li><p>èƒ½å¤Ÿä¿®æ”¹å—çš„æ–¹æ³•ç­¾åï¼Œä»¥å…è¿›è¡Œç±»å‹è½¬æ¢æ“ä½œï¼Œä»æ•ˆæœä¸Šè®²ï¼Œç›¸å½“äºæŠŠæœ¬æ¥éœ€è¦æ‰§è¡Œçš„ç±»å‹è½¬æ¢æ“ä½œäº¤ç»™å—æ–¹æ³•ç­¾åæ¥åšã€‚</p>
<p>&lt;!â€“hexoPostRenderEscape:</p><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">// for-in éå†ï¼š<br>NSDictionary *dictionary;<br>for (NSString *key in dictionary) {<br> NSString *object = (NSString *)dictionary[key];<br> // Do something with 'key' and 'value'<br>}<p></p>
</code></pre></li><code class="language-objective-c">
</code></ol><code class="language-objective-c">
</code><p><code class="language-objective-c">// åŸºäºå—çš„éå†ï¼Œå¯ä»¥åœ¨å—æ–¹æ³•ç­¾åä¸­ç›´æ¥è½¬æ¢æ•°æ®ç±»å‹ï¼š<br>[dictionary enumerateKeysAndObjectsUsingBlock:^(NSString *key, NSString *obj, BOOL *stop) {<br>    // Do something with 'key' and 'value'<br>}];<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code>:hexoPostRenderEscapeâ€“&gt;</p>
<ol start="3">
<li><p>åå‘éå†ï¼šè®¾ç½® <strong>NSEnumerationOptions</strong> é€‰é¡¹ä¸º <code>NSEnumerationReverse</code>ã€‚</p>
</li>
<li><p>å¹¶è¡Œæ‰§è¡Œï¼šè®¾ç½® <strong>NSEnumerationOptions</strong> é€‰é¡¹ä¸º <code>NSEnumerationConcurrent</code>ã€‚</p>
</li>
</ol>
<h4 id="è¦ç‚¹-1"><a href="#è¦ç‚¹-1" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>éå† collection æœ‰ 4 ç§æ–¹å¼ã€‚æœ€åŸºæœ¬çš„åŠæ³•æ˜¯ <strong>for å¾ªç¯</strong>ï¼Œå…¶æ¬¡æ˜¯ <strong>NSEnumerator</strong> éå†æ–¹æ³•åŠ<strong>å¿«é€Ÿéå†æ³•</strong>ï¼Œæœ€æ–°ã€æœ€å…ˆè¿›çš„æ–¹å¼åˆ™æ˜¯ <strong>å—æšä¸¾æ³•</strong>ã€‚</li>
<li><strong>å—æšä¸¾æ³•</strong> æœ¬èº«å°±èƒ½é€šè¿‡ GCD æ¥å¹¶å‘æ‰§è¡Œéå†æ“ä½œï¼Œæ— éœ€å¦è¡Œç¼–å†™ä»£ç ã€‚è€Œé‡‡ç”¨å…¶ä»–éå†æ–¹å¼åˆ™æ— æ³•è½»æ˜“å®ç°è¿™ä¸€ç‚¹ã€‚</li>
<li>è‹¥æå‰çŸ¥é“å¾…éå†çš„ collection å«æœ‰ä½•ç§å¯¹è±¡ï¼Œåˆ™åº”ä¿®æ”¹å—ç­¾åï¼ŒæŒ‡å‡ºå¯¹è±¡çš„å…·ä½“ç±»å‹ã€‚</li>
</ul>
<h3 id="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„-collection-ä½¿ç”¨æ— ç¼æ¡¥æ¥"><a href="#ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„-collection-ä½¿ç”¨æ— ç¼æ¡¥æ¥" class="headerlink" title="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥"></a>ç¬¬ 49 æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„ collection ä½¿ç”¨æ— ç¼æ¡¥æ¥</h3><p><strong>æ— ç¼æ¡¥æ¥</strong>ï¼šå¯ä»¥åœ¨å®šä¹‰äº <strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C ç±»å’Œå®šä¹‰äº <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C æ•°æ®ç»“æ„ä¹‹é—´äº’ç›¸è½¬æ¢ã€‚</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">// NSArray â†’ CFArray
NSArray *anNSArray = @[@1, @2, @3, @4, @5];
// CFArray éœ€è¦é€šè¿‡ CFArrayRef æ¥å¼•ç”¨ï¼Œ
// CFArrayRef æ˜¯æŒ‡å‘ struct__CFArray çš„æŒ‡é’ˆ
CFArrayRef aCFArray = (__bridge CFArrayRef)anNSArray;
NSLog(@"Size of array = %li", CFArrayGetCount(aCFArray));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="æ¡¥å¼è½¬æ¢"><a href="#æ¡¥å¼è½¬æ¢" class="headerlink" title="æ¡¥å¼è½¬æ¢"></a>æ¡¥å¼è½¬æ¢</h4><ul>
<li><code>__bridge</code> å‘Šè¯‰ ARC (å‚è§ç¬¬ 30 æ¡ï¼‰å¦‚ä½•å¤„ç†è½¬æ¢æ‰€æ¶‰åŠçš„ Objective-C å¯¹è±¡ã€‚</li>
<li><code>__bridge</code> æœ¬èº«çš„æ„æ€æ˜¯ï¼šARC ä»ç„¶å…·å¤‡è¿™ä¸ª Objective-C å¯¹è±¡çš„æ‰€æœ‰æƒã€‚è€Œ <code>__bridge_ retained</code> åˆ™ä¸ä¹‹ç›¸åï¼Œæ„å‘³ç€ ARC å°†äº¤å‡ºå¯¹è±¡çš„æ‰€æœ‰æƒã€‚</li>
<li>åå‘è½¬æ¢å¯é€šè¿‡ <code>__bridge_transfer</code> æ¥å®ç°ã€‚</li>
</ul>
<h4 id="éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š"><a href="#éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š" class="headerlink" title="éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š"></a>éœ€è¦ä½¿ç”¨æ— ç¼æ¡¥æ¥çš„åŸå› ï¼š</h4><ul>
<li><p><strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C ç±»æ‰€å…·å¤‡çš„æŸäº›åŠŸèƒ½ï¼Œæ˜¯ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„æ‰€ä¸å…·å¤‡çš„ã€‚</p>
</li>
<li><p>åœ¨ä½¿ç”¨ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„å­—å…¸å¯¹è±¡æ—¶ä¼šé‡åˆ°ä¸€ä¸ªå¤§é—®é¢˜ï¼Œé‚£å°±æ˜¯å…¶é”®çš„å†…å­˜ç®¡ç†è¯­ä¹‰ä¸º â€œæ‹·è´â€ï¼Œè€Œå€¼çš„è¯­ä¹‰å´æ˜¯ â€œä¿ç•™â€ã€‚é™¤éä½¿ç”¨å¼ºå¤§çš„æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¦åˆ™æ— æ³•æ”¹å˜å…¶è¯­ä¹‰ã€‚</p>
<p>åˆ›å»º <strong>CFMutableDictionary</strong> æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹åˆ—æ–¹æ³•æ¥æŒ‡å®šé”®å’Œå€¼çš„å†…å­˜ç®¡ç†è¯­ä¹‰:</p>
</li>
</ul>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">CFMutableDictionaryRef CFDictionaryCreateMutable(
    CFAllocatorRef allocator,
    CFIndex capacity,
    const CFDictionaryKeyCallBacks *keyCallBacks,
    const CFDictionaryValueCallBacks *valueCallBacks
);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><code>CFAllocatorRef</code>ï¼šå°†è¦ä½¿ç”¨çš„å†…å­˜åˆ†é…å™¨ï¼ˆallocator) ã€‚<strong>CoreFoundation</strong> å¯¹è±¡é‡Œçš„æ•°æ®ç»“æ„éœ€è¦å ç”¨å†…å­˜ï¼Œè€Œåˆ†é…å™¨è´Ÿè´£åˆ†é…åŠå›æ”¶è¿™äº›å†…å­˜ã€‚å¼€å‘è€…é€šå¸¸ä¸ºè¿™ä¸ªå‚æ•°ä¼ äºº <strong>NULL</strong>ï¼Œè¡¨ç¤ºé‡‡ç”¨é»˜è®¤çš„åˆ†é…å™¨ã€‚</p>
</li>
<li><p><code>CFIndex</code>ï¼šå®šä¹‰å­—å…¸çš„åˆå§‹å¤§å°ã€‚å®ƒå¹¶ä¸ä¼šé™åˆ¶å­—å…¸çš„æœ€å¤§å®¹æ™¯ï¼Œåªæ˜¯å‘åˆ†é…å™¨æç¤ºä¸€å¼€å§‹åº”è¯¥åˆ†é…å¤šå°‘å†…å­˜ã€‚å‡å¦‚è¦åˆ›å»ºçš„å­—å…¸å«æœ‰ 10 ä¸ªå¯¹è±¡ï¼Œé‚£å°±å‘è¯¥å‚æ•°ä¼ å…¥ 10ã€‚</p>
</li>
<li><p>æœ€åä¸¤ä¸ªå‚æ•°å€¼å¾—æ³¨æ„ã€‚å®ƒä»¬å®šä¹‰äº†è®¸å¤šå›è°ƒå‡½æ•°ï¼Œç”¨äºæŒ‡ç¤ºå­—å…¸ä¸­çš„é”®å’Œå€¼åœ¨é‡åˆ°å„ç§äº‹ä»¶æ—¶åº”è¯¥æ‰§è¡Œä½•ç§æ“ä½œã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼ŒäºŒè€…æ‰€å¯¹åº”çš„ç»“æ„ä½“å¦‚ä¸‹ï¼š</p>
<p>&lt;!â€“hexoPostRenderEscape:</p><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">typedef struct {<br>  CFIndex                version;<br>  CFDictionaryRetainCallBack        retain;<br>  CFDictionaryReleaseCallBack        release;<br>  CFDictionaryCopyDescriptionCallBack    copyDescription;<br>  CFDictionaryEqualCallBack        equal;<br>  CFDictionaryHashCallBack        hash;<br>} CFDictionaryKeyCallBacks;<p></p>
</code></pre></li><code class="language-objective-c">
</code></ul><code class="language-objective-c">
<p>typedef struct {<br>    CFIndex                version;<br>    CFDictionaryRetainCallBack        retain;<br>    CFDictionaryReleaseCallBack        release;<br>    CFDictionaryCopyDescriptionCallBack    copyDescription;<br>    CFDictionaryEqualCallBack        equal;<br>} CFDictionaryValueCallBacks;</p>
<p>/*</p>
</code><ul><code class="language-objective-c">
<li><p>versionå‚æ•°ç›®å‰åº”è®¾ä¸º0ã€‚å½“å‰ç¼–ç¨‹æ—¶æ€»æ˜¯å–è¿™ä¸ªå€¼ï¼Œä¸è¿‡å°†æ¥è‹¹æœå…¬å¸ä¹Ÿè®¸ä¼šä¿®æ”¹æ­¤ç»“æ„ä½“ï¼Œæ‰€ä»¥</p>
</li>
<li><p>è¦é¢„ç•™è¯¥å€¼ä»¥è¡¨ç¤ºç‰ˆæœ¬å·ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥ç”¨äºæ£€æµ‹æ–°ç‰ˆä¸æ—§ç‰ˆæ•°æ®ç»“æ„ä¹‹é—´æ˜¯å¦å…¼å®¹ã€‚</p>
</li>
<li><p>ç»“æ„ä½“ä¸­çš„å…¶ä½™æˆå‘˜éƒ½æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œå®ƒä»¬å®šä¹‰äº†å½“å„ç§äº‹ä»¶å‘ç”Ÿæ—¶åº”è¯¥é‡‡ç”¨å“ªä¸ªå‡½æ•°æ¥æ‰§è¡Œç›¸å…³ä»»åŠ¡ã€‚</p>
</li>
</code><li><code class="language-objective-c"></code><p><code class="language-objective-c">/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code>:hexoPostRenderEscapeâ€“&gt;</p>
<blockquote>
<p>åº•å±‚å®ç°æœ‰ç‚¹å¤æ‚ï¼Œæš‚ç¼“ç ”ç©¶ğŸ˜‚</p>
</blockquote>
</li>
</ul>
<h4 id="è¦ç‚¹-2"><a href="#è¦ç‚¹-2" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>é€šè¿‡æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ <strong>Foundation</strong> æ¡†æ¶ä¸­çš„ Objective-C å¯¹è±¡ä¸ <strong>CoreFoundation</strong> æ¡†æ¶ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„ä¹‹å‰æ¥å›è½¬æ¢ã€‚</li>
<li>åœ¨ <strong>CoreFoundation</strong> å±‚é¢åˆ›å»º collection æ—¶ï¼Œå¯ä»¥æŒ‡å®šè®¸å¤šå›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¡¨ç¤ºæ­¤ collection åº”å¦‚ä½•å¤„ç†å…¶å…ƒç´ ã€‚ç„¶åï¼Œå¯è¿ç”¨æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå°†å…¶è½¬æ¢æˆå…·å¤‡ç‰¹æ®Šå†…å­˜ç®¡ç†è¯­ä¹‰çš„ Objective-C collectionã€‚</li>
</ul>
<h3 id="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary"><a href="#ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary" class="headerlink" title="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary"></a>ç¬¬ 50 æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary</h3><ul>
<li><strong>NSCache</strong> èƒœè¿‡ <strong>NSDictionary</strong> ä¹‹å¤„åœ¨äºï¼Œå½“ç³»ç»Ÿèµ„æºå°†è¦è€—å°½æ—¶ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åˆ å‡ç¼“å­˜ã€‚</li>
<li><strong>NSCache</strong> è¿˜ä¼šå…ˆè¡Œåˆ å‡ <strong>æœ€ä¹…æœªä½¿ç”¨çš„ï¼ˆlease recently used) å¯¹è±¡</strong>ã€‚</li>
<li><strong>NSCache</strong> å¹¶ä¸ä¼š â€œæ‹·è´â€ é”®ï¼Œè€Œæ˜¯ä¼š â€œä¿ç•™â€ å®ƒã€‚åŸå› åœ¨äºï¼Œå¾ˆå¤šæ—¶å€™ï¼Œé”®éƒ½æ˜¯ç”±ä¸æ”¯æŒæ‹·è´æ“ä½œçš„å¯¹è±¡æ¥å……å½“çš„ã€‚</li>
<li><strong>NSCache</strong> æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚åœ¨å¼€å‘è€…è‡ªå·±ä¸ç¼–å†™åŠ é”ä»£ç çš„å‰æä¸‹ï¼Œ å¤šä¸ªçº¿ç¨‹ä¾¿å¯ä»¥åŒæ—¶è®¿é—® <strong>NSCache</strong>ã€‚å¯¹ç¼“å­˜æ¥è¯´ï¼Œçº¿ç¨‹å®‰å…¨é€šå¸¸å¾ˆé‡è¦ï¼Œå› ä¸ºå¼€å‘è€…å¯èƒ½è¦åœ¨æŸä¸ªçº¿ç¨‹ä¸­è¯»å–æ•°æ®ï¼Œæ­¤æ—¶å¦‚æœå‘ç°ç¼“å­˜é‡Œæ‰¾ä¸åˆ°æŒ‡å®šçš„é”®ï¼Œé‚£ä¹ˆå°±è¦ä¸‹è½½è¯¥é”®æ‰€å¯¹åº”çš„æ•°æ®äº†ã€‚è€Œä¸‹è½½å®Œæ•°æ®ä¹‹åæ‰€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½ä¼šæ”¾åœ¨èƒŒæ™¯çº¿ç¨‹ä¸­è¿è¡Œï¼Œè¿™æ ·çš„è¯ï¼Œå°±ç­‰äºæ˜¯ç”¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¥å†™å…¥ç¼“å­˜äº†ã€‚</li>
<li>å¼€å‘è€…å¯ä»¥æ“æ§ç¼“å­˜åˆ å‡å…¶å†…å®¹çš„æ—¶æœºã€‚æœ‰ä¸¤ä¸ªä¸ç³»ç»Ÿèµ„æºç›¸å…³çš„å°ºåº¦å¯ä¾›è°ƒæ•´ï¼Œå…¶ä¸€æ˜¯ç¼“å­˜ä¸­çš„å¯¹è±¡æ€»æ•°ï¼Œå…¶äºŒæ˜¯æ‰€æœ‰å¯¹è±¡çš„ â€œæ€»å¼€é”€â€ï¼ˆoverall cost)ã€‚</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">// EOCNetworkFetcher.h
#import &lt;Foundation/Foundation.h&gt;

// Network fetcher class
typedef void(^EOCNetworkFetcherCompletionHandler)
                                (NSData *data);

@interface EOCNetworkFetcher : NSObject
@property (nonatomic, strong, readonly) NSURL *url;
- (instancetype)initWithURL:(NSURL *)url;
- (void)startWithCompletionHandler:
            (EOCNetworkFetcherCompletionHandler)completion;
@end

// EOCNetworkFetcher.m
#import "EOCNetworkFetcher.h"

@implementation EOCNetworkFetcher {
    NSCache *_cache;
}

- (instancetype)init {
    if (self = [super init]) {
        _cache = [NSCache new];

        // Cache a maximu of 100 URLs
        // å¯ç¼“å­˜çš„æ€»å¯¹è±¡æ•°ç›®ä¸Šé™
        _cache.countLimit = 100;

        /**
         * The size in bytes of data is used as the cost,
         * å¼€é”€å€¼ ä»¥ å­—èŠ‚ ä¸ºå•ä½
         * so this sets a cost limit of 5MB
         * å› æ­¤éœ€è¦å°† MB æ¢ç®—ä¸º å­—èŠ‚
         */
        _cache.totalCostLimit = 5 * 1024 * 1024;
    }
    return self;
}

- (instancetype)initWithURL:(NSURL *)url {
    if (self = [super init]) {
        _url = url;
    }
    return self;
}

- (void)downloadDataForURL:(NSURL *)url {
    NSData *cacheData = [_cache objectForKey:url];
    if (cacheData) {
        // Cache hit
        [self useData:cacheData];
    }else {
        // Cache miss,ç¼“å­˜ä¸­æ²¡æœ‰è®¿é—®è€…æ‰€éœ€çš„æ•°æ®
        EOCNetworkFetcher *fetcher = [[EOCNetworkFetcher alloc] initWithURL:url];
        [fetcher startWithCompletionHandler:^(NSData *data) {
            [self useData:data];
        }];
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><strong>NSPurgeableData</strong> ç±»ï¼Œ<strong>NSMutableData</strong> çš„å­ç±»ã€‚å¦‚æœæŸä¸ªå¯¹è±¡æ‰€å çš„å†…å­˜èƒ½å¤Ÿæ ¹æ®éœ€è¦éšæ—¶ä¸¢å¼ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç° <strong>NSDiscardableContent</strong> åè®®æ‰€å®šä¹‰çš„æ¥å£ã€‚</p>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">- (void)downloadDataForURL:(NSURL *)url {
  NSPurgeableData *cacheData = [_cache objectForKey:url];
  if (cacheData) {
      // Stop the data being purged
      [cacheData beginContentAccess];

      // Use the cached data
      [self useData:cacheData];

      // Mark that the data may be purged again
      [cacheData endContentAccess];
  }else {
      // Cache miss
      EOCNetworkFetcher *fetcher = [[EOCNetworkFetcher alloc] initWithURL:url];
      [fetcher startWithCompletionHandler:^(NSData *data) {
          NSPurgeableData *purgeableData = [NSPurgeableData dataWithData:data];
          [_cache setObject:purgeableData
                     forKey:url
                       cost:purgeableData.length];

          // Don't need to beginContentAccess as it begins
          // with access already marked

          // Use the retrieved data
          [self useData:data];

          // Mark that the data may be purged now
          [cacheData endContentAccess];
      }];
  }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</li>
</ul>
<h4 id="è¦ç‚¹-3"><a href="#è¦ç‚¹-3" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>å®ç°ç¼“å­˜æ—¶åº”é€‰ç”¨ <strong>NSCache</strong> è€Œé <strong>NSDictionary</strong> å¯¹è±¡ã€‚å› ä¸º <strong>NSCache</strong> å¯ä»¥æä¾›ä¼˜é›…çš„è‡ªåŠ¨åˆ å‡åŠŸèƒ½ï¼Œè€Œä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ­¤å¤–ï¼Œå®ƒä¸å­—å…¸ä¸åŒï¼Œå¹¶ä¸ä¼šæ‹·è´é”®ã€‚</li>
<li>å¯ä»¥ç»™ <strong>NSCache</strong> å¯¹è±¡è®¾ç½®ä¸Šé™ï¼Œç”¨ä»¥é™åˆ¶ç¼“å­˜ä¸­çš„å¯¹è±¡æ€»ä¸ªæ•°åŠæ€»æˆæœ¬ï¼Œè€Œè¿™äº›å°ºåº¦åˆ™å®šä¹‰äº†ç¼“å­˜åˆ å‡å…¶ä¸­å¯¹è±¡çš„æ—¶æœºã€‚ä½†æ˜¯ç»å¯¹ä¸è¦æŠŠè¿™äº›å°ºåº¦å½“æˆå¯é çš„ç¡¬é™åˆ¶ï¼Œä»–ä»¬ä»…å¯¹ <strong>NSCache</strong> èµ·æŒ‡å¯¼ä½œç”¨ã€‚</li>
<li>å°† <strong>NSPurgeableData</strong> ä¸ <strong>NSCache</strong> æ­é…ä½¿ç”¨ï¼Œå¯å®ç°è‡ªåŠ¨æ¸…é™¤æ•°æ®çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ <strong>NSPurgeableData</strong> å¯¹è±¡æ‰€å å†…å­˜ä¸ºç³»ç»Ÿä¸¢å¼ƒæ—¶ï¼Œè¯¥å¯¹è±¡è‡ªèº«ä¹Ÿä¼šä»ç¼“å­˜ä¸­ç§»é™¤ã€‚</li>
<li>å¦‚æœç¼“å­˜ä½¿ç”¨å¾—å½“ã€‚é‚£ä¹ˆåº”ç”¨ç¨‹åºçš„å“åº”é€Ÿåº¦å°±èƒ½æé«˜ã€‚åªæœ‰é‚£ç§é‡æ–°è®¡ç®—èµ·æ¥å¾ˆè´¹äº‹çš„æ•°æ®ï¼Œæ‰å€¼å¾—æ”¾å…¥ç¼“å­˜ï¼Œæ¯”å¦‚é‚£äº›éœ€è¦ä»ç½‘ç»œè·å–æˆ–ä»ç£ç›˜è¯»å–çš„æ•°æ®ã€‚</li>
</ul>
<h3 id="ç¬¬51æ¡ï¼šç²¾ç®€-initialize-ä¸-load-çš„å®ç°ä»£ç "><a href="#ç¬¬51æ¡ï¼šç²¾ç®€-initialize-ä¸-load-çš„å®ç°ä»£ç " class="headerlink" title="ç¬¬51æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç "></a>ç¬¬ 51 æ¡ï¼šç²¾ç®€ initialize ä¸ load çš„å®ç°ä»£ç </h3><h4 id="load-æ–¹æ³•"><a href="#load-æ–¹æ³•" class="headerlink" title="load æ–¹æ³•"></a>load æ–¹æ³•</h4><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">+ (void)load;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å¯¹äºåŠ å…¥è¿è¡ŒæœŸç³»ç»Ÿä¸­çš„æ¯ä¸ªç±»ï¼ˆclass) åŠåˆ†ç±»ï¼ˆcategory) æ¥è¯´ï¼Œå¿…å®šä¼šè°ƒç”¨æ­¤æ–¹æ³•ï¼Œè€Œä¸”ä»…è°ƒç”¨ä¸€æ¬¡ã€‚å½“åŒ…å«ç±»æˆ–åˆ†ç±»çš„ç¨‹åºåº“è½½å…¥ç³»ç»Ÿæ—¶ï¼Œå°±ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ï¼Œè€Œè¿™é€šå¸¸å°±æ˜¯æŒ‡åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œè‹¥ç¨‹åºæ˜¯ä¸º iOS å¹³å°è®¾è®¡çš„ï¼Œåˆ™è‚¯å®šä¼šåœ¨æ­¤æ—¶æ‰§è¡Œã€‚</li>
<li>å¦‚æœåˆ†ç±»å’Œå…¶æ‰€å±çš„ç±»éƒ½å®šä¹‰äº† <code>load</code> æ–¹æ³•ï¼Œåˆ™å…ˆè°ƒç”¨ç±»é‡Œçš„ï¼Œå†è°ƒç”¨åˆ†ç±»é‡Œçš„ã€‚</li>
<li>åœ¨ <code>load</code> æ–¹æ³•ä¸­ä½¿ç”¨å…¶ä»–ç±»æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>ä¸éµå¾ªç»§æ‰¿è§„åˆ™ã€‚å¦‚æœæŸä¸ªç±»æœ¬èº«æ²¡å®ç° <code>load</code> æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ç®¡å…¶å„çº§è¶…ç±»æ˜¯å¦å®ç°æ­¤æ–¹æ³•ï¼Œç³»ç»Ÿéƒ½ä¸ä¼šè°ƒç”¨ã€‚æ­¤å¤–ï¼Œåˆ†ç±»å’Œå…¶æ‰€å±çš„ç±»é‡Œï¼Œéƒ½å¯èƒ½å‡ºç° <code>load</code> æ–¹æ³•ã€‚æ­¤æ—¶ä¸¤ç§å®ç°ä»£ç éƒ½ä¼šè°ƒç”¨ï¼Œç±»çš„å®ç°è¦æ¯”åˆ†ç±»çš„å®ç°å…ˆæ‰§è¡Œã€‚</li>
<li>è€Œä¸” <code>load</code> æ–¹æ³•åŠ¡å¿…å®ç°å¾—ç²¾ç®€ä¸€äº›ï¼Œä¹Ÿå°±æ˜¯è¦å°½é‡å‡å°‘å…¶æ‰€æ‰§è¡Œçš„æ“ä½œï¼Œå› ä¸ºæ•´ä¸ªåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œ <code>load</code> æ–¹æ³•æ—¶éƒ½ä¼šé˜»å¡ã€‚åº”ç”¨ç¨‹åºå¿…é¡»é˜»å¡å¹¶ç­‰ç€æ‰€æœ‰ç±»çš„ <code>load</code> éƒ½æ‰§è¡Œå®Œï¼Œæ‰èƒ½ç»§ç»­ã€‚</li>
<li><code>load</code> æ–¹æ³•çœŸæ­£ç”¨é€”ä»…åœ¨äºè°ƒè¯•ç¨‹åºï¼Œæ¯”å¦‚å¯ä»¥åœ¨åˆ†ç±»é‡Œç¼–å†™æ­¤æ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­è¯¥åˆ†ç±»æ˜¯å¦å·²ç»æ­£ç¡®è½½å…¥ç³»ç»Ÿä¸­ã€‚ä¹Ÿè®¸æ­¤æ–¹æ³•ä¸€åº¦å¾ˆæœ‰ç”¨å¤„ï¼Œä½†ç°åœ¨å®Œå…¨å¯ä»¥è¯´ï¼šæ—¶ä¸‹ç¼–å†™ Objective-C ä»£ç æ—¶ï¼Œä¸éœ€è¦ç”¨å®ƒã€‚</li>
</ul>
<h4 id="initialize-æ–¹æ³•"><a href="#initialize-æ–¹æ³•" class="headerlink" title="initialize æ–¹æ³•"></a>initialize æ–¹æ³•</h4><pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">+ (void)initialize;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å¯¹äºæ¯ä¸ªç±»æ¥è¯´ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨ç¨‹åºé¦–æ¬¡ç”¨è¯¥ç±»ä¹‹å‰è°ƒç”¨ï¼Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚å®ƒæ˜¯ç”±è¿è¡ŒæœŸç³»ç»Ÿæ¥è°ƒç”¨çš„ï¼Œç»ä¸åº”è¯¥é€šè¿‡ä»£ç ç›´æ¥è°ƒç”¨ã€‚</li>
<li>å®ƒæ˜¯ â€œæƒ°æ€§è°ƒç”¨çš„â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å½“ç¨‹åºç”¨åˆ°äº†ç›¸å…³çš„ç±»æ—¶ï¼Œæ‰ä¼šè°ƒç”¨ã€‚</li>
<li>è¿è¡ŒæœŸç³»ç»Ÿåœ¨æ‰§è¡Œè¯¥æ–¹æ³•æ—¶ï¼Œæ˜¯å¤„äºæ­£å¸¸çŠ¶æ€çš„ã€‚è€Œä¸”ï¼Œè¿è¡ŒæœŸç³»ç»Ÿä¹Ÿèƒ½ç¡®ä¿ <code>initialize</code> æ–¹æ³•ä¸€å®šä¼šåœ¨<strong>çº¿ç¨‹å®‰å…¨çš„ç¯å¢ƒ</strong>ä¸­æ‰§è¡Œã€‚</li>
<li>éµå¾ªç»§æ‰¿è§„åˆ™ã€‚<code>initialize</code> æ–¹æ³•ä¸å…¶ä»–æ¶ˆæ¯ä¸€æ ·ï¼Œå¦‚æœæŸä¸ªç±»æœªå®ç°å®ƒï¼Œè€Œå…¶è¶…ç±»å®ç°äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¿è¡Œè¶…ç±»çš„å®ç°ä»£ç ã€‚</li>
</ul>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul>
<li>è¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ä»£ç è¦å°½é‡ç²¾ç®€ã€‚åœ¨é‡Œé¢è®¾ç½®ä¸€äº›çŠ¶æ€ï¼Œä½¿æœ¬ç±»èƒ½å¤Ÿæ­£å¸¸è¿ä½œå°±å¯ä»¥äº†ï¼Œä¸è¦æ‰§è¡Œè€—æ—¶å¤ªä¹…æˆ–éœ€è¦åŠ é”çš„ä»»åŠ¡ã€‚</li>
<li>å¼€å‘è€…æ— æ³•æ§åˆ¶ç±»çš„åˆå§‹åŒ–æ—¶æœºã€‚</li>
<li>å¦‚æœæŸä¸ªç±»çš„å®ç°ä»£ç å¾ˆå¤æ‚ï¼Œé‚£ä¹ˆå…¶ä¸­å¯èƒ½ä¼šç›´æ¥æˆ–é—´æ¥ç”¨åˆ°å…¶ä»–ç±»ã€‚</li>
<li><code>initialize</code> æ–¹æ³•åªåº”è¯¥ç”¨æ¥è®¾ç½®å†…éƒ¨æ•°æ®ã€‚è‹¥æŸä¸ªå…¨å±€çŠ¶æ€æ— æ³•åœ¨ç¼–è¯‘æœŸåˆå§‹åŒ–ï¼Œåˆ™å¯ä»¥æ”¾åœ¨ <code>initialize</code> é‡Œæ¥åšã€‚</li>
</ul>
<h4 id="è¦ç‚¹-4"><a href="#è¦ç‚¹-4" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>åœ¨åŠ è½½é˜¶æ®µï¼Œå¦‚æœå®ç°äº† <code>load</code> æ–¹æ³•ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šè°ƒç”¨å®ƒã€‚åˆ†ç±»é‡Œä¹Ÿå¯ä»¥å®šä¹‰æ­¤æ–¹æ³•ï¼Œç±»çš„ <code>load</code> æ–¹æ³•è¦æ¯”åˆ†ç±»ä¸­çš„å…ˆè°ƒç”¨ã€‚ä¸å…¶ä»–æ–¹æ³•ä¸åŒï¼Œ<code>load</code> æ–¹æ³•ä¸å‚ä¸è¦†å†™æœºåˆ¶ã€‚</li>
<li>é¦–æ¬¡ä½¿ç”¨æŸä¸ªç±»ä¹‹å‰ï¼Œç³»ç»Ÿä¼šå‘å…¶å‘é€ <code>initialize</code> æ¶ˆæ¯ã€‚ç”±äºæ­¤æ–¹æ³•éµä»æ™®é€šçš„è¦†å†™è§„åˆ™ï¼Œæ‰€ä»¥é€šå¸¸åº”è¯¥åœ¨é‡Œé¢åˆ¤æ–­å½“å‰è¦åˆå§‹åŒ–çš„æ˜¯å“ªä¸ªç±»ã€‚</li>
<li><code>load</code> ä¸ <code>initialize</code> æ–¹æ³•éƒ½åº”è¯¥å®ç°çš„ç²¾ç®€ä¸€äº›ï¼Œè¿™æœ‰åŠ©äºä¿æŒåº”ç”¨ç¨‹åºçš„å“åº”èƒ½åŠ›ï¼Œä¹Ÿèƒ½å‡å°‘å¼•å…¥ä¾èµ–ç¯çš„å‡ ç‡ã€‚</li>
<li>æ— æ³•åœ¨ç¼–è¯‘æœŸè®¾å®šçš„å…¨å±€å¸¸é‡ï¼Œå¯ä»¥æ”¾åœ¨ <code>initialize</code> æ–¹æ³•é‡Œåˆå§‹åŒ–ã€‚</li>
</ul>
<h3 id="ç¬¬52æ¡ï¼šåˆ«å¿˜äº†-NSTimer-ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"><a href="#ç¬¬52æ¡ï¼šåˆ«å¿˜äº†-NSTimer-ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡" class="headerlink" title="ç¬¬52æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"></a>ç¬¬ 52 æ¡ï¼šåˆ«å¿˜äº† NSTimer ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡</h3><ul>
<li><strong>Foundation</strong> æ¡†æ¶ä¸­æœ‰ä¸ªç±»å«åš <strong>NSTimer</strong> ï¼Œå¼€å‘è€…å¯ä»¥æŒ‡å®šç»å¯¹çš„æ—¥æœŸä¸æ—¶é—´ï¼Œä»¥ä¾¿åˆ°æ—¶æ‰§è¡Œä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ‰§è¡Œä»»åŠ¡çš„ç›¸å¯¹å»¶è¿Ÿæ—¶é—´ã€‚è®¡æ—¶å™¨è¿˜å¯ä»¥é‡å¤è¿è¡Œä»»åŠ¡ï¼Œæœ‰ä¸ªä¸ä¹‹ç›¸å…³è”çš„ â€œé—´éš”å€¼â€ï¼ˆinterval) å¯ç”¨æ¥æŒ‡å®šä»»åŠ¡çš„è§¦å‘é¢‘ç‡ã€‚</li>
<li>åªæœ‰æŠŠè®¡æ—¶å™¨æ”¾åœ¨è¿è¡Œå¾ªç¯é‡Œï¼Œå®ƒæ‰èƒ½æ­£å¸¸è§¦å‘ä»»åŠ¡ã€‚</li>
</ul>
<pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)ti
                                     target:(id)aTarget
                                   selector:(SEL)aSelector
                                   userInfo:(nullable id)userInfo
                                    repeats:(BOOL)yesOrNo;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>ç”¨æ­¤æ–¹æ³•åˆ›å»ºå‡ºæ¥çš„è®¡æ—¶å™¨ï¼Œä¼šåœ¨æŒ‡å®šçš„é—´éš”æ—¶é—´ä¹‹åæ‰§è¡Œä»»åŠ¡ã€‚ä¹Ÿå¯ä»¥ä»¤å…¶åå¤æ‰§è¡Œä»»åŠ¡ï¼Œç›´åˆ°å¼€å‘è€…ç¨åå°†å…¶æ‰‹åŠ¨å…³é—­ä¸ºæ­¢ã€‚target ä¸ selector å‚æ•°è¡¨ç¤ºè®¡æ—¶å™¨å°†åœ¨å“ªä¸ªå¯¹è±¡ä¸Šè°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚è®¡æ—¶å™¨ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡ï¼Œç­‰åˆ°è‡ªèº« â€œå¤±æ•ˆâ€ æ—¶å†é‡Šæ”¾æ­¤å¯¹è±¡ã€‚è°ƒç”¨ <code>invalidate</code> æ–¹æ³•å¯ä»¤è®¡æ—¶å™¨å¤±æ•ˆï¼›æ‰§è¡Œå®Œç›¸å…³ä»»åŠ¡ä¹‹åï¼Œä¸€æ¬¡æ€§çš„è®¡æ—¶å™¨ä¹Ÿä¼šå¤±æ•ˆã€‚å¼€å‘è€…è‹¥å°†è®¡æ—¶å™¨è®¾ç½®æˆé‡å¤æ‰§è¡Œæ¨¡å¼ï¼Œé‚£ä¹ˆå¿…é¡»è‡ªå·±è°ƒç”¨ <code>invalidate</code> æ–¹æ³•ï¼Œæ‰èƒ½ä»¤å…¶åœæ­¢ã€‚</p>
</li>
<li><p>ç”±äºè®¡æ—¶å™¨ä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡ï¼Œæ‰€ä»¥åå¤æ‰§è¡Œä»»åŠ¡é€šå¸¸ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå‡ºé—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè®¾ç½®æˆé‡å¤æ‰§è¡Œæ¨¡å¼çš„é‚£ç§è®¡æ—¶å™¨ï¼Œå¾ˆå®¹æ˜“å¼•äºº â€œä¿ç•™ç¯â€ã€‚</p>
<p>&lt;!â€“hexoPostRenderEscape:</p><pre class="line-numbers language-none"><code class="language-none">//  EOCClass.h<br>#import &lt;Foundation/Foundation.h&gt;<p></p>
</code></pre></li><code class="language-none">
</code></ul><code class="language-none">
<p>@interface EOCClass : NSObject</p>
<ul>
<li>(void)startPolling;</li>
<li>(void)stopPolling;<br>@end</li>
</ul>
<p>//  EOCClass.m<br>#import "EOCClass.h"</p>
<p>@implementation EOCClass {<br>    // â‡ï¸ EOCClass â†’ _pollTimer<br>    NSTimer *_pollTimer;<br>}</p>
<ul>
<li><p>(instancetype)init {<br>  return [super init];<br>}</p>
</li>
<li><p>(void)dealloc {<br>  [_pollTimer invalidate];<br>}</p>
</li>
<li><p>(void)startPolling {<br>  // â‡ï¸ _pollTimer â†’ EOCClass<br>  _pollTimer =<br>  [NSTimer scheduledTimerWithTimeInterval:5.0</p>
<pre><code>                               target:self
                             selector:@selector(p_doPoll)
                             userInfo:nil
                              repeats:YES];</code></pre>
<p>}</p>
</li>
<li><p>(void)stopPolling {<br>  [_pollTimer invalidate];<br>  _pollTimer = nil;<br>}</p>
</li>
<li><p>(void)p_doPoll {<br>  // Poll the resource<br>}</p>
</li>
</ul>
</code><p><code class="language-none">@end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code>:hexoPostRenderEscapeâ€“&gt;</p>
<p>  è§£å†³å¼•ç”¨å¾ªç¯æ–¹æ³•ï¼š</p>
  <pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">//  NSTimer+EOCBlocksSupport.h
#import &lt;Foundation/Foundation.h&gt;

@interface NSTimer (EOCBlocksSupport)

+ (NSTimer *)eoc_scheduledTimerWithTimeInterval:(NSTimeInterval)interval
                                          block:(void(^)())block
                                        repeats:(BOOL)repeats;
@end

//  NSTimer+EOCBlocksSupport.m
#import "NSTimer+EOCBlocksSupport.h"

@implementation NSTimer (EOCBlocksSupport)

+ (NSTimer *)eoc_scheduledTimerWithTimeInterval:(NSTimeInterval)interval
                                          block:(void(^)())block
                                        repeats:(BOOL)repeats {
    return [self scheduledTimerWithTimeInterval:interval
                                         target:self
                                       selector:@selector(eoc_blockInvoke:) userInfo:[block copy] repeats:repeats];
}

+ (void)eoc_blockInvoke:(NSTimer *)timer {
    void (^block)() = timer.userInfo;
    if (block) {
        block();
    }
}

@end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>  å°†è®¡æ—¶å™¨æ‰€åº”æ‰§è¡Œçš„ä»»åŠ¡å°è£…æˆ block ã€‚åœ¨è°ƒç”¨è®¡æ—¶å™¨å‡½æ•°æ—¶ï¼ŒæŠŠå®ƒä½œä¸º userlnfo å‚æ•°ä¼ è¿›å»ã€‚è¯¥å‚æ•°å¯ç”¨æ¥å­˜æ”¾ä¸é€æ˜å€¼ (opaque value)ï¼Œåªè¦è®¡æ—¶å™¨è¿˜æœ‰æ•ˆï¼Œå°±ä¼šä¸€ç›´ä¿ç•™ç€å®ƒã€‚ä¼ äººå‚æ•°æ—¶è¦é€šè¿‡ copy æ–¹æ³•å°† block æ‹·è´åˆ° â€œå †â€ ä¸Šï¼ˆå‚è§ç¬¬ 37 æ¡)ï¼Œå¦åˆ™ç­‰åˆ°ç¨åè¦æ‰§è¡Œå®ƒçš„æ—¶å€™ï¼Œè¯¥å—å¯èƒ½å·²ç»æ— æ•ˆäº†ã€‚è®¡æ—¶å™¨ç°åœ¨çš„ target æ˜¯ NSTimer ç±»å¯¹è±¡ï¼Œè¿™æ˜¯ä¸ªå•ä¾‹ï¼Œå› æ­¤è®¡æ—¶å™¨æ˜¯å¦ä¼šä¿ç•™å®ƒï¼Œå…¶å®éƒ½æ— æ‰€è°“ã€‚æ­¤å¤„ä¾ç„¶æœ‰ä¿ç•™ç¯ï¼Œç„¶è€Œå› ä¸ºç±»å¯¹è±¡ï¼ˆclassobject) æ— é¡»å›æ”¶ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚</p>
<p>  ä¼˜åŒ–ï¼š</p>
  <pre class="line-numbers language-objective-c" data-language="objective-c"><code class="language-objective-c">- (void)startPolling {
    __weak EOCClass *weakSelf = self;
    _pollTimer =
    [NSTimer eoc_scheduledTimerWithTimeInterval:5.0
                                          block:^{
                                              EOCClass *strongSelf = weakSelf;
                                              [strongSelf p_doPoll];
                                          }
                                        repeats:YES];

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="iOS-10-0-ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•"><a href="#iOS-10-0-ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•" class="headerlink" title="iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•"></a>iOS 10.0 ä¸­å·²ç»å¼•å…¥äº†è¯¥æ–¹æ³•</h4><pre class="line-numbers language-none"><code class="language-none">+ (NSTimer *)timerWithTimeInterval:(NSTimeInterval)interval repeats:(BOOL)repeats block:(void (^)(NSTimer *timer))block;

+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)interval repeats:(BOOL)repeats block:(void (^)(NSTimer *timer))block;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<h4 id="è¦ç‚¹-5"><a href="#è¦ç‚¹-5" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h4><ul>
<li>NSTimer å¯¹è±¡ä¼šä¿ç•™å…¶ç›®æ ‡ï¼Œç›´åˆ°è®¡æ—¶å™¨æœ¬èº«å¤±æ•ˆä¸ºæ­¢ï¼Œè°ƒç”¨ <code>invalidate</code> æ–¹æ³•å¯ä»¤è®¡æ—¶å™¨å¤±æ•ˆï¼Œå¦å¤–ï¼Œä¸€æ¬¡æ€§çš„è®¡æ—¶å™¨åœ¨è§¦å‘å®Œä»»åŠ¡ä¹‹åä¹Ÿä¼šå¤±æ•ˆã€‚</li>
<li>åå¤æ‰§è¡Œä»»åŠ¡çš„è®¡æ—¶å™¨ï¼Œå¾ˆå®¹æ˜“å¼•å…¥ä¿ç•™ç¯ï¼Œå¦‚æœè¿™ç§è®¡æ—¶å™¨çš„ç›®æ ‡å¯¹è±¡åˆä¿ç•™äº†è®¡æ—¶å™¨æœ¬èº«ï¼Œé‚£è‚¯å®šä¼šå¯¼è‡´å¾ªç¯å¼•ç”¨ã€‚è¿™ç§å¾ªç¯å¼•ç”¨ï¼Œå¯èƒ½æ˜¯ç›´æ¥å‘ç”Ÿçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯é€šè¿‡å¯¹è±¡å›¾é‡Œçš„å…¶ä»–å¯¹è±¡é—´æ¥å‘ç”Ÿçš„ã€‚</li>
<li>å¯ä»¥æ‰©å…… NSTimer çš„åŠŸèƒ½ï¼Œç”¨å—æ¥æ‰“ç ´å¾ªç¯å¼•ç”¨ã€‚ä¸è¿‡ï¼Œé™¤é NSTimer å°†æ¥åœ¨å…¬å…±æ¥å£é‡Œæä¾›æ­¤åŠŸèƒ½ï¼Œå¦åˆ™å¿…é¡»åˆ›å»ºåˆ†ç±»ï¼Œå°†ç›¸å…³å®ç°ä»£ç åŠ å…¥å…¶ä¸­ã€‚</li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>ç‹¬æœ¨èˆŸçš„æœ¨
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://andy0570.com/2017/08/21/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B7.%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/" title="ã€ŠEffective Objective-C 2.0ã€‹7. ç³»ç»Ÿæ¡†æ¶">https://andy0570.com/2017/08/21/ã€ŠEffective Objective-C 2.0ã€‹7.ç³»ç»Ÿæ¡†æ¶/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/iOS/" rel="tag"># iOS</a>
              <a href="/tags/Objective-C/" rel="tag"># Objective-C</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/08/20/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B6.%E5%9D%97%E4%B8%8E%E5%A4%A7%E4%B8%AD%E6%9E%A2%E6%B4%BE%E5%8F%91/" rel="prev" title="ã€ŠEffective Objective-C 2.0ã€‹6. å—ä¸å¤§ä¸­æ¢æ´¾å‘">
      <i class="fa fa-chevron-left"></i> ã€ŠEffective Objective-C 2.0ã€‹6. å—ä¸å¤§ä¸­æ¢æ´¾å‘
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/08/22/%E3%80%8AEffective%20Objective-C%202.0%E3%80%8B2.%E5%AF%B9%E8%B1%A1%E3%80%81%E6%B6%88%E6%81%AF%E3%80%81%E8%BF%90%E8%A1%8C%E6%9C%9F/" rel="next" title="ã€ŠEffective Objective-C 2.0ã€‹2. å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ">
      ã€ŠEffective Objective-C 2.0ã€‹2. å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 â€“ 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç‹¬æœ¨èˆŸçš„æœ¨</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">2.3m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">34:09</span>
</div>
  <div class="powered-by">ç”± <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/next-theme/pjax@0/pjax.min.js"></script>
  <script src="//unpkg.com/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//unpkg.com/lozad@1/dist/lozad.min.js"></script>
  <script src="//unpkg.com/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  
  <script data-pjax>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>



  <script data-pjax>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : 26856,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  
<script src="//unpkg.com/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//unpkg.com/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>












<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//unpkg.com/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>


    <div class="pjax">
  

  


<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//unpkg.com/valine@1/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: location.pathname,
    }, {"enable":true,"appId":"S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz","appKey":"brOnU8mOQvSjpipJvdKUAIbU","placeholder":"å†™ä¸‹ä½ çš„è¯„è®º...","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"language":"zh-cn","visitor":false,"comment_count":true,"recordIP":true,"serverURLs":null,"enableQQ":true,"requiredFields":[]}
    ));
  }, window.Valine);
});
</script>

    </div>
</body>
</html>

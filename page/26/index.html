<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">



  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">













  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">







  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/panda/apple-touch-icon.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda/favicon-32x32.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda/favicon-16x16.png?v=7.1.0">


  <link rel="mask-icon" href="/images/panda/safari-pinned-tab.svg?v=7.1.0" color="#222">


  <link rel="manifest" href="/images/panda/site.webmanifest">


  <meta name="msapplication-config" content="/images/panda/browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有时候阳光很好 有时候阳光很暗">
<meta name="keywords" content="独木舟的木">
<meta property="og:type" content="website">
<meta property="og:title" content="独木舟的木">
<meta property="og:url" content="https://andy0570.com/page/26/index.html">
<meta property="og:site_name" content="独木舟的木">
<meta property="og:description" content="有时候阳光很好 有时候阳光很暗">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="独木舟的木">
<meta name="twitter:description" content="有时候阳光很好 有时候阳光很暗">



  <link rel="alternate" href="/atom.xml" title="独木舟的木" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://andy0570.com/page/26/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>独木舟的木</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8229a094facca297f211d61323fd9fde";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <a href="https://github.com/andy0570" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">独木舟的木</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">iOS Developer</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">14</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">39</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">314</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/02/08/《Objective-C 编程》9.地址与指针/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/02/08/《Objective-C 编程》9.地址与指针/" class="post-title-link" itemprop="url">《Objective-C 编程》9.地址与指针</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-02-08 12:40:00" itemprop="dateCreated datePublished" datetime="2017-02-08T12:40:00+08:00">2017-02-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-18 00:54:44" itemprop="dateModified" datetime="2019-04-18T00:54:44+08:00">2019-04-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Objective-C-编程/" itemprop="url" rel="index"><span itemprop="name">Objective-C 编程</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/02/08/《Objective-C 编程》9.地址与指针/" class="leancloud_visitors" data-flag-title="《Objective-C 编程》9.地址与指针">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h1 id="地址与指针"><a href="#地址与指针" class="headerlink" title="地址与指针"></a>地址与指针</h1><ul>
<li>1字节（byte）=  8 位（bit）</li>
<li>内存是有数字编号的，通常用 <strong>地址</strong>（address）来指代某个特定字节的数据。</li>
<li>32位CPU或64位CPU，其实是指地址的大小。而64位CPU的寻址能力比32位CPU更强。</li>
</ul>
<h3 id="获取地址"><a href="#获取地址" class="headerlink" title="获取地址"></a>获取地址</h3><ul>
<li><strong>变量的地址</strong>：是指内存中的某个位置，该位置的内存中保存着变量的值。通过<strong>&amp;运算符</strong>，可以得到变量的地址。</li>
<li><strong>%p</strong> 是针对内存地址的格式说明符。</li>
<li>一般情况下，内存地址都会以<strong>十六进制</strong>格式输出。</li>
</ul>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"i stores its value at %p\n"</span>,&amp;i);</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<blockquote>
<p><strong>i stores its value at 0x7fff5fbff79c</strong></p>
</blockquote>
<ul>
<li>当程序在计算机上运行时，相关的一切数据都会保存在内存中，并有各自的地址。</li>
<li><strong>函数</strong>也有自己的地址。通过函数的函数名，就能得到相应函数的地址。</li>
</ul>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">printf</span>(<span class="string">"this function starts at %p\n"</span>,main);</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<blockquote>
<p><strong>this function starts at 0x100000d10</strong></p>
</blockquote>
<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><ul>
<li><p><strong>指针</strong>，就是用特定类型的变量来保存某个内存地址。</p>
</li>
<li><p>使用指针的意义：程序不一定能够通过拷贝来传递数据，但是一定能够<strong>直接传递</strong>或<strong>通过拷贝</strong>来传递<strong>数据的起始地址</strong>。一旦有数据的起始地址，就能够很容易地存取相应数据。</p>
</li>
<li><h6 id="指针的声明方式：例-float-a"><a href="#指针的声明方式：例-float-a" class="headerlink" title="指针的声明方式：例 :float  *a;"></a>指针的声明方式：例 :float  *a;</h6></li>
<li><p>使用<strong>*运算符</strong>，可以访问保存在某个地址中的数据。</p>
</li>
<li><p>*运算符在这里的作用：</p>
<ul>
<li><ol>
<li>声明指针；</li>
</ol>
</li>
<li><ol start="2">
<li><strong>去引用</strong>：通过指针访问某个地址中的数据；</li>
<li>向指定的地址保存数据；</li>
</ol>
</li>
</ul>
</li>
</ul>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">17</span>;</span><br><span class="line">// *声明指针，将变量addressOfI声明为<span class="keyword">int</span> *，即指向保存<span class="keyword">int</span>值的内存地址</span><br><span class="line"><span class="keyword">int</span> *addressOfI = &amp;i;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"i stores its value at %p\n"</span>,addressOfI);</span><br><span class="line"></span><br><span class="line">// *访问保存在addressOfI地址中的<span class="keyword">int</span>值</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"the int stored at addressOfI is %d\n"</span>,*addressOfI);</span><br><span class="line"></span><br><span class="line">//在赋值表达式的左侧使用*运算符，将数据保存在指定的地址中</span><br><span class="line">*addressOfI = <span class="number">89</span>;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Now i is %d\n"</span>,i);</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<blockquote>
<p><strong>i stores its value at 0x7fff5fbff79c</strong></p>
<p><strong>the int stored at addressOfI is 17</strong></p>
<p><strong>Now i is 89</strong></p>
</blockquote>
<h3 id="不同类型的数据所占用的字节大小"><a href="#不同类型的数据所占用的字节大小" class="headerlink" title="不同类型的数据所占用的字节大小"></a>不同类型的数据所占用的字节大小</h3><ul>
<li><strong>sizeof()</strong> 可以得到某个数据类型的大小；</li>
<li><strong>sizeof()</strong> 会返回一个类型为 <strong>size_t</strong> 的数，与之对应的格式说明符为：<strong>%zu</strong> ;</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用 sizeof() 可以得到某个数据类型的大小</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An char is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An short is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">short</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An int is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An long is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">long</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An float is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">float</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An double is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">double</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"A pointer is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">int</span> *));</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用 sizeof() 时，传入的实参也可以是变量</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"An int is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(i));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"A pointer is %zu bytes\n"</span>,<span class="keyword">sizeof</span>(addressOfI));</span><br></pre></td></tr></table></figure>
<p> 输出结果：</p>
<blockquote>
<p><strong>An char is 1 bytes</strong></p>
<p><strong>An short is 2 bytes</strong></p>
<p><strong>An int is 4 bytes</strong></p>
<p><strong>An long is 8 bytes</strong></p>
<p><strong>An float is 4 bytes</strong></p>
<p><strong>An double is 8 bytes</strong></p>
<p><strong>A pointer is 8 bytes</strong></p>
<p><strong>An int is 4 bytes</strong></p>
<p><strong>A pointer is 8 bytes</strong></p>
</blockquote>
<blockquote>
<p>可以通过查看<strong>指针的所占用的字节大小</strong>反向判断运行该程序的处理器（CPU）位数。<br>如果指针的长度是4个字节，那么运行该程序的处理器就是32位的；<br>如果指针的长度是8个字节，那么处理器就是64位的。</p>
</blockquote>
<ul>
<li>范围，能够保存的最小数和最大数</li>
</ul>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>位数</th>
<th>最小数</th>
<th>最大数</th>
</tr>
</thead>
<tbody>
<tr>
<td>char</td>
<td>8位</td>
<td>-128</td>
<td>127</td>
</tr>
<tr>
<td>Unsigned char</td>
<td>8位</td>
<td>0</td>
<td>255</td>
</tr>
<tr>
<td>short</td>
<td>16位</td>
<td>-32768</td>
<td>32767</td>
</tr>
<tr>
<td>Unsigned short</td>
<td>16位</td>
<td>0</td>
<td>65535</td>
</tr>
</tbody>
</table>
<h3 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h3><ul>
<li><p><strong>“空”指针</strong>：某些情况下，要有一个能够保存地址的指针变量，但是要赋上某个值，用于明确表示该指针没有指向任何地址。C语言中的<strong>NULL</strong>就是这里的“某个值”；</p>
</li>
<li><p>NULL就是0；</p>
<p>在 <strong>if</strong> 的条件表达式中，判断指针是否为空：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> *myPointer;</span><br><span class="line"><span class="keyword">if</span> (myPointer) &#123;</span><br><span class="line">    <span class="comment">// myPointer 为 真，即 myPointer != NULL</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"myPointer 不是 NULL.\n"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"myPointer 是 NULL.\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  同上</span></span><br><span class="line"><span class="keyword">if</span> (myPointer != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"myPointer 不是 NULL.\n"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"myPointer 是 NULL.\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<blockquote>
<p><strong>myPointer </strong> <strong>是</strong> <strong>NULL.</strong></p>
<p><strong>myPointer </strong> <strong>是</strong> <strong>NULL.</strong></p>
</blockquote>
</li>
</ul>
<ul>
<li><p>有时NULL表示此处为空值；</p>
</li>
<li><p>nil和NULL是相等的，但是Objective-C的程序员通常会使用nil来代表该地址上没有对象。</p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/02/07/《Objective-C 编程》7.数字/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/02/07/《Objective-C 编程》7.数字/" class="post-title-link" itemprop="url">《Objective-C 编程》7.数字</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-02-07 13:44:00" itemprop="dateCreated datePublished" datetime="2017-02-07T13:44:00+08:00">2017-02-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-18 00:54:25" itemprop="dateModified" datetime="2019-04-18T00:54:25+08:00">2019-04-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Objective-C-编程/" itemprop="url" rel="index"><span itemprop="name">Objective-C 编程</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/02/07/《Objective-C 编程》7.数字/" class="leancloud_visitors" data-flag-title="《Objective-C 编程》7.数字">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h1 id="基础数据类型"><a href="#基础数据类型" class="headerlink" title="基础数据类型"></a>基础数据类型</h1><p>——摘自<a href="https://zh.wikipedia.org/wiki/C语言#.E5.9C.A8C.E8.AA.9E.E8.A8.80.E4.B8.AD.E7.9A.84.E8.BF.90.E7.AE.97.E7.AC.A6.E5.8F.B7" target="_blank" rel="noopener">维基百科</a><br><img src="http://upload-images.jianshu.io/upload_images/2648731-5d23cae672e807bb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p><strong>Tips</strong>: 合理使用限定词： <code>long</code>、<code>long long</code>、<code>short</code>、<code>unsigned</code> 及 <code>signed</code> 可以弹性地获取内存空间以节约内存。</p>
<h1 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h1><p><img src="http://upload-images.jianshu.io/upload_images/2648731-f6f09adf018657a5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="计算机中的数字"></p>
<h3 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h3><ul>
<li>整数是没有小数点的数——一个完整的数；</li>
<li>为了保存数字，整数变量会占用一定的<strong>位(bit)数空间</strong>。典型的整数尺寸有8位、16位、32位和64位，而8位的无符号数可以保存0～255之间的整数。（1 byte = 8 bit）</li>
<li>整数还有 <strong>有符号</strong> 和 <strong>无符号</strong> 两种类型。char 、short、int、long 和 long long <strong>默认是有符号</strong> 的，加上 <strong>unsigned</strong> 前缀可以得到无符号的版本。</li>
</ul>
<h4 id="整数的声明"><a href="#整数的声明" class="headerlink" title="整数的声明"></a>整数的声明</h4><table>
<thead>
<tr>
<th style="text-align:left">声明整数的变量类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">UInt32</td>
<td style="text-align:left">无符号32位整数</td>
</tr>
<tr>
<td style="text-align:left">SInt16</td>
<td style="text-align:left">有符号16位整数</td>
</tr>
<tr>
<td style="text-align:left">Char</td>
<td style="text-align:left">8位</td>
</tr>
<tr>
<td style="text-align:left">Short</td>
<td style="text-align:left">通常是16位</td>
</tr>
<tr>
<td style="text-align:left">Int</td>
<td style="text-align:left">通常是32位</td>
</tr>
<tr>
<td style="text-align:left">long</td>
<td style="text-align:left">32位或64位</td>
</tr>
<tr>
<td style="text-align:left">long long</td>
<td style="text-align:left">64位</td>
</tr>
</tbody>
</table>
<p>（注：整数类型所占的位数是平台相关的。）</p>
<h4 id="用于显示整数的格式说明符号"><a href="#用于显示整数的格式说明符号" class="headerlink" title="用于显示整数的格式说明符号"></a>用于显示整数的格式说明符号</h4><table>
<thead>
<tr>
<th>进制</th>
<th>格式说明符</th>
</tr>
</thead>
<tbody>
<tr>
<td>十进制</td>
<td>%d</td>
</tr>
<tr>
<td>八进制</td>
<td>%o</td>
</tr>
<tr>
<td>十六进制</td>
<td>%x</td>
</tr>
</tbody>
</table>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int x = 255;</span><br><span class="line">printf(&quot;x is %d.\n&quot;,x);                // x is 255.</span><br><span class="line">printf(&quot;In octal,x is %o.\n&quot;,x);       // In octal,x is 377.</span><br><span class="line">printf(&quot;In hexadecimal,x is %x.\n&quot;,x); // In hexadecimal,x is ff.</span><br></pre></td></tr></table></figure>
<p>对于位数很多的大整数，可以在%和转换字符之间加入一个 <strong>l</strong> (针对long) 或 <strong>ll</strong> (针对long long)  。</p>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">long x = 255;</span><br><span class="line">printf(&quot;x is %ld.\n&quot;,x);                // x is 255.</span><br><span class="line">printf(&quot;In octal,x is %lo.\n&quot;,x);       // In octal,x is 377.</span><br><span class="line">printf(&quot;In hexadecimal,x is %lx.\n&quot;,x); // In hexadecimal,x is ff.</span><br></pre></td></tr></table></figure>
<p>如果要输出的是<strong>无符号的十进制数</strong>，就应该使用 <strong>%u</strong> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">unsigned long x = 255;</span><br><span class="line">printf(&quot;x is %lu.\n&quot;,x); // x is 255.</span><br><span class="line"></span><br><span class="line">// 按八进制和十六进制输出时，会假设数字是无符号的</span><br><span class="line">printf(&quot;In octal,x is %lo.\n&quot;,x);       // In octal,x is 377.</span><br><span class="line">printf(&quot;In hexadecimal,x is %lx.\n&quot;,x); // In hexadecimal,x is ff.</span><br></pre></td></tr></table></figure>
<h3 id="传入特定参数，来设置最小字段宽度和最小数字位数（默认两者都是-0）"><a href="#传入特定参数，来设置最小字段宽度和最小数字位数（默认两者都是-0）" class="headerlink" title="传入特定参数，来设置最小字段宽度和最小数字位数（默认两者都是 0）"></a>传入特定参数，来设置最小字段宽度和最小数字位数（默认两者都是 0）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 正数</span><br><span class="line">int m = 42;</span><br><span class="line">NSString *s = [NSString stringWithFormat:@&quot;&apos;%4d&apos; &apos;%-4d&apos; &apos;%+4d&apos; &apos;%4.3d&apos; &apos;%04d&apos;&quot;, m, m, m, m, m];</span><br><span class="line">// &quot;[  42] [42  ] [ +42] [ 042] [0042]&quot;</span><br><span class="line"></span><br><span class="line">// 负数</span><br><span class="line">int m = -42;</span><br><span class="line">NSString *s = [NSString stringWithFormat:@&quot;&apos;%4d&apos; &apos;%-4d&apos; &apos;%+4d&apos; &apos;%4.3d&apos; &apos;%04d&apos;&quot;, m, m, m, m, m];</span><br><span class="line">// &quot;[ -42] [-42 ] [ -42] [-042] [-042]&quot;</span><br></pre></td></tr></table></figure>
<h3 id="整数运算符"><a href="#整数运算符" class="headerlink" title="整数运算符"></a>整数运算符</h3><ul>
<li>算数运算符+、-和*的作用与数学运算符相同；</li>
<li>算数运算符遵循的优先规则：*会在+或-之前运算；</li>
</ul>
<h4 id="整数除法"><a href="#整数除法" class="headerlink" title="整数除法"></a>整数除法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">printf(&quot;11 / 3 = %d\n&quot;,11 / 3);    //  11 / 3 = 3</span><br><span class="line">printf(&quot;-11 / 3 = %d\n&quot;, -11 / 3); // -11 / 3 = -3</span><br></pre></td></tr></table></figure>
<p>在C语言中，一个整数除以另一个整数，得到的还是整数。系统会将计算结果向0的方向取整;</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9d5f429c33c8add9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="整数除法运算符"></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 11除以3，得3，余2</span><br><span class="line">printf(&quot;11 / 3 = %d remainder of %d\n&quot;,11 / 3 , 11 % 3); // 11 / 3 = 3 remainder of 2</span><br></pre></td></tr></table></figure>
<p>如果要得到3.666667这样的结果，就要先通过<strong>转换运算符</strong>。</p>
<p><strong>转换运算符</strong>：就是需要转换的目标类型，但是要放在小括号里，并写在需要转换的变量的左侧。</p>
<p>💡💡💡规则：如果分子和分母都是整数类型，那么／执行的是<strong>整数除法</strong>。如果分子和分母有任何一个是浮点数，就会执行<strong>浮点数除法</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf(&quot;11 / 3.0 = %f\n&quot;,11 / (float)3); // 11 / 3.0 = 3.666667</span><br></pre></td></tr></table></figure>
<p>这里的分母是浮点数，所以执行的是浮点数除法。</p>
<h4 id="NSInteger-和-NSUInteger"><a href="#NSInteger-和-NSUInteger" class="headerlink" title="NSInteger 和 NSUInteger"></a>NSInteger 和 NSUInteger</h4><ul>
<li>NSInteger 和 NSUInteger 这两种类型无论在32位系统还是64位系统上都能够通用。NSInteger 是有符号的，NSUInteger 是无符号的。</li>
<li>构建32位应用程序时，NSInteger 是32位整数。 而64位应用程序时会将 NSInteger 视为64位整数。</li>
<li>同样地，构建32位应用程序时，NSUInteger 是一个32位无符号整数。而64位应用程序会将 NSUInteger 视为64位无符号整数。</li>
<li>使用 <code>printf()</code>输出这两种类型的变量，需要先将它们转换成对应的 long 类型。</li>
</ul>
<p>NSInteger 和 NSUInteger 只是基本整数类型的 typedef：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#if __LP64__ || NS_BUILD_32_LIKE_64</span><br><span class="line">  typedef long NSInteger;</span><br><span class="line">  typedef unsigned long NSUInteger;</span><br><span class="line">#else</span><br><span class="line">  typedef int NSInteger;</span><br><span class="line">  typedef unsigned int NSUInteger;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></p>
<p>NSInteger 和 NSUInteger 之间的相互转换，只需要做简单的投射：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSInteger myInt = 0;</span><br><span class="line">NSUInteger unsignedInt = (NSUInteger)myInt;</span><br></pre></td></tr></table></figure></p>
<h4 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h4><ul>
<li>C语言中的运算符<br>——摘自<a href="https://zh.wikipedia.org/wiki/C语言#.E5.9C.A8C.E8.AA.9E.E8.A8.80.E4.B8.AD.E7.9A.84.E8.BF.90.E7.AE.97.E7.AC.A6.E5.8F.B7" target="_blank" rel="noopener">维基百科</a><br><img src="http://upload-images.jianshu.io/upload_images/2648731-90418c36c2705e6e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></li>
<li>自增运算符（++）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Int x = 5;</span><br><span class="line">x++; // x = x + 1;</span><br></pre></td></tr></table></figure>
<ul>
<li>自减运算符（–）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Int x = 5;</span><br><span class="line">x--; // x = x - 1;</span><br></pre></td></tr></table></figure>
<ul>
<li>+=、-=、*=、／=、%=</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Int x = 5;</span><br><span class="line">x +=5; // x = x + 5;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>函数：<strong>abs()</strong>、<strong>labs()</strong></p>
<p>函数库：<strong>stdlib.h</strong></p>
</li>
</ul>
<table>
<thead>
<tr>
<th>函数名</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>abs()</td>
<td>计算 int 类型数的绝对值</td>
</tr>
<tr>
<td>labs()</td>
<td>计算 long 类型数的绝对值</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h3><ul>
<li>浮点数可以用来代表“带十进制小数的数”；</li>
<li>要区分浮点常量，可以看它是否包含小数点；</li>
<li>浮点常量可以用科学记数法表示（1.7e4 代表1.7*10^4）;</li>
<li>操作系统存储浮点数的方式：某个底数乘上一个以10为底的指数幂（指数为整数）；</li>
<li>与整数一样，浮点数也有不同的尺寸类型，但是浮点数都是<strong>有符号</strong>的。</li>
<li><code>double</code> 类型的变量可存储的范围大概是 <code>float</code> 的两倍；</li>
</ul>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>位数</th>
</tr>
</thead>
<tbody>
<tr>
<td>float</td>
<td>32位</td>
</tr>
<tr>
<td>double</td>
<td>64位</td>
</tr>
<tr>
<td>long double</td>
<td>128位</td>
</tr>
</tbody>
</table>
<h4 id="用于显示浮点数的格式说明符"><a href="#用于显示浮点数的格式说明符" class="headerlink" title="用于显示浮点数的格式说明符"></a>用于显示浮点数的格式说明符</h4><table>
<thead>
<tr>
<th>计数方法</th>
<th>格式说明符</th>
</tr>
</thead>
<tbody>
<tr>
<td>十进制计数法</td>
<td>%f</td>
</tr>
<tr>
<td>科学计数法</td>
<td>%e</td>
</tr>
<tr>
<td>以%f、%e中较短的输出宽度输出单、双精度实数，在指数小于-4或者大于等于精度时使用%e格式</td>
<td>%g</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">double y = 12345.6789;</span><br><span class="line">printf(&quot;y is %f\n&quot;,y); // y is 12345.678900</span><br><span class="line">printf(&quot;y is %e\n&quot;,y); // y is 1.234568e+04</span><br><span class="line"></span><br><span class="line">// 小数点后保留2位</span><br><span class="line">double y2 = 12345.6789;</span><br><span class="line">printf(&quot;y2 is %.2f\n&quot;,y2); // y2 is 12345.68</span><br><span class="line">printf(&quot;y2 is %.2e\n&quot;,y2); // y2 is 1.23e+04</span><br></pre></td></tr></table></figure>
<blockquote>
<p>浮点数的格式转符有8个：<strong>eEfFgGaA</strong>。但除了 <strong>%f</strong> 和 <strong>%g</strong> 外我们很少使用其它的。对于指数部分，小写的版本使用小写 e，大写的版本就使用大写 E。</p>
</blockquote>
<blockquote>
<p>通常 <strong>%g</strong> 是浮点数的全能转换符 ，它与 <strong>%f</strong> 的不同在下面的例子里显示得很清楚：<br>（ <code>%g</code>会根据变量值自动选择格式转换符（<code>%f</code> /  <code>%e</code>）用最小的位数来显示数值）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">double v[5] = &#123;12345, 12, 0.12, 0.12345678901234, 0.0000012345678901234&#125;;</span><br><span class="line">NSString *s = [NSString stringWithFormat:@&quot;%g %g %g %g %g&quot;, v[0], v[1], v[2], v[3], v[4]];</span><br><span class="line">// &quot;12345 12 0.12 0.123457 1.23457e-06&quot;</span><br><span class="line">NSString *s = [NSString stringWithFormat:@&quot;%f %f %f %f %f&quot;, v[0], v[1], v[2], v[3], v[4]];</span><br><span class="line">// &quot;12345.000000 12.000000 0.120000 0.123457 0.000001&quot;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="整数值和浮点值的相互转换"><a href="#整数值和浮点值的相互转换" class="headerlink" title="整数值和浮点值的相互转换"></a>整数值和浮点值的相互转换</h3><p>隐式转换规则：</p>
<ul>
<li>浮点值➡️整型变量，自动删除数字的小数部分。</li>
<li>整型变量➡️浮点值，不变。</li>
<li>只要表达式中的两个运算数是整型，该运算就将在整数运算规则下进行。</li>
<li>对于任何处理两个值的运算，如果其中一个值是浮点变量或常量，那么这一运算将作为浮点运算来处理。</li>
</ul>
<h3 id="数学代码库"><a href="#数学代码库" class="headerlink" title="数学代码库"></a>数学代码库</h3><ul>
<li>当要处理复杂的数学运算时，就要用到数学代码库：<strong>math.h</strong>；</li>
<li>运行Mac上的终端（Terminal）应用，输入 <code>man math</code>,可以查看数学代码库所提供的功能；</li>
<li>注意：所有与三角函数有关的函数，使用的单位都是<strong>弧度</strong>而不是角度。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/02/03/为 Windows 系统开启 Intel® Rapid Start Technology/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/02/03/为 Windows 系统开启 Intel® Rapid Start Technology/" class="post-title-link" itemprop="url">为 Windows 系统开启 Intel® Rapid Start Technology</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-02-03 23:12:00" itemprop="dateCreated datePublished" datetime="2017-02-03T23:12:00+08:00">2017-02-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-18 01:05:56" itemprop="dateModified" datetime="2019-04-18T01:05:56+08:00">2019-04-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/开发工具-Mac应用/" itemprop="url" rel="index"><span itemprop="name">开发工具&Mac应用</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/02/03/为 Windows 系统开启 Intel® Rapid Start Technology/" class="leancloud_visitors" data-flag-title="为 Windows 系统开启 Intel® Rapid Start Technology">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          <h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><p>Intel® Rapid Start Technology（IRST）：英特尔快速启动技术能够使您的系统从深度睡眠模式中更快地启动和运行，从而节省时间和功耗。</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2017/02/03/为 Windows 系统开启 Intel® Rapid Start Technology/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/19/Masonry——简化自动布局代码框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/19/Masonry——简化自动布局代码框架/" class="post-title-link" itemprop="url">Masonry——简化自动布局代码框架</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-19 17:57:00" itemprop="dateCreated datePublished" datetime="2017-01-19T17:57:00+08:00">2017-01-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 01:43:02" itemprop="dateModified" datetime="2019-04-17T01:43:02+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS-开源框架/" itemprop="url" rel="index"><span itemprop="name">iOS 开源框架</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/19/Masonry——简化自动布局代码框架/" class="leancloud_visitors" data-flag-title="Masonry——简化自动布局代码框架">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>GitHub源码: <a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">Masonry</a> </li>
<li>star:17000+</li>
</ul>
<blockquote>
<pre><code>⭐️⭐️⭐️ 
</code></pre><p>以下内容来源于官方源码、 README 文档、测试 Demo或个人使用总结 ！</p>
</blockquote>
<h1 id="Masonry"><a href="#Masonry" class="headerlink" title="Masonry"></a>Masonry</h1><p><strong>Masonry</strong> 是一个轻量级的布局框架，拥有自己的描述语法，采用更优雅的链式语法封装自动布局，简洁明了并具有高可读性。</p>
<p>Masonry利用简化、可链接和表达式的语法发挥 <strong>Auto Layout</strong> 和 <strong>NSLayoutConstraints</strong> 的力量。支持iOS和OSX <strong>Auto Layout</strong>。</p>
<p>总的来说，就是当你在 <strong>Interface Bulider</strong> 上使用 <strong>Auto Layout</strong> 的时候基本上是非常方便的，但是当我们的 <strong>UI</strong> 是用手写代码生成时，或是<strong>UI界面</strong>需要随用户交互而更改，这时候做自动布局的时候使用原生的 <strong>NSLayoutConstraints</strong> 类及其的繁琐，<strong>Masonry</strong> 用简洁的语法对<strong>Auto Layout</strong> 进行了封装，使用相对更方便。</p>
<h3 id="NSLayoutConstraints-的问题"><a href="#NSLayoutConstraints-的问题" class="headerlink" title="NSLayoutConstraints 的问题"></a>NSLayoutConstraints 的问题</h3><p>添加一个子视图，跟随父视图的大小变化，但是与父视图边距有10个点的距离：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-e9dbc519a52c663f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="使用-NSLayoutConstraints"><a href="#使用-NSLayoutConstraints" class="headerlink" title="使用 NSLayoutConstraints"></a>使用 NSLayoutConstraints</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    UIView *superview = self.view;</span><br><span class="line">    UIView *view1 = [[UIView alloc] init];</span><br><span class="line">    // 设置为NO，表示通过添加自己的约束以使用 Auto Layout 定位视图</span><br><span class="line">    view1.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line">    view1.backgroundColor = [UIColor greenColor];</span><br><span class="line">    [superview addSubview:view1];</span><br><span class="line">    </span><br><span class="line">    // 指定每个边缘的插入量（正），值可以是负的到“起点”</span><br><span class="line">    UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);</span><br><span class="line">    </span><br><span class="line">    [superview addConstraints:@[</span><br><span class="line">                                </span><br><span class="line">        // view1 constraints</span><br><span class="line">        // view1.attribute1 = multiplier × superview.attribute2 + constant</span><br><span class="line">        // view1的顶部距离父视图的顶部10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeTop</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeTop</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:padding.top],</span><br><span class="line">        // 左边距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeLeft</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeLeft</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:padding.left],</span><br><span class="line">        // 底部距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeBottom</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeBottom</span><br><span class="line">                                    multiplier:1.0</span><br><span class="line">                                      constant:-padding.bottom],</span><br><span class="line">        // 右边距离10px</span><br><span class="line">        [NSLayoutConstraint constraintWithItem:view1</span><br><span class="line">                                     attribute:NSLayoutAttributeRight</span><br><span class="line">                                     relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                        toItem:superview</span><br><span class="line">                                     attribute:NSLayoutAttributeRight</span><br><span class="line">                                    multiplier:1</span><br><span class="line">                                      constant:-padding.right],</span><br><span class="line">        ]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="使用Masonry"><a href="#使用Masonry" class="headerlink" title="使用Masonry"></a>使用Masonry</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.equalTo(superview.mas_top).with.offset(padding.top);</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding.left);</span><br><span class="line">    make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding.right);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h4 id="更短的写法"><a href="#更短的写法" class="headerlink" title="更短的写法"></a>更短的写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(superview).with.insets(padding);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h3 id="Masonry实践"><a href="#Masonry实践" class="headerlink" title="Masonry实践"></a>Masonry实践</h3><p>下面参考<a href="http://adad184.com/2014/09/28/use-masonry-to-quick-solve-autolayout/" target="_blank" rel="noopener">Masonry介绍与使用实践(快速上手Autolayout) @里脊串的开发随笔</a>，练习使用Masonry。</p>
<h4 id="需要的源码"><a href="#需要的源码" class="headerlink" title="需要的源码"></a>需要的源码</h4><ul>
<li><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">GitHub:Masonry</a></li>
<li><a href="https://github.com/adad184/MMPlaceHolder" target="_blank" rel="noopener">GitHub:MMPlaceHolder</a></li>
<li><a href="https://github.com/adad184/DemoMasonry" target="_blank" rel="noopener">GitHub:DemoMasonry</a></li>
</ul>
<h4 id="1-居中显示一个300-300的superview"><a href="#1-居中显示一个300-300的superview" class="headerlink" title="1. 居中显示一个300*300的superview"></a>1. 居中显示一个300*300的superview</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview = [UIView new];</span><br><span class="line">[superview showPlaceHolder];    // 需要导入MMPlaceHolder框架</span><br><span class="line">superview.backgroundColor = [UIColor blackColor];</span><br><span class="line">[self.view addSubview:superview];</span><br><span class="line">[superview mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.center.equalTo(self.view);</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(300, 300));</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-267b32ef5012fde1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="2-让superview1略小于其superview-边距为20"><a href="#2-让superview1略小于其superview-边距为20" class="headerlink" title="2.让superview1略小于其superview(边距为20)"></a>2.让superview1略小于其superview(边距为20)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview1 =[UIView new];</span><br><span class="line">superview1.backgroundColor = [UIColor redColor];</span><br><span class="line">[superview addSubview:superview1];</span><br><span class="line">[superview1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    // 写法一</span><br><span class="line">   make.edges.equalTo(superview).with.insets(UIEdgeInsetsMake(20, 20, 20, 20));</span><br><span class="line"></span><br><span class="line">    /** 写法二</span><br><span class="line">    make.top.equalTo(superview).with.offset(20);</span><br><span class="line">    make.left.equalTo(superview).with.offset(20);</span><br><span class="line">    make.bottom.equalTo(superview).with.offset(-20);</span><br><span class="line">    make.right.equalTo(superview).with.offset(-20);</span><br><span class="line">    **/</span><br><span class="line"></span><br><span class="line">    /** 写法三</span><br><span class="line">     make.top.left.bottom.and.right.equalTo(superview).with.insets(UIEdgeInsetsMake(20, 20, 20, 20));</span><br><span class="line">    **/</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-0572861e5411a644.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="3-让两个高度为150的view垂直居中、等宽、等间隔排列-间隔为10-自动计算其宽度"><a href="#3-让两个高度为150的view垂直居中、等宽、等间隔排列-间隔为10-自动计算其宽度" class="headerlink" title="3.让两个高度为150的view垂直居中、等宽、等间隔排列 (间隔为10 ),自动计算其宽度"></a>3.让两个高度为150的view垂直居中、等宽、等间隔排列 (间隔为10 ),自动计算其宽度</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">UIView *superview2 =[UIView new];</span><br><span class="line">superview2.backgroundColor = [UIColor orangeColor];</span><br><span class="line">[superview addSubview:superview2];</span><br><span class="line"></span><br><span class="line">UIView *superview3 =[UIView new];</span><br><span class="line">superview3.backgroundColor = [UIColor orangeColor];</span><br><span class="line">[superview addSubview:superview3];</span><br><span class="line"></span><br><span class="line">int padding1 = 10;</span><br><span class="line">[superview2 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.mas_equalTo(superview.mas_centerY);</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding1);</span><br><span class="line">    make.right.equalTo(superview3.mas_left).with.offset(-padding1);</span><br><span class="line">    make.height.mas_equalTo(@150);</span><br><span class="line">    make.width.equalTo(superview3);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[superview3 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.mas_equalTo(superview.mas_centerY);</span><br><span class="line">    make.left.equalTo(superview2.mas_right).with.offset(padding1);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding1);</span><br><span class="line">    make.height.mas_equalTo(@150);</span><br><span class="line">    make.width.equalTo(superview2);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-039fd1306120f1b4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="4-在UIScrollView-上顺序排列一些view并自动计算contentSize"><a href="#4-在UIScrollView-上顺序排列一些view并自动计算contentSize" class="headerlink" title="4.在UIScrollView 上顺序排列一些view并自动计算contentSize"></a>4.在UIScrollView 上顺序排列一些view并自动计算contentSize</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">UIScrollView *scrollView = [UIScrollView new];</span><br><span class="line">scrollView.backgroundColor = [UIColor whiteColor];</span><br><span class="line">[superview addSubview:scrollView];</span><br><span class="line">[scrollView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(superview).with.insets(UIEdgeInsetsMake(5, 5, 5, 5));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">UIView *container = [UIView new];</span><br><span class="line">[scrollView addSubview:container];</span><br><span class="line">[container mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.edges.equalTo(scrollView);</span><br><span class="line">    make.width.equalTo(scrollView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">int count = 10;</span><br><span class="line">UIView *lastView = nil;</span><br><span class="line"></span><br><span class="line">for (int i = 1;  i &lt;= count; i++) &#123;</span><br><span class="line">    UIView *subView = [UIView new];</span><br><span class="line">    [container addSubview:subView];</span><br><span class="line">    subView.backgroundColor = [UIColor colorWithHue:(arc4random() % 256 / 256.0)</span><br><span class="line">                                         saturation:(arc4random() % 128 / 256.0) + 0.5</span><br><span class="line">                                         brightness:(arc4random() % 128 / 256.0) + 0.5</span><br><span class="line">                                              alpha:1];</span><br><span class="line"></span><br><span class="line">    [subView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.left.and.right.equalTo(container);</span><br><span class="line">        make.height.mas_equalTo(@(20 * i)); // 每个子视图的高度是20的倍数</span><br><span class="line"></span><br><span class="line">        if (lastView) &#123;</span><br><span class="line">            // 下一个子视图的顶部 = 上一个子视图的底部</span><br><span class="line">            make.top.mas_equalTo(lastView.mas_bottom);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            // 第一次执行，lastView = nil,因此第一个子视图的顶部是容器的顶部</span><br><span class="line">            make.top.mas_equalTo(container.mas_top);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    lastView = subView;</span><br><span class="line">&#125;</span><br><span class="line">[container mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    // 容器的底部是最后一个视图的底部</span><br><span class="line">    make.bottom.equalTo(lastView.mas_bottom);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-c93a5fceecc4012d.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="5-横向或者纵向等间隙的排列一组view"><a href="#5-横向或者纵向等间隙的排列一组view" class="headerlink" title="5.横向或者纵向等间隙的排列一组view"></a>5.横向或者纵向等间隙的排列一组view</h4><blockquote>
<p>11/15 添加<br>均匀分布一组view推荐使用 <code>NSArray+MASAdditions.h</code> 类中的两个方法:</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  distribute with fixed spacing</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> axisType     which axis to distribute items along</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> fixedSpacing the spacing between each item</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> leadSpacing  the spacing before the first item and the container</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> tailSpacing  the spacing after the last item and the container</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">mas_distributeViewsAlongAxis:</span>(MASAxisType)axisType <span class="string">withFixedSpacing:</span>(CGFloat)fixedSpacing <span class="string">leadSpacing:</span>(CGFloat)leadSpacing <span class="string">tailSpacing:</span>(CGFloat)tailSpacing;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  distribute with fixed item size</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> axisType        which axis to distribute items along</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> fixedItemLength the fixed length of each item</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> leadSpacing     the spacing before the first item and the container</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> tailSpacing     the spacing after the last item and the container</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">mas_distributeViewsAlongAxis:</span>(MASAxisType)axisType <span class="string">withFixedItemLength:</span>(CGFloat)fixedItemLength <span class="string">leadSpacing:</span>(CGFloat)leadSpacing <span class="string">tailSpacing:</span>(CGFloat)tailSpacing;</span><br></pre></td></tr></table></figure>
<p><del>需要使用封装的 category 类:</del></p>
<ul>
<li><strong>UIView+LJC.h</strong>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 横向或者纵向等间隙的排列一组view</span><br><span class="line"> */</span><br><span class="line">@interface UIView (LJC)</span><br><span class="line"></span><br><span class="line">- (void) distributeSpacingHorizontallyWith:(NSArray*)views;</span><br><span class="line"></span><br><span class="line">- (void) distributeSpacingVerticallyWith:(NSArray*)views;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>UIView+LJC.m</strong>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;UIView+LJC.h&quot;</span><br><span class="line">#import &lt;Masonry/Masonry.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation UIView (LJC)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 横向排列一组view</span><br><span class="line"></span><br><span class="line"> @param views view数组</span><br><span class="line"> */</span><br><span class="line">- (void) distributeSpacingHorizontallyWith:(NSArray*)views</span><br><span class="line">&#123;</span><br><span class="line">    NSMutableArray *spaces = [NSMutableArray arrayWithCapacity:views.count+1];</span><br><span class="line">    </span><br><span class="line">    for ( int i = 0 ; i &lt; views.count+1 ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *v = [UIView new];</span><br><span class="line">        [spaces addObject:v];</span><br><span class="line">        [self addSubview:v];</span><br><span class="line">        </span><br><span class="line">        [v mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.width.equalTo(v.mas_height);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    UIView *v0 = spaces[0];</span><br><span class="line">    </span><br><span class="line">    [v0 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.left.equalTo(self.mas_left);</span><br><span class="line">        make.centerY.equalTo(((UIView*)views[0]).mas_centerY);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    UIView *lastSpace = v0;</span><br><span class="line">    for ( int i = 0 ; i &lt; views.count; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *obj = views[i];</span><br><span class="line">        UIView *space = spaces[i+1];</span><br><span class="line">        </span><br><span class="line">        [obj mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(lastSpace.mas_right);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        [space mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.left.equalTo(obj.mas_right);</span><br><span class="line">            make.centerY.equalTo(obj.mas_centerY);</span><br><span class="line">            make.width.equalTo(v0);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        lastSpace = space;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [lastSpace mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.right.equalTo(self.mas_right);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 垂直排列一组view</span><br><span class="line"></span><br><span class="line"> @param views view数组</span><br><span class="line"> */</span><br><span class="line">- (void) distributeSpacingVerticallyWith:(NSArray*)views</span><br><span class="line">&#123;</span><br><span class="line">    NSMutableArray *spaces = [NSMutableArray arrayWithCapacity:views.count+1];</span><br><span class="line">    </span><br><span class="line">    for ( int i = 0 ; i &lt; views.count+1 ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *v = [UIView new];</span><br><span class="line">        [spaces addObject:v];</span><br><span class="line">        [self addSubview:v];</span><br><span class="line">        </span><br><span class="line">        [v mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.width.equalTo(v.mas_height);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    UIView *v0 = spaces[0];</span><br><span class="line">    </span><br><span class="line">    [v0 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.top.equalTo(self.mas_top);</span><br><span class="line">        make.centerX.equalTo(((UIView*)views[0]).mas_centerX);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    UIView *lastSpace = v0;</span><br><span class="line">    for ( int i = 0 ; i &lt; views.count; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        UIView *obj = views[i];</span><br><span class="line">        UIView *space = spaces[i+1];</span><br><span class="line">        </span><br><span class="line">        [obj mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.top.equalTo(lastSpace.mas_bottom);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        [space mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.top.equalTo(obj.mas_bottom);</span><br><span class="line">            make.centerX.equalTo(obj.mas_centerX);</span><br><span class="line">            make.height.equalTo(v0);</span><br><span class="line">        &#125;];</span><br><span class="line">        </span><br><span class="line">        lastSpace = space;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [lastSpace mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        make.bottom.equalTo(self.mas_bottom);</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li>实例测试：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">UIView *subView11 = [UIView new];</span><br><span class="line">UIView *subView12 = [UIView new];</span><br><span class="line">UIView *subView13 = [UIView new];</span><br><span class="line">UIView *subView21 = [UIView new];</span><br><span class="line">UIView *subView31 = [UIView new];</span><br><span class="line"></span><br><span class="line">subView11.backgroundColor = [UIColor redColor];</span><br><span class="line">subView12.backgroundColor = [UIColor redColor];</span><br><span class="line">subView13.backgroundColor = [UIColor redColor];</span><br><span class="line">subView21.backgroundColor = [UIColor redColor];</span><br><span class="line">subView31.backgroundColor = [UIColor redColor];</span><br><span class="line"></span><br><span class="line">[superview addSubview:subView11];</span><br><span class="line">[superview addSubview:subView12];</span><br><span class="line">[superview addSubview:subView13];</span><br><span class="line">[superview addSubview:subView21];</span><br><span class="line">[superview addSubview:subView31];</span><br><span class="line"></span><br><span class="line">//给予不同的大小，测试结果</span><br><span class="line"></span><br><span class="line">[subView11 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.centerY.equalTo(@[subView12,subView13]); // 11、12、13 Y方向对齐</span><br><span class="line">    make.centerX.equalTo(@[subView21,subView31]); // 11、21、31 X方向对齐</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(40, 40));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView12 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(30, 30));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView13 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(20, 20));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView21 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(50, 50));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subView31 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.size.mas_equalTo(CGSizeMake(60, 60));</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[superview distributeSpacingHorizontallyWith:@[subView11,subView12,subView13]];</span><br><span class="line">[superview distributeSpacingVerticallyWith:@[subView11,subView21,subView31]];</span><br><span class="line"></span><br><span class="line">[superview showPlaceHolderWithAllSubviews];</span><br><span class="line">[superview hidePlaceHolder];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用空白的占位view填充目标view的旁边</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-06bc5eb7dfff4d34.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>继续参考：<a href="https://www.zybuluo.com/kezhen/note/147167" target="_blank" rel="noopener">Masonry使用总结</a>，学习使用 Masonry；</p>
<h4 id="6-Masonry的比例使用-multipliedBy"><a href="#6-Masonry的比例使用-multipliedBy" class="headerlink" title="6.Masonry的比例使用 multipliedBy"></a>6.Masonry的比例使用 multipliedBy</h4><p>使用<strong>multipliedBy</strong>必须是对<strong>同一个控件本身</strong>，如果修改成相对于其它控件会导致Crash。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">UIView *topView = [UIView new]<span class="comment">;</span></span><br><span class="line">[topView setBackgroundColor:[UIColor redColor]]<span class="comment">;</span></span><br><span class="line">[self.view <span class="keyword">addSubview:topView];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">UIView </span>*topInnerView = [UIView new]<span class="comment">;</span></span><br><span class="line">[topInnerView setBackgroundColor:[UIColor greenColor]]<span class="comment">;</span></span><br><span class="line">[topInnerView <span class="keyword">showPlaceHolder];</span></span><br><span class="line"><span class="keyword">[self.view </span><span class="keyword">addSubview:topInnerView];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">UIView </span>*<span class="keyword">bottomView </span>=[UIView new]<span class="comment">;</span></span><br><span class="line">[<span class="keyword">bottomView </span>setBackgroundColor:[UIColor <span class="keyword">blueColor]];</span></span><br><span class="line"><span class="keyword">[self.view </span><span class="keyword">addSubview:bottomView];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">UIView </span>*<span class="keyword">bottomInnerView </span>=[UIView new]<span class="comment">;</span></span><br><span class="line">[<span class="keyword">bottomInnerView </span>setBackgroundColor:[UIColor <span class="keyword">blackColor]];</span></span><br><span class="line"><span class="keyword">[bottomInnerView </span><span class="keyword">showPlaceHolder];</span></span><br><span class="line"><span class="keyword">[self.view </span><span class="keyword">addSubview:bottomInnerView];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">[topView </span>mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.left.<span class="keyword">and.right.mas_equalTo(0);</span></span><br><span class="line"><span class="keyword"> </span>   make.height.mas_equalTo(<span class="keyword">bottomView);</span></span><br><span class="line"><span class="keyword">&#125;];</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">[topInnerView </span>mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.<span class="keyword">and.right.mas_equalTo(0);</span></span><br><span class="line"><span class="keyword"> </span>   make.width.mas_equalTo(topInnerView.mas_height).<span class="keyword">multipliedBy(3);</span></span><br><span class="line"><span class="keyword"> </span>   make.center.mas_equalTo(topView)<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">[<span class="keyword">bottomView </span>mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.<span class="keyword">bottom.and.right.mas_equalTo(0);</span></span><br><span class="line"><span class="keyword"> </span>   make.height.mas_equalTo(topView)<span class="comment">;</span></span><br><span class="line">    make.top.mas_equalTo(topView.mas_bottom)<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">[<span class="keyword">bottomInnerView </span>mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.<span class="keyword">and.bottom.mas_equalTo(bottomView);</span></span><br><span class="line"><span class="keyword"> </span>   make.height.mas_equalTo(<span class="keyword">bottomInnerView.mas_width).multipliedBy(3);</span></span><br><span class="line"><span class="keyword"> </span>   make.center.mas_equalTo(<span class="keyword">bottomView);</span></span><br><span class="line"><span class="keyword">&#125;];</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-fd5dee7c4a43a469.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h4 id="7-使用priority优先级属性来做简单的动画"><a href="#7-使用priority优先级属性来做简单的动画" class="headerlink" title="7.使用priority优先级属性来做简单的动画"></a>7.使用priority优先级属性来做简单的动画</h4><blockquote>
<p>.priority allows you to specify an exact priority</p>
<p>.priorityHigh equivalent to <strong>UILayoutPriorityDefaultHigh</strong></p>
<p>.priorityMedium is half way between high and low</p>
<p>.priorityLow equivalent to <strong>UILayoutPriorityDefaultLow</strong></p>
</blockquote>
<ol>
<li>先为blueView设置属性：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic,strong) UIView *blueView;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>2.创建视图并设置约束：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// 红色视图</span><br><span class="line">UIView *redView = [UIView new];</span><br><span class="line">redView.backgroundColor = [UIColor redColor];</span><br><span class="line">[self.view addSubview:redView];</span><br><span class="line"></span><br><span class="line">// 蓝色视图</span><br><span class="line">self.blueView = [UIView new];</span><br><span class="line">self.blueView.backgroundColor = [UIColor blueColor];</span><br><span class="line">[self.view addSubview:self.blueView];</span><br><span class="line"></span><br><span class="line">// 黄色视图</span><br><span class="line">UIView *yellowView = [UIView new];</span><br><span class="line">yellowView.backgroundColor = [UIColor yellowColor];</span><br><span class="line">[self.view addSubview:yellowView];</span><br><span class="line"></span><br><span class="line">// ————红色视图约束————</span><br><span class="line">[redView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.mas_equalTo(self.view.mas_left).with.offset(20);</span><br><span class="line">    make.bottom.mas_equalTo(self.view.mas_bottom).with.offset(-80);</span><br><span class="line">    make.height.mas_equalTo(50);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">// ————蓝色视图约束————</span><br><span class="line">[self.blueView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.left.mas_equalTo(redView.mas_right).with.offset(40);</span><br><span class="line">    make.bottom.width.and.height.with.height.mas_equalTo(redView);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">// ————黄色视图约束————</span><br><span class="line">[yellowView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">  	// 默认满足高优先级约束</span><br><span class="line">    make.left.mas_equalTo(self.blueView.mas_right).with.offset(40);</span><br><span class="line">    make.right.mas_equalTo(self.view.mas_right).with.offset(-20);</span><br><span class="line">    make.bottom.width.and.height.mas_equalTo(redView);</span><br><span class="line"></span><br><span class="line">    //** priority设置为250，最高1000（默认）**</span><br><span class="line">    make.left.mas_equalTo(redView.mas_right).with.offset(20).priority(250);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>3.点击屏幕移除蓝色视图方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    [self.blueView removeFromSuperview];</span><br><span class="line">    [UIView animateWithDuration:1.0 animations:^&#123;</span><br><span class="line">        [self.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注释：黄色视图的<strong>left</strong>属性分别设置了两个约束，一个相对于蓝色视图的高优先级约束：<code>make.left.mas_equalTo(self.blueView.mas_right).with.offset(40);</code></p>
<p>另一个相对于红色视图的低优先级约束：<code>make.left.mas_equalTo(redView.mas_right).with.offset(20).priority(250);</code></p>
<p>当蓝色视图存在时，两个约束同时存在，为避免约束冲突，系统默认满足高优先级的约束；</p>
<p>当点击屏幕，蓝色视图被移除后，低优先级的约束就会生效。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-30f240cd53c469ea.gif?imageMogr2/auto-orient/strip" alt></p>
<h4 id="8-Masonry更新约束方法：mas-updateConstraints"><a href="#8-Masonry更新约束方法：mas-updateConstraints" class="headerlink" title="8.Masonry更新约束方法：mas_updateConstraints"></a>8.Masonry更新约束方法：mas_updateConstraints</h4><p>如果你只想更新约束的常量值，则可以使用更方便的方法:<code>mas_updateConstraints</code>而不是<code>mas_makeConstraints</code>。</p>
<ol>
<li><p>创建一个Button属性、scale属性用于记录放大比例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController ()</span><br><span class="line">@property (nonatomic,strong) UIButton *growingButton;</span><br><span class="line">@property (nonatomic,assign) CGFloat scale;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建Button实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">self.growingButton = [UIButton buttonWithType:UIButtonTypeSystem];</span><br><span class="line">[self.growingButton setTitle:@&quot;点我放大&quot; forState:UIControlStateNormal];</span><br><span class="line">self.growingButton.layer.borderColor = UIColor.greenColor.CGColor;</span><br><span class="line">self.growingButton.layer.borderWidth = 3;</span><br><span class="line">[self.growingButton addTarget:self action:@selector(onGrowButtonTaped:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">[self.view addSubview:self.growingButton];</span><br><span class="line">self.scale = 1.0;</span><br><span class="line"></span><br><span class="line">[self.growingButton mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.center.mas_equalTo(self.view);</span><br><span class="line">    // 初始宽、高为100，优先级最低</span><br><span class="line">    make.width.height.mas_equalTo(100 * self.scale);</span><br><span class="line">    // 最大放大到整个view</span><br><span class="line">    make.width.and.height.lessThanOrEqualTo(self.view);</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击Button方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)onGrowButtonTaped:(UIButton *)sender &#123;</span><br><span class="line">    self.scale += 1.0;</span><br><span class="line">    </span><br><span class="line">    //告诉self.view约束需要更新</span><br><span class="line">    [self.view setNeedsUpdateConstraints];</span><br><span class="line">    </span><br><span class="line">    //调用此方法告诉self.view检测是否需要更新约束，若需要则更新。下面添加的动画效果才起作用</span><br><span class="line">    [self.view updateConstraintsIfNeeded];</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:0.3 animations:^&#123;</span><br><span class="line">        [self.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新约束：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 这是Apple推荐的添加/更新约束的地方</span><br><span class="line">// 此方法可以被多次调用，以响应 setNeedsUpdateConstraints</span><br><span class="line">// 如果您需要触发对约束的更新，可以在UIKit内部或你的代码中调用该方法</span><br><span class="line">- (void)updateViewConstraints &#123;</span><br><span class="line">    [self.growingButton mas_updateConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        //这里写需要更新的约束，不用更新的约束将继续存在，并不会被取代</span><br><span class="line">        make.width.and.height.mas_equalTo(100*self.scale);</span><br><span class="line">    &#125;];</span><br><span class="line">  	// //根据Apple要求，super方法应该在方法结束时调用</span><br><span class="line">    [super updateViewConstraints];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>   <img src="http://upload-images.jianshu.io/upload_images/2648731-ad606f82654fc2c0.gif?imageMogr2/auto-orient/strip" alt></p>
<p>代码执行顺序：</p>
<blockquote>
<p><strong>-[ViewController viewDidLoad]</strong></p>
<p><strong>-[ViewController createGrowingButton]</strong></p>
<p><strong>mas_makeConstraints</strong></p>
<p> <strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
<p>点击按钮</p>
<p><strong>-[ViewController onGrowButtonTaped:]</strong></p>
<p><strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
<p>点击按钮</p>
<p><strong>-[ViewController onGrowButtonTaped:]</strong></p>
<p><strong>-[ViewController updateViewConstraints]</strong></p>
<p><strong>mas_updateConstraints</strong></p>
</blockquote>
<h5 id="更新约束和布局的相关方法"><a href="#更新约束和布局的相关方法" class="headerlink" title="更新约束和布局的相关方法"></a>更新约束和布局的相关方法</h5><ul>
<li>关于UIView重新布局相关的API，主要用以下三个API：</li>
</ul>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(void)</span>setNeedsLayout  标记为需要在下一个周期重新布局</span><br><span class="line">- <span class="params">(void)</span>layoutIfNeeded  查看当前视图是否被标记需要重新布局，有则在内部调用layoutSubviews方法立即进行重新布局</span><br><span class="line">- <span class="params">(void)</span>layoutSubviews  重写当前方法，在内部完成重新布局操作,不要直接调用，如果需要强制更新布局，调用 setNeedsLayout<span class="params">()</span></span><br></pre></td></tr></table></figure>
<ul>
<li>关于更新约束布局相关的API，主要用以下四个API：</li>
</ul>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(void)</span>setNeedsUpdateConstraints  标记需要进行重新布局，系统会调用 updateConstraints<span class="params">()</span>方法，修改多个约束后调用该方法批量更新有助于提升性能</span><br><span class="line">- <span class="params">(BOOL)</span>needsUpdateConstraints     当前是否需要重新布局，内部会判断当前有没有被标记的约束</span><br><span class="line">- <span class="params">(void)</span>updateConstraintsIfNeeded  调用此方法，如果有标记为需要重新布局的约束，则立即进行重新布局，内部会调用  updateConstraints方法</span><br><span class="line">- <span class="params">(void)</span>updateConstraints          重写此方法，内部实现自定义布局过程</span><br></pre></td></tr></table></figure>
<h4 id="9-Masonry的重写约束：mas-remakeConstraints"><a href="#9-Masonry的重写约束：mas-remakeConstraints" class="headerlink" title="9.Masonry的重写约束：mas_remakeConstraints"></a>9.Masonry的重写约束：mas_remakeConstraints</h4><blockquote>
<p><code>mas_updateConstraints</code> is useful for updating a set of constraints, but doing anything <em>beyond updating constant values</em>  can get exhausting. That’s where <code>mas_remakeConstraints</code> comes in.</p>
<p><code>mas_remakeConstraints</code> is similar to <code>mas_updateConstraints</code>, but instead of updating constant values, it will remove all of its constraints before installing them again. This lets you provide different constraints without having to keep around references to ones which you want to remove.</p>
</blockquote>
<ol>
<li>创建一个Button属性、isExpanded属性用于记录按钮状态：</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">UIButton</span> *growingButton;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">BOOL</span> isExpanded;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>创建Button实例：</li>
</ol>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">self.isExpanded</span> = <span class="literal">NO</span>;</span><br><span class="line"><span class="attr">self.growingButton</span> = [UIButton buttonWithType:UIButtonTypeSystem];</span><br><span class="line"><span class="section">[self.growingButton setTitle:@"点我展开" forState:UIControlStateNormal]</span><span class="comment">;</span></span><br><span class="line"><span class="attr">self.growingButton.layer.borderColor</span> = UIColor.greenColor.CGColor;</span><br><span class="line"><span class="attr">self.growingButton.layer.borderWidth</span> = <span class="number">3</span>;</span><br><span class="line"><span class="attr">self.growingButton.backgroundColor</span> = [UIColor redColor];</span><br><span class="line"><span class="section">[self.growingButton addTarget:self action:@selector(onGrowButtonTaped:) forControlEvents:UIControlEventTouchUpInside]</span><span class="comment">;</span></span><br><span class="line"><span class="section">[self.view addSubview:_growingButton]</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[self.growingButton mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span></span><br><span class="line"><span class="section">    make.top.and.left.mas_equalTo(100);</span></span><br><span class="line"><span class="section">    make.bottom.mas_equalTo(-350);</span></span><br><span class="line"><span class="section">    make.right.mas_equalTo(-100);</span></span><br><span class="line"><span class="section">&#125;]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>点击Button方法：</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)onGrowButtonTaped:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.isExpanded = !<span class="keyword">self</span>.isExpanded;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.isExpanded) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.growingButton setTitle:<span class="string">@"点我展开"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.growingButton setTitle:<span class="string">@"点我收起"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.view setNeedsUpdateConstraints];</span><br><span class="line">    [<span class="keyword">self</span>.view updateConstraintsIfNeeded];</span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.3</span> animations:^&#123;</span><br><span class="line">        [<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>更新约束：</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)updateViewConstraints &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>,__func__);</span><br><span class="line">    <span class="comment">// 这里使用update也能实现效果，而remark会将之前的约束全部移除，然后重新添加</span></span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span> (<span class="keyword">self</span>)weakself = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.growingButton mas_remakeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">        <span class="comment">// 重写全部约束</span></span><br><span class="line">        <span class="keyword">if</span> (weakself.isExpanded) &#123;</span><br><span class="line">            make.top.and.left.mas_equalTo(<span class="number">0</span>);</span><br><span class="line">            make.bottom.mas_equalTo(<span class="number">10</span>);</span><br><span class="line">            make.right.mas_equalTo(<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            make.top.and.left.mas_equalTo(<span class="number">100</span>);</span><br><span class="line">            make.bottom.mas_equalTo(<span class="number">-350</span>);</span><br><span class="line">            make.right.mas_equalTo(<span class="number">-100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    [<span class="keyword">super</span> updateViewConstraints];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现结果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-7f6f17b8a615be53.gif?imageMogr2/auto-orient/strip" alt></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><blockquote>
<p>By default, macros which support <a href="https://en.wikipedia.org/wiki/Autoboxing#Autoboxing" target="_blank" rel="noopener">autoboxing</a> are prefixed with mas_. Unprefixed versions are available by defining MAS_SHORTHAND_GLOBALS before importing Masonry.</p>
<p>​                                                            ——摘自<a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">Masonary:README.md</a></p>
<ul>
<li>为了增加代码的可读性这里有两个简化代码的宏：<code>#define MAS_SHORTHAND</code>和<code>#define MAS_SHORTHAND_GLOBALS</code></li>
</ul>
<ul>
<li><p><code>MAS_SHORTHAND</code>：只要在导入<strong>Masonry</strong>主头文件之前定义这个宏, 那么以后在使用<strong>Masonry</strong>框架中的属性和方法的时候, 就可以省略<strong>mas_</strong>前缀</p>
</li>
<li><p><code>MAS_SHORTHAND_GLOBALS</code>：只要在导入Masonry主头文件之前定义这个宏,那么就可以让<code>equalTo</code>函数接收基本数据类型, 内部会对基本数据类型进行包装 </p>
</li>
<li><p>注意：这两个宏如果想有效使用，必须要在添加<strong>Masonry</strong>头文件之前导入进去。在没有增加宏<code>MAS_SHORTHAND_GLOBALS</code>时，下面这句是会报错的。 </p>
</li>
<li><p><code>make.top.equalTo(42); --&gt; make.top.equalTo([NSNumber numberWithInt:42]);</code></p>
<p>​                                                    ——摘自<a href="https://www.zybuluo.com/kezhen/note/147167" target="_blank" rel="noopener">Masonry使用总结</a></p>
</li>
</ul>
</blockquote>
<p>注意：有时候写约束语法的时候 <strong>with</strong> 经常会不小心写成 <strong>width</strong>,就像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make.bottom.mas_equalTo(self.view.mas_bottom).width.offset(-80);</span><br></pre></td></tr></table></figure>
<p>于是会报这样的错误：</p>
<blockquote>
<p>Attributes should be chained before defining the constraint relation.</p>
<p>属性应该在定义约束关系之前链接.</p>
</blockquote>
<p>记得仔细查找这种错误并改正。</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><a href="http://blog.lessfun.com/blog/2014/10/17/ios-autolayout-vs-autosizing/" target="_blank" rel="noopener">iOS AutoLayout与AutoSizing：自动布局，想说爱你真的好难</a></li>
<li><a href="http://adad184.com/2014/09/28/use-masonry-to-quick-solve-autolayout/" target="_blank" rel="noopener">Masonry介绍与使用实践(快速上手Autolayout) @里脊串的开发随笔</a> ⭐️⭐️⭐️</li>
<li><a href="https://www.zybuluo.com/kezhen/note/147167" target="_blank" rel="noopener">Masonry使用总结</a> ⭐️⭐️⭐️</li>
<li><a href="http://www.jianshu.com/p/ea74b230c70d" target="_blank" rel="noopener">简书：iOS自动布局框架-Masonry详解 @刘小壮</a></li>
<li><a href="http://hao.jobbole.com/masonry-ios/" target="_blank" rel="noopener">Masonry:使用纯代码进行iOS应用的autolayout自适应布局 @伯乐在线</a></li>
<li><a href="http://www.cocoachina.com/ios/20150702/12217.html" target="_blank" rel="noopener">iOS自适应前段库-Masonry的使用</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/18/翻译文章：iOS-7中的自动布局教程第1部分：入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/18/翻译文章：iOS-7中的自动布局教程第1部分：入门/" class="post-title-link" itemprop="url">翻译文章：iOS 7 中的自动布局教程第1部分：入门</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-18 14:42:00" itemprop="dateCreated datePublished" datetime="2017-01-18T14:42:00+08:00">2017-01-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-18 01:02:27" itemprop="dateModified" datetime="2019-04-18T01:02:27+08:00">2019-04-18</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/翻译文档/" itemprop="url" rel="index"><span itemprop="name">翻译文档</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/18/翻译文章：iOS-7中的自动布局教程第1部分：入门/" class="leancloud_visitors" data-flag-title="翻译文章：iOS 7 中的自动布局教程第1部分：入门">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<blockquote>
<p>参考外文学习并使用<strong>Auto Layout</strong>,顺便翻译记录一下。</p>
</blockquote>
<h3 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h3><ul>
<li><a href="https://www.raywenderlich.com/50317/beginning-auto-layout-tutorial-in-ios-7-part-1" target="_blank" rel="noopener">Beginning Auto Layout Tutorial in iOS 7: Part 1</a> @Matthijs Hollemans on October 16, 2013</li>
<li><p><a href="https://www.raywenderlich.com/50319/beginning-auto-layout-tutorial-in-ios-7-part-2" target="_blank" rel="noopener">Beginning Auto Layout Tutorial in iOS 7: Part 2</a> @Matthijs Hollemans on October 16, 2013</p>
<h4 id="作者-Matthijs-Hollemans"><a href="#作者-Matthijs-Hollemans" class="headerlink" title="作者 : Matthijs Hollemans"></a>作者 : Matthijs Hollemans</h4><p>  <strong>Matthijs Hollemans</strong>是一位独立的开发人员和设计师。 <a href="http://www.matthijshollemans.com" target="_blank" rel="noopener">访问他的网站</a>。<br><img src="http://upload-images.jianshu.io/upload_images/2648731-29ee036c74ec6fba?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt> </p>
</li>
<li><p>注：第一篇文章翻译到一半的时候发现早就有人都翻译好了，就是下面的这两篇，但咱也不能烂尾啊不是，干脆就自己再翻译着再啃一遍吧。</p>
</li>
<li><a href="http://www.cocoachina.com/industry/20131203/7462.html" target="_blank" rel="noopener">开始iOS 7中自动布局教程(一)</a></li>
<li><a href="http://www.cnblogs.com/zer0Black/p/3977288.html" target="_blank" rel="noopener">开始iOS 7中自动布局教程(二)</a>  </li>
</ul>
<hr>
<h3 id="iOS-9-Xcode-7-Swift-2-环境下可以参考"><a href="#iOS-9-Xcode-7-Swift-2-环境下可以参考" class="headerlink" title="iOS 9, Xcode 7, Swift 2 环境下可以参考:"></a>iOS 9, Xcode 7, Swift 2 环境下可以参考:</h3><ul>
<li><a href="https://www.raywenderlich.com/115440/auto-layout-tutorial-in-ios-9-part-1-getting-started-2" target="_blank" rel="noopener">Auto Layout Tutorial in iOS 9 Part 1: Getting Started</a> @ Bradley Johnson on September 22, 2015</li>
<li><p><a href="https://www.raywenderlich.com/115444/auto-layout-tutorial-in-ios-9-part-2-constraints" target="_blank" rel="noopener">Auto Layout Tutorial in iOS 9 Part 2: Constraints</a></p>
<h4 id="作者-Bradley-Johnson"><a href="#作者-Bradley-Johnson" class="headerlink" title="作者 : Bradley Johnson"></a>作者 : Bradley Johnson</h4><p>  一名位于西雅图 Getty Images Inc.公司的移动开发人员。具有大约4年的iOS开发经验。<br>  <img src="http://upload-images.jianshu.io/upload_images/2648731-3a34e658ecd58bce?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt>   </p>
</li>
</ul>
<h1 id="iOS-7中的自动布局教程第1部分：入门"><a href="#iOS-7中的自动布局教程第1部分：入门" class="headerlink" title="iOS 7中的自动布局教程第1部分：入门"></a>iOS 7中的自动布局教程第1部分：入门</h1><p>来自Ray的注释:教程团队成员 <strong>Matthijs Hollemans</strong>（iOS Apprentice系列作者）已将此教程移植到iOS 7作为 <a href="https://www.raywenderlich.com/49762/introducing-the-ios-7-feast" target="_blank" rel="noopener">iOS 7系列</a> 的一部分。我们希望你会喜欢！</p>
<p>设想这样一个场景，如果你想让你的应用程序能够在手机竖屏和横屏状态下都能正常显示，但是调试起来却是一件足够令人崩溃的事情。另外，想要约束屏幕布局让APP同时支持iPhone和iPad，是否是一件足以把你逼到绝望边缘的事情？ 别灰心，这篇文章会给你带来好消息！   </p>
<p>为屏幕设计一个总是能保证大小相同的用户界面并不困难，但如果屏幕的frame是可以改变的，UI元素的位置和大小也必须适应这些新的尺寸变化。</p>
<p>到目前为止，如果你的设计是相当复杂的，你就必须编写大量的代码来支持这种自适应布局。 你会很高兴听到这再也不是个麻烦了——iOS 6给iPhone和iPad带来了一个非常棒的新功能：<strong>自动布局（Auto Layout）</strong>。 Xcode 5和iOS 7让它实现得更好！如果你尝试在Xcode 4中实现自动布局并想放弃时，那么你真的应该给Xcode 5一个机会了。</p>
<p>Auto Layout不仅可以轻松地在应用程序中支持不同的屏幕的尺寸，而且还可以使国际化实现变得非常方便。你不再需要为希望支持的每种语言创建新的nib文件或storyboard文件，这包括从右到左的语言，如希伯来语（Hebrew）或阿拉伯语（Arabic）。</p>
<p>此自动布局教程将向您介绍如何在<strong>Interface Builder</strong>中开始使用自动布局。 在<a href="https://www.raywenderlich.com/store/ios-6-by-tutorials" target="_blank" rel="noopener">iOS 6 by Tutorials Third Edition</a>教程中，我们将本教程向深层次推进，然后会有一个新的章节，基于这些知识，并展示如何通过代码实现Auto Layout的全部功能。</p>
<blockquote>
<p>提示：我们正在将基于iOS 6上的所有教程到更新到iOS 7 上——这是一个预览版本！ 当我们完成所有的更新后，更新将免费下载到所有iOS 6的Tutorials PDF客户手中。</p>
</blockquote>
<p>所以吃着点心和你最喜欢的咖啡饮料，准备好成为一个自动布局（Auto Layout）大师吧！</p>
<h2 id="弹簧和支柱（Autosizing）的问题"><a href="#弹簧和支柱（Autosizing）的问题" class="headerlink" title="弹簧和支柱（Autosizing）的问题"></a>弹簧和支柱（Autosizing）的问题</h2><p>毫无疑问你一定对<strong>autosizing masks</strong>非常熟悉 - 它也常被称为“弹簧和支柱”模型。 <strong>autosizing masks</strong>确定了当父视图更改大小时，相应子视图发生的改变。 它是否有灵活或固定的边距（<strong>margins</strong>）（支柱），以及它的宽度和高度（弹簧）发生的变化？</p>
<p>例如，如果子视图使用灵活可变的宽度，当父视图变得更宽时，则子视图将成比例地变宽。 如果使用固定的右边距，子视图的右边缘将始终贴着父视图（superview）的右边缘。</p>
<p><strong>Autosizing</strong> 系统适用于简单的情况，但是当你的布局变得更复杂时，它很快就会失效。 让我们来看一个弹簧和支柱完全失效的例子。</p>
<p>打开Xcode 5并创建一个新的基于 <strong>Single View Application</strong> 模板的iPhone项目。 设置应用程序名为：StrutsProblem</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-497cd3b315c408b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1"></p>
<p>点击 <strong>Main.storyboard</strong> 以打开Interface Builder（界面生成器）界面。在做任何操作之前，先禁用该storyboard的Auto Layout功能。你可以在右侧工具栏的六个标签中的第一个 <strong>File Inspector</strong> (文件检视器)中执行该操作。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-cae9307740861995.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2"></p>
<p>取消勾选<strong>Use Autolayout</strong>。 现在storyboard就会使用旧的支柱和弹簧(struts-and-springs)模型.</p>
<blockquote>
<p>译者注：我在Xcode 8环境下取消勾选的对话框界面如下：</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-d038ab730bae7ee9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>取消勾选<strong>Use Auto Layout</strong>后，会弹出如下对话框：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-f1933a1cdb5c97be.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><strong>Trait Variations</strong>:用来声明APP在不同设备上的不同特征。使用<strong>特征变量(Trait Variations)</strong>需要 <strong>Autolayout</strong> 支持，因此如果取消勾选<strong>Use Autolayout</strong>，那么<strong>特征变量(Trait Variations)</strong>也会不可用。</p>
<p>禁用特征变量(Trait Variations)将文档限制为存储单个设备的数据。用于表示目标设备系列的性状集合的数据将被保留，并且所有其他数据将被删除。此外，segues 将被转换为它们的非适应性等效。</p>
<p>这里我们点击 <strong>Disable Trait Variations</strong>。</p>
<ul>
<li>关于<a href="http://www.skyfox.org/ios-use-trait-variations.html" target="_blank" rel="noopener">特征变量</a></li>
</ul>
<blockquote>
<p>注意：使用Xcode 4.5或更高版本创建的任何新的nib或storyboard文件将默认开启Auto Layout。 因为Auto Layout是iOS 6及以上系统的新特性，如果你想使用最新的Xcode来开发与iOS 5兼容的应用程序，你需要通过取消选中“Use Autolayout“复选框,在任何新创建的nib或storyboard上禁用Auto layout。</p>
</blockquote>
<p>拖动三个新视图UIView到主视图上，并按照这样的方式排列：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-76b1c2df704a4dc7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>为了便于清晰理解，给每一个新视图设置它们自己的颜色以便于区分是哪个。</p>
<p>每个视图距离窗口的边框20pt; 视图之间的距离也是20pt。 底部视图是280pt宽，顶部的两个视图都是130 pt宽。 所有的视图都是254pt高。</p>
<p>运行APP在 <strong>iPhone Retina 4-inch 模拟器</strong>（没有的话也可以用iPhone SE代替）上，旋转模拟器至横屏状态。这时APP看起来是这样子的，并不是我所期待的样子：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-a9ea86d3d61316d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>注意：你可以使用菜单栏中的 <strong>Hardware\Rotate Left</strong> 和 <strong>Rotate Right </strong> 选项来旋转模拟器，或者通过按住键盘 <strong>⌘</strong> 同时按向左或者向右的方向键来实现屏幕旋转。</p>
</blockquote>
<p>相反，你想要APP在横屏状态下应该是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9c52bd1497af653c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>显然，autosizing masks为所有三个视图留了一些需要设置的东西。 将左上角视图的 autosizing设置更改为：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-838924b76530312a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>该操作会使视图贴着顶部和左边缘（但不是底部和右边缘），并且当父视图更改其大小时会调整子视图的宽和高。同样，将右上角视图的autosizing设置为：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-b414aba8bd6a93af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>底部视图设置：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-fd689f7f27c38983.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>再次运行APP并且旋转至横屏状态，它应该看起来是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-44bc9d8df119c304.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>已经很接近我们想要的样式了，但还不完全匹配。视图之间的距离不正确。或者用另一种说法：视图的大小比例并不是100%正确的。问题就在于 <strong>autosizing masks</strong> 告诉子视图当父视图调整大小时，子视图大小随之改变，但是它无法告诉子视图<strong>以何种方式</strong>调整大小。</p>
<p>你或许可以这样设置 autosizing masks  - 例如，调整可变的宽度和高度设置（弹簧） - 但是你不会得到三个视图之间的距离正好完全是20pt的结果。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-98d2214ba50694e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="这是为什么呢"></p>
<p>要用弹簧和支柱（springs and struts）的方法解决这个布局问题，不幸的是，你将不得不写一点代码。</p>
<p>在旋转UI界面之前，之中和之后，UIKit会向您的视图控制器发送几个消息。 您可以截取这些消息以更改UI的布局。 通常，你需要覆写 <code>viewWillLayoutSubviews</code> 方法以更改需要重新排列的任何视图的大小。</p>
<p>在这样做之前，你首先必须声明插座属性来引用需要调整的视图。</p>
<p>切换到辅助编辑器模式（ Assistant Editor mode）（Xcode工具栏上的编辑器工具集上的中间按钮），然后鼠标右击拖动三个视图的每个视图到 <strong>ViewController.m</strong> 中：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-3a2292159f926f28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>分别连接每个视图到这三个属性：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *topLeftView;    </span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *topRightView;      </span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *bottomView;</span><br></pre></td></tr></table></figure>
<p>添加以下代码到<strong>ViewController.m</strong> 中：</p>
<pre><code>- (void)viewWillLayoutSubviews
{    
// 译者注：原文中if的判断方法在我最新的Xcode 8中尝试时发现被弃用了。
~~if(UIInterfaceOrientationIsLandscape(self.interfaceOrientation))~~
// 换用下面这个
if(UIInterfaceOrientationIsLandscape([[UIApplication sharedApplication] statusBarOrientation]))
{     
    // 判断设备方向：如果是横屏模式
    CGRect rect = self.topLeftView.frame;
    rect.size.width = 254;
    rect.size.height = 130;
    self.topLeftView.frame = rect;

    rect = self.topRightView.frame;
    rect.origin.x = 294;
    rect.size.width = 254;
    rect.size.height = 130;
    self.topRightView.frame = rect;

    rect = self.bottomView.frame;
    rect.origin.y = 170;
    rect.size.width = 528;
    rect.size.height = 130;
    self.bottomView.frame = rect;
}
else
{
    CGRect rect = self.topLeftView.frame;
    rect.size.width = 130;
    rect.size.height = 254;
    self.topLeftView.frame = rect;

    rect = self.topRightView.frame;
    rect.origin.x = 170;
    rect.size.width = 130;
    rect.size.height = 254;
    self.topRightView.frame = rect;

    rect = self.bottomView.frame;
    rect.origin.y = 295;
    rect.size.width = 280;
    rect.size.height = 254;
    self.bottomView.frame = rect;
}
}
</code></pre><p>当视图控制器旋转到新方向时，就会回调这段方法。 它先判断视图控制器旋转到的方向，并适当调整视图大小——在这种情况下，使用基于iPhone的已知屏幕尺寸的硬编码偏移(将可变变量用一个固定值来代替的方法叫做hard-code)。 此回调发生在动画块中，因此会以动画的方式调整视图大小。</p>
<p>先别运行APP,首先你需要恢复刚才所作的所有三个视图的 <strong>autosizing masks</strong> 设置，否则自动调整机制将与您在<code>viewWillLayoutSubviews</code>中的设置的视图位置和大小相冲突：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-64591d061ca99d84.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>三个都还原后就可以了。 运行APP，旋转到横屏状态。 现在的视图排列得很好。 旋转回竖屏状态，验证一切看起来也很好。</p>
<p>这奏效了。代价就是，你必须为一个看起来很简单的布局写很多的代码。 想象一下调整一个真正复杂的布局需要花费的工夫，尤其是单个视图以动态的方式更改大小，或者子视图的数量是不确定的情况下。</p>
<p>现在试着在3.5寸的模拟器上运行程序。糟糕。视图的位置和大小又错了，因为<code>viewWillLayoutSubviews</code>的硬编码坐标是基于4英寸大小的手机(320x568取代320x480)。你可以增加另一个if语句判断屏幕大小，并使用不同的坐标集，但是你可以看到这个方法很快变得不切实际。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-2bbe5f7c63ac4412.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>注意：您可以采取的另一种方法是为竖屏和横屏设置单独的nib文件。 当设备旋转时，您从另一个nib加载视图，并替换出现有的nib。 但这仍然需要非常大的工作量，它也增加了许多麻烦，必须设置两个nib文件，而不是一个。 当你使用storyboards而不是nibs时，这种方法是不切实际的。</p>
</blockquote>
<h1 id="Auto-Layout-（自动布局）拯救猿！"><a href="#Auto-Layout-（自动布局）拯救猿！" class="headerlink" title="Auto Layout （自动布局）拯救猿！"></a>Auto Layout （自动布局）拯救猿！</h1><p>现在，你将看到如何使用自动布局实现相同的效果。 首先，从<strong>ViewController.m</strong>中删除<code>viewWillLayoutSubviews</code>方法，因为该方法不用写任何代码。</p>
<p>选择<strong>Main.storyboard</strong>，并在<strong>File inspector</strong>中勾选<strong>Use Autolayout</strong>为该storyboard文件开启自动布局：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-64ee4a669608b21d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>注意：自动布局始终作用于整个nib或storyboard文件。 如果选中该框，那么所有插入nib或storyboard中的视图都将使用自动布局。</p>
</blockquote>
<p>运行APP并且旋转为横屏状态，它现在看起来是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-a16d1c0f76063262.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>让我们把Auto Layout放到Action中。 按住⌘键的同时单击顶部的两个视图（绿色和黄色视图），以便同时选中这两个视图。 从Xcode的编辑器菜单中，选择 <strong>Pin \ Widths Equal（相等宽度）：</strong></p>
<blockquote>
<p>还是译者提示：这一步操作在 Xcode 5 环境下应该入下图所示，但我在 Xcode 8 的环境下操作发现情况已经不一样了，菜单界面都发生了变化，Editor 里 没有 Pin 选项了。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-30f9649b6260b744.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<blockquote>
<p>所以选中两个View之后不妨可以在画板右下角设置，之后的很多操作步骤在新Xcode环境下找不到的话你也可以在这里试试：</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ae85fcb041e9d6cb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>再次选中相同的两个视图，然后选择 <strong>Editor\Pin\Horizontal Spacing(水平距离)</strong>。（即使在执行第一次Pin操作后两个视图看起来是仍然选中，请注意这只是它们处于特殊的布局关系的一种显示模式，因此你必须重新选中这两个视图。）</p>
<p>现在storyboard看起来是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-af7764265b456ba5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>橙色的“T条”形状的东西代表视图之间的约束。 到目前为止，你添加了两个约束：两个视图的 <strong>Equal Widths</strong> （相同宽度）约束（由带有等号”=”的T条表示）和位于两个视图之间的 <strong>Horizontal Space</strong>（水平距离）约束。约束（Constraints ）代表了视图之间的关系，它们是使用Auto Layout设置布局的主要工具。它可能看起来有点可怕，但它实际上是很直接的描述，一旦你知道这一切意味着什么时。</p>
<p>要继续构建此屏幕的布局，请执行以下步骤。 每个步骤都会添加更多的橙色T条。</p>
<p>对于左边的视图，从 <strong>Editor\Pin</strong> 菜单选择：</p>
<ul>
<li>Top Space to Superview ——上边界到父视图的距离</li>
<li>Leading Space to Superview ——左边界到父视图的距离</li>
</ul>
<p>对于右边的视图，选择：</p>
<ul>
<li>Top Space to Superview ——上边界到父视图的距离</li>
<li>Trailing Space to Superview ——右边界到父视图的距离</li>
</ul>
<p>对于底部那张大视图：</p>
<ul>
<li>Leading Space to Superview ——左边界到父视图的距离</li>
<li>Trailing Space to Superview ——右边界到父视图的距离</li>
<li>Bottom Space to Superview ——下边界到父视图的距离</li>
</ul>
<p>现在你应该有了如下的约束：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-49b29d416073df07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>请注意，T形条仍然是 <strong>橙色</strong> 的。这就意味着你的布局是不完整的;也就是说自动布局没有足够的约束来计算视图的位置和大小。解决方案是添加更多的约束，直到它们变成 <strong>蓝色</strong> 。</p>
<p>按住⌘并选中所有三个视图。从 <strong>Editor</strong> 菜单中，选择 <strong>Pin\Heights Equally（相等高度）</strong></p>
<p>现在选中左上角视图和底部视图（像先前一样使用⌘），并选择 <strong>Editor\Pin\Vertical Spacing（垂直距离）</strong>。</p>
<p>Interface Builder 应该看起来是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-bb37cbe68ab0f836.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>现在T条已经变为<strong>蓝色</strong>了。自动布局现在有足够的信息来计算有效的布局了。 它看起来有点凌乱，不过这是因为<strong>Equal Widths</strong>和<strong>Equal Heights</strong>约束占据了很大空间的缘故。</p>
<p>运行APP并且…哇噢，不需要写一行代码便运行的很好了。不管你在哪个模拟器上运行它；在3.5英寸和4英寸设备上，布局效果都运行良好。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-492d1c96857d5fbe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>真酷，但是实际上你到底做了什么你？Auto Layout 允许你表达：<strong>布局中的视图如何相互关联</strong>，而不是要求你对视图的大小和位置进行硬编码设置。</p>
<p>你已经把以下关系——也就是所谓的约束——放入了布局中：</p>
<ul>
<li>左上角和右上角的视图总是保持相同的宽度（也就是pin中第一个widths equally命令）</li>
<li>左上角和右上角视图的水平距离是20pt（也就是pin中的horizontal spacing命令）</li>
<li>所有的视图总是有相同的高度（pin中heights equally命令）</li>
<li>顶部两个视图和底部视图的垂直距离是20pt（pin中的vertical spacing命令）</li>
<li>视图和屏幕边缘的距离是20pt （上边界、下边界、左边界和右边界到父视图的距离）</li>
</ul>
<p>这些就足以表达出让 <strong>Auto Layout</strong> 怎么放置视图，以及当屏幕大小改变时该如何处理了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-23762c2e1cae43fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>你可以在左侧的 <strong>Document Outline</strong> 中查看所有的约束(constraints)。 当你为storyboard开启<strong>Auto Layout</strong>时，就添加了名为<strong>Constraints</strong>的部分。 （如果没有看到大纲窗格，请单击Interface Builder窗口底部的箭头按钮。）</p>
<p>如果你选中了<strong>Document Outline</strong>中的一个约束(constraints)，Interface Builder界面就会通过在约束周围画白色轮廓的方式，高亮显示约束在视图上的位置，并且还会为其添加阴影以使其突出显示。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9eea894b7b5e523a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>约束是真实的对象（<strong>NSLayoutConstraint</strong> 类），它们也有属性。例如，选择在两个顶部视图之间创建填充的约束（名“为Horizontal Space（20）”，请务必选择正确），然后切换到<strong>Attributes inspector</strong>。 你就可以通过编辑<strong>Constant</strong>字段来更改边距的大小。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-295fba89d07a8b5e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>把值设置为100，然后再次运行APP，现在边距变得更宽了：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ffdf7d85fd3be83e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>当你在应用程序中描述视图时，<strong>Auto Layout</strong> 比 <strong>springs and struts</strong> 更具表达力。 在本教程的其余部分中，您将了解所有约束以及如何在Interface Builder中应用它们以创建不同类型的布局。</p>
<h1 id="Auto-Layout-是如何工作的"><a href="#Auto-Layout-是如何工作的" class="headerlink" title="Auto Layout 是如何工作的"></a>Auto Layout 是如何工作的</h1><p>正如你在上面的测试中所看到的，<strong>Auto Layout</strong>中的基本工具是约束（<strong>constraint</strong>）。 约束描述了两个视图之间的几何关系。 例如，您可能有一个约束：<br>“label A右边缘和button B左边缘有20点的空白空间”</p>
<p>自动布局采用所有这些约束，并进行一些数学计算，计算出所有视图的理想位置和大小。 您不再需要自己设置视图的frame——自动布局会帮你实现它，完全基于你在这些视图上设置的约束。</p>
<p>自动布局以前，你总是需要为视图的frames设置硬编码，要么在Interface Builder中将他们放置在特定的坐标中，或通过传递一个rectangle到<code>initWithFrame：</code>，或者设置视图的<strong>frame</strong>，<strong>bounds</strong>或者<strong>center</strong>属性。</p>
<p>对于你刚刚设置的APP来说，你尤其需要像这样设置frames：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ac48baee6fc0cab6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>还需要为这些视图设置自动调整大小的masks：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-54aa95cda946df0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这再也不是你需要为屏幕设计所考虑的东西了。有了<strong>Auto Layout</strong>（自动布局），你需要做的是这些：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-a8c0954e6191b8a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>视图的大小和位置不再重要了; 只有约束才是最重要的。当然，当你拖动一个新的button或label到画布上时，它将有一定的大小，并且你会把它放在一个特定的位置，但这只是一个设计帮助，用来告诉Interface Builder在哪里放置约束 。</p>
<h1 id="想你所想，如你所愿"><a href="#想你所想，如你所愿" class="headerlink" title="想你所想，如你所愿"></a>想你所想，如你所愿</h1><p>使用约束的最大优点是，你不再需要调整坐标以使你的视图显示在正确的位置。 相反，你可以向自动布局描述视图如何相互关联，自动布局将为您做所有的辛苦工作。 这就是所谓的根据目的设计（designing by intent）。</p>
<p>当你根据目的设计时，你表达的是你想要实现什么，而不是是如何实现。你不应该说：“该按钮的左上角坐标是（20,230）”，你应该说：</p>
<p>按钮在其父视图中垂直居中，并且放置在距离父视图的左边缘固定的距离处。</p>
<p>使用此描述，自动布局可以自动计算按钮应显示的位置，不用管父视图的大小。</p>
<p>其他根据目的设计的示例（自动布局可以处理所有这些指令）：</p>
<ul>
<li>这两个textField应该总是保持相同大小；</li>
<li>这两个button应该总是同时移动；</li>
<li>这四个label应该总是保持右对齐；</li>
</ul>
<p>这使得你的用户界面的设计更具描述性。你只需定义约束，系统就会自动计算其frame。</p>
<p>在第一部分你看到，即使为几个视图在横竖方向上正确的布局都需要做大量的工作。有了自动布局，你可以绕过这些麻烦。如果你正确的设置了约束，那么在横竖屏方向上，布局将不需要做任何改变。</p>
<p>使用自动布局另一个重要的好处就是国际化。比如德语中的文本，出了名的比老奶奶的裹脚布还要长，适配起来是一件很麻烦的事。再次，自动布局释放了程序员的双手，因为它能根据label需要显示的内容自动改变label的大小。</p>
<p>添加对德语，法语或任何其他语言的支持现在只是一个设置约束的问题，翻译文本…然后就完了！</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-7c468dfb91effe5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>学习自动布局最好的方法就是使用它，所以这正是剩下教程中你会学到的东西。</p>
<blockquote>
<p>注意：自动布局不仅对旋转有作用；它还能轻易的缩放你UI的大小从而适应不同尺寸的屏幕。这并不是巧合，当iPhone5拥有更高屏幕的同时，这个技术也同时加到了iOS中！自动布局能轻易的拉伸你程序的用户界面，从而充满iPhone5垂直方向上多出来的空间。随着iOS7中的动态类型的出现，自动布局变得更加重要了。用户现在可以改变全局字体大小设置–有了自动布局，这将变得非常简单。</p>
</blockquote>
<h1 id="拥抱约束（courting-constraints）"><a href="#拥抱约束（courting-constraints）" class="headerlink" title="拥抱约束（courting constraints）"></a>拥抱约束（courting constraints）</h1><p>关闭你当前的项目并用 <strong>Single View Application</strong> 模板创建一个新的iPhone项目。叫做”Constraints”。任何用Xcode5创建出来的项目都会自动假定你会使用自动布局，所以你并不需要额外做任何事情。</p>
<p>点击<strong>Main.storyboard</strong>打开Interface Builder。 将一个新按钮拖动到画布上。 请注意，当您拖动时，会出现蓝色虚线。 这些线用来做向导：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9938cf4bf70e8ac5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>将控件拖动到在屏幕边缘以及中心的时候，都会有向导线出现：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-33d4c005354c567a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>如果之前你已经使用过Interface Builder，那么你肯定看到过这些向导线。这些对我们对齐控件有很大的帮助。</p>
<p>在启用自动布局的Xcode 4中，指南有不同的用途。你仍然使用它们来对齐，但他们也告诉你新的约束会在哪里。如果你将button沿着向导线反方向拖拽到左上角时，Xcode 4中的storyboard会是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-dd91e27c1edc5bb8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>有两个蓝色的东西附属在button上面。这些T-bar形状的对象便是约束了。在Xcode 4的Interface Builder中不管你将UI控制器放在哪儿，它总是会给出有效的约束。理论上这听起来是个好主意，但是实际上，在Interface Builder中使用自动布局却非常困难。</p>
<p>幸运的是，在Xcode 5中使用的情况变好了。当你将按钮放到画布上后，没有任何T形条可见了：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-d509131594ecbc77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>注意到<strong>Document Outline</strong>窗格中也没有“约束”部分。结论就是：这个按钮没有设置任何约束。</p>
<p>但是这又是如何奏效的呢？你刚刚也有了解到，Auto Layout总是需要足够的约束来确定所有视图的大小和位置，但在这里你根本没有设置任何约束。很明显这难道不是一个不完整的布局吗？</p>
<p>这就是Xcode 5比Xcode 4有所提升的地方：它不再强迫你总是去设置一个有效的布局。</p>
<blockquote>
<p>注意：</p>
<ul>
<li>运行带有无效布局的应用程序是一个坏主意，因为自动布局无法正确计算视图应该在哪里。 要么视图的位置将是不可预测的（如果没有足够的约束）或是应用程序将会崩溃（如果有太多的约束）。</li>
<li>Xcode 4试图通过确保总是有足够的约束来创建有效的布局来防止这种情况的发生。 不幸的是，它通常通过删除你自己的约束并用你实际上不想要的约束来替换它们。 这是非常令人沮丧的，这也是许多开发人员放弃使用Auto Layout的原因。<br>Xcode5中，当你编辑Storyboard时它允许你有不完整的布局，但它也会指出哪些地方你还需要修改。使用Interface Builder创建的自动布局驱动用户界面变得更有趣了，使用Xcode5也消耗更少的时间。</li>
<li>如果你根本不提供任何约束，Xcode自动分配一套默认的约束，正是我们所知的<strong>automatic constraints</strong>(自动约束)。它会在程序built的编译时间中去完成这些事，而不是设计时间。当你设计你的用户界面时，Xcode5中的自动布局为了不参与你的设计方法而努力工作，这这是我们喜欢它的原因。</li>
</ul>
</blockquote>
<p>自动约束为你的视图提供一个固定尺寸和位置。换句话说，视图总是拥有跟你在storyboard中看到的一样的坐标。这是非常方便的，因为这就意味着你可以大量的忽视自动布局。你可以为那些拥有充分约束的控件不增加约束，只为那些需要特殊规则的视图创建约束。</p>
<p>好吧，让我们来使用一下约束，看看他们能做些什么。现在，按钮位于左上角并且没有约束。请确保按钮是与两个角导轨对齐的。</p>
<p>使用<strong>Editor\Pin</strong>菜单为按钮增加两个新的约束，看起来像这样：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-2bce0e726ca3f648.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>如果你还没有猜到，这就是<strong>Leading Space to Superview</strong> 和 <strong>Top Space to Superview</strong> 选项。</p>
<p>所有的约束也列在Interface Builder窗口左侧的Document Outline窗格中：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-1393992ffb98a156.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>目前有两个约束，即按钮和主视图的左边缘之间的水平距离，以及按钮和主视图的顶部边缘之间的垂直距离。 描述这些约束表达的关系就是：</p>
<p>该按钮始终位于其父视图中左上角的20点位置。</p>
<blockquote>
<p>注意：这些实际上并不是非常有用的约束，因为它们与自动约束所做的事相同。 如果你总是希望你的按钮位于它父视图的左上角，那么你可能不需要提供任何约束，你可以让Xcode帮你完成。</p>
</blockquote>
<p>现在拖动button并将它放到屏幕的右上角，再次和蓝色向导线对齐：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-8d9bc5ccfaff4ec6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>哇，这里发生了什么？在Xcode 4中，这将破坏旧的约束并基于蓝色引导线分配新的约束，但在Xcode 5中，按钮保留现有的约束。这里的问题是，【Interface Builder中按钮的大小和位置】与【Auto Layout中基于约束所设置的大小和位置】不一致。我们称之为 <strong>misplaced view</strong>(错位视图)。</p>
<p>运行APP。该按钮仍将显示在屏幕的左上角：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-c187e81a028df06a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>对于Auto Layout来说，橙色代表着问题所在。 Interface Builder绘制了两个橙色框：一个带有虚线的边框，一个带有实线的边框。 虚线框展示的是根据Auto Layout约束显示的视图边框。 实心橙色框是根据你对视图的拖动显示在屏幕中的边框。 这两个边框应该是匹配一致的，但在这里他们并不匹配。</p>
<p>如何解决这个问题取决于你想实现什么：</p>
<ul>
<li>如果你想要将按钮放在屏幕的左边，而左边边缘距离拖放的视图234点位置， 在这种情况下，你已经使现有视图的水平空间约束增加了234pt。 这就是橙色线条用“+234”的意思。</li>
<li>如果你要将按钮放在屏幕的右边，那么，你需要删除现有的约束并创建一个新的约束。</li>
</ul>
<p>删除水平空间约束。首先在画布或 <strong>Document Outline</strong> 中选择它，然后按键盘上的<strong>Delete</strong>键。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9d76eeb34268db7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>请注意，这步操作会将垂直空间约束变为橙色，而刚才它是蓝色的。这个特定的约束并没有错误;它只是意味着没有足够的约束来确定按钮的完整位置。你仍然需要为X位置添加约束。</p>
<blockquote>
<p>注意：你可能想知道为什么Xcode不为X位置添加一个自动约束。 规则是：只有当你没有人为设置任何约束时，Xcode才会创建自动约束。而一旦只要你添加了一个约束，这就意味着你告诉Xcode，这个视图的约束由你管理，不需要Xcode插手来自动添加。因此，Xcode将不再进行任何自动约束，并希望你添加此视图所需要的任何其他约束。</p>
</blockquote>
<p>选中按钮，选择 <strong>Editor\Pin\Trailing Space to Superview</strong>。 这个步骤会在按钮的右边缘和屏幕的右边缘之间产生新的约束。 该约束表达的关系是：<br>“这个按钮总是位于它的superview的右上角20px。”<br>运行APP并旋转模拟器到横屏状态。 请注意查看按钮与右边屏幕边缘的距离是否始终相同：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-e184db0c51d4d032.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>当你将按钮（或任何其他视图）参照引导并设置约束时，你将获得一个由Apple的iOS人机交互指南 （即<strong>HIG</strong>）定义的标准尺寸的间距约束。 对于边框周围的边缘距离，标准大小为20px的空间。</p>
<p>现在，将按钮向左拖动一点：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-61fd30ee489fdde3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>同样你又得到了一个橙色的虚线框，因为视图产生了<strong>misplaced view</strong>(错位视图)。如果说这个新的按钮位置确实是你想要的。这是常见的约束设置，只要微调视图的几个像素，橙色框就会出现。解决该问题的一种方法是删除旧约束并创建一个新的约束，但有一个更简单的解决方案。</p>
<p><strong>Editor</strong>菜单有一个<strong>Resolve Auto Layout Issues</strong>子菜单。 从该菜单中，选择<strong>Update Constraints</strong>更新约束。在我的这种情况下，这就告诉了Interface Builder，它的约束需要增大64px，如下所示：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-0bef699b21d4109e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>太棒了，T条又变成蓝色并且布局也是有效的。在<strong>Document Outline</strong>（文档大纲）中，你可以看到水平空间约束不再有标准空间的那个约束了：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-1de131aa6d4626dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>到目前为止，你已经尝试使用了水平空间和垂直空间约束。 还有一个“中心”约束。将一个新的Button对象拖动到画布的底部中心，以便它与指引位置相同：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9151869a263bf602.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>为了使按钮始终相对于父视图居中对齐，在水平轴上，你需要添加 Center X Alignment（中心对齐）约束。 从Editor菜单中选择<strong>Align\Horizontal Center in Container</strong>。 这个步骤会增加了一条长的橙色线条：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-b42ce1fe7e781f0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>该线是橙色的，因为你只指定了按钮的X坐标，而没有指明其Y坐标发生了什么。 使用Editor \ Pin菜单在视图的按钮和底部之间添加垂直空间约束。 它应该看起来像这样：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-75e441178e1b8bfd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>如果你不知道如何操作，它是<strong>Bottom Space to Superview</strong>选项。 垂直空间约束使按钮远离视图的底部（再次使用标准边距20px）。</p>
<p>运行APP并将其旋转到横屏状态。 即使在横屏模式下，按钮仍停留在屏幕的底部中心：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-ecffc2a2d06a96f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这就是你所表达的意图：“这个按钮应该始终在底部中心。”注意，你并没有告诉Interface Builder该按钮的坐标是什么，你只是希望它被锚定在视图底部中心。</p>
<p> 有了 <strong>Auto Layout</strong>，你不再需要关心在画布上放置视图的位置的确切坐标或它们的大小。相反，<strong>Auto Layout</strong> 会根据你设置的约束中导出这两个东西。</p>
<p>您可以在按钮的Size inspector（大小检视器）中看到这种模式转换，现在已经非常不同了：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-7bdc17850fbeeb0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>禁用自动布局后，输入X，Y，宽度或高度字段将更改所选视图的位置和大小。 启用自动布局后，您仍然可以在这些字段中键入新值，但是如果您已经在视图上设置了约束，它现在可能会放错位置。 您还必须更新约束以使其与新值匹配。</p>
<p>例如，将按钮的宽度值更改为100.画布变成这样：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-8288ee0173af52ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>Xcode 4 会用水平空间的新约束替换掉中心X对齐约束，强制它具有100点的宽度。然而，Xcode 5简单地说，“如果你想要的宽度是100点，对我来说无所谓，但是你要知道约束并不是这么说的。</p>
<p>在这种情况下，你希望按钮是100点宽。 对此有一种特殊类型的约束：<strong>the Fixed Width constraint</strong>（固定宽度约束）。 首先按撤消，使按钮再次居中，T条全部为蓝色。 选择按钮并选择<strong>Editor \ Pin \ Width</strong>。 这会在按钮下方放置一个新的T形条：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-890ef4e4d6c02f20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>选择该T条，并在<strong>Attributes inspector</strong>（属性检视器）中将常数更改为100.这将强制按钮总是100点宽，无论它的标题多大或小。 要看到这一点，你可以给按钮一个背景颜色：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-a52cbcea41364e93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>您还可以在左侧的Document Outline中看到此新宽度约束：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ab041d340078e94c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>与按钮及其父视图之间的其他约束不同，宽度约束仅适用于按钮本身。 你可以认为这是按钮和…按钮之间的约束。</p>
<p>你可能想知道为什么按钮之前没有宽度约束。 Auto Layout如何知道按钮有多宽？</p>
<p>这里有一条就是：按钮本身是知道它自己必须有多宽的。 它是基于其标题文本和一些填充来计算的。 如果你在按钮上设置了一个背景图片，它也会考虑到这一点。</p>
<p>这称之为<strong>intrinsic content size（固有内容大小）</strong>。 不是所有的控件都有这个，但很多（UILabel是另一个例子）。 如果视图可以计算自己的应有大小，那么您不需要在为其设置特定的宽度或高度约束。 以后你会看到更多的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-4ed8bec5c49ccf3e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>要将按钮恢复到最佳大小，请先删除宽度约束。 然后选择按钮，从编辑器菜单中选择<strong>Size to Fit Content</strong>（大小适应内容）。这将恢复按钮的固有内容大小。</p>
<h1 id="孤掌难鸣"><a href="#孤掌难鸣" class="headerlink" title="孤掌难鸣"></a>孤掌难鸣</h1><p>引导线不仅仅呈现视图及其父视图之间的关系，而且也呈现视图层次结构的同一级别的视图之间。 为了演示这一点，将一个新按钮拖到画布上。 如果将此按钮拖动到其他按钮附近，则它们的引导线也会开始交互。</p>
<p>将新按钮放在现有按钮旁边，使其卡入到位：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-b743cc13ad5727b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>这里有很多虚线的引导线。 Interface Builder认为这两个按钮可以以不同的方式排列 - 在它们的顶部，中心和基线。<br>Xcode 4将把这些贴紧引导下中的一个转换成新的约束。 但是使用Xcode 5，如果你想在这两个按钮之间有一个约束，你必须自己做。 您已经看到，您可以使用<strong>Editor \ Pin</strong>菜单在两个视图之间创建约束，但也有一种更简单的方法。<br>选择新的按钮，然后<strong>Ctrl-drag</strong>到另一个按钮，像这样：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ad8eec6c9faf83fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>当您松开鼠标按钮时，会出现一个弹出窗口。 选择第一个选项，<strong>Horizontal Spacing</strong>（水平间距）。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-9127fdd7e02b531a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>它会创建一个像这样的新约束：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-71fdc5b6d8aa34f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>它是橙色的，意味着此按钮需要至少一个其他约束。 按钮的大小是已知的 - 它使用固有内容大小确定 - 并且按钮的X位置已经有一个约束了。 只留下Y位置没有约束。</p>
<p>这里缺少的约束很容易确定，但对于更复杂的设计，它可能不会总是立即显而易见的。 幸运的是，你不必猜测。 Xcode会一直保持计算，可以准确地告诉你缺少什么。<br>在文档大纲中有一个小的红色箭头，在<strong>View Controller Scene</strong>旁边。 单击该箭头以查看所有自动布局问题的列表：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-766aae86dedda18e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>真贴心！让我们添加那个缺少Y位置的约束吧。选择新按钮向下拖动：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-59b26064860bbe9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>此时弹出菜单有不同的选项。此菜单中的项目取决于上下文（您在其间拖动的视图）和移动鼠标的方向。 选择<strong>Bottom Space to Bottom Layout</strong>（底部空间到底部布局）。</p>
<p>新按钮现在有一个到屏幕底部的垂直空间，还有一个水平空间，它与其他按钮链接。 因为这个空间很小（只有8分），T条可能有点难以看到，但它绝对存在。</p>
<p>单击文档大纲中的<strong>Horizontal Space (8)</strong>约束将其选中：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-c9e4f149baab9b31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>当选择约束时，它会点亮其所属的控件。 这个特定约束位于两个按钮之间。 你在这里做的是说：</p>
<p>“第二个按钮总是出现在第一个按钮的左边，无论第一个按钮位于何处或有多大。</p>
<p>选择黄色的按钮，并在其标签中键入一些长的“A longer label”。 完成后，按钮会调整大小，为新文本腾出空间，而另一个按钮则会移动。毕竟，它被附加到第一个按钮的左边缘，所以这是你打算发生的事情：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-63ff2f6eef7b9c8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>只是为了获得【这是如何工作的】更好感觉，再试一次。 将另一个按钮拖动到画布中，并将其放在黄色的上方，以便它们垂直卡入到位（但不要尝试对齐两个按钮的左边缘）：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-0b7db0ee45d776b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>给新按钮设置一个背景颜色（绿色），这样你可以更容易地看到它的范围。</p>
<p>因为你把两个按钮扣在一起，根据HIG的推荐现在它们之间有一个标准的8pt空间。 通过在两个按钮之间按住Ctrl键并拖动，将其转换为约束。 从弹出菜单中选择<strong>Vertical Spacing</strong>（垂直间距）。</p>
<blockquote>
<p>注意：“HIG”是iOS人机交互指南的缩写，包含Apple关于设计良好用户界面的建议。 这是任何iOS开发人员的必须要阅读的。 HIG解释了哪些UI元素适合在哪些情况下使用，以及使用它们的最佳做法。 您可以在<a href="https://developer.apple.com/ios/human-interface-guidelines/overview/design-principles/" target="_blank" rel="noopener">此处</a>找到此文档。</p>
</blockquote>
<p>但是，您并不受限于控件之间的标准间距。 约束是完整的对象，就像视图一样，因此它们具有可以更改的属性。</p>
<p>选择两个按钮之间的垂直空间约束。 你可以通过点击T条在画布中做到这一点，虽然这往往是有点过于挑剔 到目前为止，最简单的方法是单击文档大纲中的约束。 一旦选择它，切换到<strong>Attributes inspector</strong>（属性检查器）：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-c5836645ae2797bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>在Constant字段中输入40以更改约束的大小。现在两个按钮分开了，但它们仍然连接：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-53790e91214e5947.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>运行应用程序并翻转到横屏模式以查看效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-3d2779bec6566a0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>按钮当然仍然保持着垂直排列，但他们不是在同一个水平位置！ 原因应该很明显：绿色按钮还没有X位置的约束。</p>
<p>从绿色按钮向画布的左边缘添加水平空间约束将无法解决此问题。 有了这样的约束，绿色按钮总是保持相同的X坐标，即使在横屏模式下也同样。 这看起来不是很好，所以你要表达以下意图：</p>
<p>“黄色按钮将始终水平居中，并且绿色按钮的左边缘要和黄色按钮的左边缘对齐。</p>
<p>您已经有第一个约束了，但还没有第二个的约束。 Interface Builder有显示对齐的指引线，因此您可以拖动顶部按钮，直到其左边缘与黄色按钮对齐：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-f23e94351701e62c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>如果您也拖动了按钮的垂直距离，按钮的边框和垂直空间约束可能不在正确的距离下。 您将在T形条上看到橙色标识：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-ea10bad262b32f7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>如果发生这种情况，只需使用方向键将按钮推入到位，直到标识消失。</p>
<p>最后，在两个按钮之间按住Ctrl键并拖动，然后从弹出菜单中选择<strong>Left</strong>。 这创建了一个对齐约束，它的意思是说：“这两个视图的左边缘总是对齐的”。 换句话说，两个按钮将总是具有完全相同的X位置。 这步解决了布局问题，同时T条转为蓝色：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-08a8f775f8c516ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>运行APP，并旋转到横屏模式以验证其是否有效：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-3acad973c3d3fe4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="接下来做什么？"><a href="#接下来做什么？" class="headerlink" title="接下来做什么？"></a>接下来做什么？</h1><p>现在你已经对 <strong>Auto Layout</strong> 有了第一次尝试，你喜欢它吗？ 适应它可能还要花些功夫，但可以使你的生活很容易，你的应用程序也会更灵活！</p>
<p>想了解更多？ 继续阅读本<a href="https://www.raywenderlich.com/50319/beginning-auto-layout-tutorial-in-ios-7-part-2" target="_blank" rel="noopener">part 2 of this Auto Layout tutorial</a>，您将继续使用Interface Builder中的按钮来更好地了解<strong>Auto Layout</strong>提供的功能以及您可能遇到的问题。最好就是 - 你也将使用Auto Layout 在你真正的APP中创建一个真正的布局。</p>
<p>在此期间，如果您有任何问题或意见，请加入下面的论坛讨论！</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><a href="http://blog.lessfun.com/blog/2014/10/17/ios-autolayout-vs-autosizing/" target="_blank" rel="noopener">iOS AutoLayout与AutoSizing：自动布局，想说爱你真的好难</a></li>
<li><a href="https://segmentfault.com/a/1190000000646452" target="_blank" rel="noopener">从此爱上iOS Autolayout</a></li>
<li><a href="http://www.jianshu.com/p/0f031606e5f2" target="_blank" rel="noopener">使用 Auto Layout 的典型痛点和技巧</a></li>
<li><a href="https://onevcat.com/2013/12/code-vs-xib-vs-storyboard/" target="_blank" rel="noopener">代码手写UI，xib和StoryBoard间的博弈，以及Interface Builder的一些小技巧</a></li>
<li><a href="https://www.jianshu.com/p/b3fb77f95ec8" target="_blank" rel="noopener">iOS AutoLayout 进阶: Aspect Ratio</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/14/iOS 编程：base64 编码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/14/iOS 编程：base64 编码/" class="post-title-link" itemprop="url">iOS 编程：base64 编码</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-14 10:32:00" itemprop="dateCreated datePublished" datetime="2017-01-14T10:32:00+08:00">2017-01-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 16:12:11" itemprop="dateModified" datetime="2019-04-17T16:12:11+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/14/iOS 编程：base64 编码/" class="leancloud_visitors" data-flag-title="iOS 编程：base64 编码">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h3 id="对字符串进行-base64-编解码方法"><a href="#对字符串进行-base64-编解码方法" class="headerlink" title="对字符串进行 base64 编解码方法"></a>对字符串进行 base64 编解码方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// base64编码</span><br><span class="line">- (NSString *)base64Encode:(NSString *)string &#123;</span><br><span class="line">    // 1.将字符串转换为二进制</span><br><span class="line">    NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    // 2.二进制数据进行编码</span><br><span class="line">    return [data base64EncodedStringWithOptions:0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// base64解码</span><br><span class="line">- (NSString *)base64Decode:(NSString *)string &#123;</span><br><span class="line">    // 1.字符串转换为二进制</span><br><span class="line">    NSData *data = [[NSData alloc] initWithBase64EncodedString:string options:0];</span><br><span class="line">    // 2.解码</span><br><span class="line">    return [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="base64-的编码枚举类型"><a href="#base64-的编码枚举类型" class="headerlink" title="base64 的编码枚举类型"></a>base64 的编码枚举类型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_OPTIONS(NSUInteger, NSDataBase64EncodingOptions) &#123;</span><br><span class="line"></span><br><span class="line">		// 将生成的Base64字符串按照64个字符长度进行等分换行。</span><br><span class="line">    NSDataBase64Encoding64CharacterLineLength = 1UL &lt;&lt; 0, </span><br><span class="line"></span><br><span class="line">		// 将生成的Base64字符串按照76个字符长度进行等分换行。</span><br><span class="line">    NSDataBase64Encoding76CharacterLineLength = 1UL &lt;&lt; 1,</span><br><span class="line"></span><br><span class="line">		// 将生成的Base64字符串以回车结束。  </span><br><span class="line">    NSDataBase64EncodingEndLineWithCarriageReturn = 1UL &lt;&lt; 4,</span><br><span class="line"></span><br><span class="line">		// 将生成的Base64字符串以换行结束。</span><br><span class="line">    NSDataBase64EncodingEndLineWithLineFeed = 1UL &lt;&lt; 5,</span><br><span class="line"></span><br><span class="line">&#125; NS_ENUM_AVAILABLE(10_9, 7_0);</span><br></pre></td></tr></table></figure>
<h3 id="声明方法"><a href="#声明方法" class="headerlink" title="声明方法"></a>声明方法</h3><p><code>- (NSString *)base64;</code></p>
<h3 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (NSString *)base64 &#123;</span><br><span class="line">    NSData *data = [NSData dataWithBytes:[self UTF8String] length:[self lengthOfBytesUsingEncoding:NSUTF8StringEncoding]];</span><br><span class="line">    NSUInteger length = [data length];</span><br><span class="line">    NSMutableData *mutableData = [NSMutableData dataWithLength:((length + 2) / 3) * 4];</span><br><span class="line"></span><br><span class="line">    uint8_t *input = (uint8_t *)[data bytes];</span><br><span class="line">    uint8_t *output = (uint8_t *)[mutableData mutableBytes];</span><br><span class="line"></span><br><span class="line">    for (NSUInteger i = 0; i &lt; length; i += 3) &#123;</span><br><span class="line">        NSUInteger value = 0;</span><br><span class="line">        for (NSUInteger j = i; j &lt; (i + 3); j++) &#123;</span><br><span class="line">            value &lt;&lt;= 8;</span><br><span class="line">            if (j &lt; length) &#123;</span><br><span class="line">                value |= (0xFF &amp; input[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static uint8_t const kAFBase64EncodingTable[] = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</span><br><span class="line"></span><br><span class="line">        NSUInteger idx = (i / 3) * 4;</span><br><span class="line">        output[idx + 0] = kAFBase64EncodingTable[(value &gt;&gt; 18) &amp; 0x3F];</span><br><span class="line">        output[idx + 1] = kAFBase64EncodingTable[(value &gt;&gt; 12) &amp; 0x3F];</span><br><span class="line">        output[idx + 2] = (i + 1) &lt; length ? kAFBase64EncodingTable[(value &gt;&gt; 6)  &amp; 0x3F] : &apos;=&apos;;</span><br><span class="line">        output[idx + 3] = (i + 2) &lt; length ? kAFBase64EncodingTable[(value &gt;&gt; 0)  &amp; 0x3F] : &apos;=&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return [[NSString alloc] initWithData:mutableData encoding:NSASCIIStringEncoding];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><a href="https://www.jianshu.com/p/e5bd30ba089b" target="_blank" rel="noopener">iOS 7.0 后的 Base64 全解</a></li>
<li><a href="http://www.cnblogs.com/dannygao/p/6958762.html" target="_blank" rel="noopener">iOS 几种加密方法</a></li>
<li><a href="http://www.jianshu.com/p/f795e3609514" target="_blank" rel="noopener">iOS常见又通用的一些小方法集合（不定时更新，欢迎补充）</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/12/iOS 编程：启动引导页/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/12/iOS 编程：启动引导页/" class="post-title-link" itemprop="url">iOS 编程：启动引导页</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-12 15:50:00" itemprop="dateCreated datePublished" datetime="2017-01-12T15:50:00+08:00">2017-01-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 16:14:08" itemprop="dateModified" datetime="2019-04-17T16:14:08+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/12/iOS 编程：启动引导页/" class="leancloud_visitors" data-flag-title="iOS 编程：启动引导页">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h2 id="启动引导页"><a href="#启动引导页" class="headerlink" title="启动引导页"></a>启动引导页</h2><blockquote>
<p>最近急着用启动引导图，折腾磨蹭了俩礼拜，所以搜了很多资料，最后终于用<a href="https://github.com/guowilling/SRNewFeatures" target="_blank" rel="noopener">SRNewFeatures</a>实现了。</p>
</blockquote>
<p>使用当中发现发现如果使用<strong>Assets.xcassets</strong>中的Image是无法显示的，只有把图片放在<strong>根目录</strong>里才能显示。<br>开始以为是图片加载的问题：参考：<a href="http://www.jianshu.com/p/5358f587af38" target="_blank" rel="noopener">UIImage加载图片的方式以及Images.xcassets对于加载方法的影响</a><br>后来研究了一下发现是在<strong>Assets.xcassets</strong>添加Image包的创建方式用错了，不应该使用<strong>New iOS Launch Image</strong> 的方式，而是使用<strong>New Image Set*</strong> 的方式。</p>
<h3 id="设计思想"><a href="#设计思想" class="headerlink" title="设计思想"></a>设计思想</h3><h4 id="示例一："><a href="#示例一：" class="headerlink" title="示例一："></a>示例一：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 获取上次启动应用保存的appVersion</span><br><span class="line">NSString *lastVersion = [[NSUserDefaults standardUserDefaults] stringForKey:@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">// 获取当前版本号</span><br><span class="line">NSString *currentVersion = [NSBundle mainBundle].infoDictionary[@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">if ([currentVersion isEqualToString:lastVersion]) &#123;</span><br><span class="line">    // 两个版本号相同，不是首次登陆</span><br><span class="line">    return NO;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    // 否则存入当前版本信息</span><br><span class="line">    [[NSUserDefaults standardUserDefaults] setObject:currentVersion forKey:@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">    [[NSUserDefaults standardUserDefaults] synchronize];</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例二："><a href="#示例二：" class="headerlink" title="示例二："></a>示例二：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">static NSString *const kAppVersion = @&quot;appVersion&quot;;</span><br><span class="line"></span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">#pragma mark - 判断是不是首次登录或者版本更新</span><br><span class="line">-(BOOL )isFirstLauch &#123;</span><br><span class="line">    // 获取当前版本号</span><br><span class="line">    NSString *currentVersion = [NSBundle mainBundle].infoDictionary[@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">    // 获取上次启动应用保存的Version</span><br><span class="line">    NSString *lastVersion = [[NSUserDefaults standardUserDefaults] objectForKey:kAppVersion];</span><br><span class="line">    // 版本升级(即两次版本号不相同)或首次登录(即获取到上次版本号为nil)</span><br><span class="line">    BOOL isEqualVerson = [lastVersion isEqualToString:currentVersion];</span><br><span class="line">    if (!lastVersion || !isEqualVerson) &#123;</span><br><span class="line">        [[NSUserDefaults standardUserDefaults] setObject:currentVersion forKey:kAppVersion];</span><br><span class="line">        [[NSUserDefaults standardUserDefaults] synchronize];</span><br><span class="line">        return YES;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考 Demo：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  TPPWelcomeView.m</span></span><br><span class="line"><span class="comment">//  TaoPiaoPiao</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by blackcater on 16/7/5.</span></span><br><span class="line"><span class="comment">//  Copyright (c) 2016 blackcater. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"TPPWelcomeView.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">TPPWelcomeView</span>() &lt;<span class="title">UIScrollViewDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIScrollView</span> *scrollView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIPageControl</span> *pageControl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">TPPWelcomeView</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Lifecycle</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> render];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)render &#123;</span><br><span class="line">    [<span class="keyword">self</span> addImagesToScrollView];</span><br><span class="line">    [<span class="keyword">self</span> addSubview:<span class="keyword">self</span>.scrollView];</span><br><span class="line">    [<span class="keyword">self</span> addSubview:<span class="keyword">self</span>.pageControl];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Custom Accessors</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_scrollView) &#123;</span><br><span class="line">        _scrollView = [[<span class="built_in">UIScrollView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT)];</span><br><span class="line"></span><br><span class="line">        _scrollView.minimumZoomScale = <span class="number">1.0</span>;</span><br><span class="line">        _scrollView.maximumZoomScale = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">        _scrollView.showsVerticalScrollIndicator = <span class="literal">NO</span>;</span><br><span class="line">        _scrollView.showsHorizontalScrollIndicator = <span class="literal">NO</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// bounces,布尔值，用于控制当滚动视图超过内容边缘是否反弹，然后返回。</span></span><br><span class="line">        _scrollView.bounces = <span class="literal">NO</span>;</span><br><span class="line">        _scrollView.pagingEnabled = <span class="literal">YES</span>; <span class="comment">// scrollView 以边界倍数滚动</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// scrollView 的宽度 = SCREEN_WIDTH * 图片数量</span></span><br><span class="line">        _scrollView.contentSize = <span class="built_in">CGSizeMake</span>(SCREEN_WIDTH*WELCOME_PAHE_NUM, SCREEN_HEIGHT);</span><br><span class="line">        _scrollView.contentOffset = <span class="built_in">CGPointZero</span>; <span class="comment">// 初始位置</span></span><br><span class="line"></span><br><span class="line">        _scrollView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _scrollView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIPageControl</span> *)pageControl &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_pageControl) &#123;</span><br><span class="line">        _pageControl = [[<span class="built_in">UIPageControl</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>((SCREEN_WIDTH<span class="number">-300</span>)/<span class="number">2</span>, (SCREEN_HEIGHT<span class="number">-14</span><span class="number">-6</span>), <span class="number">300</span>, <span class="number">14</span>)];</span><br><span class="line">        _pageControl.numberOfPages = WELCOME_PAHE_NUM;</span><br><span class="line">        _pageControl.currentPage = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        _pageControl.currentPageIndicatorTintColor = COLOR_RGB(<span class="number">239</span>, <span class="number">26</span>, <span class="number">40</span>);</span><br><span class="line">        _pageControl.pageIndicatorTintColor = COLOR_RGB(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _pageControl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Private</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)addImagesToScrollView &#123;</span><br><span class="line">    <span class="keyword">int</span> num = WELCOME_PAHE_NUM;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;num; i++) &#123;</span><br><span class="line">        <span class="comment">// 循环遍历添加图片</span></span><br><span class="line">        <span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc] initWithImage:[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@%d.jpg"</span>, WELCOME_FILE_NAME, (i+<span class="number">1</span>)]]];</span><br><span class="line">        imageView.frame = <span class="built_in">CGRectMake</span>(SCREEN_WIDTH*i, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT);</span><br><span class="line">        [<span class="keyword">self</span>.scrollView addSubview:imageView];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 📝 最后一页时添加按钮</span></span><br><span class="line">        <span class="keyword">if</span> ((i+<span class="number">1</span>) == num) &#123;</span><br><span class="line">            <span class="comment">// 添加button</span></span><br><span class="line">            <span class="built_in">UIButton</span> *button = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>((SCREEN_WIDTH<span class="number">-200</span>)/<span class="number">2</span>, <span class="number">460</span>, <span class="number">200</span>, <span class="number">44</span>)];</span><br><span class="line">            [button setTitle:<span class="string">@"立刻观影"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">            [button setTitleColor: COLOR_RGB(<span class="number">239</span>, <span class="number">26</span>, <span class="number">40</span>) forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">            button.layer.borderColor = COLOR_RGB(<span class="number">239</span>, <span class="number">26</span>, <span class="number">40</span>).CGColor;</span><br><span class="line">            button.layer.borderWidth = <span class="number">2</span>;</span><br><span class="line">            button.layer.cornerRadius = <span class="number">20</span>;</span><br><span class="line">            button.clipsToBounds = <span class="literal">YES</span>;</span><br><span class="line">            button.backgroundColor = [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line">            </span><br><span class="line">            [button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnClickDownHandler:) forControlEvents:<span class="built_in">UIControlEventTouchDown</span>];</span><br><span class="line">            [button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btnClickUpHandler:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line"></span><br><span class="line">            [imageView addSubview:button];</span><br><span class="line">            imageView.userInteractionEnabled = <span class="literal">YES</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - IBActions</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 📌 Target-Action 事件：按钮按下时，高亮背景颜色</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 优化建议：</span></span><br><span class="line"><span class="comment"> * [UIImage imageWitColor:HexColor(@"#000000")]</span></span><br><span class="line"><span class="comment"> * [button setBackgroundImage: forState:UIControlStateHighlighted];</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)btnClickDownHandler:(<span class="built_in">UIButton</span> *)button &#123;</span><br><span class="line">    button.backgroundColor = COLOR_RGB(<span class="number">239</span>, <span class="number">26</span>, <span class="number">40</span>);</span><br><span class="line">    [button setTitleColor:[<span class="built_in">UIColor</span> whiteColor] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)btnClickUpHandler:(<span class="built_in">UIButton</span> *)button &#123;</span><br><span class="line">    button.backgroundColor = [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line"></span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1.0</span> delay:<span class="number">0.0</span> options:<span class="built_in">UIViewAnimationOptionCurveEaseInOut</span> animations:^&#123;</span><br><span class="line">        <span class="keyword">self</span>.alpha = <span class="number">0.0</span>;</span><br><span class="line">    &#125; completion:^(<span class="built_in">BOOL</span> flag) &#123;</span><br><span class="line">        <span class="comment">// 清除视图</span></span><br><span class="line">        [<span class="keyword">self</span> removeFromSuperview];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark -</span></span><br><span class="line"><span class="meta">#pragma mark UIScrollViewDelegate</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line">    <span class="comment">// 根据 scrollView 的偏移量计算出当前页索引，并更新 pageControl</span></span><br><span class="line">    <span class="keyword">int</span> index = (<span class="keyword">int</span>)floor(scrollView.contentOffset.x/SCREEN_WIDTH);</span><br><span class="line">    <span class="keyword">self</span>.pageControl.currentPage = index;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h4 id="AppDelegate-m"><a href="#AppDelegate-m" class="headerlink" title="AppDelegate.m"></a>AppDelegate.m</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 欢迎页</span></span><br><span class="line"><span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line"><span class="built_in">BOOL</span> flag = [[defaults objectForKey:WELCOME_ACTIVE_NAME] boolValue];</span><br><span class="line"><span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    [defaults setBool:<span class="literal">YES</span> forKey:WELCOME_ACTIVE_NAME];</span><br><span class="line">    <span class="comment">// 设置启动页</span></span><br><span class="line">    TPPWelcomeView *welcomeView = [[TPPWelcomeView alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT)];</span><br><span class="line">    [<span class="keyword">self</span>.window addSubview:welcomeView];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://github.com/guowilling/SRNewFeatures" target="_blank" rel="noopener">SRNewFeatures</a> </li>
<li><a href="http://www.jianshu.com/p/f08891ccb218" target="_blank" rel="noopener">一句代码搞定启动引导页——LaunchIntroductionView.m</a></li>
<li><a href="http://www.code4app.com/thread-10485-1-1.html" target="_blank" rel="noopener">0代码实现项目引导页——KSGuidViewController</a></li>
</ul>
<h3 id="其他第三方框架"><a href="#其他第三方框架" class="headerlink" title="其他第三方框架"></a>其他第三方框架</h3><ul>
<li><a href="https://github.com/ealeksandrov/EAIntroView" target="_blank" rel="noopener"><strong>EAIntroView</strong></a> ⭐️ 3400+<ul>
<li><a href="http://hao.jobbole.com/eaintroview-ios/" target="_blank" rel="noopener">EAIntroView：高度可定制的应用欢迎页通用解决方案</a></li>
</ul>
</li>
<li><a href="https://github.com/mamaral/Onboard" target="_blank" rel="noopener"><strong>Onboard</strong></a>  ⭐️ 5600+</li>
</ul>
<h3 id="设计思想-1"><a href="#设计思想-1" class="headerlink" title="设计思想"></a>设计思想</h3><ul>
<li><a href="http://www.woshipm.com/discuss/114689.html" target="_blank" rel="noopener">令人难忘的引导页欣赏</a></li>
<li><a href="http://www.3lian.com/edu/2014/07-10/154957.html" target="_blank" rel="noopener">22个知名APP启动引导页设计欣赏</a></li>
<li><a href="http://isux.tencent.com/user-guide-design-01.html" target="_blank" rel="noopener">移动端引导设计技巧1：前置的引导页</a></li>
<li><a href="http://uedc.163.com/12264.html" target="_blank" rel="noopener">由引导页说开来 | 网易用户体验设计中心</a></li>
<li><a href="http://wenku.baidu.com/link?url=xbOPxzSa7bkM57FNX0P7IuXBuEvgKYJzoEp1ICQWPAZnlu0O5JRMT0e25wWlagiCvq-TOrE6PwQH4XrJSLeBuPyraFtI8FyHl3U6fJGb3TK" target="_blank" rel="noopener">腾讯实例：怎么样让引导页变得更有用？</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/12/UIAlertViewController/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/12/UIAlertViewController/" class="post-title-link" itemprop="url">UIAlertController</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-12 11:35:00" itemprop="dateCreated datePublished" datetime="2017-01-12T11:35:00+08:00">2017-01-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-23 16:57:24" itemprop="dateModified" datetime="2019-04-23T16:57:24+08:00">2019-04-23</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/12/UIAlertViewController/" class="leancloud_visitors" data-flag-title="UIAlertController">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="UIAlertController"><a href="#UIAlertController" class="headerlink" title="UIAlertController"></a>UIAlertController</h1><blockquote>
<p>UIAlertController 同时替代了 UIAlertView 和 UIActionSheet，从系统层级上统一了 alert 的概念 —— 即以 modal 方式或 popover 方式展示。</p>
</blockquote>
<blockquote>
<p>UIAlertController 是 UIViewController 的子类，而非其先前的方式。因此新的 alert 可以由 view controller 展示相关的配置中获益很多。</p>
</blockquote>
<blockquote>
<p>UIAlertController 不管是要用 alert 还是 action sheet 方式展示，都要以 title 和 message 参数来初始化。Alert 会在当前显示的 view controller 中心以模态形式出现，action sheet 则会在底部滑出。Alert 可以同时有按钮和输入框，action sheet 仅支持按钮。</p>
</blockquote>
<blockquote>
<p>新的方式并没有把所有的 alert 按钮配置都放在初始化函数中，而是引入了一个新类 UIAlertAction 的对象，在初始化之后可以进行配置。这种形式的 API 重构让对按钮数量、类型、顺序方便有了更大的控制。同时也弃用了 UIAlertView 和 UIActionSheet 使用的delegate 这种方式，而是采用更简便的完成时回调。<br>                                       -<a href="http://nshipster.cn/uialertcontroller/" target="_blank" rel="noopener">摘自Mattt Thompson</a></p>
</blockquote>
<h2 id="UIAlertControllerStyle-——Alert-样式"><a href="#UIAlertControllerStyle-——Alert-样式" class="headerlink" title="UIAlertControllerStyle ——Alert 样式"></a>UIAlertControllerStyle ——Alert 样式</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typedef <span class="class"><span class="keyword">enum</span> <span class="title">UIAlertControllerStyle</span> : <span class="title">NSInteger</span> &#123;</span></span><br><span class="line">    UIAlertControllerStyleActionSheet = <span class="number">0</span>, <span class="regexp">//</span> 从底部向上推出的 action sheet 列表方式</span><br><span class="line">    UIAlertControllerStyleAlert            /<span class="regexp">/ 模态显示的 alert</span></span><br><span class="line"><span class="regexp">&#125; UIAlertControllerStyle;</span></span><br></pre></td></tr></table></figure>
<h2 id="UIAlertActionStyle-——-按钮样式"><a href="#UIAlertActionStyle-——-按钮样式" class="headerlink" title="UIAlertActionStyle —— 按钮样式"></a>UIAlertActionStyle —— 按钮样式</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef <span class="class"><span class="keyword">enum</span> <span class="title">UIAlertActionStyle</span> : <span class="title">NSInteger</span> &#123;</span></span><br><span class="line">    UIAlertActionStyleDefault = <span class="number">0</span>,</span><br><span class="line">    UIAlertActionStyleCancel,</span><br><span class="line">    UIAlertActionStyleDestructive</span><br><span class="line">&#125; UIAlertActionStyle;</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>UIAlertActionStyleDefault</strong><br> 默认风格样式的动作按钮;</li>
<li><strong>UIAlertActionStyleCancel</strong><br> 取消操作并且保持视图内容不变的动作按钮;</li>
<li><strong>UIAlertActionStyleDestructive</strong><br> 可能更改或删除数据样式的动作按钮,警示性样式，默认按钮字体为红色，提示用户这样做可能会删除或者改变某些数据.</li>
</ol>
<h2 id="1-1一个按钮的-Alert-样式"><a href="#1-1一个按钮的-Alert-样式" class="headerlink" title="1.1一个按钮的 Alert 样式"></a>1.1一个按钮的 Alert 样式</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-9365af9b8539a424.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="一个按钮的Alert样式"></p>
<h2 id="创建方法"><a href="#创建方法" class="headerlink" title="创建方法"></a>创建方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 1.实例化alertController</span><br><span class="line">UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;标题&quot;</span><br><span class="line">                                                               message:@&quot;消息&quot;</span><br><span class="line">                                                        preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line"></span><br><span class="line">// 2.实例化按钮</span><br><span class="line">UIAlertAction *action = [UIAlertAction actionWithTitle:@&quot;确定&quot;</span><br><span class="line">                                                 style:UIAlertActionStyleDefault</span><br><span class="line">                                               handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                   // 点击按钮，调用此block</span><br><span class="line">                                                   NSLog(@&quot;Button Click&quot;);</span><br><span class="line">                                               &#125;];</span><br><span class="line">[alert addAction:action];</span><br><span class="line"></span><br><span class="line">//  3.显示alertController</span><br><span class="line">[self presentViewController:alert animated:YES completion:nil];</span><br></pre></td></tr></table></figure>
<h2 id="1-2-标准的-Alert-样式"><a href="#1-2-标准的-Alert-样式" class="headerlink" title="1.2 标准的 Alert 样式"></a>1.2 标准的 Alert 样式</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-37369a5a1c4637a4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="创建方法-1"><a href="#创建方法-1" class="headerlink" title="创建方法"></a>创建方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//  1.实例化UIAlertController对象</span><br><span class="line">UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;标准的Alert 样式&quot;</span><br><span class="line">                                                               message:@&quot;UIAlertControllerStyleAlert&quot;</span><br><span class="line">                                                        preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line"></span><br><span class="line">//  2.1实例化UIAlertAction按钮:取消按钮</span><br><span class="line">UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;取消&quot;</span><br><span class="line">                                                       style:UIAlertActionStyleCancel</span><br><span class="line">                                                     handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                         // 点击取消按钮，调用此block</span><br><span class="line">                                                         NSLog(@&quot;取消按钮被按下！&quot;);</span><br><span class="line">                                                     &#125;];</span><br><span class="line">[alert addAction:cancelAction];</span><br><span class="line"></span><br><span class="line">//  2.2实例化UIAlertAction按钮:确定按钮</span><br><span class="line">UIAlertAction *defaultAction = [UIAlertAction actionWithTitle:@&quot;确定&quot;</span><br><span class="line">                                                        style:UIAlertActionStyleDefault</span><br><span class="line">                                                      handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                          // 点击按钮，调用此block</span><br><span class="line">                                                          NSLog(@&quot;确定按钮被按下&quot;);</span><br><span class="line">                                                      &#125;];</span><br><span class="line">[alert addAction:defaultAction];</span><br><span class="line"></span><br><span class="line">//  3.显示alertController</span><br><span class="line">[self presentViewController:alert animated:YES completion:nil];</span><br></pre></td></tr></table></figure>
<h2 id="1-3-带有多个按钮的-Alert-样式"><a href="#1-3-带有多个按钮的-Alert-样式" class="headerlink" title="1.3 带有多个按钮的 Alert 样式"></a>1.3 带有多个按钮的 Alert 样式</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-11a63e2058244842.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="创建方法-2"><a href="#创建方法-2" class="headerlink" title="创建方法"></a>创建方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">//  1.实例化UIAlertController对象</span><br><span class="line">UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;多个按钮的Alert 样式&quot;</span><br><span class="line">                                                               message:@&quot;有1个或者2个操作按钮的时候，按钮会水平排布。更多按钮的情况，就会像action sheet那样展示：&quot;</span><br><span class="line">                                                        preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line"></span><br><span class="line">//  2.1实例化UIAlertAction按钮:确定按钮</span><br><span class="line">UIAlertAction *defaultAction = [UIAlertAction actionWithTitle:@&quot;确定&quot;</span><br><span class="line">                                                        style:UIAlertActionStyleDefault</span><br><span class="line">                                                      handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                          // 点击按钮，调用此block</span><br><span class="line">                                                          NSLog(@&quot;确定按钮被按下&quot;);</span><br><span class="line">                                                      &#125;];</span><br><span class="line">[alert addAction:defaultAction];</span><br><span class="line"></span><br><span class="line">//  2.2实例化UIAlertAction按钮:更多按钮</span><br><span class="line">UIAlertAction *moreAction = [UIAlertAction actionWithTitle:@&quot;更多&quot;</span><br><span class="line">                                                     style:UIAlertActionStyleDestructive</span><br><span class="line">                                                   handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                       // 点击按钮，调用此block</span><br><span class="line">                                                       NSLog(@&quot;更多按钮被按下&quot;);</span><br><span class="line">                                                   &#125;];</span><br><span class="line">[alert addAction:moreAction];</span><br><span class="line"></span><br><span class="line">//  2.3实例化UIAlertAction按钮:取消按钮</span><br><span class="line">UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;取消&quot;</span><br><span class="line">                                                       style:UIAlertActionStyleCancel</span><br><span class="line">                                                     handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                         // 点击取消按钮，调用此block</span><br><span class="line">                                                         NSLog(@&quot;取消按钮被按下！&quot;);</span><br><span class="line">                                                     &#125;];</span><br><span class="line">[alert addAction:cancelAction];</span><br><span class="line"></span><br><span class="line">//  3.显示alertController</span><br><span class="line">[self presentViewController:alert animated:YES completion:nil];</span><br></pre></td></tr></table></figure>
<h2 id="2-标准的-Alert-Sheet-样式"><a href="#2-标准的-Alert-Sheet-样式" class="headerlink" title="2.标准的 Alert Sheet 样式"></a>2.标准的 Alert Sheet 样式</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-f39b4609119063b8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="创建方法-3"><a href="#创建方法-3" class="headerlink" title="创建方法"></a>创建方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 1.实例化UIAlertController对象</span><br><span class="line">UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;标准的Action Sheet样式&quot;</span><br><span class="line">                                                               message:@&quot;UIAlertControllerStyleActionSheet&quot;</span><br><span class="line">                                                        preferredStyle:UIAlertControllerStyleActionSheet];</span><br><span class="line"></span><br><span class="line">// 2.1实例化UIAlertAction按钮:取消按钮</span><br><span class="line">UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;取消&quot;</span><br><span class="line">                                                       style:UIAlertActionStyleCancel</span><br><span class="line">                                                     handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                         NSLog(@&quot;取消按钮被按下！&quot;);</span><br><span class="line">                                                     &#125;];</span><br><span class="line">[alert addAction:cancelAction];</span><br><span class="line"></span><br><span class="line">// 2.2实例化UIAlertAction按钮:更多按钮</span><br><span class="line">UIAlertAction *moreAction = [UIAlertAction actionWithTitle:@&quot;更多&quot;</span><br><span class="line">                                                     style:UIAlertActionStyleDestructive</span><br><span class="line">                                                   handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                       NSLog(@&quot;更多按钮被按下！&quot;);</span><br><span class="line">                                                   &#125;];</span><br><span class="line">[alert addAction:moreAction];</span><br><span class="line"></span><br><span class="line">// 2.3实例化UIAlertAction按钮:确定按钮</span><br><span class="line">UIAlertAction *confirmAction = [UIAlertAction actionWithTitle:@&quot;确定&quot;</span><br><span class="line">                                                        style:UIAlertActionStyleDefault</span><br><span class="line">                                                      handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                          NSLog(@&quot;确定按钮被按下&quot;);</span><br><span class="line">                                                      &#125;];</span><br><span class="line">[alert addAction:confirmAction];</span><br><span class="line"></span><br><span class="line">//  3.显示alertController</span><br><span class="line">[self presentViewController:alert animated:YES completion:nil];</span><br></pre></td></tr></table></figure>
<h2 id="3-带输入框样式"><a href="#3-带输入框样式" class="headerlink" title="3.带输入框样式"></a>3.带输入框样式</h2><p><img src="http://upload-images.jianshu.io/upload_images/2648731-43c00a697f332898.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="创建方法-4"><a href="#创建方法-4" class="headerlink" title="创建方法"></a>创建方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 1.实例化UIAlertController对象</span><br><span class="line">UIAlertController *alert = [UIAlertController alertControllerWithTitle:@&quot;标题&quot;</span><br><span class="line">                                                               message:@&quot;信息&quot;</span><br><span class="line">                                                        preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line"></span><br><span class="line">// 2.1添加输入文本框</span><br><span class="line">[alert addTextFieldWithConfigurationHandler:^(UITextField * _Nonnull textField) &#123;</span><br><span class="line">    textField.placeholder = @&quot;支付密码&quot;;</span><br><span class="line">    textField.secureTextEntry = YES;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">// 2.2实例化UIAlertAction按钮:确定按钮</span><br><span class="line">UIAlertAction *confirmAction = [UIAlertAction actionWithTitle:@&quot;确定&quot;</span><br><span class="line">                                                        style:UIAlertActionStyleDefault</span><br><span class="line">                                                      handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">                                                          NSLog(@&quot;确定按钮被按下&quot;);</span><br><span class="line">                                                          UITextField *passwordTextField = alert.textFields.firstObject;</span><br><span class="line">                                                          NSLog(@&quot;读取输入密码：%@&quot;,passwordTextField.text);</span><br><span class="line">                                &#125;];</span><br><span class="line">[alert addAction:confirmAction];</span><br><span class="line"></span><br><span class="line">//  3.显示alertController</span><br><span class="line">[self presentViewController:alert animated:YES completion:nil];</span><br></pre></td></tr></table></figure>
<h1 id="第三方框架："><a href="#第三方框架：" class="headerlink" title="第三方框架："></a>第三方框架：</h1><h2 id="ryanmaxwell-UIAlertController-Blocks"><a href="#ryanmaxwell-UIAlertController-Blocks" class="headerlink" title="ryanmaxwell/UIAlertController-Blocks"></a><a href="https://github.com/ryanmaxwell/UIAlertController-Blocks" target="_blank" rel="noopener">ryanmaxwell/<strong>UIAlertController-Blocks</strong></a></h2><p>用 Blocks 方式封装的便捷扩展类，调用更简单：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// 通用创建方法</span><br><span class="line">+ (nonnull instancetype)showInViewController:(nonnull UIViewController *)viewController</span><br><span class="line">                                   withTitle:(nullable NSString *)title</span><br><span class="line">                                     message:(nullable NSString *)message</span><br><span class="line">                              preferredStyle:(UIAlertControllerStyle)preferredStyle</span><br><span class="line">                           cancelButtonTitle:(nullable NSString *)cancelButtonTitle</span><br><span class="line">                      destructiveButtonTitle:(nullable NSString *)destructiveButtonTitle</span><br><span class="line">                           otherButtonTitles:(nullable NSArray *)otherButtonTitles</span><br><span class="line">#if TARGET_OS_iOS</span><br><span class="line">          popoverPresentationControllerBlock:(nullable UIAlertControllerPopoverPresentationControllerBlock)popoverPresentationControllerBlock</span><br><span class="line">#endif</span><br><span class="line">                                    tapBlock:(nullable UIAlertControllerCompletionBlock)tapBlock;</span><br><span class="line"></span><br><span class="line">// 指明创建 UIAlertControllerStyleAlert 样式的弹窗：</span><br><span class="line">+ (nonnull instancetype)showAlertInViewController:(nonnull UIViewController *)viewController</span><br><span class="line">                                        withTitle:(nullable NSString *)title</span><br><span class="line">                                          message:(nullable NSString *)message</span><br><span class="line">                                cancelButtonTitle:(nullable NSString *)cancelButtonTitle</span><br><span class="line">                           destructiveButtonTitle:(nullable NSString *)destructiveButtonTitle</span><br><span class="line">                                otherButtonTitles:(nullable NSArray *)otherButtonTitles</span><br><span class="line">                                         tapBlock:(nullable UIAlertControllerCompletionBlock)tapBlock;</span><br><span class="line"></span><br><span class="line">// 指明创建 UIAlertControllerStyleActionSheet 样式的弹窗：</span><br><span class="line">+ (nonnull instancetype)showActionSheetInViewController:(nonnull UIViewController *)viewController</span><br><span class="line">                                              withTitle:(nullable NSString *)title</span><br><span class="line">                                                message:(nullable NSString *)message</span><br><span class="line">                                      cancelButtonTitle:(nullable NSString *)cancelButtonTitle</span><br><span class="line">                                 destructiveButtonTitle:(nullable NSString *)destructiveButtonTitle</span><br><span class="line">                                      otherButtonTitles:(nullable NSArray *)otherButtonTitles</span><br><span class="line">#if TARGET_OS_iOS</span><br><span class="line">                     popoverPresentationControllerBlock:(nullable UIAlertControllerPopoverPresentationControllerBlock)popoverPresentationControllerBlock</span><br><span class="line">#endif</span><br><span class="line">                                               tapBlock:(nullable UIAlertControllerCompletionBlock)tapBlock;</span><br></pre></td></tr></table></figure></p>
<h3 id="调用示例"><a href="#调用示例" class="headerlink" title="调用示例"></a>调用示例</h3><h5 id="示例一："><a href="#示例一：" class="headerlink" title="示例一："></a>示例一：</h5><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[UIAlertController showAlertInViewController:self</span><br><span class="line"><span class="symbol">                                           withTitle:</span>@<span class="string">"无法访问位置信息"</span></span><br><span class="line"><span class="symbol">                                             message:</span>@<span class="string">"请去设置-隐私-定位服务中开启该功能"</span></span><br><span class="line"><span class="symbol">                                   cancelButtonTitle:</span>@<span class="string">"知道了"</span></span><br><span class="line"><span class="symbol">                              destructiveButtonTitle:</span>nil</span><br><span class="line"><span class="symbol">                                   otherButtonTitles:</span>nil</span><br><span class="line"><span class="symbol">                                            tapBlock:</span>nil];</span><br></pre></td></tr></table></figure>
<h5 id="示例二："><a href="#示例二：" class="headerlink" title="示例二："></a>示例二：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">self.tapBlock = ^(UIAlertController *controller, UIAlertAction *action, NSInteger buttonIndex)&#123;</span><br><span class="line">            if (buttonIndex == controller.destructiveButtonIndex) &#123;</span><br><span class="line">                NSLog(@&quot;Delete&quot;);</span><br><span class="line">            &#125; else if (buttonIndex == controller.cancelButtonIndex) &#123;</span><br><span class="line">                NSLog(@&quot;Cancel&quot;);</span><br><span class="line">            &#125; else if (buttonIndex &gt;= controller.firstOtherButtonIndex) &#123;</span><br><span class="line">                NSLog(@&quot;Other %ld&quot;, (long)buttonIndex - controller.firstOtherButtonIndex + 1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">// Alert 样式</span><br><span class="line">[UIAlertController showAlertInViewController:self</span><br><span class="line">                                       withTitle:@&quot;Test Alert&quot;</span><br><span class="line">                                         message:@&quot;Test Message&quot;</span><br><span class="line">                               cancelButtonTitle:@&quot;Cancel&quot;</span><br><span class="line">                          destructiveButtonTitle:@&quot;Delete&quot;</span><br><span class="line">                               otherButtonTitles:@[@&quot;First Other&quot;, @&quot;Second Other&quot;]</span><br><span class="line">                                        tapBlock:self.tapBlock];</span><br><span class="line">// ActionSheet 样式</span><br><span class="line">[UIAlertController showActionSheetInViewController:self</span><br><span class="line">                                         withTitle:@&quot;Test Action Sheet&quot;</span><br><span class="line">                                           message:@&quot;Test Message&quot;</span><br><span class="line">                                 cancelButtonTitle:@&quot;Cancel&quot;</span><br><span class="line">                            destructiveButtonTitle:@&quot;Delete&quot;</span><br><span class="line">                                 otherButtonTitles:@[@&quot;First Other&quot;, @&quot;Second Other&quot;]</span><br><span class="line">#if TARGET_OS_iOS</span><br><span class="line">                popoverPresentationControllerBlock:^(UIPopoverPresentationController *popover)&#123;</span><br><span class="line"></span><br><span class="line">                    popover.sourceView = self.view;</span><br><span class="line">                    popover.sourceRect = sender.frame;</span><br><span class="line">                &#125;</span><br><span class="line">#endif</span><br><span class="line">                                          tapBlock:self.tapBlock];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:如果不需要某个按钮，就给按钮的Title 传 nil。</p>
</blockquote>
<ul>
<li>ButtonIndex判断：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static NSInteger const UIAlertControllerBlocksCancelButtonIndex = 0; // 取消、返回按钮</span><br><span class="line">static NSInteger const UIAlertControllerBlocksDestructiveButtonIndex = 1; // 更改、删除按钮</span><br><span class="line">static NSInteger const UIAlertControllerBlocksFirstOtherButtonIndex = 2; // 第一个默认按钮</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-e5c12f04932099b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/150" alt="button Index"></p>
<h3 id="第三方框架：kukumaluCN-JXTAlertManager"><a href="#第三方框架：kukumaluCN-JXTAlertManager" class="headerlink" title="第三方框架：kukumaluCN/JXTAlertManager"></a>第三方框架：<a href="https://github.com/kukumaluCN/JXTAlertManager" target="_blank" rel="noopener">kukumaluCN/JXTAlertManager</a></h3><p>这个框架支持链式语法：<br>使用示例：</p>
<h4 id="1-Alert"><a href="#1-Alert" class="headerlink" title="1.Alert"></a>1.Alert</h4><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[<span class="name">self</span> jxt_showAlertWithTitle:@<span class="string">"title"</span></span><br><span class="line">                     message:@<span class="string">"message"</span></span><br><span class="line">           appearanceProcess:^(<span class="name">JXTAlertController</span> * _Nonnull alertMaker) &#123;</span><br><span class="line">    alertMaker.</span><br><span class="line">    addActionCancelTitle(<span class="name">@</span><span class="string">"cancel"</span>).</span><br><span class="line">    addActionDestructiveTitle(<span class="name">@</span><span class="string">"按钮1"</span>)<span class="comment">;</span></span><br><span class="line">&#125; actionsBlock:^(<span class="name">NSInteger</span> buttonIndex, UIAlertAction * _Nonnull action, JXTAlertController * _Nonnull alertSelf) &#123;</span><br><span class="line">    if (<span class="name">buttonIndex</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        NSLog(<span class="name">@</span><span class="string">"cancel"</span>)<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    else if (<span class="name">buttonIndex</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        NSLog(<span class="name">@</span><span class="string">"按钮1"</span>)<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-AlertSheet"><a href="#2-AlertSheet" class="headerlink" title="2.AlertSheet"></a>2.AlertSheet</h4><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[<span class="name">self</span> jxt_showAlertWithTitle:@<span class="string">"title"</span></span><br><span class="line">                     message:@<span class="string">"message"</span></span><br><span class="line">           appearanceProcess:^(<span class="name">JXTAlertController</span> * _Nonnull alertMaker) &#123;</span><br><span class="line">    alertMaker.</span><br><span class="line">    addActionDestructiveTitle(<span class="name">@</span><span class="string">"获取输入框1"</span>).</span><br><span class="line">    addActionDestructiveTitle(<span class="name">@</span><span class="string">"获取输入框2"</span>)<span class="comment">;</span></span><br><span class="line">    </span><br><span class="line">    [<span class="name">alertMaker</span> addTextFieldWithConfigurationHandler:^(<span class="name">UITextField</span> * _Nonnull textField) &#123;</span><br><span class="line">        textField.placeholder = @<span class="string">"输入框1-请输入"</span><span class="comment">;</span></span><br><span class="line">    &#125;]<span class="comment">;</span></span><br><span class="line">    [<span class="name">alertMaker</span> addTextFieldWithConfigurationHandler:^(<span class="name">UITextField</span> * _Nonnull textField) &#123;</span><br><span class="line">        textField.placeholder = @<span class="string">"输入框2-请输入"</span><span class="comment">;</span></span><br><span class="line">    &#125;]<span class="comment">;</span></span><br><span class="line">&#125; actionsBlock:^(<span class="name">NSInteger</span> buttonIndex, UIAlertAction * _Nonnull action, JXTAlertController * _Nonnull alertSelf) &#123;</span><br><span class="line">    if (<span class="name">buttonIndex</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        UITextField *textField = alertSelf.textFields.firstObject<span class="comment">;</span></span><br><span class="line">        [<span class="name">self</span> logMsg:textField.text]<span class="comment">;//不用担心循环引用</span></span><br><span class="line">    &#125;</span><br><span class="line">    else if (<span class="name">buttonIndex</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        UITextField *textField = alertSelf.textFields.lastObject<span class="comment">;</span></span><br><span class="line">        [<span class="name">self</span> logMsg:textField.text]<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h2 id="播放系统声音、提醒声音和振动设备"><a href="#播放系统声音、提醒声音和振动设备" class="headerlink" title="播放系统声音、提醒声音和振动设备"></a>播放系统声音、提醒声音和振动设备</h2><pre><code>// 导入框架
#import &lt;AudioToolbox/AudioToolbox.h&gt;
</code></pre><h2 id="播放系统声音"><a href="#播放系统声音" class="headerlink" title="播放系统声音"></a>播放系统声音</h2><pre><code>AudioServicesPlaySystemSound(1005);
</code></pre><h2 id="播放提醒声音"><a href="#播放提醒声音" class="headerlink" title="播放提醒声音"></a>播放提醒声音</h2><pre><code>AudioServicesPlayAlertSound(1006);
</code></pre><h2 id="执行震动"><a href="#执行震动" class="headerlink" title="执行震动"></a>执行震动</h2><pre><code>AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);
</code></pre><h3 id="其它开源框架"><a href="#其它开源框架" class="headerlink" title="其它开源框架"></a>其它开源框架</h3><ul>
<li><a href="https://github.com/dogo/SCLAlertView" target="_blank" rel="noopener">dogo/SCLAlertView</a> ⭐️3000</li>
<li><a href="https://github.com/adad184/MMPopupView" target="_blank" rel="noopener">GitHub:adad184/MMPopupView</a> ⭐️1800</li>
<li><a href="https://github.com/mtonio91/AMSmoothAlert" target="_blank" rel="noopener">GitHub:mtonio91/AMSmoothAlert</a> ⭐️1300</li>
<li><a href="https://github.com/12207480/TYAlertController" target="_blank" rel="noopener">GitHub:12207480/TYAlertController</a> ⭐️1000</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://nshipster.cn/uialertcontroller/" target="_blank" rel="noopener">UIAlert​Controller @Mattt Thompson撰写、 Croath Liu翻译</a>-<strong>Swift</strong></li>
<li><a href="http://www.jianshu.com/p/c4018f4fef0b" target="_blank" rel="noopener">iOS开发笔记：提示框（UIAlertController）学习</a></li>
<li><a href="http://blog.csdn.net/bht890811/article/details/40952439" target="_blank" rel="noopener"> iOS 8 新特性初学：UIAlertController @关东糖</a></li>
<li><a href="http://www.jianshu.com/p/ae336594daf0" target="_blank" rel="noopener">iOS 更加优雅便捷的UIAlertView/UIAlertController封装使用 @霖溦</a></li>
<li><a href="http://www.jianshu.com/p/d11453dbd980" target="_blank" rel="noopener">模仿支付宝支付密码输入对话框</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/09/iOS 编程：AES 加密算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/09/iOS 编程：AES 加密算法/" class="post-title-link" itemprop="url">iOS 编程：AES 加密算法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-09 12:22:00" itemprop="dateCreated datePublished" datetime="2017-01-09T12:22:00+08:00">2017-01-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 16:20:41" itemprop="dateModified" datetime="2019-04-17T16:20:41+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/09/iOS 编程：AES 加密算法/" class="leancloud_visitors" data-flag-title="iOS 编程：AES 加密算法">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h3 id="在线AES加解密网站"><a href="#在线AES加解密网站" class="headerlink" title="在线AES加解密网站"></a><a href="http://www.seacha.com/tools/aes.html" target="_blank" rel="noopener">在线AES加解密网站</a></h3><ul>
<li>发现这个网站除了可以<strong>在线AES加解密</strong>，还有<strong>MD5在线加密</strong> 、<strong>SHA1在线加密</strong> 、<strong>Base64在线加解密</strong>  、<strong>3DES在线加解密</strong> 、<strong>中文域名在线转码</strong> 、<strong>在线生成二维码</strong> 等其它功能。</li>
</ul>
<h3 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h3><blockquote>
<p>iOS加密算法参考了<a href="http://www.jianshu.com/p/df828a57cb8f" target="_blank" rel="noopener">AES加密 - iOS与Java的同步实现 @WelkinXie</a>，然后根据自己的需求作了一下修改，传入的是<strong>NSDictionary</strong>类型，并且嵌套进了 <strong>NSDictionary</strong> <-> <strong>NSString</strong> 相互转换的两个方法。</-></p>
</blockquote>
<h4 id="AESCipher-h"><a href="#AESCipher-h" class="headerlink" title="AESCipher.h"></a>AESCipher.h</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AESCipher</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 加密算法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param dictionary 待加密字典</span></span><br><span class="line"><span class="comment"> @param key 密钥</span></span><br><span class="line"><span class="comment"> @return 加密后字符串</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)encryptAES:(<span class="built_in">NSDictionary</span> *)dictionary key:(<span class="built_in">NSString</span> *)key;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 解密算法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param content 待解密字符串</span></span><br><span class="line"><span class="comment"> @param key 密钥</span></span><br><span class="line"><span class="comment"> @return 解密后字典</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSDictionary</span> *)decryptAES:(<span class="built_in">NSString</span> *)content key:(<span class="built_in">NSString</span> *)key;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h4 id="AESCiphser-m"><a href="#AESCiphser-m" class="headerlink" title="AESCiphser.m"></a>AESCiphser.m</h4><ul>
<li>需要注意的是AES加密算法中的这几个设置参数一定要和服务器端一致，否则会有各种错误。<ul>
<li>密钥长度（Key Size）</li>
<li>加密模式（Cipher Mode）</li>
<li>填充方式（Padding）</li>
<li>初始向量（Initialization Vector）</li>
</ul>
</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"AESCipher.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CommonCrypto/CommonCryptor.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 初始向量*/</span></span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> kInitVector = <span class="string">@"16-Bytes--String"</span>;</span><br><span class="line"><span class="comment">/** 密钥长度：AES-128*/</span></span><br><span class="line">size_t <span class="keyword">const</span> kKeySize = kCCKeySizeAES128;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AESCipher</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - 加密算法</span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSString</span> *)encryptAES:(<span class="built_in">NSDictionary</span> *)dictionary key:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// NSDictionary -&gt; NSString</span></span><br><span class="line">    <span class="built_in">NSString</span> *content = [<span class="keyword">self</span> convertToJsonData:dictionary];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 待加密数据: NSString -&gt; NSData</span></span><br><span class="line">    <span class="built_in">NSData</span> *contentData = [content dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSUInteger</span> dataLength = contentData.length;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 密钥长度:kCCKeySizeAES128</span></span><br><span class="line">    <span class="keyword">char</span> keyPtr[kKeySize + <span class="number">1</span>]; <span class="comment">// 为结束符'\\0' +1</span></span><br><span class="line">    memset(keyPtr, <span class="number">0</span>, <span class="keyword">sizeof</span>(keyPtr));</span><br><span class="line">    [key getCString:keyPtr maxLength:<span class="keyword">sizeof</span>(keyPtr) encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 密文长度 &lt;= 明文长度 + BlockSize（填充数据）</span></span><br><span class="line">    size_t encryptSize = dataLength + kCCBlockSizeAES128;</span><br><span class="line">    <span class="keyword">void</span> *encryptedBytes = malloc(encryptSize);</span><br><span class="line">    size_t actualOutSize = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSData</span> *initVector = [kInitVector dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置加密参数</span></span><br><span class="line">    <span class="comment">// 系统默认使用 CBC 加密模式，然后指明使用 PKCS7Padding 补码方式(填充方式)</span></span><br><span class="line">    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt,</span><br><span class="line">                                          kCCAlgorithmAES,</span><br><span class="line">                                          kCCOptionPKCS7Padding,</span><br><span class="line">                                          keyPtr,</span><br><span class="line">                                          kKeySize,</span><br><span class="line">                                          initVector.bytes,</span><br><span class="line">                                          contentData.bytes,</span><br><span class="line">                                          dataLength,</span><br><span class="line">                                          encryptedBytes,</span><br><span class="line">                                          encryptSize,</span><br><span class="line">                                          &amp;actualOutSize);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (cryptStatus == kCCSuccess) &#123;</span><br><span class="line">        <span class="comment">// 加密结果编码方式: base64 编码</span></span><br><span class="line">        <span class="keyword">return</span> [[<span class="built_in">NSData</span> dataWithBytesNoCopy:encryptedBytes length:actualOutSize] base64EncodedStringWithOptions:<span class="built_in">NSDataBase64EncodingEndLineWithLineFeed</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    free(encryptedBytes);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - 解密算法</span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSDictionary</span> *)decryptAES:(<span class="built_in">NSString</span> *)content key:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="comment">// 把 base64 String 转换成 Data</span></span><br><span class="line">    <span class="built_in">NSData</span> *contentData = [[<span class="built_in">NSData</span> alloc] initWithBase64EncodedString:content options:<span class="built_in">NSDataBase64DecodingIgnoreUnknownCharacters</span>];</span><br><span class="line">    <span class="built_in">NSUInteger</span> dataLength = contentData.length;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">char</span> keyPtr[kKeySize + <span class="number">1</span>];</span><br><span class="line">    memset(keyPtr, <span class="number">0</span>, <span class="keyword">sizeof</span>(keyPtr));</span><br><span class="line">    [key getCString:keyPtr maxLength:<span class="keyword">sizeof</span>(keyPtr) encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    </span><br><span class="line">    size_t decryptSize = dataLength + kCCBlockSizeAES128;</span><br><span class="line">    <span class="keyword">void</span> *decryptedBytes = malloc(decryptSize);</span><br><span class="line">    size_t actualOutSize = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSData</span> *initVector = [kInitVector dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    </span><br><span class="line">    CCCryptorStatus cryptStatus = CCCrypt(kCCDecrypt,</span><br><span class="line">                                          kCCAlgorithmAES,</span><br><span class="line">                                          kCCOptionPKCS7Padding,</span><br><span class="line">                                          keyPtr,</span><br><span class="line">                                          kKeySize,</span><br><span class="line">                                          initVector.bytes,</span><br><span class="line">                                          contentData.bytes,</span><br><span class="line">                                          dataLength,</span><br><span class="line">                                          decryptedBytes,</span><br><span class="line">                                          decryptSize,</span><br><span class="line">                                          &amp;actualOutSize);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (cryptStatus == kCCSuccess) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *content = [[<span class="built_in">NSString</span> alloc] initWithData:[<span class="built_in">NSData</span> dataWithBytesNoCopy:decryptedBytes length:actualOutSize] encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">        <span class="keyword">return</span> [<span class="keyword">self</span> dictionaryWithJsonString:content];</span><br><span class="line">    &#125;</span><br><span class="line">    free(decryptedBytes);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - NSDictionary <span class="meta-string">&lt;-&gt;</span> NSString</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NSDictionary 转换为 NSString</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)convertToJsonData:(<span class="built_in">NSDictionary</span> *)dictionary &#123;</span><br><span class="line">    <span class="built_in">NSError</span> *error;</span><br><span class="line">    <span class="built_in">NSData</span> *jsonData = [<span class="built_in">NSJSONSerialization</span> dataWithJSONObject:dictionary options:<span class="built_in">NSJSONWritingPrettyPrinted</span> error:&amp;error];</span><br><span class="line">    <span class="built_in">NSString</span> *jsonString;</span><br><span class="line">    <span class="keyword">if</span> (!jsonData) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,error);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        jsonString = [[<span class="built_in">NSString</span> alloc]initWithData:jsonData encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *mutStr = [<span class="built_in">NSMutableString</span> stringWithString:jsonString];</span><br><span class="line">    <span class="built_in">NSRange</span> range = &#123;<span class="number">0</span>,jsonString.length&#125;;</span><br><span class="line">    <span class="comment">//去掉字符串中的空格</span></span><br><span class="line">    [mutStr replaceOccurrencesOfString:<span class="string">@" "</span> withString:<span class="string">@""</span> options:<span class="built_in">NSLiteralSearch</span> range:range];</span><br><span class="line">    <span class="built_in">NSRange</span> range2 = &#123;<span class="number">0</span>,mutStr.length&#125;;</span><br><span class="line">    <span class="comment">//去掉字符串中的换行符</span></span><br><span class="line">    [mutStr replaceOccurrencesOfString:<span class="string">@"\n"</span> withString:<span class="string">@""</span> options:<span class="built_in">NSLiteralSearch</span> range:range2];</span><br><span class="line">    <span class="keyword">return</span> mutStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSString 转换为 NSDictionary</span></span><br><span class="line">+ (<span class="built_in">NSDictionary</span> *)dictionaryWithJsonString:(<span class="built_in">NSString</span> *)content &#123;</span><br><span class="line">    <span class="keyword">if</span> (content == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSData</span> *jsonData = [content dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSError</span> *err;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:jsonData</span><br><span class="line">                                                        options:<span class="built_in">NSJSONReadingMutableContainers</span></span><br><span class="line">                                                          error:&amp;err];</span><br><span class="line">    <span class="keyword">if</span>(err)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"json解析失败：%@"</span>,err);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dic;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><ol>
<li>先在需要使用AES加密方法的文件中先导入包文件。<br><code>#import &quot;AESCipher.h&quot;</code></li>
<li><p>设置好需要传入的<strong>NSDictionary对象</strong>和<strong>key值</strong>（一定要确保是16位的，且和服务器端一致）。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *<span class="keyword">dictionary </span>= @&#123;</span><br><span class="line">                               @<span class="string">"key"</span>:@<span class="string">"value"</span></span><br><span class="line">                                &#125;<span class="comment">;</span></span><br><span class="line">NSString *key = @<span class="string">"1234567890123456"</span><span class="comment">;</span></span><br><span class="line">NSString *cipherString = [AESCipher encryptAES:<span class="keyword">dictionary </span>key:key]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解密调用时，设置一个<strong>NSDictionary对象</strong>传入需要解密的字符串接受解密后的数据。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">NSDictionary</span> <span class="meta">*dictionary</span> <span class="string">=</span> <span class="string">[AESCipher</span> <span class="attr">decryptAES:cipherString</span> <span class="attr">key:key];</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.jianshu.com/p/df828a57cb8f" target="_blank" rel="noopener">AES加密 - iOS与Java的同步实现 @WelkinXie</a></li>
<li><a href="https://github.com/Gurpartap/AESCrypt-ObjC" target="_blank" rel="noopener">GitHub框架：<strong>AESCrypt-ObjC</strong></a></li>
<li><a href="http://www.jianshu.com/p/3a4f47cb86f8" target="_blank" rel="noopener">iOS数据加密方式 MD5 &amp; RSA</a></li>
<li><a href="http://www.cnblogs.com/ming1025/p/6186171.html" target="_blank" rel="noopener">iOS开发–字典(NSDictionary)和JSON字符串(NSString)之间互转</a></li>
<li><a href="http://www.infoq.com/cn/articles/how-to-encrypt-the-user-password-correctly" target="_blank" rel="noopener">如何正确对用户密码进行加密？</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2017/01/06/iOS 编程：获取设备信息、应用跳转/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/01/06/iOS 编程：获取设备信息、应用跳转/" class="post-title-link" itemprop="url">iOS 编程：获取设备信息、应用跳转</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-01-06 10:19:00" itemprop="dateCreated datePublished" datetime="2017-01-06T10:19:00+08:00">2017-01-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-17 16:53:00" itemprop="dateModified" datetime="2019-04-17T16:53:00+08:00">2019-04-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2017/01/06/iOS 编程：获取设备信息、应用跳转/" class="leancloud_visitors" data-flag-title="iOS 编程：获取设备信息、应用跳转">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1g25qc34deaj30u0160gvr.jpg" alt="Photo by [Wesley Tingey](https://unsplash.com/photos/sPBRRwT_fKA?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText) on [Unsplash](https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText)"></p>
<h2 id="1-获取设备相关信息"><a href="#1-获取设备相关信息" class="headerlink" title="1.获取设备相关信息"></a>1.获取设备相关信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UIDevice *device = [[UIDevice alloc] init];  </span><br><span class="line">NSString *name = device.name;                   // 获取设备所有者的名称  </span><br><span class="line">NSString *model = device.model;                 // 获取设备的型号  </span><br><span class="line">NSString *type = device.localizedModel;         // 获取本地化版本  </span><br><span class="line">NSString *systemName = device.systemName;       // 获取当前运行的系统  </span><br><span class="line">NSString *systemVersion = device.systemVersion; // 获取当前系统的版本</span><br></pre></td></tr></table></figure>
<p>同上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 获取设备所有者的名称——&quot;My iPhone&quot;</span><br><span class="line">NSString * name = [[UIDevice currentDevice] name];</span><br><span class="line"></span><br><span class="line">// 获取设备的型号——@&quot;iPhone&quot;</span><br><span class="line">NSString * model = [[UIDevice currentDevice] model];</span><br><span class="line"></span><br><span class="line">// //获取本地化版本</span><br><span class="line">NSString * localizedModel = [[UIDevice currentDevice] localizedModel];</span><br><span class="line"></span><br><span class="line">// 获取当前运行的系统名称——@&quot;iOS&quot;</span><br><span class="line">NSString * systemName = [[UIDevice currentDevice] systemName];</span><br><span class="line"></span><br><span class="line">// //获取当前系统的版本——@&quot;10.0&quot;、@&quot;11.3.1&quot;</span><br><span class="line">NSString * systemVersion = [[UIDevice currentDevice] systemVersion];</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong></p>
<blockquote>
<p>上面获取设备型号的方法 <code>NSString * model = [[UIDevice currentDevice] model];</code>只能获取 @”iPhone” ，想要获取到具体型号（例如@”iPhone 6s Plus”、@”iPhone 7 (CDMA)”）需要使用下面这个方法：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">// 1.需要先导入包</span><br><span class="line">#import &lt;sys/utsname.h&gt;</span><br><span class="line"></span><br><span class="line">// 2.获取方法</span><br><span class="line">// 获取设备名称</span><br><span class="line">- (NSString *)deviceModel &#123;</span><br><span class="line">    struct utsname systemInfo;</span><br><span class="line">    uname(&amp;systemInfo);</span><br><span class="line">    NSString *deviceModel = [NSString stringWithCString:systemInfo.machine</span><br><span class="line">                                               encoding:NSUTF8StringEncoding];</span><br><span class="line">    </span><br><span class="line">    // 模拟器</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;i386&quot;])         return @&quot;Simulator&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;x86_64&quot;])       return @&quot;Simulator&quot;;</span><br><span class="line">    </span><br><span class="line">    // iPhone 系列</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone1,1&quot;])    return @&quot;iPhone 1G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone1,2&quot;])    return @&quot;iPhone 3G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone2,1&quot;])    return @&quot;iPhone 3GS&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone3,1&quot;])    return @&quot;iPhone 4 (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone3,2&quot;])    return @&quot;Verizon iPhone 4&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone3,3&quot;])    return @&quot;iPhone 4 (CDMA/Verizon/Sprint)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone4,1&quot;])    return @&quot;iPhone 4S&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone5,1&quot;])    return @&quot;iPhone 5&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone5,2&quot;])    return @&quot;iPhone 5&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone5,3&quot;])    return @&quot;iPhone 5C&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone5,4&quot;])    return @&quot;iPhone 5C&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone6,1&quot;])    return @&quot;iPhone 5S&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone6,2&quot;])    return @&quot;iPhone 5S&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone7,1&quot;])    return @&quot;iPhone 6 Plus&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone7,2&quot;])    return @&quot;iPhone 6&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone8,1&quot;])    return @&quot;iPhone 6s&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone8,2&quot;])    return @&quot;iPhone 6s Plus&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone8,4&quot;])    return @&quot;iPhone SE&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone9,1&quot;])    return @&quot;iPhone 7 (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone9,3&quot;])    return @&quot;iPhone 7 (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone9,2&quot;])    return @&quot;iPhone 7 Plus (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone9,4&quot;])    return @&quot;iPhone 7 Plus (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,1&quot;])    return @&quot;iPhone 8 (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,4&quot;])    return @&quot;iPhone 8 (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,2&quot;])    return @&quot;iPhone 8 Plus (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,5&quot;])    return @&quot;iPhone 8 Plus (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,3&quot;])    return @&quot;iPhone X (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPhone10,6&quot;])    return @&quot;iPhone X (GSM)&quot;;</span><br><span class="line">    </span><br><span class="line">    // iPod 系列</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod1,1&quot;])      return @&quot;iPod Touch 1G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod2,1&quot;])      return @&quot;iPod Touch 2G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod3,1&quot;])      return @&quot;iPod Touch 3G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod4,1&quot;])      return @&quot;iPod Touch 4G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod5,1&quot;])      return @&quot;iPod Touch 5G&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPod7,1&quot;])      return @&quot;iPod Touch 6G&quot;;</span><br><span class="line">    </span><br><span class="line">    // iPad 系列</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad1,1&quot;])      return @&quot;iPad&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad1,2&quot;])      return @&quot;iPad 3G&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,1&quot;])      return @&quot;iPad 2 (WiFi)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,2&quot;])      return @&quot;iPad 2 (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,3&quot;])      return @&quot;iPad 2 (CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,4&quot;])      return @&quot;iPad 2 (32nm)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,5&quot;])      return @&quot;iPad Mini (WiFi)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,6&quot;])      return @&quot;iPad Mini (GSM)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad2,7&quot;])      return @&quot;iPad Mini (CDMA)&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,1&quot;])      return @&quot;iPad 3(WiFi)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,2&quot;])      return @&quot;iPad 3(CDMA)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,3&quot;])      return @&quot;iPad 3(4G)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,4&quot;])      return @&quot;iPad 4 (WiFi)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,5&quot;])      return @&quot;iPad 4 (4G)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad3,6&quot;])      return @&quot;iPad 4 (CDMA)&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,1&quot;])      return @&quot;iPad Air&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,2&quot;])      return @&quot;iPad Air&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,3&quot;])      return @&quot;iPad Air&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,4&quot;])      return @&quot;iPad Mini 2&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,5&quot;])      return @&quot;iPad Mini 2&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,6&quot;])      return @&quot;iPad Mini 2&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,7&quot;])      return @&quot;iPad Mini 3&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,8&quot;])      return @&quot;iPad Mini 3&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad4,9&quot;])      return @&quot;iPad Mini 3&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad5,1&quot;])      return @&quot;iPad Mini 4&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad5,2&quot;])      return @&quot;iPad Mini 4&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad5,3&quot;])      return @&quot;iPad Air 2&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad5,4&quot;])      return @&quot;iPad Air 2&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,3&quot;])      return @&quot;iPad PRO (12.9)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,4&quot;])      return @&quot;iPad PRO (12.9)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,7&quot;])      return @&quot;iPad PRO (9.7)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,8&quot;])      return @&quot;iPad PRO (9.7)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,11&quot;])      return @&quot;iPad 5&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad6,12&quot;])      return @&quot;iPad 5&quot;;</span><br><span class="line">    </span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad7,1&quot;])      return @&quot;iPad PRO 2 (12.9)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad7,2&quot;])      return @&quot;iPad PRO 2 (12.9)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad7,3&quot;])      return @&quot;iPad PRO (10.5)&quot;;</span><br><span class="line">    if ([deviceModel isEqualToString:@&quot;iPad7,4&quot;])      return @&quot;iPad PRO (10.5)&quot;;</span><br><span class="line">    </span><br><span class="line">    return deviceModel;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 3.使用方法</span><br><span class="line">// 获取移动设备名称</span><br><span class="line">NSString *deviceModel = [self deviceModelName];</span><br></pre></td></tr></table></figure>
<p>具体型号和设备名称参考：<a href="https://www.theiphonewiki.com/wiki/Models" target="_blank" rel="noopener">https://www.theiphonewiki.com/wiki/Models</a></p>
<h2 id="2-获取设备唯一标识符UUID"><a href="#2-获取设备唯一标识符UUID" class="headerlink" title="2.获取设备唯一标识符UUID"></a>2.获取设备唯一标识符UUID</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *UUIDString = [[[UIDevice currentDevice] identifierForVendor] UUIDString];</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong></p>
<blockquote>
<p>这个唯一标识符UUID也有点问题，在iOS系统升级或者APP卸载后重新安装，可能会产生获取到的UUID是不同的问题。</p>
</blockquote>
<p>科普文： <a href="http://www.skyfox.org/ios-uuid-udid-keychain.html" target="_blank" rel="noopener">iOS 开发之获取设备唯一标识符</a></p>
<h3 id="1-关于APP从设备上卸载后重新安装引起UUID值改变的问题"><a href="#1-关于APP从设备上卸载后重新安装引起UUID值改变的问题" class="headerlink" title="1.关于APP从设备上卸载后重新安装引起UUID值改变的问题"></a>1.关于APP从设备上卸载后重新安装引起UUID值改变的问题</h3><ul>
<li><a href="http://stackoverflow.com/questions/40753246/ios-uuid-different-for-same-app-depending-if-installed-through-xcode-or-testflig" target="_blank" rel="noopener">stackoverflow社区中的相关讨论</a>：其中有一条：在iOS设备上安装应用程序（或同一供应商的其他应用程序）时，此属性中的值保持不变。 当用户从设备中删除该供应商的所有应用程序，然后重新安装一个或多个应用程序时，该值会更改。</li>
<li><p>在<a href="https://developer.apple.com/reference/uikit/uidevice/1620059-identifierforvendor" target="_blank" rel="noopener">Apple API Reference：UIDevice——identifierForVendor</a>中也可以找到这样一段描述：</p>
<blockquote>
<p>The value in this property remains the same while the app (or another app from the same vendor) is installed on the iOS device. The value changes when the user deletes all of that vendor’s apps from the device and subsequently reinstalls one or more of them. The value can also change when installing test builds using Xcode or when installing an app on a device using ad-hoc distribution. Therefore, if your app stores the value of this property anywhere, you should gracefully handle situations where the identifier changes.<br>翻译：在iOS设备上安装应用程序（或同一供应商的其他应用程序）时，此属性中的值保持不变。 当用户从设备中删除该供应商的所有应用程序，然后重新安装一个或多个应用程序时，该值会更改。 使用Xcode安装测试版本时或使用ad-hoc分发在设备上安装应用程序时，该值也可能更改。 因此，如果您的应用程序要在任何位置存储此属性的值，您应该适当地处理标识符会改变的情况。</p>
</blockquote>
</li>
<li><p>如果用<strong>keychain</strong>（钥匙串）来保存UUID这个方法：<br><strong>keychain</strong> 顾名思义，是钥匙串的意思，是苹果公司Mac OS中的密码管理系统。当使用UUID来作为设备的唯一标识时，获取到UUID后，如果用<strong>NSUserDefaults</strong>存储，当程序（这里指某一供应商在该设备上的所有应用程序）被卸载后重装时，再获得的UUID和之前就不同了。使用<strong>keychain</strong>存储可以保证APP被卸载重装时，UUID不会被删除，还是保存在系统的钥匙串中。所以我们可以将UUID存储到<strong>keychain</strong>里面，需要用到的时候从<strong>keychain</strong>中去取，这样可以保证UUID的唯一性。但当刷机或者升级系统后，UUID还是会改变的。<br>该方法可参考的资料：</p>
<ul>
<li><a href="https://github.com/soffes/SAMKeychain" target="_blank" rel="noopener">SAMKeychain</a></li>
<li><a href="http://www.jianshu.com/p/37899e767f5b" target="_blank" rel="noopener">iOS如何获取设备的唯一标识（UUID）@若锦</a> ：<a href="https://github.com/wxzwork/GetDeviceUUID" target="_blank" rel="noopener">Demo:GitHub</a></li>
<li><a href="http://www.jianshu.com/p/572833efaac4" target="_blank" rel="noopener">iOS获取UUID，并使用keychain存储 @wooke</a></li>
</ul>
</li>
<li><p><a href="http://stackoverflow.com/questions/21878560/how-to-preserve-identifierforvendor-in-ios-after-uninstalling-ios-app-on-device" target="_blank" rel="noopener">stackoverflow社区中</a>有人讨论到，如果开启了iCloud 同步功能（synchronisation ），KeyChain（钥匙串）就会被同步，所有同步的设备也将获得相同的UUID。</p>
</li>
</ul>
<h3 id="2-系统升级、还原或者刷机会导致UUID变化吗？"><a href="#2-系统升级、还原或者刷机会导致UUID变化吗？" class="headerlink" title="2.系统升级、还原或者刷机会导致UUID变化吗？"></a>2.系统升级、还原或者刷机会导致UUID变化吗？</h3><p>目前我得到的答案是：用户还原设备或刷机会导致<strong>KeyChain</strong>（钥匙串）数据被删除。系统升级还不知道，没有测过。<br>stackoverflow上的讨论：<a href="http://stackoverflow.com/questions/41651936/if-users-upgrade-ios-system-will-the-uuid-saved-in-keychain-also-been-changed-or" target="_blank" rel="noopener"><a href="http://stackoverflow.com/questions/41651936/if-users-upgrade-ios-system-will-the-uuid-saved-in-keychain-also-been-changed-or" target="_blank" rel="noopener">If users upgrade iOS system,will the UUID saved in keyChain also been changed or deleted?</a></a><br>如果你有答案或有相关的解决方法，不妨留言吧。</p>
<ul>
<li>还有一种方法是：使用设备的mac地址结合bundle标识符生成一个新的散列的唯一标识符。<br><a href="https://github.com/gekitz/UIDevice-with-UniqueIdentifier-for-iOS-5" target="_blank" rel="noopener">UIDevice-with-UniqueIdentifier-for-iOS-5</a>,但是该文档的第一行描述 <code>NOTE: this is not going to work under iOS 7</code>看来这个方法估计也是不能用的。</li>
<li>参考:<a href="http://www.skyfox.org/ios-uuid-udid-keychain.html" target="_blank" rel="noopener">iOS开发之获取设备唯一标识符</a></li>
</ul>
<h2 id="3-为系统创建一个随机标识符"><a href="#3-为系统创建一个随机标识符" class="headerlink" title="3.为系统创建一个随机标识符"></a>3.为系统创建一个随机标识符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(NSString*) createUUID  &#123;  </span><br><span class="line">    NSString *id = [[NSUserDefaults standardUserDefaults] objectForKey:@&quot;UUID&quot;];    //获取标识为&quot;UUID&quot;的值  </span><br><span class="line">    if(id == nil)  </span><br><span class="line">    &#123;  </span><br><span class="line">        if([[[UIDevice currentDevice] systemVersion] floatValue] &gt; 6.0)  </span><br><span class="line">        &#123;  </span><br><span class="line">            NSString *identifierNumber = [[NSUUID UUID] UUIDString];                //ios 6.0 之后可以使用的api  </span><br><span class="line">            [[NSUserDefaults standardUserDefaults] setObject:identifierNumber forKey:@&quot;UUID&quot;];  //保存为UUID  </span><br><span class="line">            [[NSUserDefaults standardUserDefaults] synchronize];  </span><br><span class="line">        &#125;  </span><br><span class="line">        else&#123;  </span><br><span class="line">            CFUUIDRef uuid = CFUUIDCreate(NULL);  </span><br><span class="line">            CFStringRef uuidString = CFUUIDCreateString(NULL, uuid);                    //ios6.0之前使用的api  </span><br><span class="line">            NSString *identifierNumber = [NSString stringWithFormat:@&quot;%@&quot;, uuidString];  </span><br><span class="line">            [[NSUserDefaults standardUserDefaults] setObject:identifierNumber forKey:@&quot;UUID&quot;];  </span><br><span class="line">            [[NSUserDefaults standardUserDefaults] synchronize];  </span><br><span class="line">            CFRelease(uuidString);  </span><br><span class="line">            CFRelease(uuid);  </span><br><span class="line">        &#125;  </span><br><span class="line">        return [[NSUserDefaults standardUserDefaults] objectForKey@&quot;UUID&quot;];  </span><br><span class="line">    &#125;  </span><br><span class="line">    return id;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-获取当前屏幕分辨率的信息"><a href="#4-获取当前屏幕分辨率的信息" class="headerlink" title="4. 获取当前屏幕分辨率的信息"></a>4. 获取当前屏幕分辨率的信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CGRect rect = [[UIScreen mainScreen] bounds];  </span><br><span class="line">CGFloat scale = [[UIScreen mainScreen].scale];  </span><br><span class="line">CGFloat width = rect.size.width * scale;  </span><br><span class="line">CGFloat height = rect.size.height * scale;</span><br></pre></td></tr></table></figure>
<h2 id="5-获取运营商信息"><a href="#5-获取运营商信息" class="headerlink" title="5. 获取运营商信息"></a>5. 获取运营商信息</h2><ul>
<li><p>需要先导入头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;CoreTelephony/CTCarrier.h&gt;  </span><br><span class="line">#import &lt;CoreTelephony/CTTelephonyNetworkInfo.h&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCTelephonyNetworkInfo *info = [[CTTelephonyNetworkInfo alloc] init];</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取运行商的名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CTCarrier *carrier = [info subscriberCellularProvider];  </span><br><span class="line">NSString *mCarrier = [NSString stringWithFormat:@&quot;%@&quot;,[carrier carrierName]];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="6-获取当前网络类型"><a href="#6-获取当前网络类型" class="headerlink" title="6.获取当前网络类型"></a>6.获取当前网络类型</h2><p>iOS 7之后可以按照以下方式获取。方便而且类型多</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *mConnectType = [[NSString alloc] initWithFormat:@&quot;%@&quot;,info.currentRadioAccessTechnology];</span><br></pre></td></tr></table></figure>
<p>类型有以下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CTRadioAccessTechnologyGPRS         //介于2G和3G之间，也叫2.5G ,过度技术    </span><br><span class="line">CTRadioAccessTechnologyEdge         //EDGE为GPRS到第三代移动通信的过渡，EDGE俗称2.75G   </span><br><span class="line">CTRadioAccessTechnologyWCDMA           </span><br><span class="line">CTRadioAccessTechnologyHSDPA           //亦称为3.5G(3?G)  </span><br><span class="line">CTRadioAccessTechnologyHSUPA           //3G到4G的过度技术  </span><br><span class="line">CTRadioAccessTechnologyCDMA1x          //3G      </span><br><span class="line">CTRadioAccessTechnologyCDMAEVDORev0    //3G标准  </span><br><span class="line">CTRadioAccessTechnologyCDMAEVDORevA    </span><br><span class="line">CTRadioAccessTechnologyCDMAEVDORevB    </span><br><span class="line">CTRadioAccessTechnologyeHRPD        //电信使用的一种3G到4G的演进技术， 3.75G       </span><br><span class="line">CTRadioAccessTechnologyLTE          //接近4G</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong></p>
<blockquote>
<p>如果你使用<a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="noopener">AFNetworking</a>框架的话，该框架中有一个检测网络状态的方法:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark 网络状态监测</span><br><span class="line">- (void)initNetworkReachabilityManager &#123;</span><br><span class="line">    AFNetworkReachabilityManager *networkReachabilityManager = [AFNetworkReachabilityManager sharedManager];</span><br><span class="line">    [networkReachabilityManager setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">        switch (status) &#123;</span><br><span class="line">            case AFNetworkReachabilityStatusUnknown:</span><br><span class="line">                NSLog(@&quot;网络状态检测：未知&quot;);</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusNotReachable:</span><br><span class="line">                NSLog(@&quot;网络状态检测：没有网络&quot;);</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusReachableViaWWAN:</span><br><span class="line">                NSLog(@&quot;网络状态检测：3G网络&quot;);</span><br><span class="line">                break;</span><br><span class="line">            case AFNetworkReachabilityStatusReachableViaWiFi:</span><br><span class="line">                NSLog(@&quot;网络状态检测：WiFi&quot;);</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    // 开启</span><br><span class="line">    [networkReachabilityManager startMonitoring];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>封装了这个方法以后在<strong>viewController.m</strong>的<figure class="highlight plain"><figcaption><span>(void)viewDidLoad```方法中调用：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```objective-c</span><br><span class="line">// 检测网络状态</span><br><span class="line">[self checkServerState];</span><br></pre></td></tr></table></figure></p>
<h2 id="7-获取当前信号强弱"><a href="#7-获取当前信号强弱" class="headerlink" title="7. 获取当前信号强弱"></a>7. 获取当前信号强弱</h2><p>这个貌似没有给出官方的api，但是网上有人说可以用私有的api实现，但是通不过appStore的审核，方法如下：<br>利用linux下动态库显式调用api的函数。先包含头文件 <figure class="highlight plain"><figcaption><span><dlfcn.h> ```</dlfcn.h></span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">```objective-c</span><br><span class="line">(int) getSignalLevel  &#123;  </span><br><span class="line">//获取库句柄</span><br><span class="line">voidvoid *libHandle = dlopen(&quot;/System/Library/Frameworks/CoreTelephony.framework/CoreTelephony&quot;,RTLD_LAZY); </span><br><span class="line">//定义一个与将要获取的函数匹配的函数指针 </span><br><span class="line">int (*CTGetSignalStrength)(); </span><br><span class="line">//获取指定名称的函数  </span><br><span class="line">CTGetSignalStrength = (int(*)())dlsym(libHandle,&quot;CTGetSignalStrength&quot;);   </span><br><span class="line">  </span><br><span class="line">if(CTGetSignalStrength == NULL)  </span><br><span class="line">    return -1;  </span><br><span class="line">else&#123;  </span><br><span class="line">    int level = CTGetSignalStrength();  </span><br><span class="line">    dlclose(libHandle); //切记关闭库  </span><br><span class="line">    return level  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="8-播放系统声音、提醒声音和振动设备"><a href="#8-播放系统声音、提醒声音和振动设备" class="headerlink" title="8. 播放系统声音、提醒声音和振动设备"></a>8. 播放系统声音、提醒声音和振动设备</h2><ol>
<li>需要加入<code>AudioToolbox.framework</code>框架</li>
<li>然后导入头文件<br> <code>#import &lt;AudioToolbox/AudioToolbox.h&gt;</code>    </li>
<li>在需要震动的地方添加代码：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 播放系统声音</span><br><span class="line">AudioServicesPlaySystemSound(1005);</span><br><span class="line"></span><br><span class="line">// 播放提醒声音</span><br><span class="line">AudioServicesPlayAlertSound(1006);</span><br><span class="line"></span><br><span class="line">// 执行震动</span><br><span class="line">AudioServicesPlaySystemSound ( kSystemSoundID_Vibrate) ;</span><br></pre></td></tr></table></figure>
<p>但是貌似这个执行震动不支持传入震动时间和模式，自己去控制吧。<br>附：声音文件列表参考：<a href="http://iphonedevwiki.net/index.php/AudioServices" target="_blank" rel="noopener">wiki: AudioServices</a></p>
<h2 id="9-获取电池相关信息"><a href="#9-获取电池相关信息" class="headerlink" title="9. 获取电池相关信息"></a>9. 获取电池相关信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@implementation BatterMonitor  </span><br><span class="line">//获取电池当前的状态，共有4种状态  </span><br><span class="line">-(NSString*) getBatteryState &#123;    </span><br><span class="line">    UIDevice *device = [UIDevice currentDevice];    </span><br><span class="line">    if (device.batteryState == UIDeviceBatteryStateUnknown) &#123;    </span><br><span class="line">        return @&quot;UnKnow&quot;;    </span><br><span class="line">    &#125;else if (device.batteryState == UIDeviceBatteryStateUnplugged)&#123;    </span><br><span class="line">        return @&quot;Unplugged&quot;;    </span><br><span class="line">    &#125;else if (device.batteryState == UIDeviceBatteryStateCharging)&#123;    </span><br><span class="line">        return @&quot;Charging&quot;;    </span><br><span class="line">    &#125;else if (device.batteryState == UIDeviceBatteryStateFull)&#123;    </span><br><span class="line">        return @&quot;Full&quot;;    </span><br><span class="line">    &#125;  </span><br><span class="line">    return nil;   </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">//获取电量的等级，0.00~1.00  </span><br><span class="line">-(float) getBatteryLevel &#123;    </span><br><span class="line">    return [UIDevice currentDevice].batteryLevel;  </span><br><span class="line">&#125;   </span><br><span class="line">  </span><br><span class="line">-(void) getBatteryInfo  &#123;  </span><br><span class="line">    NSString *state = getBatteryState();  </span><br><span class="line">    float level = getBatteryLevel()*100.0;  </span><br><span class="line">    //yourControlFunc(state, level);  //写自己要实现的获取电量信息后怎么处理  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">//打开对电量和电池状态的监控，类似定时器的功能  </span><br><span class="line">-(void) didLoad  &#123;  </span><br><span class="line">    [[UIDevice currentDevice] setBatteryMonitoringEnable:YES];  </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(getBatteryInfo:) name:UIDeviceBatteryStateDidChangeNotification object:nil];  </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(getBatteryInfo:) name:UIDeviceBatteryLevelDidChangeNotification object:nil];  </span><br><span class="line">    [NSTimer scheduledTimerWithTimeInterval:0.5f target:self selector:@selector(getBatteryInfo:) userInfo:nil repeats:YES];  </span><br><span class="line">&#125;  </span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h2 id="10-获取APP相关的信息"><a href="#10-获取APP相关的信息" class="headerlink" title="10. 获取APP相关的信息"></a>10. 获取APP相关的信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *infoDic = [[NSBundle mainBundle] infoDictionary];</span><br><span class="line"></span><br><span class="line">// 获取当前APP版本号，本地程序版本号</span><br><span class="line">NSString *appVersion = [infoDic objectForKey:@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line"></span><br><span class="line">// 获取App的build版本</span><br><span class="line">NSString *appBuildVersion = [infoDic objectForKey:@&quot;CFBundleVersion&quot;];</span><br><span class="line"></span><br><span class="line">// 获取App的名称</span><br><span class="line">NSString *appName = [infoDic objectForKey:@&quot;CFBundleDisplayName&quot;];</span><br><span class="line"></span><br><span class="line">// ******************************</span><br><span class="line">// 以下四个获取方法摘自 YYCategories：</span><br><span class="line">- (NSString *)appBundleName &#123;</span><br><span class="line">    return [[NSBundle mainBundle] objectForInfoDictionaryKey:@&quot;CFBundleName&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)appBundleID &#123;</span><br><span class="line">    return [[NSBundle mainBundle] objectForInfoDictionaryKey:@&quot;CFBundleIdentifier&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)appVersion &#123;</span><br><span class="line">    return [[NSBundle mainBundle] objectForInfoDictionaryKey:@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSString *)appBuildVersion &#123;</span><br><span class="line">    return [[NSBundle mainBundle] objectForInfoDictionaryKey:@&quot;CFBundleVersion&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="11-获取设备IP地址"><a href="#11-获取设备IP地址" class="headerlink" title="11. 获取设备IP地址"></a>11. 获取设备IP地址</h2><p>某天服务器端的同学跑来说想获取并记录移动端的IP地址，非要在每一个请求Dictionary里再多放一个IP地址，于是Internet上找到了这个解决方法，<code>(NSDictionary *)getIPAddresses</code>可以返回一个Dictionary,里面记录着有关IP地址的所有信息：</p>
<p><strong>Simulator</strong>的Log：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-ac050aac36ee549d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/620" alt="模拟器"></p>
<hr>
<p><strong>iPhone</strong>的Log<br><img src="http://upload-images.jianshu.io/upload_images/2648731-a6d6f9cfa3bbe7dc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/620" alt="真机"></p>
<p>可以再通过：<br><code>NSString *IP = [dict objectForKey:@&quot;en0/ipv4&quot;];</code> 来取得所需的IP地址，问题就在于<strong>Simulator</strong> 中对应IP地址的 <strong>Key</strong> 和 <strong>iPhone</strong>中对应IP地址的 <strong>Key</strong> 是不同的，正在纠结的时候Leader说获得IP地址完全没有必要让移动端的额外给，服务器本身是有方法获得这个IP地址的。。。吭哧吭哧忙活了半天原来咱白干了，好吧，删代码。。。等一下，先保存下吧！</p>
<h3 id="好了，这是一段保存下来的有作用但是没有必要写的代码："><a href="#好了，这是一段保存下来的有作用但是没有必要写的代码：" class="headerlink" title="好了，这是一段保存下来的有作用但是没有必要写的代码："></a>好了，这是一段保存下来的有作用但是没有必要写的代码：</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要导入的包</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"HQLGetIPAddress.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;ifaddrs.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;net/if.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 宏定义</span></span><br><span class="line"><span class="meta">#define IOS_CELLULAR    @<span class="meta-string">"pdp_ip0"</span></span></span><br><span class="line"><span class="meta">#define IOS_WIFI        @<span class="meta-string">"en0"</span></span></span><br><span class="line"><span class="comment">//#define IOS_VPN       @"utun0"</span></span><br><span class="line"><span class="meta">#define IP_ADDR_IPv4    @<span class="meta-string">"ipv4"</span></span></span><br><span class="line"><span class="meta">#define IP_ADDR_IPv6    @<span class="meta-string">"ipv6"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - 获取设备当前网络IP地址</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)getIPAddress:(<span class="built_in">BOOL</span>)preferIPv4</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSArray</span> *searchArray = preferIPv4 ?</span><br><span class="line">    @[ <span class="comment">/*IOS_VPN @"/" IP_ADDR_IPv4, IOS_VPN @"/" IP_ADDR_IPv6,*/</span> IOS_WIFI <span class="string">@"/"</span> IP_ADDR_IPv4, IOS_WIFI <span class="string">@"/"</span> IP_ADDR_IPv6, IOS_CELLULAR <span class="string">@"/"</span> IP_ADDR_IPv4, IOS_CELLULAR <span class="string">@"/"</span> IP_ADDR_IPv6 ] :</span><br><span class="line">    @[ <span class="comment">/*IOS_VPN @"/" IP_ADDR_IPv6, IOS_VPN @"/" IP_ADDR_IPv4,*/</span> IOS_WIFI <span class="string">@"/"</span> IP_ADDR_IPv6, IOS_WIFI <span class="string">@"/"</span> IP_ADDR_IPv4, IOS_CELLULAR <span class="string">@"/"</span> IP_ADDR_IPv6, IOS_CELLULAR <span class="string">@"/"</span> IP_ADDR_IPv4 ] ;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSDictionary</span> *addresses = [<span class="keyword">self</span> getIPAddresses];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"addresses: %@"</span>, addresses);</span><br><span class="line">    </span><br><span class="line">    __block <span class="built_in">NSString</span> *address;</span><br><span class="line">    [searchArray enumerateObjectsUsingBlock:^(<span class="built_in">NSString</span> *key, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> *stop)</span><br><span class="line">     &#123;</span><br><span class="line">         address = addresses[key];</span><br><span class="line">         <span class="keyword">if</span>(address) *stop = <span class="literal">YES</span>;</span><br><span class="line">     &#125; ];</span><br><span class="line">    <span class="keyword">return</span> address ? address : <span class="string">@"0.0.0.0"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取所有相关IP信息</span></span><br><span class="line">- (<span class="built_in">NSDictionary</span> *)getIPAddresses</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *addresses = [<span class="built_in">NSMutableDictionary</span> dictionaryWithCapacity:<span class="number">8</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// retrieve the current interfaces - returns 0 on success</span></span><br><span class="line">    <span class="keyword">struct</span> ifaddrs *interfaces;</span><br><span class="line">    <span class="keyword">if</span>(!getifaddrs(&amp;interfaces)) &#123;</span><br><span class="line">        <span class="comment">// Loop through linked list of interfaces</span></span><br><span class="line">        <span class="keyword">struct</span> ifaddrs *interface;</span><br><span class="line">        <span class="keyword">for</span>(interface=interfaces; interface; interface=interface-&gt;ifa_next) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(interface-&gt;ifa_flags &amp; IFF_UP) <span class="comment">/* || (interface-&gt;ifa_flags &amp; IFF_LOOPBACK) */</span> ) &#123;</span><br><span class="line">                <span class="keyword">continue</span>; <span class="comment">// deeply nested code harder to read</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in *addr = (<span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in*)interface-&gt;ifa_addr;</span><br><span class="line">            <span class="keyword">char</span> addrBuf[ MAX(INET_ADDRSTRLEN, INET6_ADDRSTRLEN) ];</span><br><span class="line">            <span class="keyword">if</span>(addr &amp;&amp; (addr-&gt;sin_family==AF_INET || addr-&gt;sin_family==AF_INET6)) &#123;</span><br><span class="line">                <span class="built_in">NSString</span> *name = [<span class="built_in">NSString</span> stringWithUTF8String:interface-&gt;ifa_name];</span><br><span class="line">                <span class="built_in">NSString</span> *type;</span><br><span class="line">                <span class="keyword">if</span>(addr-&gt;sin_family == AF_INET) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(inet_ntop(AF_INET, &amp;addr-&gt;sin_addr, addrBuf, INET_ADDRSTRLEN)) &#123;</span><br><span class="line">                        type = IP_ADDR_IPv4;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in6 *addr6 = (<span class="keyword">const</span> <span class="keyword">struct</span> sockaddr_in6*)interface-&gt;ifa_addr;</span><br><span class="line">                    <span class="keyword">if</span>(inet_ntop(AF_INET6, &amp;addr6-&gt;sin6_addr, addrBuf, INET6_ADDRSTRLEN)) &#123;</span><br><span class="line">                        type = IP_ADDR_IPv6;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(type) &#123;</span><br><span class="line">                    <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@/%@"</span>, name, type];</span><br><span class="line">                    addresses[key] = [<span class="built_in">NSString</span> stringWithUTF8String:addrBuf];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Free memory</span></span><br><span class="line">        freeifaddrs(interfaces);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [addresses count] ? addresses : <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="12-APP中打开一个网页"><a href="#12-APP中打开一个网页" class="headerlink" title="12. APP中打开一个网页"></a>12. APP中打开一个网页</h2><p>这个比较简单，直接用提供的接口openURL即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// APP中打开一个网页</span><br><span class="line">NSURL *url= [NSURL URLWithString:@&quot;https://www.apple.com&quot;];</span><br><span class="line">if ([[UIApplication sharedApplication] canOpenURL:url]) &#123;</span><br><span class="line">    if (@available(iOS 10.0, *)) &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:^(BOOL success) &#123;</span><br><span class="line">            if (success) &#123;</span><br><span class="line">                // 打开网页成功...</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                // 打开网页失败...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="13-APP中打开另一个APP"><a href="#13-APP中打开另一个APP" class="headerlink" title="13. APP中打开另一个APP"></a>13. APP中打开另一个APP</h2><p>打开另一个app还是可以通过openURL来实现。但是要分两种情况。第一种是启动内置的应用，一般的电话，浏览器，短信和邮件可以直接调用并添加参数，譬如： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;tel://10086&quot;]];  </span><br><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;mailto://devprograms@apple.com&quot;]];  </span><br><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;sms://10086&quot;]];</span><br></pre></td></tr></table></figure>
<p>第二种情况是要打开自己开发的app，这种情况则要为将要打开的app注册一个URL协议。这个可以在项目的文件info.plist中注册。主要操作为：</p>
<ul>
<li><p>Step1. 右键，选择“Add Row”</p>
</li>
<li><p>Step2. Key值选择“URL types”</p>
</li>
<li><p>Step3. 打开“Item 0″,然后为该key增加一个URL identifier。可以是任何值，但建议用“反域名”(例如 “com.fcplayer.testHello”)。</p>
</li>
<li><p>Step4. 在“Item 0”下再加一行。</p>
</li>
<li><p>Step5. 选择“URL Schemes” 作为Key。</p>
</li>
<li><p>Step6. 输入你的URL协议名 (例如“testHello://” 应写做“testHello”)。如果有必要，你可以在这里加入多个协议。</p>
</li>
</ul>
<p>其实在打开的时候只需要 <strong>URL Schemes</strong> 即可，<strong>URL identifier</strong> 是可选项。如果需要传送参数，可以在URL Schemes://添加你的参数，格式和网页开发的传递参数差不多。（又或者URL Schemes://URL identifier@添加的参数）关键是要和接收参数方定义好处理的方式。然后在需要打开的地方添加代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSString *url = @&quot;URL Schemes的路径&quot;  </span><br><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]];</span><br></pre></td></tr></table></figure>
<p>推荐阅读：<a href="https://www.jianshu.com/p/a1895c766400" target="_blank" rel="noopener">LSApplicationQueriesSchemes– 关于 info.plist 第三方登录 添加 URL Schemes 白名单</a></p>
<h2 id="14-App-Store-应用分享链接"><a href="#14-App-Store-应用分享链接" class="headerlink" title="14. App Store 应用分享链接"></a>14. App Store 应用分享链接</h2><p>应用分享链接获取方法：</p>
<ol>
<li>打开 <strong>「iTunes」</strong>应用；</li>
<li>进入  App Store； </li>
<li>🔍搜索并找到你的应用；</li>
<li>鼠标右击应用ICON图标并拷贝链接；</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-08d547e36474e31d.gif?imageMogr2/auto-orient/strip" alt></p>
<p>以「支付宝」为例：<a href="https://itunes.apple.com/cn/app/支付宝-让生活更简单/id333206289?mt=8" target="_blank" rel="noopener">https://itunes.apple.com/cn/app/支付宝-让生活更简单/id333206289?mt=8</a></p>
<p>然后就可以把这个链接<a href="https://cli.im/url?b389d0900c5894e55a68298084555384" target="_blank" rel="noopener">生成二维码</a>，扫一扫下载：<br><img src="https://upload-images.jianshu.io/upload_images/2648731-8c6ea3935d22ca2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/620" alt><br>图片来源：<a href="https://pixabay.com/zh/qr-%E7%A0%81-%E6%89%AB%E6%8F%8F%E4%BB%AA-%E6%9D%A1%E7%A0%81-%E6%9D%A1%E7%A0%81%E6%89%AB%E6%8F%8F%E5%99%A8-%E7%9F%A9%E9%98%B5%E7%A0%81-%E6%99%BA%E8%83%BD%E6%89%8B%E6%9C%BA-%E8%AF%BB-156717/" target="_blank" rel="noopener">pixabay</a></p>
<h2 id="15-iOS-应用内跳转到-App-Store"><a href="#15-iOS-应用内跳转到-App-Store" class="headerlink" title="15. iOS 应用内跳转到 App Store"></a>15. iOS 应用内跳转到 App Store</h2><p>APP ID 通过类型常量定义好：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static NSString * const APPID = @&quot;333206289&quot;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>APP ID 去哪儿找，怎么设置？</p>
<p>在 <a href="https://developer.apple.com/develop/" target="_blank" rel="noopener">iTunes Connect</a> 中新建APP后，系统会默认分配一个 ID 给你。忘记的话也可以在应用分享链接的 URL 中提取。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-581a8762f9d4865f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="一、跳转到「应用详情」页面"><a href="#一、跳转到「应用详情」页面" class="headerlink" title="一、跳转到「应用详情」页面"></a>一、跳转到「应用详情」页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NSString *urlStr = [NSString stringWithFormat:@&quot;itms-apps://itunes.apple.com/app/id%@&quot;, APPID];</span><br><span class="line">NSURL *url = [NSURL URLWithString:urlStr];</span><br><span class="line">// 跳转之前判断是否可以打开URL</span><br><span class="line">if ([[UIApplication sharedApplication] canOpenURL:url]) &#123;</span><br><span class="line">    if (@available(iOS 10.0, *)) &#123;</span><br><span class="line">        // iOS 10.0 之后使用此方法</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:nil];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        // iOS 10.0 之前使用此方法</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二、跳转到「评论」页面"><a href="#二、跳转到「评论」页面" class="headerlink" title="二、跳转到「评论」页面"></a>二、跳转到「评论」页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NSString *urlStr = [NSString stringWithFormat:@&quot;itms-apps://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=%@&amp;pageNumber=0&amp;sortOrdering=2&amp;mt=8&quot;, APPID];</span><br><span class="line">NSURL *url = [NSURL URLWithString:urlStr];</span><br><span class="line">if ([[UIApplication sharedApplication] canOpenURL:url]) &#123;</span><br><span class="line">    if (@available(iOS 10.0, *)) &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:nil];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="三、跳转到「撰写评论」页面"><a href="#三、跳转到「撰写评论」页面" class="headerlink" title="三、跳转到「撰写评论」页面"></a>三、跳转到「撰写评论」页面</h3><p>前两种方法网上已经分享泛滥了，而这个跳转方法很特别哦。</p>
<blockquote>
<p>💡💡💡区别：</p>
<p>上面的方法只可以跳转到 App Store 中应用的评论页面，如果用户要评分，步骤是：</p>
<ol>
<li>首先跳转到评论页面；</li>
<li>点击「撰写评论」按钮，开始评分。</li>
</ol>
<p>而这个方法更深入，它可以打开撰写评论页面，用户去评分的步骤是：</p>
<ol>
<li>直接跳转到「撰写评论」页面评分。</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// iOS11 之后，以下链接已失效</span><br><span class="line">NSString *urlStr = [NSString stringWithFormat:@&quot;itms-apps://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=%@&amp;action=write-review&quot;,APPID];</span><br><span class="line">[[UIApplication sharedApplication] openURL:[NSURL URLWithString:urlStr]]</span><br><span class="line"></span><br><span class="line">// 今天没事点了点App里的评论功能，发现显示“无法连接到App Store”，修复更换的URL如下（更新时间：2018年3月16日） </span><br><span class="line">NSString *urlStr = [NSString stringWithFormat:@&quot;itms-apps://itunes.apple.com/cn/app/id%@?mt=8&amp;action=write-review&quot;,APPID];</span><br><span class="line">NSURL *url = [NSURL URLWithString:urlStr];</span><br><span class="line">if ([[UIApplication sharedApplication] canOpenURL:url]) &#123;</span><br><span class="line">    if (@available(iOS 10.0, *)) &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:nil];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        [[UIApplication sharedApplication] openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到这两个 URL 地址是不同的，以「微信」示例：</p>
<ul>
<li>评论页面 URL：<a href="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=414478124&amp;pageNumber=0&amp;sortOrdering=2&amp;mt=8" target="_blank" rel="noopener">https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=414478124&amp;pageNumber=0&amp;sortOrdering=2&amp;mt=8</a></li>
<li>撰写批评 URL（已失效）：<del><a href="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=414478124&amp;action=write-review" target="_blank" rel="noopener">https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&amp;id=414478124&amp;action=write-review</a></del></li>
<li>2018，新的撰写批评 URL：<br>itms-apps://itunes.apple.com/cn/app/id414478124?mt=8&amp;action=write-review<br>参考：<a href="https://www.jianshu.com/p/ae47e1cd9058" target="_blank" rel="noopener">iOS 11 适配之跳转 App Store 评论</a></li>
</ul>
<p>「微信」的去评分跳转到 App Store 就是这个效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2648731-bb3bafc7ed835d99.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="16-应用内跳转到系统设置"><a href="#16-应用内跳转到系统设置" class="headerlink" title="16. 应用内跳转到系统设置"></a>16. 应用内跳转到系统设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 跳转到系统设置中本应用设置下，iOS 8.0 之后有效</span><br><span class="line">if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@&quot;8.0&quot;)) &#123;</span><br><span class="line">    </span><br><span class="line">    NSURL *url = [NSURL URLWithString:UIApplicationOpenSettingsURLString];</span><br><span class="line">	// 跳转之前先判断是否能打开URL</span><br><span class="line">    if ([[UIApplication sharedApplication] canOpenURL:url]) &#123;</span><br><span class="line">        if (@available(iOS 10.0, *)) &#123;</span><br><span class="line">            [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:nil];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            [[UIApplication sharedApplication] openURL:url];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="17-版本更新提示"><a href="#17-版本更新提示" class="headerlink" title="17. 版本更新提示"></a>17. 版本更新提示</h2><p>需求：每当新版本发布时，首页弹窗提示。<br>流程图：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-2bc6ba1044395aca.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">// 检查版本更新</span><br><span class="line">- (void)requestVersionFromAppStore &#123;</span><br><span class="line">    // 使用 YTKNetwork 发起 POST 请求</span><br><span class="line">    // URL：https://itunes.apple.com/cn/lookup?id=836500024</span><br><span class="line">    HQLURL_Check_Version *api = [[HQLURL_Check_Version alloc] init];</span><br><span class="line">    [api startWithCompletionBlockWithSuccess:^(__kindof YTKBaseRequest * _Nonnull request) &#123;</span><br><span class="line">        // App Store 版本号</span><br><span class="line">        NSString *version = [(NSDictionary *)[(NSArray *)request.responseObject[@&quot;results&quot;] lastObject] objectForKey:@&quot;version&quot;];</span><br><span class="line">        [self checkVersionUpdate:version];</span><br><span class="line">        </span><br><span class="line">    &#125; failure:^(__kindof YTKBaseRequest * _Nonnull request) &#123;</span><br><span class="line">        // error...</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)checkVersionUpdate:(NSString *)version &#123;</span><br><span class="line">    // App Store 版本号</span><br><span class="line">    NSString *formatAppStoreVersion = [version stringByReplacingOccurrencesOfString:@&quot;.&quot; withString:@&quot;&quot;];</span><br><span class="line">    </span><br><span class="line">    // 本地程序版本号</span><br><span class="line">    NSString *localVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@&quot;CFBundleShortVersionString&quot;];</span><br><span class="line">    NSString *formatLocalVersion = [localVersion stringByReplacingOccurrencesOfString:@&quot;.&quot; withString:@&quot;&quot;];</span><br><span class="line">    </span><br><span class="line">    BOOL shouldUpdate = [formatAppStoreVersion unsignedIntValue] &gt; [formatLocalVersion unsignedIntValue];</span><br><span class="line">    if (!shouldUpdate) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 弹窗提示，使用 SCLAlertView-Objective-C 框架</span><br><span class="line">    SCLAlertView *alert = [[SCLAlertView alloc] initWithNewWindow];</span><br><span class="line">    alert.horizontalButtons = YES;</span><br><span class="line">    alert.shouldDismissOnTapOutside = YES;</span><br><span class="line">    </span><br><span class="line">    // 拒绝按钮</span><br><span class="line">    SCLButton *button = [alert addButton:@&quot;残忍拒绝&quot; actionBlock:nil];</span><br><span class="line">    button.buttonFormatBlock = ^NSDictionary *&#123;</span><br><span class="line">        NSMutableDictionary *buttonConfig = [[NSMutableDictionary alloc] init];</span><br><span class="line">        buttonConfig[@&quot;backgroundColor&quot;] = [UIColor whiteColor];</span><br><span class="line">        buttonConfig[@&quot;textColor&quot;] = HexColor(@&quot;0x2866BF&quot;);</span><br><span class="line">        return buttonConfig;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    // 下载按钮</span><br><span class="line">    [alert addButton:@&quot;前往下载&quot; actionBlock:^&#123;</span><br><span class="line">        NSString *urlStr = [NSString stringWithFormat:@&quot;itms-apps://itunes.apple.com/app/id836500024&quot;];</span><br><span class="line">        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:urlStr]];</span><br><span class="line">    &#125;];</span><br><span class="line">    [alert showInfo:self title:@&quot;发现新版本&quot; subTitle:@&quot;您有新的版本可供下载&quot; closeButtonTitle:nil duration:0.0f];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="http://upload-images.jianshu.io/upload_images/2648731-c957b336fc3244f5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/375" alt="image"></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://www.cocoachina.com" target="_blank" rel="noopener">iOS 如何获取设备的各种信息 @ymwm</a></li>
<li><a href="http://blog.csdn.net/decajes/article/details/41807977" target="_blank" rel="noopener">iOS开发-获取设备名称</a></li>
<li><a href="http://www.jianshu.com/p/0d84e6852c5a" target="_blank" rel="noopener">iOS获取设备型号和App版本号等信息（OC＋Swift）</a></li>
<li><a href="http://www.jianshu.com/p/37899e767f5b" target="_blank" rel="noopener">iOS如何获取设备的唯一标识（UUID）</a></li>
<li><a href="http://www.jianshu.com/p/572833efaac4" target="_blank" rel="noopener">iOS获取UUID，并使用keychain存储 @wooke</a></li>
<li><a href="http://blog.csdn.net/luoshengkim/article/details/51135063" target="_blank" rel="noopener">iOS获取设备IP地址 @月光下的夜曲</a></li>
<li><a href="http://www.cnblogs.com/gaoxiaoniu/p/5482623.html" target="_blank" rel="noopener">iOS开发：获取设备IP地址 @高晓牛</a></li>
<li><a href="http://www.jianshu.com/p/b23016bb97af" target="_blank" rel="noopener">史上最全的iOS各种设备信息获取总结(iPhone8/iPhone X 已更新)</a></li>
<li><a href="https://stackoverflow.com/questions/11197509/how-to-get-device-make-and-model-on-ios" target="_blank" rel="noopener">How to get device make and model on iOS? @stackoverflow</a></li>
<li><a href="http://pdadb.net/index.php?m=device&amp;id=2214&amp;c=apple_ipad_wifi_a1219_64gb__apple_ipad_1,1" target="_blank" rel="noopener">http://pdadb.net</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/25/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><span class="page-number current">26</span><a class="page-number" href="/page/27/">27</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/27/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://ws1.sinaimg.cn/large/006tNc79gy1g22m14458rj30u014xu0x.jpg" alt="独木舟的木">
            
              <p class="site-author-name" itemprop="name">独木舟的木</p>
              <div class="site-description motion-element" itemprop="description">有时候阳光很好 有时候阳光很暗</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">314</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Andy0570" title="GitHub &rarr; https://github.com/Andy0570" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:andywhm@163.com" title="E-Mail &rarr; mailto:andywhm@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">独木舟的木</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  



  
    
    
      
    
  
  <script color="17,119,176" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>













  
  <script src="//cdn.jsdelivr.net/npm/jquery@2/dist/jquery.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  
  
  
    
  

  
    
      
    
  

  
  
  
    <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
    <script>
      
        window.addEventListener('load', () => {
      
        quicklink({
          timeout: 3000,
          priority: true,
          ignores: [uri => uri.includes('#'),uri => uri == 'https://andy0570.com/page/26/',]
        });
      
        });
      
    </script>
  


  



  



  
  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">

  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.js"></script>
  

  <script src="/js/algolia-search.js?v=7.1.0"></script>



  
  
  <script>
    
    function showTime(Counter) {
      var entries = [];
      var $visitors = $('.leancloud_visitors');

      $visitors.each(function() {
        entries.push( $(this).attr('id').trim() );
      });

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url: { '$in': entries } }) })
        .done(function({ results }) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.url;
            var time = item.time;
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for (var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if (countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'S7i1Y8YorMKFPaYbJbekD5el-gzGzoHsz',
                'X-LC-Key': 'brOnU8mOQvSjpipJvdKUAIbU',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            if ($('.post-title-link').length >= 1) {
              showTime(Counter);
            }
          
        });
    });
  </script>



  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script>pangu.spacingPage();</script>


  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.loadBookmark();
  
  </script>


  

  

  


  <!-- red heart -->
  <script type="text/javascript" src="/js/src/love.js"></script>
  
</body>
</html>

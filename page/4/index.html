<!DOCTYPE html>













<html class="theme-next gemini" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">



  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">













  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">







  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/panda/apple-touch-icon.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda/favicon-32x32.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda/favicon-16x16.png?v=7.1.0">


  <link rel="mask-icon" href="/images/panda/safari-pinned-tab.svg?v=7.1.0" color="#222">


  <link rel="manifest" href="/images/panda/site.webmanifest">


  <meta name="msapplication-config" content="/images/panda/browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '0E2AON8EZF',
      apiKey: '22fbefd84c8343239f5c04365b9728de',
      indexName: 'MyBlogPlatform',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有时候阳光很好 有时候阳光很暗">
<meta name="keywords" content="独木舟的木">
<meta property="og:type" content="website">
<meta property="og:title" content="独木舟的木">
<meta property="og:url" content="https://andy0570.com/page/4/index.html">
<meta property="og:site_name" content="独木舟的木">
<meta property="og:description" content="有时候阳光很好 有时候阳光很暗">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="独木舟的木">
<meta name="twitter:description" content="有时候阳光很好 有时候阳光很暗">



  <link rel="alternate" href="/atom.xml" title="独木舟的木" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://andy0570.com/page/4/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>独木舟的木</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8229a094facca297f211d61323fd9fde";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <a href="https://github.com/andy0570" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">独木舟的木</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">iOS Developer</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">14</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">38</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">315</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/andy0570" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2019/01/02/各厂商云服务费用调查/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/02/各厂商云服务费用调查/" class="post-title-link" itemprop="url">各厂商云服务费用调查</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-02 17:40:00" itemprop="dateCreated datePublished" datetime="2019-01-02T17:40:00+08:00">2019-01-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-11 03:18:36" itemprop="dateModified" datetime="2019-05-11T03:18:36+08:00">2019-05-11</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/云计算/" itemprop="url" rel="index"><span itemprop="name">云计算</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">5.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">5 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>调查时间：2018年12月11日</p>
</blockquote>
<h1>参数指标</h1>
<h3>计费方式</h3>
<ul>
<li><strong>包年包月</strong>：按月购买及续费，预付费模式。==有折扣优惠==</li>
<li><strong>按量付费</strong>：按实际开通时长以小时为单位进行收费，后付费模式。</li>
<li><strong>抢占式实例</strong>：相对于按量付费实例价格有一定的折扣，价格随供求波动，按实际使用时长进行收费，后付费模式。您愿意支付每小时的实例最高价。当您的出价高于当前市场成交价时，您的实例就会运行。（注：抢占式实例适用于无状态的应用场景，比如可弹性伸缩的 Web 站点服务、实时分析、图像渲染、大数据分析和大规模并行计算等。）==后期可以尝试的计费方式，弹性增减节点数量==</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h3>ECS实例类型</h3>
<table>
<thead>
<tr>
<th>实例类型</th>
<th>==CPU/内存比==</th>
<th>CPU型号</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>通用型</td>
<td>1:4</td>
<td>Intel Skylake Xeon Platinum 8163 2.5GHz 处理器。</td>
<td></td>
</tr>
<tr>
<td>计算型</td>
<td>1:2</td>
<td>Intel Skylake Xeon Platinum 8163 2.5GHz 处理器。</td>
<td></td>
</tr>
<tr>
<td>内存型</td>
<td>1:8</td>
<td>Intel Skylake Xeon Platinum 8163 2.5GHz 处理器。</td>
<td></td>
</tr>
<tr>
<td>大数据型</td>
<td>1:4</td>
<td>Intel Xeon E5-2682 v4（Broadwell）处理器，2.5GHZ 主频。</td>
<td>适合 Hadoop、并行数据处理类业务使用</td>
</tr>
<tr>
<td>本地SSD</td>
<td>1:4</td>
<td>Intel Skylake Xeon Platinum 8163 2.5GHz 处理器，为高性能数据库等场景设计，配备高性能（高 IOPS、大吞吐、低访问延迟）NVMe SSD 本地盘</td>
<td>适用于 OLTP、高性能关系型数据库、NoSQL 数据库（如 Cassandra、MongoDB 等）、Elasticsearch 等搜索场景</td>
</tr>
<tr>
<td>高主频型</td>
<td>1:4</td>
<td>Intel Xeon(Skylake) Gold 6149 3.1GHz 处理器，为高计算性能需求场景设计。</td>
<td></td>
</tr>
<tr>
<td>入门级（共享）</td>
<td>-</td>
<td>-</td>
<td>适用于 Web 应用前端机，轻负载应用、微服务，开发测试压测服务应用场景。</td>
</tr>
</tbody>
</table>
<p>参考：阿里云 ECS 标准，X86架构。</p>
<p><a href="https://help.aliyun.com/document_detail/58291.html?spm=a2c4g.11174283.6.611.364d52fevr5Cji" target="_blank" rel="noopener">阿里云 - ECS 配置选型 </a></p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080049.jpg" alt="阿里云配置选型"></p>
<blockquote>
<p>推荐部署==通用型实例==，CPU/内存比为1:4，大部分云厂商的实例类型可弹性更改。</p>
</blockquote>
<h3>块存储</h3>
<ul>
<li><a href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/EBSVolumeTypes.html" target="_blank" rel="noopener">AWS - EBS 卷类型</a></li>
<li><a href="https://help.aliyun.com/document_detail/25382.html?spm=5176.ecsbuyv3.storage.2.122a3675k4YZ7H" target="_blank" rel="noopener">阿里云 - 块存储性能</a></li>
</ul>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080050.jpg" alt="阿里云块存储"></p>
<h3>公网带宽计费模式</h3>
<ul>
<li><strong>按固定带宽</strong>：需指定公网出方向的带宽的大小，如 10Mbps，==适用于业务场景对于网络带宽要求比较稳定的客户==，费用较低。</li>
<li><strong>按使用流量</strong>：是按公网出方向的实际发生的网络流量进行收费，==适用于业务场景对网络带宽需求变化较大的场景==，如平时带宽使用较低但间歇性的出现网络访问高峰的场景；</li>
</ul>
<h4>固定带宽费用（元/月）</h4>
<table>
<thead>
<tr>
<th>云服务</th>
<th>1 Mbps</th>
<th>5 Mbps</th>
<th>10 Mbps</th>
<th>20 Mbps</th>
</tr>
</thead>
<tbody>
<tr>
<td>AWS</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Azure</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>阿里云</td>
<td>23</td>
<td>125</td>
<td>502</td>
<td>1325</td>
</tr>
<tr>
<td>华为云</td>
<td>23</td>
<td>115</td>
<td>800</td>
<td>1600</td>
</tr>
<tr>
<td>移动云</td>
<td>20</td>
<td>100</td>
<td>600</td>
<td>1200</td>
</tr>
<tr>
<td>天翼云</td>
<td>20</td>
<td>100</td>
<td>280</td>
<td>640</td>
</tr>
<tr>
<td>浪潮</td>
<td>-</td>
<td>95.8</td>
<td>429.16</td>
<td>1095.83</td>
</tr>
<tr>
<td>谷歌云</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<h1>AWS</h1>
<p>区域：美国东部（俄亥俄州）</p>
<h3>按需定价</h3>
<table>
<thead>
<tr>
<th>通用实例</th>
<th>vCPU</th>
<th>内存（GiB）</th>
<th>实例存储</th>
<th>Linux 使用量</th>
<th>预计费用/月</th>
</tr>
</thead>
<tbody>
<tr>
<td>t3.large</td>
<td>2</td>
<td>8</td>
<td>仅限 EBS</td>
<td>每小时 0.0832 USD</td>
<td>==¥413.36==</td>
</tr>
<tr>
<td>t3.xlarge</td>
<td>4</td>
<td>16</td>
<td>仅限 EBS</td>
<td>每小时 0.1664 USD</td>
<td>==¥826.67==</td>
</tr>
<tr>
<td>t2.large</td>
<td>2</td>
<td>8</td>
<td>仅限 EBS</td>
<td>每小时 0.0928 USD</td>
<td>¥461.36</td>
</tr>
<tr>
<td>t2.xlarge</td>
<td>4</td>
<td>16</td>
<td>仅限 EBS</td>
<td>每小时 0.1856 USD</td>
<td>¥ 922.1</td>
</tr>
</tbody>
</table>
<ul>
<li>预计费用按照：每小时费用 x (当前汇率 6.9) x 24 x 30 计算。</li>
<li>数据传出、传入根据==不同的数据量==和==不同的地区==单独收费（没有带宽，按流量计费）。</li>
<li>弹性IP地址：¥24.8/月。</li>
</ul>
<h3>预留实例</h3>
<table>
<thead>
<tr>
<th>通用实例</th>
<th>预付</th>
<th>每小时有效价格</th>
<th>按需每小时费率</th>
<th>折扣</th>
<th>预计费用/月</th>
</tr>
</thead>
<tbody>
<tr>
<td>t3.large</td>
<td>¥ 2939.95</td>
<td>0.049 USD</td>
<td>0.0832 USD</td>
<td>42%</td>
<td>==¥ 245==</td>
</tr>
<tr>
<td>t3.xlarge</td>
<td>¥ 5886.80</td>
<td>0.097 USD</td>
<td>0.1664 USD</td>
<td>41%</td>
<td>==¥ 490.5==</td>
</tr>
<tr>
<td>t2.large</td>
<td>¥ 3243</td>
<td>0.054 USD</td>
<td>0.0928 USD</td>
<td>42%</td>
<td>==¥ 270.25==</td>
</tr>
<tr>
<td>t2.xlarge</td>
<td>¥ 6487</td>
<td>0.107 USD</td>
<td>0.1856 USD</td>
<td>42%</td>
<td>==540.58==</td>
</tr>
</tbody>
</table>
<ul>
<li><a href="https://amazonaws-china.com/cn/ec2/pricing/reserved-instances/pricing/" target="_blank" rel="noopener">Amazon EC2 预留实例定价</a></li>
<li>预付费用分：不预付费用、预付部分费用、预付全部费用。以上按预付全部费用计算。</li>
<li>与按需实例的定价相比，标准预留实例可为您提供大幅折扣（==最高可达 75%==），并能按 1 年或 3 年的使用期进行购买。</li>
</ul>
<h1>Azure</h1>
<p><a href="https://azure.microsoft.com/zh-cn/pricing/details/virtual-machines/series/" target="_blank" rel="noopener">Azure 虚拟机系列</a> 以 B 系列（经济型可突增 VM）为例，包年（节省25%价格）：</p>
<table>
<thead>
<tr>
<th>实例类型</th>
<th>CPU</th>
<th>内存</th>
<th>临时存储空间</th>
<th>每小时费用</th>
<th>预计费用/月</th>
</tr>
</thead>
<tbody>
<tr>
<td>B2MS</td>
<td>2</td>
<td>8</td>
<td>16 GB</td>
<td>0.102 USD</td>
<td>==¥ 512==</td>
</tr>
<tr>
<td>B4MS</td>
<td>4</td>
<td>16</td>
<td>32 BG</td>
<td>0.203 USD</td>
<td>==¥ 1008.32==</td>
</tr>
</tbody>
</table>
<ul>
<li>亚洲东部|2 vCPU|8 GB RAM|32 GiB 标准 HDD，OS 磁盘|存储 1000 GiB |==¥ 943/月==</li>
<li>亚洲东部|4 vCPU|16 GB RAM|32 GiB 标准 HDD，OS 磁盘|存储 1000 GiB |==¥ 1455.56/月==</li>
</ul>
<h1>阿里云</h1>
<table>
<thead>
<tr>
<th>实例规格</th>
<th>vCPU</th>
<th>内存</th>
<th>处理器主频</th>
<th>内网带宽</th>
<th>内网收发包</th>
<th>支持iPv6</th>
<th>规格参考价格</th>
</tr>
</thead>
<tbody>
<tr>
<td>通用型g5 ecs.g5.large</td>
<td>2</td>
<td>8</td>
<td>2.5 GHz</td>
<td>1 Gbps</td>
<td>30 万 PPS</td>
<td>是</td>
<td>==¥ 242.25/月==</td>
</tr>
<tr>
<td>通用型g5 ecs.g5.xlarge</td>
<td>4</td>
<td>16</td>
<td>2.5 Ghz</td>
<td>1.5 Gbps</td>
<td>50 万 PPS</td>
<td>是</td>
<td>==¥ 484.5/月==</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>2 核vCPU | 8 GiB 内存 |系统盘+数据盘高效云盘 40 + 1020 GiB |10Mbps 带宽|==¥ 952.8/月（包一年）==。</p>
</li>
<li>
<p>4 核vCPU | 16 GiB 内存 |系统盘+数据盘高效云盘 40 + 1020 GiB |10Mbps 带宽|==¥ 1144.1/月（包一年）==。（==¥13729==一年）</p>
</li>
<li>
<p>包一年优惠：数据盘享 8.5 折，系统盘享 8.5 折，买满一年，带宽立享 8.5 折，专有网络实例立享 7.5 折。</p>
</li>
</ul>
<h1>华为云</h1>
<p><a href="https://www.huaweicloud.com/pricing.html#/ecs" target="_blank" rel="noopener">华为云费用详情</a></p>
<h3>ECS 价格</h3>
<table>
<thead>
<tr>
<th>规格名称</th>
<th>CPU</th>
<th>内存</th>
<th>按小时</th>
<th>包月</th>
<th>包1年（83折）</th>
<th>包2年（7折）</th>
<th>包3年（5折）</th>
</tr>
</thead>
<tbody>
<tr>
<td>通用计算型S1</td>
<td>2</td>
<td>8</td>
<td>0.59</td>
<td>==284.9==</td>
<td>2849</td>
<td>4786.3</td>
<td>5128.2</td>
</tr>
<tr>
<td>通用计算型S1</td>
<td>4</td>
<td>16</td>
<td>1.19</td>
<td>==569.8==</td>
<td>5698</td>
<td>9572.6</td>
<td>10256.4</td>
</tr>
<tr>
<td>通用计算型S2</td>
<td>4</td>
<td>8</td>
<td>0.78</td>
<td>376</td>
<td>3760</td>
<td>6316.8</td>
<td>6768</td>
</tr>
<tr>
<td>通用计算型S3</td>
<td>2</td>
<td>8</td>
<td>0.68</td>
<td>==215.6==</td>
<td>2069.8</td>
<td>3363.4</td>
<td>3725.6</td>
</tr>
<tr>
<td>通用计算型S3</td>
<td>4</td>
<td>16</td>
<td>1.37</td>
<td>==431.2==</td>
<td>4139.6</td>
<td>6727.6</td>
<td>7451.1</td>
</tr>
</tbody>
</table>
<h3>磁盘价格</h3>
<table>
<thead>
<tr>
<th>产品类型</th>
<th>说明</th>
<th>步长规格</th>
<th>按小时</th>
<th>包月</th>
<th>包1年（83折）</th>
<th>包2年（7折）</th>
<th>包3年（5折）</th>
</tr>
</thead>
<tbody>
<tr>
<td>普通 IO</td>
<td>线性计算</td>
<td>1 GB</td>
<td>-</td>
<td>0.3</td>
<td>3</td>
<td>5.04</td>
<td>5.4</td>
</tr>
<tr>
<td>高 IO</td>
<td>线性计算</td>
<td>1 GB</td>
<td>-</td>
<td>0.35</td>
<td>==3.5==</td>
<td>5.88</td>
<td>6.3</td>
</tr>
<tr>
<td>超高 IO</td>
<td>线性计算</td>
<td>1 GB</td>
<td>-</td>
<td>1</td>
<td>==10==</td>
<td>16.8</td>
<td>18</td>
</tr>
</tbody>
</table>
<h3>带宽价格</h3>
<h4>固定带宽（元/Mbits/s）</h4>
<table>
<thead>
<tr>
<th>规格</th>
<th>收费方式</th>
<th>按小时</th>
<th>包月</th>
<th>包1年（83折）</th>
<th>包2年（7折）</th>
<th>包3年（5折）</th>
</tr>
</thead>
<tbody>
<tr>
<td>全动态 BGP</td>
<td>1-5M</td>
<td>0.063</td>
<td>23</td>
<td>230</td>
<td>460</td>
<td>690</td>
</tr>
<tr>
<td>全动态 BGP</td>
<td>6M以上</td>
<td>0.25</td>
<td>80</td>
<td>800</td>
<td>1600</td>
<td>2400</td>
</tr>
</tbody>
</table>
<h4>按流量</h4>
<table>
<thead>
<tr>
<th>规格</th>
<th>收费方式</th>
<th>按流量</th>
<th>价格单位</th>
</tr>
</thead>
<tbody>
<tr>
<td>全动态 BGP</td>
<td>按流量</td>
<td>0.8</td>
<td>元/GB</td>
</tr>
<tr>
<td>静态 BGP</td>
<td>按流量</td>
<td>0.64</td>
<td>元/GB</td>
</tr>
</tbody>
</table>
<ul>
<li>华北 - 北京一|s3.large.4 | 2 核 | 8GB|系统盘+数据盘高I/O 40 G + 1020G |10 Mbps 带宽|==¥910.8/月（包一年价格）==</li>
<li>华北 - 北京一|s3.xlarge.4 | 4核 | 16GB|系统盘+数据盘高I/O 40 G + 1020G |10 Mbps 带宽|==¥1083.25/月（包一年价格）==</li>
</ul>
<h1>移动云</h1>
<blockquote>
<p>⚠️</p>
<ul>
<li>节点限制：只有一个地域可选，华南节点2。</li>
<li>机型限制：通用型。</li>
<li>参考：<a href="https://ecloud.10086.cn/op-help-center/show/f_4_4_3" target="_blank" rel="noopener">移动云</a></li>
</ul>
</blockquote>
<ul>
<li>华南节点2|2核|8GB|系统盘+数据盘 40GB+1TB|10 Mbps 带宽|==¥808.6/月==</li>
<li>华南节点2|4核|16GB|系统盘+数据盘 40GB+1TB|10 Mbps 带宽|==¥1028.6/月==</li>
</ul>
<h1>天翼云</h1>
<blockquote>
<p>⚠️</p>
<ul>
<li>节点限制，只有一个地域可选：北京1。</li>
<li>没有机型选项。</li>
<li>数据盘只有普通I/O。</li>
<li>参考：<a href="https://www.ctyun.cn/calculator/ecs" target="_blank" rel="noopener">天翼云价格计算器</a></li>
</ul>
</blockquote>
<ul>
<li>北京1|2核|8GB|数据盘 1020 GB|10 Mbps 带宽|==¥800.7/月==</li>
<li>北京1|4核|16GB|数据盘 1020 GB|10 Mbps 带宽|==¥1103.3/月==</li>
</ul>
<h1>浪潮</h1>
<blockquote>
<p>⚠️</p>
<ul>
<li>节点限制：只有一个地域可选，北京。</li>
<li>机型限制：标准型。</li>
<li>云服务器无法备份。</li>
<li>带宽限制：只有</li>
</ul>
<p>参考：<a href="https://cloud.inspur.com/" target="_blank" rel="noopener">浪潮云</a></p>
</blockquote>
<ul>
<li>北京|2核|8GB|系统盘+数据盘 20GB+1020GB|10 Mbps 带宽|==¥923.9/月==</li>
<li>北京|4核|16GB|系统盘+数据盘 20GB+1020GB|10 Mbps 带宽|==¥1115.16/月==</li>
</ul>
<h1>谷歌云</h1>
<blockquote>
<p>⚠️</p>
<ul>
<li>无国内服务。</li>
</ul>
<p>参考：<a href="https://cloud.google.com/pricing/" target="_blank" rel="noopener">谷歌云</a></p>
</blockquote>
<p><a href="https://www.ifanr.com/1141734" target="_blank" rel="noopener">资讯：秘密洽谈，Google 想和腾讯在云服务上合作</a></p>
<blockquote>
<p>腾讯云回应「Google 借道腾讯扩展中国云服务市场」：假消息。**据财联社 近日有媒体报道，Google 正打算和腾讯在云计算上合作，让腾讯作为中国谷歌云的代理，并提到「如果项目进展顺利，谷歌云将为国内客户提供从数据管理到分析以及网络安全的服务，同时在海外的腾讯云客户也可以使用谷歌云」。</p>
<p>针对此事，腾讯云方面回应称，「系假消息」。</p>
</blockquote>
<h1>腾讯云</h1>
<table>
<thead>
<tr>
<th>机型规格</th>
<th>vCPU</th>
<th>内存</th>
<th>处理器型号</th>
<th>内网带宽</th>
<th>网络收发包</th>
<th>费用</th>
</tr>
</thead>
<tbody>
<tr>
<td>S4.MEDIUM8</td>
<td>2</td>
<td>8</td>
<td>Intel Xeon Skylake 6148(2.4 GHz)</td>
<td>1.5Gbps</td>
<td>30 万 PPS</td>
<td>276 元/月</td>
</tr>
<tr>
<td>S4.LARGE16</td>
<td>4</td>
<td>16</td>
<td>Intel Xeon Skylake 6148(2.4 GHz)</td>
<td>1.5Gbps</td>
<td>50 万 PPS</td>
<td>552 元/月</td>
</tr>
<tr>
<td>S2.MEDIUM8</td>
<td>2</td>
<td>8</td>
<td>Intel Xeon E5-2680 v4(2.4 GHz)</td>
<td>1.5Gbps</td>
<td>25 万 PPS</td>
<td>270 元/月</td>
</tr>
<tr>
<td>S2.LARGE16</td>
<td>4</td>
<td>16</td>
<td>Intel Xeon E5-2680 v4(2.4 GHz)</td>
<td>1.5Gbps</td>
<td>45 万 PPS</td>
<td>540 元/月</td>
</tr>
</tbody>
</table>
<ul>
<li>注：以下为标准价格，未计算包年折扣（83折）。</li>
<li>上海|2核 8GB|系统盘+数据盘 50+1020|10 Mbps 带宽|==¥1162==</li>
<li>上海|4核 16GB|系统盘+数据盘 50+1020|10 Mbps 带宽|==¥1438==</li>
</ul>
<h1>存储服务</h1>
<h3><a href="https://www.aliyun.com/price/product?spm=5176.7933691.744462.c1.ffbe6a56ZNiOt4#/oss/detail" target="_blank" rel="noopener">对象存储 </a></h3>
<table>
<thead>
<tr>
<th>资费项</th>
<th>计费项</th>
<th>标准型单价</th>
<th>低频访问型单价</th>
<th>归档型单价</th>
</tr>
</thead>
<tbody>
<tr>
<td>存储费用</td>
<td>数据存储</td>
<td>0.12 元/GB/月</td>
<td>0.08 元/GB/月</td>
<td>0.033 元/GB/月</td>
</tr>
<tr>
<td></td>
<td>10GB/年的价格</td>
<td>14.4 元</td>
<td>9.6 元</td>
<td>3.96 元</td>
</tr>
</tbody>
</table>
<h3><a href="https://www.aliyun.com/product/nas?spm=5176.208355.cloudEssentials.20.11732ca1L5ja8K" target="_blank" rel="noopener">文件存储</a></h3>
<p>文件存储分：性能型存储包/容量型存储包</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080051.jpg" alt="容量型存储包价格"></p>
<blockquote>
<p>按照 0.21 元/GB/月的价格计算， 25.2 元/10GB/年。</p>
</blockquote>
<h1>参考</h1>
<ul>
<li><a href="https://amazonaws-china.com/cn/ec2/instance-types/" target="_blank" rel="noopener">AWS 实例类型</a></li>
<li><a href="https://amazonaws-china.com/cn/ec2/pricing/on-demand/" target="_blank" rel="noopener">Amazon EC2 定价</a></li>
<li><a href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/EBSVolumeTypes.html" target="_blank" rel="noopener">Amazon EBS 卷类型</a></li>
<li><a href="https://azure.microsoft.com/zh-cn/pricing/details/virtual-machines/series/" target="_blank" rel="noopener">Azure 虚拟机类型</a></li>
<li><a href="https://azure.microsoft.com/zh-cn/pricing/calculator/?service=cost-management" target="_blank" rel="noopener">Azure 定价计算器</a></li>
<li><a href="https://www.aliyun.com/price/?spm=5176.8142029.388261.19.3e076d3eCTb08Q" target="_blank" rel="noopener">阿里云 - 定价</a></li>
<li><a href="https://ecs-buy.aliyun.com/wizard/#/prepay/cn-shanghai" target="_blank" rel="noopener">阿里云 - 实例类型</a></li>
<li><a href="https://help.aliyun.com/document_detail/58291.html?spm=5176.ecsbuyv3.instance.2.122a3675k4YZ7H" target="_blank" rel="noopener">阿里云 - 配置选型</a></li>
<li><a href="https://help.aliyun.com/document_detail/25378.html?spm=5176.ecsbuyv3.instance.1.122a3675k4YZ7H#g5" target="_blank" rel="noopener">阿里云 - 实例规格族特点</a></li>
<li><a href="https://help.aliyun.com/document_detail/25382.html?spm=5176.ecsbuyv3.storage.2.122a3675k4YZ7H" target="_blank" rel="noopener">阿里云 - 块存储性能</a></li>
<li><a href="https://www.huaweicloud.com/pricing.html#/ecs" target="_blank" rel="noopener">华为云 - 弹性云服务器ECS 价格计算器</a></li>
<li><a href="https://support.huaweicloud.com/productdesc-ecs/zh-cn_topic_0088142812.html" target="_blank" rel="noopener">华为云 - 弹性云服务器ECS 通用计算型实例规格</a></li>
<li><a href="https://cloud.tencent.com/document/product/213/11518" target="_blank" rel="noopener">腾讯云 - 实例规格</a></li>
<li><a href="https://www.infoq.cn/article/3FiAVeY8i_A1ziR67tux" target="_blank" rel="noopener">国内云计算厂商众生相：四大阵营十几家企业生存盘点</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2019/01/01/《AWS云计算实战》1.AWS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/01/《AWS云计算实战》1.AWS/" class="post-title-link" itemprop="url">《AWS云计算实战》1.AWS</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-01 20:12:00" itemprop="dateCreated datePublished" datetime="2019-01-01T20:12:00+08:00">2019-01-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-28 16:01:32" itemprop="dateModified" datetime="2019-04-28T16:01:32+08:00">2019-04-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/云计算/" itemprop="url" rel="index"><span itemprop="name">云计算</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">1.9k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">2 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1>AWS 是一个云计算平台</h1>
<p><strong>Amazon Web Service</strong>（AWS）是一个提供 Web 服务解决方案的平台，它提供了不同抽象层上的计算、存储和网络的解决方案。</p>
<p><strong>Web 服务</strong>：可以通过 Web 界面来控制服务。</p>
<p>AWS 部署在世界各地的数据中心，可以为客户提供全球性的基础设施服务。</p>
<blockquote>
<p>AWS 云在全球 20 个地理区域内运营着 60 个可用区，并宣布计划增加巴林、开普敦、中国香港特别行政区和米兰这四个区域，同时再增加 12 个可用区。（201902）</p>
</blockquote>
<p>&lt;!-- more --&gt;</p>
<h2>云计算</h2>
<blockquote>
<p>美国国家标准和技术研究所（NIST）对云计算的定义：</p>
<p>云计算是一种普适的、方便的、按需提供网络访问的可配置的计算资源（如网络、服务器、存储、应用程序和服务）的共享池模型，它能够以最少的管理工作量或与服务提供者交互的方式快速进行分配和发布。</p>
</blockquote>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080126.jpg" alt="云计算的分类"></p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080128.jpg" alt="云计算服务"></p>
<ul>
<li><strong>基础设施即服务（Iaas）</strong>——提供计算、存储和网络功能等基本资源，使用 Amazon EC2、Google Compute Engine 和 Microsoft Azure 虚拟机这一类虚拟服务器。</li>
<li><strong>平台即服务（Paas）</strong>——提供将定制的应用部署到云上的平台，如 AWS Elastic Beanstalk、Google App Engine 和 Heroku。</li>
<li><strong>软件即服务（Saas）</strong>——结合了基础设施和软件并且运行在云端，包括 Amazon WorkSpaces、Google Apps for Work 和 Microsoft Office 365 这一类办公应用。还有例如 AWS ELB 负载均衡器、AWS RDS 数据库 等。</li>
</ul>
<h2>AWS 可以做什么？</h2>
<p>使用一个或多个服务组合在 AWS 上运行任何应用程序。</p>
<p>如：托管一家网店、在 AWS 上运行企业应用程序、以可靠、耐用的方式存储和归档数据、实现容错的系统架构...</p>
<h2>使用 AWS 的优势</h2>
<ol>
<li>
<p>创新和快速发展的平台。使用 AWS 的新功能和服务转化为针对自己的客户的创新解决方案，从而体现竞争优势。</p>
</li>
<li>
<p>选择合适的服务构建复杂的系统。</p>
</li>
<li>
<p>利用 AWS API 实现自动化操作。</p>
</li>
<li>
<p>灵活的容量（可扩展性）。根据需求弹性部署应用。</p>
</li>
<li>
<p>为失效而构建（可靠性）。AWS 为客户提供了创建容错系统所需要的一切资源。</p>
</li>
<li>
<p>缩短上市的时间。客户可以在 AWS 上快速调整基础架构以满足需求。</p>
</li>
<li>
<p>从规模经济中受益（节约成本）。AWS 规模越大，价格就会越低。</p>
<blockquote>
<p>截止到 2017 年 11 月，AWS 已经进行了 62 次降价。</p>
</blockquote>
</li>
<li>
<p>全球化的基础设施。</p>
</li>
<li>
<p>专业的合作伙伴。AWS 符合很多行业合规性要求。ISO 27001、FedRAMP &amp; DoD CSM、PCI DSS Level 1、ISO 9001。</p>
</li>
</ol>
<h2>AWS 的付费机制——按使用量付费</h2>
<p>AWS 的计费方式：</p>
<ul>
<li>按使用时间计费；</li>
<li>按流量计费；</li>
<li>按存储用量计费；</li>
</ul>
<h2>AWS 服务</h2>
<p>用于计算、存储和联网的硬件是 AWS 云计算的基础。AWS 在硬件上运行软件服务来提供服务。</p>
<ul>
<li><strong>计算服务</strong>提供了计算能力以及内存。客户可以启动虚拟服务器并使用它们来运行应用程序。</li>
<li><strong>应用服务</strong>为常见的使用场景提供解决方案，如消息队列、主题以及检索大量数据以集成到应用中。</li>
<li><strong>企业服务</strong>提供独立的解决方案，如邮件服务器和目录服务。</li>
<li><strong>部署和管理服务</strong>作用于迄今所提到的服务。这个服务可以帮助客户授予或者撤销对云资源的访问、虚拟服务系统的监控以及部署应用程序。</li>
<li><strong>存储服务</strong>被用来搜集、保存和归档数据。AWS供了不同的存储选项:对象存储或者用于虚拟服务器的网络附加存储方案。</li>
<li>当需要管理结构化数据时，<strong>数据库存储</strong>比其他存储方案有一些优势。AWS提供了关系数据库和 NOSQL数据库服务。</li>
<li><strong>网络服务</strong>是AWS的基本组成部分。客户可以定义一个私有的网络并使用高度集成的DNS服务。</li>
</ul>
<h2>与 AWS 交互</h2>
<p>客户可以使用诸如管理控制台、基于 Web 的用户界面或命令行工具等工具实现对服务资源的管理。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080128-1.jpg" alt="与 AWS 交互的方式"></p>
<ul>
<li>GUI：使用基于 Web 的管理控制台实现与 AWS 的交互；</li>
<li>CLI 通常用于自动执行 AWS 上的任务，客户可以将多个 CLI 调用链接起来，以实现基础设施的自动化；</li>
<li>SDK 通常用于将 AWS 服务集成到应用程序中；</li>
<li>蓝图（AWS CloudFormation，官方称之为“堆栈”）是包含所有服务和依赖关系的对于系统的描述。蓝图可以帮助你自动化云中基础设施的配置。（简而言之，就是用一个 JSON 文件描述整个云服务基础设施架构，可以一键部署）。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2019/01/01/《AWS云计算实战》2.五分钟搭建 WordPress 站点/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/01/《AWS云计算实战》2.五分钟搭建 WordPress 站点/" class="post-title-link" itemprop="url">《AWS云计算实战》2.五分钟搭建 WordPress 站点</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-01 20:12:00" itemprop="dateCreated datePublished" datetime="2019-01-01T20:12:00+08:00">2019-01-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:34:49" itemprop="dateModified" datetime="2019-05-01T20:34:49+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/云计算/" itemprop="url" rel="index"><span itemprop="name">云计算</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">12k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">11 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>本文内容：使用 <a href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/Welcome.html" target="_blank" rel="noopener">AWS CloudFormation</a> 实现基础设施的自动化部署。</p>
<h2>WordPress 基础设施架构</h2>
<p>需要使用4个不同的 AWS 服务实现 WordPress 站点项目：</p>
<ul>
<li>
<p>弹性负载均衡（Elastic Load Balancing，ELB）——AWS 提供的弹性负载均衡服务。负载均衡器用于将流量分发到 Web 服务器。</p>
</li>
<li>
<p>弹性计算云（Elastic Computer Cloud，EC2）——EC2 服务提供的虚拟服务器。</p>
<blockquote>
<p>如果 EC2 的 CPU 利用率高于 80%，应该添加第三台服务器，以防止 Web 页面加载的时间过长。</p>
</blockquote>
</li>
<li>
<p>适用于 MySQL 的关系型数据库服务（Relational Database Service for MySQL）——AWS 的关系数据库服务（RDS）提供了对 MySQL 的支持。</p>
<blockquote>
<p>使用 RDS 的好处是，AWS 平台会自动完成数据库备份。</p>
</blockquote>
</li>
<li>
<p>安全组（Security group）——安全组类似于防火墙。</p>
</li>
</ul>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080008.jpg" alt="wordpress 基础设施架构"></p>
<p>&lt;!-- more --&gt;</p>
<h2>准备工作：创建并设置密钥对</h2>
<ol>
<li>创建密钥对并下载一个名为 <strong>mykey.pem</strong> 的私钥文件。</li>
<li>Mac 系统下，<code>shift+cmd+.</code>显示隐藏文件，将 <strong>mykey.pem</strong> 文件放到 <strong>.ssh</strong> 目录下，设置密钥文件访问权限仅自己可见：</li>
</ol>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 400 mykey.pem</span><br></pre></td></tr></table></figure></p>
<h2>CloudFormation（堆栈）</h2>
<blockquote>
<p>AWS CloudFormation 允许您快速和轻松地部署自己的基础设施资源和应用程序在 AWS 上。</p>
<p>AWS CloudFormation 是一项服务，可帮助您对 Amazon Web Services 资源进行建模和设置，以便能花较少的时间管理这些资源，而将更多的时间花在运行于 AWS 中的应用程序上。您创建一个描述您所需的所有 AWS 资源（如 Amazon EC2 实例或 Amazon RDS 数据库实例）的模板，并且 AWS CloudFormation 将负责为您设置和配置这些资源。</p>
</blockquote>
<p>指定的 Amazon S3 模板 URL：<a href="https://s3.amazonaws.com/awsinaction/chapter2/template.json" target="_blank" rel="noopener">https://s3.amazonaws.com/awsinaction/chapter2/template.json</a></p>
<p>简单4步就可以创建一个 <strong>CloudFormation</strong>。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080010.jpg" alt="堆栈实例"></p>
<p>使用 **CloudFormation（堆栈）**的好处是：<strong>你可以随时按需自动化创建或删除基础设施。</strong></p>
<h2>估算成本</h2>
<p>使用 <a href="http://calculator.s3.amazonaws.com/index.html?key=cloudformation/c08f47ad-184c-4a69-90a5-1238619ff57e&amp;lng=zh_CN#" target="_blank" rel="noopener">AWS 简单月度计算器</a> 分析博客站点基础设施的成本。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/080011.jpg" alt="Jietu20190102-134656"></p>
<h2>📎 配置文件</h2>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"AWSTemplateFormatVersion"</span>: <span class="string">"2010-09-09"</span>,</span><br><span class="line">	<span class="attr">"Description"</span>: <span class="string">"AWS in Action: chapter 2"</span>,</span><br><span class="line">	<span class="attr">"Parameters"</span>: &#123;</span><br><span class="line">		"KeyName": &#123; // 密钥对</span><br><span class="line">			"Description": "Key Pair name",</span><br><span class="line">			"Type": "AWS::EC2::KeyPair::KeyName",</span><br><span class="line">			"Default": "mykey"</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	"Mappings": &#123;</span><br><span class="line">		"EC2RegionMap": &#123;</span><br><span class="line">			"ap-northeast-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-cbf90ecb"&#125;,</span><br><span class="line">			"ap-southeast-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-68d8e93a"&#125;,</span><br><span class="line">			"ap-southeast-2": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-fd9cecc7"&#125;,</span><br><span class="line">			"eu-central-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-a8221fb5"&#125;,</span><br><span class="line">			"eu-west-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-a10897d6"&#125;,</span><br><span class="line">			"sa-east-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-b52890a8"&#125;,</span><br><span class="line">			"us-east-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-1ecae776"&#125;,</span><br><span class="line">			"us-west-1": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-d114f295"&#125;,</span><br><span class="line">			"us-west-2": &#123;"AmazonLinuxAMIHVMEBSBacked64bit": "ami-e7527ed7"&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	"Resources": &#123;</span><br><span class="line">		"VPC": &#123; // 虚拟网络</span><br><span class="line">			"Type": "AWS::EC2::VPC",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"CidrBlock": "172.31.0.0/16",</span><br><span class="line">				"EnableDnsHostnames": "true"</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"InternetGateway": &#123; // 网关</span><br><span class="line">			"Type": "AWS::EC2::InternetGateway",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"VPCGatewayAttachment": &#123; // VPC 网关关联设置</span><br><span class="line">			"Type": "AWS::EC2::VPCGatewayAttachment",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;,</span><br><span class="line">				"InternetGatewayId": &#123;"Ref": "InternetGateway"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"SubnetA": &#123; // 虚拟网络子网A</span><br><span class="line">			"Type": "AWS::EC2::Subnet",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"AvailabilityZone": &#123;"Fn::Select": ["0", &#123;"Fn::GetAZs": ""&#125;]&#125;,</span><br><span class="line">				"CidrBlock": "172.31.38.0/24",</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"SubnetB": &#123; // 虚拟网络子网B</span><br><span class="line">			"Type": "AWS::EC2::Subnet",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"AvailabilityZone": &#123;"Fn::Select": ["1", &#123;"Fn::GetAZs": ""&#125;]&#125;,</span><br><span class="line">				"CidrBlock": "172.31.37.0/24",</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"RouteTable": &#123; // 路由表</span><br><span class="line">			"Type": "AWS::EC2::RouteTable",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"RouteTableAssociationA": &#123; // 路由表关联到子网A</span><br><span class="line">			"Type": "AWS::EC2::SubnetRouteTableAssociation",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"SubnetId": &#123;"Ref": "SubnetA"&#125;,</span><br><span class="line">				"RouteTableId": &#123;"Ref": "RouteTable"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"RouteTableAssociationB": &#123; // 路由表关联到子网B</span><br><span class="line">			"Type": "AWS::EC2::SubnetRouteTableAssociation",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"SubnetId": &#123;"Ref": "SubnetB"&#125;,</span><br><span class="line">				"RouteTableId": &#123;"Ref": "RouteTable"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"RoutePublicNATToInternet": &#123; // NAT 路由设置</span><br><span class="line">			"Type": "AWS::EC2::Route",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"RouteTableId": &#123;"Ref": "RouteTable"&#125;,</span><br><span class="line">				"DestinationCidrBlock": "0.0.0.0/0",</span><br><span class="line">				"GatewayId": &#123;"Ref": "InternetGateway"&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			"DependsOn": "VPCGatewayAttachment"</span><br><span class="line">		&#125;,</span><br><span class="line">		"NetworkAcl": &#123;</span><br><span class="line">			"Type": "AWS::EC2::NetworkAcl",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"SubnetNetworkAclAssociationA": &#123;</span><br><span class="line">			"Type": "AWS::EC2::SubnetNetworkAclAssociation",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"SubnetId": &#123;"Ref": "SubnetA"&#125;,</span><br><span class="line">				"NetworkAclId": &#123;"Ref": "NetworkAcl"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"SubnetNetworkAclAssociationB": &#123;</span><br><span class="line">			"Type": "AWS::EC2::SubnetNetworkAclAssociation",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"SubnetId": &#123;"Ref": "SubnetB"&#125;,</span><br><span class="line">				"NetworkAclId": &#123;"Ref": "NetworkAcl"&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"NetworkAclEntryIngress": &#123;</span><br><span class="line">			"Type": "AWS::EC2::NetworkAclEntry",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"NetworkAclId": &#123;"Ref": "NetworkAcl"&#125;,</span><br><span class="line">				"RuleNumber": "100",</span><br><span class="line">				"Protocol": "-1",</span><br><span class="line">				"RuleAction": "allow",</span><br><span class="line">				"Egress": "false",</span><br><span class="line">				"CidrBlock": "0.0.0.0/0"</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"NetworkAclEntryEgress": &#123;</span><br><span class="line">			"Type": "AWS::EC2::NetworkAclEntry",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"NetworkAclId": &#123;"Ref": "NetworkAcl"&#125;,</span><br><span class="line">				"RuleNumber": "100",</span><br><span class="line">				"Protocol": "-1",</span><br><span class="line">				"RuleAction": "allow",</span><br><span class="line">				"Egress": "true",</span><br><span class="line">				"CidrBlock": "0.0.0.0/0"</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"LoadBalancer": &#123; // 负载均衡</span><br><span class="line">			"Type": "AWS::ElasticLoadBalancing::LoadBalancer",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"Subnets": [&#123;"Ref": "SubnetA"&#125;, &#123;"Ref": "SubnetB"&#125;],</span><br><span class="line">				"LoadBalancerName": "awsinaction-elb",</span><br><span class="line">				"Listeners": [&#123; // 监听 80 端口</span><br><span class="line">					"InstancePort": "80",</span><br><span class="line">					"InstanceProtocol": "HTTP",</span><br><span class="line">					"LoadBalancerPort": "80",</span><br><span class="line">					"Protocol": "HTTP"</span><br><span class="line">				&#125;],</span><br><span class="line">				"HealthCheck": &#123; // 端口状态检测设置</span><br><span class="line">					"HealthyThreshold": "2",</span><br><span class="line">					"Interval": "5",</span><br><span class="line">					"Target": "TCP:80",</span><br><span class="line">					"Timeout": "3",</span><br><span class="line">					"UnhealthyThreshold": "2"</span><br><span class="line">				&#125;,</span><br><span class="line">				"SecurityGroups": [&#123;"Ref": "LoadBalancerSecurityGroup"&#125;], // 安全组设置</span><br><span class="line">				"Scheme": "internet-facing"</span><br><span class="line">			&#125;,</span><br><span class="line">			"DependsOn": "VPCGatewayAttachment"</span><br><span class="line">		&#125;,</span><br><span class="line">		"LoadBalancerSecurityGroup": &#123; // 负载均衡安全组设置</span><br><span class="line">			"Type": "AWS::EC2::SecurityGroup",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"GroupDescription": "awsinaction-elb-sg",</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;,</span><br><span class="line">				"SecurityGroupIngress": [&#123;</span><br><span class="line">					"CidrIp": "0.0.0.0/0",</span><br><span class="line">					"FromPort": 80,</span><br><span class="line">					"IpProtocol": "tcp",</span><br><span class="line">					"ToPort": 80</span><br><span class="line">				&#125;]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"WebServerSecurityGroup": &#123; // Web 服务安全组，打开80、22</span><br><span class="line">			"Type": "AWS::EC2::SecurityGroup",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"GroupDescription": "awsinaction-sg",</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;,</span><br><span class="line">				"SecurityGroupIngress": [&#123;</span><br><span class="line">					"CidrIp": "0.0.0.0/0",</span><br><span class="line">					"FromPort": 22,</span><br><span class="line">					"IpProtocol": "tcp",</span><br><span class="line">					"ToPort": 22</span><br><span class="line">				&#125;, &#123;</span><br><span class="line">					"FromPort": 80,</span><br><span class="line">					"IpProtocol": "tcp",</span><br><span class="line">					"SourceSecurityGroupId": &#123;"Ref": "LoadBalancerSecurityGroup"&#125;,</span><br><span class="line">					"ToPort": 80</span><br><span class="line">				&#125;]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"DatabaseSecurityGroup": &#123; // 数据库安全组</span><br><span class="line">			"Type": "AWS::EC2::SecurityGroup",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"GroupDescription": "awsinaction-db-sg",</span><br><span class="line">				"VpcId": &#123;"Ref": "VPC"&#125;,</span><br><span class="line">				"SecurityGroupIngress": [&#123;</span><br><span class="line">					"IpProtocol": "tcp",</span><br><span class="line">					"FromPort": "3306",</span><br><span class="line">					"ToPort": "3306",</span><br><span class="line">					"SourceSecurityGroupId": &#123;"Ref": "WebServerSecurityGroup"&#125;</span><br><span class="line">				&#125;]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"Database": &#123; // 数据库设置</span><br><span class="line">			"Type": "AWS::RDS::DBInstance",</span><br><span class="line">			"DeletionPolicy": "Delete",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"AllocatedStorage": "5",</span><br><span class="line">				"BackupRetentionPeriod": "0",</span><br><span class="line">				"DBInstanceClass": "db.t2.micro",</span><br><span class="line">				"DBInstanceIdentifier": "awsinaction-db",</span><br><span class="line">				"DBName": "wordpress",</span><br><span class="line">				"Engine": "MySQL",</span><br><span class="line">				"MasterUsername": "wordpress",</span><br><span class="line">				"MasterUserPassword": "wordpress",</span><br><span class="line">				"VPCSecurityGroups": [&#123;"Fn::GetAtt": ["DatabaseSecurityGroup", "GroupId"]&#125;],</span><br><span class="line">				"DBSubnetGroupName": &#123;"Ref": "DBSubnetGroup"&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			"DependsOn": "VPCGatewayAttachment"</span><br><span class="line">		&#125;,</span><br><span class="line">		"DBSubnetGroup" : &#123;</span><br><span class="line">			"Type" : "AWS::RDS::DBSubnetGroup",</span><br><span class="line">			"Properties" : &#123;</span><br><span class="line">				"DBSubnetGroupDescription" : "DB subnet group",</span><br><span class="line">				"SubnetIds": [&#123;"Ref": "SubnetA"&#125;, &#123;"Ref": "SubnetB"&#125;]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"LaunchConfiguration": &#123; // 启动配置</span><br><span class="line">			"Type": "AWS::AutoScaling::LaunchConfiguration",</span><br><span class="line">			"Metadata": &#123;</span><br><span class="line">				"AWS::CloudFormation::Init": &#123;</span><br><span class="line">					"config": &#123;</span><br><span class="line">						"packages": &#123;</span><br><span class="line">							"yum": &#123;</span><br><span class="line">								"php": [],</span><br><span class="line">								"php-mysql": [],</span><br><span class="line">								"mysql": [],</span><br><span class="line">								"httpd": []</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;,</span><br><span class="line">						"sources": &#123;</span><br><span class="line">							"/var/www/html": "https://wordpress.org/wordpress-4.2.4.tar.gz"</span><br><span class="line">						&#125;,</span><br><span class="line">						"files": &#123;</span><br><span class="line">							"/tmp/config": &#123; // 虚拟机启动初始化 shell 脚本</span><br><span class="line">								"content": &#123;"Fn::Join": ["", [</span><br><span class="line">									"#!/bin/bash -ex\n",</span><br><span class="line">									"cp /var/www/html/wordpress/wp-config-sample.php /var/www/html/wordpress/wp-config.php\n",</span><br><span class="line">									"sed -i \"s/'database_name_here'/'wordpress'/g\" wp-config.php\n",</span><br><span class="line">									"sed -i \"s/'username_here'/'wordpress'/g\" wp-config.php\n",</span><br><span class="line">									"sed -i \"s/'password_here'/'wordpress'/g\" wp-config.php\n",</span><br><span class="line">									"sed -i \"s/'localhost'/'", &#123;"Fn::GetAtt": ["Database", "Endpoint.Address"]&#125;, "'/g\" wp-config.php\n",</span><br><span class="line">									<span class="string">"chmod -R 777 wp-content/ \n"</span></span><br><span class="line">								]]&#125;,</span><br><span class="line">								"mode": "000500",</span><br><span class="line">								"owner": "root",</span><br><span class="line">								"group": "root"</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;,</span><br><span class="line">						"commands": &#123;</span><br><span class="line">							"01_config": &#123;</span><br><span class="line">								"command": "/tmp/config",</span><br><span class="line">								"cwd": "/var/www/html/wordpress"</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;,</span><br><span class="line">						"services": &#123;</span><br><span class="line">							"sysvinit": &#123;</span><br><span class="line">								"httpd": &#123;</span><br><span class="line">									"enabled": "true",</span><br><span class="line">									"ensureRunning": "true"</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"EbsOptimized": false,</span><br><span class="line">				"ImageId": &#123;"Fn::FindInMap": ["EC2RegionMap", &#123;"Ref": "AWS::Region"&#125;, "AmazonLinuxAMIHVMEBSBacked64bit"]&#125;,</span><br><span class="line">				"InstanceType": "t2.micro",</span><br><span class="line">				"SecurityGroups": [&#123;"Ref": "WebServerSecurityGroup"&#125;],</span><br><span class="line">				"KeyName": &#123;"Ref": "KeyName"&#125;,</span><br><span class="line">				"AssociatePublicIpAddress": true,</span><br><span class="line">				"UserData": &#123;"Fn::Base64": &#123;"Fn::Join": ["", [</span><br><span class="line">					"#!/bin/bash -ex\n",</span><br><span class="line">					"yum update -y aws-cfn-bootstrap\n",</span><br><span class="line">					"/opt/aws/bin/cfn-init -v --stack ", &#123;"Ref": "AWS::StackName"&#125;, " --resource LaunchConfiguration --region ", &#123;"Ref": "AWS::Region"&#125;, "\n",</span><br><span class="line">					"/opt/aws/bin/cfn-signal -e $? --stack ", &#123;"Ref": "AWS::StackName"&#125;, " --resource AutoScalingGroup --region ", &#123;"Ref": "AWS::Region"&#125;, "\n"</span><br><span class="line">				]]&#125;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		"AutoScalingGroup": &#123;</span><br><span class="line">			"Type": "AWS::AutoScaling::AutoScalingGroup",</span><br><span class="line">			"Properties": &#123;</span><br><span class="line">				"LoadBalancerNames": [&#123;"Ref": "LoadBalancer"&#125;],</span><br><span class="line">				"LaunchConfigurationName": &#123;"Ref": "LaunchConfiguration"&#125;,</span><br><span class="line">				"MinSize": "2",</span><br><span class="line">				"MaxSize": "2",</span><br><span class="line">				"DesiredCapacity": "2",</span><br><span class="line">				"VPCZoneIdentifier": [&#123;"Ref": "SubnetA"&#125;, &#123;"Ref": "SubnetB"&#125;]</span><br><span class="line">			&#125;,</span><br><span class="line">			"CreationPolicy": &#123;</span><br><span class="line">				"ResourceSignal": &#123;</span><br><span class="line">					"Timeout": "PT10M"</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			"DependsOn": "VPCGatewayAttachment"</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	"Outputs": &#123;</span><br><span class="line">		"URL": &#123;</span><br><span class="line">			"Value": &#123;"Fn::Join": ["", ["http://", &#123;"Fn::GetAtt": ["LoadBalancer", "DNSName"]&#125;, "/wordpress"]]&#125;,</span><br><span class="line">			"Description": "Wordpress URL"</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/28/iOS 编程：UIRefreshControl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/28/iOS 编程：UIRefreshControl/" class="post-title-link" itemprop="url">iOS 编程：UIRefreshControl</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-28 15:10:00" itemprop="dateCreated datePublished" datetime="2018-12-28T15:10:00+08:00">2018-12-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:51:06" itemprop="dateModified" datetime="2019-05-01T20:51:06+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">650</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h3>UIRefreshControl</h3>
<p>示例代码：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@implementation MyViewController</span><br><span class="line">&#123;</span><br><span class="line">    UIRefreshControl * refreshControl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">        </span><br><span class="line">    // 刷新控件</span><br><span class="line">    refreshControl = [[UIRefreshControl alloc] init];</span><br><span class="line">    [refreshControl addTarget:self action:@selector(refreshCallback) forControlEvents:UIControlEventValueChanged];</span><br><span class="line">    [self.tableView addSubview:refreshControl];</span><br><span class="line">    </span><br><span class="line">    [self prepareDemoData];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - IBActions</span><br><span class="line"></span><br><span class="line">// 刷新控件触发方法</span><br><span class="line">-(void) refreshCallback</span><br><span class="line">&#123;</span><br><span class="line">    // Run job...</span><br><span class="line">    [_tableView reloadData];</span><br><span class="line">    [refreshControl endRefreshing];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3>推荐阅读</h3>
<ul>
<li><a href="https://medium.com/@ann.green/loading-indicators-e9d9ac9680b" target="_blank" rel="noopener">Medium：Loading Indicators</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/26/MGSwipeTableCell——为 cell 添加带过渡动画的工具按钮/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/26/MGSwipeTableCell——为 cell 添加带过渡动画的工具按钮/" class="post-title-link" itemprop="url">MGSwipeTableCell——为 cell 添加带过渡动画的工具按钮</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-26 18:00:00" itemprop="dateCreated datePublished" datetime="2018-12-26T18:00:00+08:00">2018-12-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:58:26" itemprop="dateModified" datetime="2019-05-01T20:58:26+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS-开源框架/" itemprop="url" rel="index"><span itemprop="name">iOS 开源框架</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">11k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">10 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>GitHub: <a href="https://github.com/MortimerGoro/MGSwipeTableCell" target="_blank" rel="noopener">MGSwipeTableCell</a></li>
<li>Star: 6500+</li>
</ul>
<h1>MGSwipeTableCell</h1>
<p>MGSwipeTableCell 是一个易于使用的 UITableViewCell 子类，允许显示具有各种过渡效果的可滑动按钮。</p>
<p>该库与创建 UITableViewCell 的所有不同方法兼容：系统预定义样式，以编程方式创建的 cell，从 xib 加载的单元格以及故事板中的原型cell。 如果需要，您也可以使用 autolayout。</p>
<p>适用于 iOS&gt; = 5.0 版本。 在 iPhone 和 iPad 上的所有 iOS 版本上进行测试：iOS 7，iOS 8，iOS 9，iOS 10，iOS 11。</p>
<h2>过渡动画演示</h2>
<h3>Border transition - 边缘过渡</h3>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075044.gif" alt="1.gif"></p>
<h3>Clip transition - 剪辑过渡</h3>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075045.gif" alt="2.gif"></p>
<h3>3D transition - 3D 过渡</h3>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075046.gif" alt="3.gif"></p>
<h3>Static transition - 静态过渡</h3>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075048.gif" alt="4.gif"></p>
<h3>Drag transition - 拖动过渡</h3>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075050.gif" alt="5.gif"></p>
<p>&lt;!-- more --&gt;</p>
<h2>API 参考</h2>
<p>参见 <a href="MGSwipeTableCell/MGSwipeTableCell.h"><code>MGSwipeTableCell.h</code></a> 头文件查看有关该类功能的完整概述。
参见 <a href="demo/MailAppDemo"><code>MailAppDemo</code></a> 查看一个模仿 Apple 的邮件应用程序的完整项目（用 Objective-C 编写）。
参见 <a href="demo/MailAppDemoSwift"><code>MailAppDemoSwift</code></a> 查看一个模仿 Apple 的邮件应用程序的完整项目（用 Swift 编写）。
参见 <a href="demo/SpotifyDemo"><code>SpotifyDemo</code></a> 查看一个模仿 Spotify App 滑动样式的完整项目。
参见 <a href="demo/MGSwipeDemo"><code>MGSwipeDemo</code></a> 查看一个完整的项目示例，您可以在真实设备 / 模拟器上测试各种过渡。</p>
<h2>项目设置</h2>
<p>You can use CocoaPods to include MGSwipeTableCell into you project:</p>
<pre><code>pod 'MGSwipeTableCell'
</code></pre>
<p>You can use Carthage to include MGSwipeTableCell into your project. Just add this dependency to your Cartfile:
​<br>
​    github &quot;MortimerGoro/MGSwipeTableCell&quot;</p>
<h2>用法</h2>
<h3>概述</h3>
<p>在项目中集成 MGSwipeTableCell 非常简单。 基本上，你只需继承 MGSwipeTableCell 而不是 UITableViewCell，或直接使用 iOS 预定义单元格样式实例化 MGSwipeTableCell 实例。 你可以按照以前的方式布置单元格内容，MGSwipeTableCell 不会强制您更改布局。</p>
<p>以下是使用 iOS 预定义样式的 MGSwipeTableCell 的示例。 您可以将按钮数组设置为 cell.leftButtons 和 / 或 cell.rightButtons 属性。 MGSwipeButton 是一个便利类，你不必被迫使用它。 你可以使用自己的 UIButtons 或 UIViews。 你也可以使用 leftSwipeSettings 和 / 或 rightSwipeSettings 属性配置转场（和滑动阈值）</p>
<h5>Objective-C</h5>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSString</span> * reuseIdentifier = <span class="string">@"programmaticCell"</span>;</span><br><span class="line">    MGSwipeTableCell * cell = [<span class="keyword">self</span>.tableView dequeueReusableCellWithIdentifier:reuseIdentifier];</span><br><span class="line">    <span class="keyword">if</span> (!cell) &#123;</span><br><span class="line">        cell = [[MGSwipeTableCell alloc] initWithStyle:<span class="built_in">UITableViewCellStyleSubtitle</span> reuseIdentifier:reuseIdentifier];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cell.textLabel.text = <span class="string">@"Title"</span>;</span><br><span class="line">    cell.detailTextLabel.text = <span class="string">@"Detail text"</span>;</span><br><span class="line">    cell.delegate = <span class="keyword">self</span>; <span class="comment">//optional</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置左边按钮</span></span><br><span class="line">    cell.leftButtons = @[[MGSwipeButton buttonWithTitle:<span class="string">@""</span> icon:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"check.png"</span>] backgroundColor:[<span class="built_in">UIColor</span> greenColor]],</span><br><span class="line">                          [MGSwipeButton buttonWithTitle:<span class="string">@""</span> icon:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"fav.png"</span>] backgroundColor:[<span class="built_in">UIColor</span> blueColor]]];</span><br><span class="line">    <span class="comment">// 按钮过渡样式,3D转换</span></span><br><span class="line">    cell.leftSwipeSettings.transition = MGSwipeTransition3D;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置右边按钮</span></span><br><span class="line">    cell.rightButtons = @[[MGSwipeButton buttonWithTitle:<span class="string">@"Delete"</span> backgroundColor:[<span class="built_in">UIColor</span> redColor]],</span><br><span class="line">                           [MGSwipeButton buttonWithTitle:<span class="string">@"More"</span> backgroundColor:[<span class="built_in">UIColor</span> lightGrayColor]]];</span><br><span class="line">    cell.rightSwipeSettings.transition = MGSwipeTransition3D;</span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5>Swift</h5>
<p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> reuseIdentifier = <span class="string">"programmaticCell"</span></span><br><span class="line">    <span class="keyword">var</span> cell = tableView.dequeueReusableCell(withIdentifier: reuseIdentifier, <span class="keyword">for</span>: indexPath) <span class="keyword">as</span>! <span class="type">MGSwipeTableCell</span></span><br><span class="line"></span><br><span class="line">    cell.textLabel!.text = <span class="string">"Title"</span></span><br><span class="line">    cell.detailTextLabel!.text = <span class="string">"Detail text"</span></span><br><span class="line">    cell.delegate = <span class="keyword">self</span> <span class="comment">//optional</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//configure left buttons</span></span><br><span class="line">    cell.leftButtons = [<span class="type">MGSwipeButton</span>(title: <span class="string">""</span>, icon: <span class="type">UIImage</span>(named:<span class="string">"check.png"</span>), backgroundColor: .green),</span><br><span class="line">                        <span class="type">MGSwipeButton</span>(title: <span class="string">""</span>, icon: <span class="type">UIImage</span>(named:<span class="string">"fav.png"</span>), backgroundColor: .blue)]</span><br><span class="line">    cell.leftSwipeSettings.transition = .rotate3D</span><br><span class="line"></span><br><span class="line">    <span class="comment">//configure right buttons</span></span><br><span class="line">    cell.rightButtons = [<span class="type">MGSwipeButton</span>(title: <span class="string">"Delete"</span>, backgroundColor: .red),</span><br><span class="line">                         <span class="type">MGSwipeButton</span>(title: <span class="string">"More"</span>,backgroundColor: .lightGray)]</span><br><span class="line">    cell.rightSwipeSettings.transition = .rotate3D</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cell</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>为了监听按钮点击事件，你可以实现可选的 MGSwipeTableCellDelegate 协议，或者如果您懒得这样做，MGSwipeButton 类也附带一个便捷 block 回调;）</p>
<h5>Objective-c</h5>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建按钮时，同时设置 block 回调</span></span><br><span class="line">[MGSwipeButton buttonWithTitle:<span class="string">@"More"</span> backgroundColor:[<span class="built_in">UIColor</span> lightGrayColor] callback:^<span class="built_in">BOOL</span>(MGSwipeTableCell *sender) &#123;</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"Convenience callback for swipe buttons!"</span>);</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<h5>Swift</h5>
<p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MGSwipeButton</span>(title: <span class="string">"Delete"</span>, backgroundColor: .red) &#123;</span><br><span class="line">      (sender: <span class="type">MGSwipeTableCell!</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">      <span class="built_in">print</span>(<span class="string">"Convenience callback for swipe buttons!"</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3>Delegate - 代理协议</h3>
<p>MGSwipeTableCellDelegate 是一个可选的委托协议，用于配置滑动按钮或接收触发的操作或其他事件。 按钮可以在cell 被创建时内联配置，如果你不想使用此委托方法。但是使用委托可以提高内存使用率，因为按钮仅按需创建。</p>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MGSwipeTableCellDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Delegate method to enable/disable swipe gestures</span></span><br><span class="line"><span class="comment"> * 开关</span></span><br><span class="line"><span class="comment"> * @return YES if swipe is allowed</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">-(<span class="built_in">BOOL</span>) swipeTableCell:(MGSwipeTableCell*) cell canSwipe:(MGSwipeDirection) direction;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Delegate method invoked when the current swipe state changes</span></span><br><span class="line"><span class="comment"> * 当前滑动状态更改时调用的 Delegate 方法</span></span><br><span class="line"><span class="comment"> @param state the current Swipe State</span></span><br><span class="line"><span class="comment"> @param gestureIsActive YES if the user swipe gesture is active. No if the uses has already ended the gesture</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">-(<span class="keyword">void</span>) swipeTableCell:(MGSwipeTableCell*) cell didChangeSwipeState:(MGSwipeState) state gestureIsActive:(<span class="built_in">BOOL</span>) gestureIsActive;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Called when the user clicks a swipe button or when a expandable button is automatically triggered</span></span><br><span class="line"><span class="comment"> * 当用户单击滑动按钮或自动触发可展开按钮时调用</span></span><br><span class="line"><span class="comment"> * @return YES to autohide the current swipe buttons</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">-(<span class="built_in">BOOL</span>) swipeTableCell:(MGSwipeTableCell*) cell tappedButtonAtIndex:(<span class="built_in">NSInteger</span>) index direction:(MGSwipeDirection)direction fromExpansion:(<span class="built_in">BOOL</span>) fromExpansion;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Delegate method to setup the swipe buttons and swipe/expansion settings</span></span><br><span class="line"><span class="comment"> * 配置按钮协议方法</span></span><br><span class="line"><span class="comment"> * Buttons can be any kind of UIView but it's recommended to use the convenience MGSwipeButton class</span></span><br><span class="line"><span class="comment"> * Setting up buttons with this delegate instead of using cell properties improves memory usage because buttons are only created in demand</span></span><br><span class="line"><span class="comment"> * @param swipeTableCell the UITableViewCell to configure. You can get the indexPath using [tableView indexPathForCell:cell]</span></span><br><span class="line"><span class="comment"> * @param direction The swipe direction (left to right or right to left)</span></span><br><span class="line"><span class="comment"> * @param swipeSettings instance to configure the swipe transition and setting (optional)</span></span><br><span class="line"><span class="comment"> * @param expansionSettings instance to configure button expansions (optional)</span></span><br><span class="line"><span class="comment"> * @return Buttons array</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">-(<span class="built_in">NSArray</span>*) swipeTableCell:(MGSwipeTableCell*) cell swipeButtonsForDirection:(MGSwipeDirection)direction</span><br><span class="line">             swipeSettings:(MGSwipeSettings*) swipeSettings expansionSettings:(MGSwipeExpansionSettings*) expansionSettings;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h3>Expandable buttons - 可扩展按钮</h3>
<p>默认情况下，按钮不可扩展。 你可以使用 cell.leftExpansion 和 cell.rightExpansion 属性设置可扩展按钮</p>
<p>当用户结束滑动手势并且扩展处于活动状态时（可通过阈值配置），将自动触发可扩展按钮事件。 触发的可扩展按钮可以弹回到其初始位置或填充整个 UITableViewCell，您可以使用 fillOnTrigger 属性选择所需的动画。</p>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MGSwipeExpansionSettings</span>: <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/** index of the expandable button (in the left or right buttons arrays) */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">NSInteger</span> buttonIndex;</span><br><span class="line"><span class="comment">/** if true the button fills the cell on trigger, else it bounces back to its initial position */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> fillOnTrigger;</span><br><span class="line"><span class="comment">/** Size proportional threshold to trigger the expansion button. Default value 1.5 */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> threshold;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<h3>Rounded corners and swipe buttons - 圆角和滑动按钮</h3>
<p>MGSwipeTableCell 支持圆角。 例：</p>
<p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cell.layer.cornerRadius = <span class="number">50</span></span><br><span class="line">cell.backgroundColor = <span class="built_in">UIColor</span>.gray</span><br><span class="line">cell.clipsToBounds = <span class="literal">true</span></span><br><span class="line">cell.swipeBackgroundColor = <span class="built_in">UIColor</span>.gray</span><br></pre></td></tr></table></figure></p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075051.jpg" alt="RoundTableViewCell"></p>
<h2>License - 许可证</h2>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2014 Imanol Fernandez @MortimerGoro</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
<h3>示例代码</h3>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - MGSwipeTableCellDelegate</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Delegate method to setup the swipe buttons and swipe/expansion settings</span><br><span class="line"> * Buttons can be any kind of UIView but it&apos;s recommended to use the convenience MGSwipeButton class</span><br><span class="line"> * Setting up buttons with this delegate instead of using cell properties improves memory usage because buttons are only created in demand</span><br><span class="line"> * @param cell the UITableViewCell to configure. You can get the indexPath using [tableView indexPathForCell:cell]</span><br><span class="line"> * @param direction The swipe direction (left to right or right to left)</span><br><span class="line"> * @param swipeSettings instance to configure the swipe transition and setting (optional)</span><br><span class="line"> * @param expansionSettings instance to configure button expansions (optional)</span><br><span class="line"> * @return Buttons array</span><br><span class="line"> **/</span><br><span class="line">-(nullable NSArray&lt;UIView*&gt;*) swipeTableCell:(nonnull MGSwipeTableCell*) cell swipeButtonsForDirection:(MGSwipeDirection)direction</span><br><span class="line">                               swipeSettings:(nonnull MGSwipeSettings*) swipeSettings expansionSettings:(nonnull MGSwipeExpansionSettings*) expansionSettings &#123;</span><br><span class="line">    </span><br><span class="line">    if (direction == MGSwipeDirectionRightToLeft) &#123;</span><br><span class="line">        // MGSwipeSettings 按钮设置</span><br><span class="line">        swipeSettings.transition = MGSwipeTransitionBorder;</span><br><span class="line">        swipeSettings.threshold = 1.5; // 工具按钮被显示出来的阈值 （手势拉伸的长度/按钮自身宽度）</span><br><span class="line">        swipeSettings.keepButtonsSwiped = YES; // 手势停止时，按钮是否自动隐藏</span><br><span class="line">        </span><br><span class="line">        // MGSwipeExpansionSettings 拉伸设置</span><br><span class="line">        expansionSettings.buttonIndex = 0; // 被拉伸的按钮索引</span><br><span class="line">        expansionSettings.fillOnTrigger = NO; // 拉伸时是否填充整个 cell</span><br><span class="line">        expansionSettings.threshold = 2.0; // 拉伸动作被触发的阈值（与按钮的宽度相关）</span><br><span class="line">        </span><br><span class="line">        // 删除按钮</span><br><span class="line">        CGFloat padding = 20; // 按钮右侧 - contentView 右侧边距</span><br><span class="line">        MGSwipeButton *trashButton = [MGSwipeButton buttonWithTitle:@&quot;&quot; icon:[UIImage imageNamed:@&quot;trash&quot;] backgroundColor:[UIColor clearColor] padding:padding];</span><br><span class="line">        return @[trashButton];</span><br><span class="line">    &#125;</span><br><span class="line">    return nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 当用户单击滑动按钮或可展开按钮被自动自动触发时调用</span><br><span class="line"> * Called when the user clicks a swipe button or when a expandable button is automatically triggered</span><br><span class="line"> * @return YES to autohide the current swipe buttons</span><br><span class="line"> **/</span><br><span class="line">-(BOOL) swipeTableCell:(nonnull MGSwipeTableCell*) cell tappedButtonAtIndex:(NSInteger) index direction:(MGSwipeDirection)direction fromExpansion:(BOOL) fromExpansion &#123;</span><br><span class="line">    </span><br><span class="line">    // 删除按钮触发事件</span><br><span class="line">    if (direction == MGSwipeDirectionRightToLeft &amp;&amp; index == 0) &#123;</span><br><span class="line">        // 这里直接删除，业务层还需要做删除前的提示和判断的！！！</span><br><span class="line">        NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];</span><br><span class="line">        [self.dataSourceArray removeObjectAtIndex:indexPath.row];</span><br><span class="line">        [self.tableView deleteRowAtIndexPath:indexPath withRowAnimation:UITableViewRowAnimationLeft];</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3>参考</h3>
<ul>
<li><a href="https://github.com/CEWendel/SWTableViewCell" target="_blank" rel="noopener">GitHub：SWTableViewCell</a> ⭐️ 7000+，但是这个库好像很久没有更新了（最后更新是4年前。。。）</li>
<li><a href="https://github.com/MortimerGoro/MGSwipeTableCell" target="_blank" rel="noopener">GitHub：MGSwipeTableCell</a> ⭐️6500+</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/25/iOS 集成微信支付SDK/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/25/iOS 集成微信支付SDK/" class="post-title-link" itemprop="url">iOS 集成微信支付SDK</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-25 17:07:00" itemprop="dateCreated datePublished" datetime="2018-12-25T17:07:00+08:00">2018-12-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:51:41" itemprop="dateModified" datetime="2019-05-01T20:51:41+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">7.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>微信支付SDK 版本：1.8.3</p>
<h2>参考</h2>
<ul>
<li><a href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=8_1" target="_blank" rel="noopener">微信支付开发文档</a> ⭐️</li>
<li><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=1417694084&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">微信开放平台 - iOS接入指南</a> ⭐️⭐️⭐️</li>
<li><a href="https://kf.qq.com/faq/161226bymQ3y161226yQbmQv.html" target="_blank" rel="noopener">微信支付APP商户截图标准示范</a></li>
<li><a href="https://www.jianshu.com/p/867563a1f080" target="_blank" rel="noopener">简书 - iOS-微信支付总结</a></li>
<li><a href="https://www.jianshu.com/p/162ece335b31" target="_blank" rel="noopener">简书 - 微信支付</a></li>
<li><a href="https://juejin.im/post/5ac32a7c51882555677ebeb3" target="_blank" rel="noopener">掘金 - iOS 微信支付接入以及工具类封装</a></li>
<li><a href="https://github.com/renzifeng/WXPay" target="_blank" rel="noopener">GitHub：WXPay</a> - 微信支付讲解示例 ⭐️⭐️⭐️</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>iOS 接入指南</h2>
<blockquote>
<p>讲解 iOS 接入微信SDK，仅记录关键部分代码，其余在官方文档或网络文章中都已详述备尽，此处不再赘述。</p>
</blockquote>
<h3>1. 向微信注册你的应用程序 id</h3>
<p>（略。。。）</p>
<h3>2. 下载微信终端 SDK 文件</h3>
<p>集成微信 SDK 有两种方式：</p>
<ol>
<li>
<p>手动集成，<a href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=11_1" target="_blank" rel="noopener">下载 SDK </a>然后拖拽相关库文件到你的项目中；</p>
</li>
<li>
<p>通过 CocoaPods 集成：</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &apos;WechatOpenSDK&apos;, &apos;~&gt; 1.8.3&apos;</span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<h3>3. 开发环境搭建</h3>
<h4>3.1 设置 TARGETS ，在 URL Types 中添加应用程序 id。</h4>
<p>（略。。。）</p>
<h4>3.2 设置微信白名单</h4>
<p>在 Xcode 中，选择你的工程设置项，选中 “TARGETS” 一栏，在 “info” 标签栏的 “LSApplicationQueriesSchemes“添加 weixin：</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075930.jpg" alt="weix"></p>
<p>⚠️ 这个步骤用于判断微信是否安装（<code>[WXApi isWXAppInstalled]</code>）</p>
<p>详细可以参见 <a href="https://www.jianshu.com/p/a1895c766400" target="_blank" rel="noopener">LSApplicationQueriesSchemes-- 关于 info.plist 第三方登录 添加 URL Schemes 白名单</a></p>
<h3>4. 在项目中添加代码</h3>
<p>为了使项目代码更清晰简洁（解耦合思想），我创建了一个范畴（Category）类专门存放微信支付相关的代码：</p>
<h4>4.1 AppDelegate+WechatPayService.h</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;AppDelegate.h&quot;</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 集成微信支付</span><br><span class="line"> */</span><br><span class="line">@interface AppDelegate (WechatPayService)</span><br><span class="line"></span><br><span class="line">// 配置方法，用于向微信终端注册应用 id</span><br><span class="line">- (void)hql_configureForWechatPay;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure></p>
<h4>4.2 AppDelegate+WechatPayService.m</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;AppDelegate+WechatPayService.h&quot;</span><br><span class="line">#import &lt;WechatOpenSDK/WXApi.h&gt; // 引入微信 SDK</span><br><span class="line"></span><br><span class="line">@interface AppDelegate () &lt;WXApiDelegate&gt; // 遵守 SDK 协议</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation AppDelegate (WechatPayService)</span><br><span class="line"></span><br><span class="line">#pragma mark - Public</span><br><span class="line"></span><br><span class="line">- (void)hql_configureForWechatPay &#123;</span><br><span class="line">    //向微信注册</span><br><span class="line">    //注：WechatAppId 是常量，已经写在了预编译配置文件中</span><br><span class="line">    //#define WechatAppId @&quot;wx12345...67890&quot;</span><br><span class="line">    [WXApi registerApp:WechatAppId];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - WeChatPay</span><br><span class="line"></span><br><span class="line">// NOTE: 9.0以后使用新API接口</span><br><span class="line">- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary&lt;NSString*, id&gt; *)options &#123;</span><br><span class="line">    return [WXApi handleOpenURL:url delegate:(id&lt;WXApiDelegate&gt;)self];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*! @brief 发送一个sendReq后，收到微信的回应</span><br><span class="line"> *</span><br><span class="line"> * 收到一个来自微信的处理结果。调用一次sendReq后会收到onResp。</span><br><span class="line"> * 可能收到的处理结果有SendMessageToWXResp、SendAuthResp等。</span><br><span class="line"> * @param resp具体的回应内容，是自动释放的</span><br><span class="line"> */</span><br><span class="line">-(void) onResp:(BaseResp*)resp &#123;</span><br><span class="line">    // 微信支付成功/失败，发起通知查询</span><br><span class="line">    // 注：HQLWechatPayOnResponceNotification 通知方法名是常量，统一写在配置文件中</span><br><span class="line">    // #define HQLWechatPayOnResponceNotification @&quot;HQLWechatPayOnResponceNotification&quot;</span><br><span class="line">    [[NSNotificationCenter defaultCenter] postNotificationName:HQLWechatPayOnResponceNotification</span><br><span class="line">                                                        object:(BaseReq *)resp];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure></p>
<h4>4.3 AppDelegate.m</h4>
<p><strong>AppDelegate+WechatPayService</strong> 文件写好后，这里可以直接使用了。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;AppDelegate.h&quot;</span><br><span class="line">#import &quot;AppDelegate+WechatPayService.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation AppDelegate</span><br><span class="line"></span><br><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    [self hql_configureForWechatPay]; // 是的，只有一行配置代码</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3>5. 发起微信支付代码</h3>
<h4>交互数据模型</h4>
<p>先来看一下商户服务端返回的 JSON 数据格式：</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    appid = "wx12345...678906"; （应用 ID）</span><br><span class="line">    noncestr = "FS7JBpYQ5TzkyfcV"; （随机字符串）</span><br><span class="line">    package = "Sign=WXPay"; （扩展字段，默认值）</span><br><span class="line">    partnerid = "12345674321"; （商户号）</span><br><span class="line">    prepayid = "wx2530149711249kd7b531c00a2446020522"; （预支付交易会话 ID）</span><br><span class="line">    sign = "BEE9FA6FCD14D286CCCD4EE7DC74578B"; （签名）</span><br><span class="line">    timestamp = 1545704053 （时间戳，精确到秒，10位！！！）</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后写一个模型类来映射 JSON 数据，如下，JSON 解析可以使用 <a href="https://github.com/ibireme/YYModel" target="_blank" rel="noopener">YYModel</a> 库。</p>
<h4>HQLWechatPayRequestModel.h</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 微信支付，服务器返回支付参数模型</span><br><span class="line"> */</span><br><span class="line">@interface HQLWechatPayRequestModel : NSObject</span><br><span class="line"></span><br><span class="line">/** 应用 ID */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *appid;</span><br><span class="line">/** 商家向财付通申请的商家 ID */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *partnerid;</span><br><span class="line">/** 预支付订单 */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *prepayid;</span><br><span class="line">/** 商家根据财付通文档填写的数据和签名，默认值为 Sign=WXPay */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *package;</span><br><span class="line">/** 随机串，防重发 */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *noncestr;</span><br><span class="line">/** 时间戳，防重发 */</span><br><span class="line">@property (nonatomic, assign, readonly) UInt32 timestamp;</span><br><span class="line">/** 商家根据微信开放平台文档对数据做的签名 */</span><br><span class="line">@property (nonatomic, copy, readonly) NSString *sign;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure></p>
<h4>HQLWechatPayRequestModel.m</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;HQLWechatPayRequestModel.h&quot;</span><br><span class="line"></span><br><span class="line">@interface HQLWechatPayRequestModel ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *appid;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *partnerid;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *prepayid;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *package;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *noncestr;</span><br><span class="line">@property (nonatomic, assign, readwrite) UInt32 timestamp;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *sign;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation HQLWechatPayRequestModel</span><br><span class="line"></span><br><span class="line">#pragma mark - NSObject</span><br><span class="line"></span><br><span class="line">- (NSString *)description &#123;</span><br><span class="line">    return [self modelDescription];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure></p>
<h4>发起微信支付</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;HQLWeChatPayViewController.h&quot;</span><br><span class="line"></span><br><span class="line">// Frameworks</span><br><span class="line">#import &lt;WechatOpenSDK/WXApi.h&gt;</span><br><span class="line">#import &lt;WechatOpenSDK/WXApiObject.h&gt;</span><br><span class="line"></span><br><span class="line">// Models</span><br><span class="line">#import &quot;HQLWechatPayRequestModel.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation HQLThirdPartyPayViewController</span><br><span class="line"></span><br><span class="line">#pragma mark - Lifecycle</span><br><span class="line"></span><br><span class="line">- (void)dealloc &#123;</span><br><span class="line">    // 移除微信支付通知</span><br><span class="line">    [[NSNotificationCenter defaultCenter] removeObserver:self];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">  </span><br><span class="line">    // 添加微信支付通知</span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self</span><br><span class="line">                                             selector:@selector(respondsToWechatPayNotification:)</span><br><span class="line">                                                 name:HQLWechatPayOnResponceNotification</span><br><span class="line">                                               object:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - Private</span><br><span class="line"></span><br><span class="line">// 判断用户设备是否支持微信支付</span><br><span class="line">- (BOOL)isSupportWechatPay &#123;</span><br><span class="line">    // 1.判断是否安装微信</span><br><span class="line">    if (![WXApi isWXAppInstalled]) &#123;</span><br><span class="line">        // 业务代码，提示微信未安装...</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line">    // 2.判断微信的版本是否支持最新API</span><br><span class="line">    if (![WXApi isWXAppSupportApi]) &#123;</span><br><span class="line">        // 业务代码，提示微信当前版本不支持此功能...</span><br><span class="line">        return NO;</span><br><span class="line">    &#125;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 响应微信支付回调通知</span><br><span class="line">- (void)respondsToWechatPayNotification:(NSNotification *)notification &#123;</span><br><span class="line">    BaseResp *responds = notification.object;</span><br><span class="line">    switch (responds.errCode) &#123;</span><br><span class="line">        case WXSuccess: &#123;</span><br><span class="line">            // 1. 微信支付成功</span><br><span class="line">            // ...</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        case WXErrCodeCommon: &#123;</span><br><span class="line">            // 2. 微信支付失败</span><br><span class="line">            // ...</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        case WXErrCodeUserCancel: &#123;</span><br><span class="line">            // 3. 用户点击取消并返回</span><br><span class="line">            // ...</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        default: &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 发起支付请求</span><br><span class="line">- (void)dealWithOrderPay &#123;</span><br><span class="line">    // 业务逻辑，先向服务器发起预支付请求，服务器返回支持订单信息。</span><br><span class="line">    // ...</span><br><span class="line">    </span><br><span class="line">    // 先判断是否支持微信支付</span><br><span class="line">    if ([self isSupportWechatPay]) &#123;</span><br><span class="line">        // 解析服务端返回的支付参数</span><br><span class="line">        NSDictionary *payDictionary;</span><br><span class="line">        // 使用 YYModel 将 JSON 数据转化为数据模型 HQLWechatPayRequestModel</span><br><span class="line">        HQLWechatPayRequestModel *payRequestModel = [HQLWechatPayRequestModel modelWithJSON:payDictionary];</span><br><span class="line">        // 向微信终端发起支付的消息结构体</span><br><span class="line">        PayReq *request = [[PayReq alloc] init];</span><br><span class="line">        request.partnerId = payRequestModel.partnerid;</span><br><span class="line">        request.prepayId = payRequestModel.prepayid;</span><br><span class="line">        request.package = payRequestModel.package;</span><br><span class="line">        request.nonceStr = payRequestModel.noncestr;</span><br><span class="line">        request.timeStamp = payRequestModel.timestamp;</span><br><span class="line">        request.sign = payRequestModel.sign;</span><br><span class="line">        // 发起微信支付</span><br><span class="line">        [WXApi sendReq:request];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure></p>
<p>That's all.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/19/块存储&对象存储&文件存储/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/19/块存储&对象存储&文件存储/" class="post-title-link" itemprop="url">块存储&对象存储&文件存储</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-19 10:25:00" itemprop="dateCreated datePublished" datetime="2018-12-19T10:25:00+08:00">2018-12-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:44:09" itemprop="dateModified" datetime="2019-05-01T20:44:09+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/云计算/" itemprop="url" rel="index"><span itemprop="name">云计算</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">683</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h3>块存储</h3>
<p>是阿里云为 ECS 云服务器提供的块设备，高性能、低时延，满足随机读写，可以像使用物理硬盘一样格式化建文件系统使用。可用于大部分通用业务场景下的数据存储。</p>
<h3>文件存储（NAS）</h3>
<p>类似于对象存储，适合存储非结构化的海量数据。但是您需要通过标准的文件访问协议访问这些数据，比如 <strong>Linux 系统需要使用 Network File System (NFS) 协议，Windows 系统需要使用 Common Internet File System (CIFS) 协议</strong>。您可以通过设置权限让不同的客户端同时访问同一份文件。</p>
<p><strong>适用场景</strong>：文件共享 | 网站文件、代码存储 | 数据备份 | 日志存储 | 数据分析 | Docker 存储 | Hadoop 存储 | 广电非编 | 动画渲染 | 图片、视频。</p>
<h3>对象存储（OSS）</h3>
<p>可以理解是一个海量的存储空间，最适合存储互联网上产生
的图片、短视频、音频等海量非结构化数据，您可以通过 API 在任何时间、任何地点访问对象存储里的数据。常用于互联网业务网站搭建、动静资源分离、CDN 加速等业务场景。</p>
<p><strong>适用场景</strong>：
标准类型：移动应用 | 大型网站 | 图片分享 | 热点音视频 |
低频访问类型： 移动设备 | 应用与企业数据备份 | 监控数据 | 网盘应用
归档类型：各种长期保存的档案数据 | 医疗影像 | 影视素材</p>
<p>&lt;!-- more --&gt;</p>
<h3>参考</h3>
<ul>
<li><a href="http://blog.51cto.com/433266/2173153" target="_blank" rel="noopener">块存储、文件存储、对象存储这三者和分布式文件存储系统的本质区别</a> ⭐️⭐️⭐️</li>
<li><a href="https://www.jianshu.com/p/f54f0511171c" target="_blank" rel="noopener">云产品 OSS/NAS 选型</a></li>
<li><a href="https://help.aliyun.com/document_detail/27518.html?spm=a2c4g.11174283.6.542.5b674da2L3RQX4" target="_blank" rel="noopener">阿里云 - 文件存储</a></li>
<li><a href="https://help.aliyun.com/document_detail/27518.html?spm=a2c4g.11174283.6.542.5b674da2L3RQX4" target="_blank" rel="noopener">阿里云- 对象存储</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/18/代码片段工具/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/18/代码片段工具/" class="post-title-link" itemprop="url">代码片段工具</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-18 17:07:00" itemprop="dateCreated datePublished" datetime="2018-12-18T17:07:00+08:00">2018-12-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-01 20:43:54" itemprop="dateModified" datetime="2019-05-01T20:43:54+08:00">2019-05-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/开发工具-Mac应用/" itemprop="url" rel="index"><span itemprop="name">开发工具&Mac应用</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">272</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h3>一、<a href="https://www.renfei.org/snippets-lab/" target="_blank" rel="noopener">SnippetsLab</a></h3>
<p><a href="https://itunes.apple.com/cn/app/snippetslab/id1006087419?mt=12" target="_blank" rel="noopener">App Store</a> ¥30</p>
<ul>
<li>参考：<a href="https://sspai.com/post/30406" target="_blank" rel="noopener">SnippetsLab - 像纳博科夫写小说一样写代码</a></li>
</ul>
<h3>二、<a href="https://useforge.co/" target="_blank" rel="noopener">forge</a>：免费代码片段工具</h3>
<p>根据 Forge 开发者介绍，他们并不想把 Forge 变成「又一款」代码片段工具，而是真正能让开发变得高效的工作流。所以，Forge 在代码片段创建、检索、输入、分享等方面都做了易用性优化。
Forge 目前支持主流平台，开源免费，且提供云同步。</p>
<h3>三、Xcode</h3>
<p>另外，如果你只是用 Xcode 做 iOS 或者 Mac 开发，其实 Xcode 自带代码片段工具（Snippets）。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/17/Web 开发的身份数据和安全_3.身份安全基础/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/17/Web 开发的身份数据和安全_3.身份安全基础/" class="post-title-link" itemprop="url">Web 开发的身份数据和安全_3.身份安全基础</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-17 22:11:00" itemprop="dateCreated datePublished" datetime="2018-12-17T22:11:00+08:00">2018-12-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-17 15:09:18" itemprop="dateModified" datetime="2019-05-17T15:09:18+08:00">2019-05-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PKI-密码学/" itemprop="url" rel="index"><span itemprop="name">PKI&密码学</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">1.8k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">2 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>本文主要内容：在不同场合下如何验证和授权。</p>
<h1>理解不同的身份类型</h1>
<p><strong>身份</strong>：把个人和组织区分开的品性、信条等。——韦氏词典</p>
<p>根据网站的用途，身份可以分为：</p>
<ol>
<li>社会身份；</li>
<li>实际身份；</li>
<li>弱身份；</li>
</ol>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075100.jpg" alt="不同身份之间的重叠"></p>
<p>&lt;!-- more --&gt;</p>
<h2>社会身份</h2>
<p>人们随意分享的身份，真实性有限。主要内容：社交网络、社会联系、兴趣和爱好。</p>
<h2>实际身份</h2>
<p>真实的个人资料。如网银和电商中的电子邮箱、地址、电话号码、语言、年龄等。</p>
<p>选举和其他很多政府服务也通常使用实际身份。</p>
<h2>弱身份</h2>
<p>验证用户身份时不访问任何个人资料。如：如通过短信给手机发送一次性密码实现无密码登录。</p>
<h1>利用身份提升用户体验</h1>
<p>刚接触用户时没有必要让他们登录（有损用户转化率），而是提供功能预览，帮助用户决定是否要使用应用。</p>
<h2>信任区简介</h2>
<p>如今，我们使用的设备都预装了各种传感器，通过这些传感器可以收集用户所处环境的信息。GPS、WiFi、摄像头、加速计、陀螺仪、光线传感器等可用于构建用户的个人资料，然后据此认证用户的身份。把这个概念与身份结合起来，我们不仅可以认证用户的身份，还能构建起<span class="label info">信任区</span>。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/075102.jpg" alt="信任区"></p>
<ul>
<li>使用可用且独特的数据（例如用户的浏览器配置、硬件、设备、位置等信息）为用户创建数字指纹。</li>
<li>GPS 坐标、手机摄像头、指纹识别、声纹识别、可穿戴设备。</li>
<li>通过用户使用的系统和设备能收集足够的信息基本上确认用户就是他声称的那个人➡用户处在信任区中，减少用户再提供身份信任凭据的步骤。</li>
</ul>
<h3>浏览器指纹识别</h3>
<p>通过用户所用的浏览器具有的独特信息（例如首部、字体等）得出验证用户身份的第二个因素。</p>
<p>获取浏览器特性的方式：用户代理、插件、字体、HTTP ACCEPT 首部、屏幕分辨率、超级 cookie、时区、启用cookie...</p>
<h3>位置追踪</h3>
<p>使用用户的物理位置（GPS 数据）构建信任区。</p>
<p><div class="note warning">
            <p>物理位置可以伪造，而且结果也未必准确。</p>
          </div></p>
<h3>设备指纹识别（手机/平板）</h3>
<p>设备的硬件指纹：操作系统版本、设备名称、设备型号、框架的 SDK 版本、硬件序列号（IMEI 码）。</p>
<h3>设备指纹识别（蓝牙配对设备）</h3>
<p>将连接到手机上的硬件设备作为硬件指纹。</p>
<h1>身份认证的其他方法</h1>
<h2>双因素身份验证和 n 因素身份验证</h2>
<p>双因素身份验证（2FA）依赖一个单独的令牌，例如一次性密码，使用后即失效，因此能避免常见的安全漏洞，例如重放攻击。</p>
<h2>n 因素身份验证（MFA）</h2>
<p>假设每个人都具有三个基本的要素：</p>
<ul>
<li>知道的事情。（密码）</li>
<li>拥有的东西。（智能卡或 RSA 令牌、Google Authenticator、Au-thy）</li>
<li>自身的特征。（个体的身份、指纹）</li>
</ul>
<h2>一次性密码</h2>
<p>生成一次性密码的三种方式：</p>
<ol>
<li>采用时钟同步方式，生成短期令牌。（Authy 和 Google Authenticator）</li>
<li>基于数学算法，生成长期令牌。（短信验证码、电子邮件）</li>
</ol>
<h2>使用 Authy 实现双因素身份验证</h2>
<p>通过使用 Twilio 提供的身份验证服务 <a href="https://authy.com/" target="_blank" rel="noopener">Authy</a> 实现 2FA 功能：</p>
<ol>
<li>在服务中注册/删除 2FA 用户账户；</li>
<li>通过短信把验证码发给这些用户；</li>
<li>用户在网站中输入验证码时确认验证码；</li>
</ol>
<h2>使用生物特征代替密码</h2>
<p>移动设备的指纹扫描仪。</p>
<p>生物特征更适合看作一种证明身份的机制。</p>
<h2>如何评价生物特征的效果</h2>
<p>在身份验证场景下处理生物特征时一定要考虑假阳性率（误识率）。</p>
<ol>
<li>遵循官方的误识率要求。</li>
<li>限制尝试次数。</li>
</ol>
<h3>面部识别</h3>
<p>面部识别使用数字图像或视频识别人类。这个技术使用标志性特征匹配轮廓。</p>
<h3>视网膜和虹膜扫描</h3>
<p>通过人类眼球上的血管识别用户。</p>
<p>视网膜扫描：检测血管对光的吸收。</p>
<p>虹膜扫描：先获取眼球的图像，然后再做分析。</p>
<h3>静脉识别</h3>
<p>脉搏只有身体中有血液流动时才有。富士通为日本的 ATM 机部署了掌侧静脉识别。</p>
<h1>新出现的标准</h1>
<h2>FIDO Alliance</h2>
<p>FIDO 提供了两种解决方案：</p>
<ol>
<li>通用身份识别框架。</li>
<li>通用第二因素。</li>
</ol>
<h2>Oz</h2>
<p>Web 授权框架：https://github.com/hueniverse/oz</p>
<h2>区块链</h2>
<p>用户存储某些属性的证明，例如姓名、住址或生日，然后在任何能提供公钥的地方公开这些属性的加密哈希。这样个人就可以确认信息，而且能保证信息的真实性。这个概念的关键是决定分享哪些信息。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://andy0570.com/2018/12/17/Web 开发的身份数据和安全_2.密码加密、哈希和加盐/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="独木舟的木">
      <meta itemprop="description" content="有时候阳光很好 有时候阳光很暗">
      <meta itemprop="image" content="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="独木舟的木">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/17/Web 开发的身份数据和安全_2.密码加密、哈希和加盐/" class="post-title-link" itemprop="url">Web 开发的身份数据和安全_2.密码加密、哈希和加盐</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-17 13:47:00" itemprop="dateCreated datePublished" datetime="2018-12-17T13:47:00+08:00">2018-12-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-17 14:18:43" itemprop="dateModified" datetime="2019-05-17T14:18:43+08:00">2019-05-17</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PKI-密码学/" itemprop="url" rel="index"><span itemprop="name">PKI&密码学</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">4.7k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">4 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>本文主要内容：探讨密码加密和安全性。</p>
<p><img src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/wooden-shelf-with-laptop-and-notebook.jpg" alt="Photo on &amp;lt;a href=&amp;quot;https://visualhunt.com/re3/fa8128d7&amp;quot;&amp;gt;Visualhunt.com&amp;lt;/a&amp;gt;"></p>
<p>&lt;!-- more --&gt;</p>
<h1>静态数据&amp;动态数据</h1>
<p><strong>静态数据</strong>：不活动的（或静止的）数字数据，存储在服务器中，例如用于存储密码、个人资料、或其他应用所需数据的数据库。</p>
<p><strong>动态数据</strong>：传输中的数据，在应用和数据库之间来回发送，或者在网站和 API 或外部数据源之间来回传送。</p>
<h2>静态数据</h2>
<ul>
<li>数据库加密是绝对有必要的，尽管 99% 的团体没有这么做。</li>
<li>加密数据库应该使用强加密、受 NIST 认可的算法，如：SHA-256、AES、RSA。</li>
<li>遵循标准做法：1. 分开访问控制（用户登录）和数据加密；2. 定期更新加密数据库的密钥；3. 分开存储加密密钥和数据。</li>
<li>对全球覆盖的应用来说，可以使用<strong>数据联合</strong>避免恶意访问数据存储器，在需要个人信息的不同区域维护不同的数据库系统。</li>
<li>根据运行应用、网站或服务的需要，<strong>应该尽量少存储敏感的用户数据</strong>。</li>
<li>敏感的财务信息（例如信用卡数据）可以交由他方（支付提供商）处理。</li>
</ul>
<h2>动态数据</h2>
<p>动态数据的使用场景：</p>
<ul>
<li>用户填写的注册信息，用于访问账户和认证身份。</li>
<li>把个人档案信息传输给API服务，或从中获取。</li>
<li>应用或网站收集的其他数据，传给数据库存储起来。</li>
</ul>
<h2>密码攻击媒介</h2>
<ul>
<li>钓鱼；</li>
<li>社会工程；</li>
<li>暴力攻击；（抵抗方式：密钥延伸技术）
<ul>
<li>登录失败后显示验证码（<a href="https://www.google.com/recaptcha/intro/v3.html" target="_blank" rel="noopener">Google reCAPTCHA</a>、<a href="http://dun.163.com/trial/sense" target="_blank" rel="noopener">易盾 - 智能无感知验证码</a>），增加登录难度。</li>
<li>添加 2FA （双因素身份认证）机制。</li>
</ul>
</li>
<li>字典攻击；（抵抗方式：加盐）</li>
<li>彩虹表；（抵抗方式：加盐）</li>
<li>恶意软件；（抵抗方式：短信验证、n因素认证）</li>
<li>离线破解；</li>
</ul>
<h1>加盐</h1>
<p>盐值是一种随机数据，计算密码的哈希值时用于加强数据，抵御多种攻击媒介尤其是字典攻击和彩虹表。这个随机数据（特别长）能确保生成的哈希值是唯一的，即使多个用户使用相同的密码（确实有这种情况），添加唯一的盐值后能确保得到的哈希值仍是唯一的。就因为得到的哈希值是唯一的，我们才得以免受彩虹表和字典攻击的危害。</p>
<p>盐值的特点：盐值需要<span class="label info">足够长</span>、<span class="label info">不可预测</span>、<span class="label info">高度随机</span>、需要使用<span class="label info">安全的伪随机函数</span>生成，另外，还要避免使用全局的盐值。</p>
<h2>生成随机盐值</h2>
<p>使用 Node 原生支持的的 <a href="http://nodejs.cn/api/crypto.html#crypto_crypto_randombytes_size_callback" target="_blank" rel="noopener">crypto</a> 库生成随机盐值。</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// crypto.randomBytes() 生成 16 位强加密的伪随机数</span></span><br><span class="line">crypto.randomBytes(<span class="number">16</span>, (err, buf) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;buf.length&#125;</span> bytes of random data: <span class="subst">$&#123;buf.toString(<span class="string">'hex'</span>)&#125;</span>`</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;buf.length&#125;</span> bytes of random data: <span class="subst">$&#123;buf.toString(<span class="string">'base64'</span>)&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步方法生成盐值</span></span><br><span class="line"><span class="keyword">const</span> buf = crypto.randomBytes(<span class="number">256</span>);</span><br></pre></td></tr></table></figure></p>
<h2>重用盐值</h2>
<p>用户注册账户或修改密码时应该生成并存储新的盐值和哈希值。</p>
<h2>盐值的长度</h2>
<ul>
<li>根据经验，盐值的长度应该与哈希函数的输出长度一致。</li>
<li>PBKDF2 标准建议至少应该使用 <span class="label info">64 位（8字节）</span>长度的盐值。通常，多数情况下使用的是2的7次方，即 <span class="label info">128 位（16字节）</span>。</li>
</ul>
<h2>把盐值存储在哪？</h2>
<p><s>盐值可以和哈希值一起以明文形式存储在数据库中。</s></p>
<p>salt 不能和哈希值存储在一起，不然就和没有 salt 一样，因为攻击者拖库后，构建字典非常简单，因为它能够直接看到 salt，所以一定要分开存储（比如在不同的机器上），这样即使口令密文表被拖库了，而 salt 表没有被拖库，也是相对安全的。</p>
<h1>撒胡椒</h1>
<ul>
<li>胡椒是在计算哈希值时随盐值和密码一起传入的值。</li>
<li>使用胡椒的简单公式：hash ( salt + pepper + password ) = password hash</li>
<li>胡椒在代码层计算，而不是使用存储的值。</li>
<li>使用胡椒的原因：利用额外的字符和符号加强密码的强度。</li>
</ul>
<h1>选择正确的密码哈希函数</h1>
<h2>bcrypt ⭐️⭐️⭐️</h2>
<p>GitHub 源码：<a href="https://github.com/kelektiv/node.bcrypt.js#readme" target="_blank" rel="noopener">node.bcrypt.js</a></p>
<p>特性：专为加密密码设计，底层基于 Blowfish 密码法，有异步方法和同步方法、密码哈希函数、校验密码函数、带 promise 特性...</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">'bcrypt'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 封装 hash 函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bcrypt_encrypt</span>(<span class="params">username, password</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. bcrypt 内置了生成盐值的方法：getSalt()</span></span><br><span class="line">  bcrypt.genSalt(<span class="number">10</span>, (err, salt) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      </span><br><span class="line">    <span class="comment">// 2. 生成哈希值：hash()</span></span><br><span class="line">    bcrypt.hash(password, salt, (err, key) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 3. 把用户名、密码哈希值和盐值存入数据库</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用示例</span></span><br><span class="line">bcrypt_encrypt(<span class="string">'zhangsan'</span>, <span class="string">'123456'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对比哈希值，验证密码：</span></span><br><span class="line">bcrypt.compare(password, hash, (err, same) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 返回 true 或 false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2>PBKDF2</h2>
<ul>
<li>1Password、LastPass 等密码管理系统采用的算法；</li>
<li>Node.js 中的 crypt 模块原生支持的标准算法；</li>
<li>通过该算法可以实现基于口令的加密（PBE），即<strong>基于口令生成密钥</strong>。</li>
</ul>
<p>加密示例：</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PBKDF2 算法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pbkdf2_encrypt</span>(<span class="params">username, password</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. crypto.randomBytes(）方法生成 32 字节的随机盐值</span></span><br><span class="line">  crypto.randomBytes(<span class="number">32</span>, (err, salt) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 参数列表：（密码，盐值，迭代次数，输出密钥长度，摘要算法）</span></span><br><span class="line">    crypto.pbkdf2(password, salt, <span class="number">4096</span>, <span class="number">512</span>, <span class="string">'sha256'</span>, (err, key) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 3. 将用户名、密码哈希值和盐值存入数据库</span></span><br><span class="line">      <span class="comment">// Salt 盐值是明文保存的，一般不和最终生成的密钥保存在一起。</span></span><br><span class="line">      <span class="built_in">console</span>.log(username, key.toString(<span class="string">'hex'</span>), salt.toString(<span class="string">'hex'</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用示例</span></span><br><span class="line">pbkdf2_encrypt(<span class="string">'zhangSan'</span>, <span class="string">'123456'</span>);</span><br></pre></td></tr></table></figure></p>
<p>对比哈希值，验证密码：</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dbsalt = <span class="string">'USER RECORD SALT FROM YOUR DATABASE'</span>;</span><br><span class="line"><span class="keyword">const</span> dbhash = <span class="string">'USER RECORD KEY FROM YOUR DATABASE'</span>;</span><br><span class="line"></span><br><span class="line">crypto.pbkdf2(password, dbsalt, <span class="number">4096</span>, <span class="number">512</span>, <span class="string">'sha256'</span>, (err, comparsehash) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 比较</span></span><br><span class="line">  <span class="keyword">if</span> (dbhash.toString(<span class="string">'hex'</span>) === comparsehash.toString(<span class="string">'hex'</span>)) &#123;</span><br><span class="line">    <span class="comment">// 密码匹配</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 密码不匹配</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2>scrypt</h2>
<p>GitHub 源码：<a href="(https://github.com/barrysteyn/node-scrypt)">node-scrypt</a></p>
<p>scrypt 的优势和实现如下：</p>
<ul>
<li>做了特殊设计，是硬件和内存密集型算法，攻击者要实施大型攻击，想要破解需要耗费异常多的硬件和内存。</li>
<li>是加密数字货币莱特币和狗狗币背后采用的算法。</li>
</ul>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scrypt = <span class="built_in">require</span>(<span class="string">'scrypt'</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrypt_encrypt</span>(<span class="params">username, password</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. 使用 crypto 的 crypto.randomBytes(...) 方法生成盐值。</span></span><br><span class="line">  crypto.randomBytes(<span class="number">32</span>, (err, salt) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. scrypt.hash(...) 生成 64 位的哈希值</span></span><br><span class="line">    <span class="comment">// - N: scrypt 最多使用多长时间（秒数）计算密钥（偶数）。</span></span><br><span class="line">    <span class="comment">// - r:计算密钥时最多使用多少字节 RAM（整数）。默认为0。</span></span><br><span class="line">    <span class="comment">// - p:计算密钥时所用 RAM 占可用值的比例（0-1，换算成百分比）默认为0.5。</span></span><br><span class="line">    scrypt.hash(password, &#123;<span class="string">"N"</span>:<span class="number">16384</span>,<span class="string">"r"</span>:<span class="number">8</span>,<span class="string">"p"</span>:<span class="number">1</span>&#125;, <span class="number">64</span>, salt, (err, key) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 3. 把用户名、密码哈希值和盐值存入数据库</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`key is <span class="subst">$&#123;key&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2>密钥延伸</h2>
<p>bcrypt、scrypt 和 PBKDF2 行之有效涉及到的底层概念——密钥延伸（Key Derivation Function，KDF）。
<strong>密钥延伸</strong>：把弱密码变成特别复杂的长密码，致使暴力攻击等攻击媒介不再可行。</p>
<p>对加密哈希函数来说，密钥延伸体现在不断循环应用哈希函数（哈希函数迭代），直到得到所需长度和复杂度的哈希值为止。</p>
<h1>重新计算哈希值</h1>
<p>有时可能需要为用户生成新的密码哈希值。比如说:</p>
<ul>
<li>根据摩尔定律，硬件更新了，要修改加密算法使用的权重/工作因子。</li>
<li>算法变了，或者有更好的算法出现，目前使用的算法不安全。</li>
<li>觉得现有哈希值不再安全。</li>
</ul>
<p>遇到这些情况，符合常规的做法是为用户生成新哈希值，存储在系统中。用户提供用户名和密码请求登录时，正常比较根据输入值计算的哈希值和存储的哈希值，而不是拒绝登录。随后，为用户生成新的哈希值，替换用户记录中的旧值。</p>
<h1>参考</h1>
<ul>
<li><a href="https://www.cnblogs.com/lobby/p/5361789.html" target="_blank" rel="noopener">设计安全的账号系统的正确姿势</a></li>
<li><a href="https://mp.weixin.qq.com/s/1X_aOoadk1CCBzGFC-EM3w" target="_blank" rel="noopener">如何安全存储口令？了解下 Hash 加盐的原理</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/avatar.png" alt="独木舟的木">
            
              <p class="site-author-name" itemprop="name">独木舟的木</p>
              <div class="site-description motion-element" itemprop="description">有时候阳光很好 有时候阳光很暗</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">315</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">37</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Andy0570" title="GitHub &rarr; https://github.com/Andy0570" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:andywhm@163.com" title="E-Mail &rarr; mailto:andywhm@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">独木舟的木</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">2.3m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">34:07</span>
  
</div>



  <span id="busuanzi_container_site_uv">
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
  </span>
  <span class="post-meta-divider">|</span>

  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  



  
    
    
      
    
  
  <script color="17,119,176" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>













  
  <script src="//cdn.jsdelivr.net/npm/jquery@2/dist/jquery.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery-lazyload@1/jquery.lazyload.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  
  
  
    
  

  
    
      
    
  

  
  
  
    <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
    <script>
      
        window.addEventListener('load', () => {
      
        quicklink({
          timeout: 3000,
          priority: true,
          ignores: [uri => uri.includes('#'),uri => uri == 'https://andy0570.com/page/4/',]
        });
      
        });
      
    </script>
  


  



  



  
  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.min.css">

  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/instantsearch.js@2/dist/instantsearch.js"></script>
  

  <script src="/js/algolia-search.js?v=7.1.0"></script>



  

  

  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script>pangu.spacingPage();</script>


  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.loadBookmark();
  
  </script>


  

  

  
  
</body>
</html>
